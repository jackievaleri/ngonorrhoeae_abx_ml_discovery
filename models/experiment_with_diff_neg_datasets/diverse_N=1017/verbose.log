Command line
python /home/jackievaleri8/.conda/envs/chemprop/bin/chemprop_train --dropout 0.1 --hidden_size 500 --ffn_num_layers 2 --depth 3 --metric prc-auc --extra_metrics auc --save_dir models/controls_with_diff_neg_datasets/diverse_N=1017/ --data_path data/controls_with_diff_neg_datasets/diverse_N=1017.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --num_folds 5 --ensemble_size 2 --split_type scaffold_balanced --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --gpu 0
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/controls_with_diff_neg_datasets/diverse_N=1017.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda', index=0),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 2,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 500,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'models/controls_with_diff_neg_datasets/diverse_N=1017/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'scaffold_balanced',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 1,229 | train scaffolds = 947 | val scaffolds = 148 | test scaffolds = 134
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 142 | target average = 0.169014


Scaffold 1
Task 0: count = 118 | target average = 0.440678


Scaffold 2
Task 0: count = 20 | target average = 0.000000


Scaffold 3
Task 0: count = 16 | target average = 0.187500


Scaffold 4
Task 0: count = 16 | target average = 0.062500


Scaffold 5
Task 0: count = 14 | target average = 0.000000


Scaffold 6
Task 0: count = 12 | target average = 0.000000


Scaffold 7
Task 0: count = 11 | target average = 0.181818


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 9 | target average = 1.000000


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 5.8393e-01, PNorm = 43.2249, GNorm = 0.9000, lr_0 = 2.5469e-04
Loss = 4.3206e-01, PNorm = 43.2493, GNorm = 0.7127, lr_0 = 3.9531e-04
Loss = 3.5733e-01, PNorm = 43.2756, GNorm = 2.7601, lr_0 = 5.3594e-04
Validation prc-auc = 0.976507
Validation auc = 0.967449
Epoch 1
Loss = 3.8029e-01, PNorm = 43.2995, GNorm = 1.0145, lr_0 = 6.9063e-04
Loss = 3.3674e-01, PNorm = 43.3252, GNorm = 0.3581, lr_0 = 8.3125e-04
Loss = 3.5706e-01, PNorm = 43.3526, GNorm = 0.4147, lr_0 = 9.7187e-04
Validation prc-auc = 0.978486
Validation auc = 0.969306
Epoch 2
Loss = 3.1197e-01, PNorm = 43.3953, GNorm = 0.4571, lr_0 = 9.7965e-04
Loss = 3.5372e-01, PNorm = 43.4374, GNorm = 0.4105, lr_0 = 9.5480e-04
Loss = 2.9195e-01, PNorm = 43.4850, GNorm = 1.0022, lr_0 = 9.3057e-04
Validation prc-auc = 0.978889
Validation auc = 0.970870
Epoch 3
Loss = 3.9528e-01, PNorm = 43.5208, GNorm = 0.5114, lr_0 = 9.0463e-04
Loss = 2.7674e-01, PNorm = 43.5637, GNorm = 0.3823, lr_0 = 8.8168e-04
Loss = 2.8063e-01, PNorm = 43.6112, GNorm = 0.6452, lr_0 = 8.5931e-04
Loss = 3.5463e-01, PNorm = 43.6520, GNorm = 0.9684, lr_0 = 8.3751e-04
Validation prc-auc = 0.978681
Validation auc = 0.966764
Epoch 4
Loss = 2.7725e-01, PNorm = 43.7011, GNorm = 1.4239, lr_0 = 8.1626e-04
Loss = 3.1090e-01, PNorm = 43.7486, GNorm = 0.9589, lr_0 = 7.9555e-04
Loss = 3.4167e-01, PNorm = 43.7915, GNorm = 0.7451, lr_0 = 7.7537e-04
Validation prc-auc = 0.982560
Validation auc = 0.973607
Epoch 5
Loss = 2.9364e-01, PNorm = 43.8330, GNorm = 0.3008, lr_0 = 7.5376e-04
Loss = 3.0171e-01, PNorm = 43.8887, GNorm = 0.4475, lr_0 = 7.3463e-04
Loss = 2.7859e-01, PNorm = 43.9451, GNorm = 0.5599, lr_0 = 7.1600e-04
Validation prc-auc = 0.979261
Validation auc = 0.969208
Epoch 6
Loss = 3.2393e-01, PNorm = 43.9874, GNorm = 0.3779, lr_0 = 6.9783e-04
Loss = 2.7268e-01, PNorm = 44.0283, GNorm = 0.3191, lr_0 = 6.8013e-04
Loss = 2.8747e-01, PNorm = 44.0752, GNorm = 0.3962, lr_0 = 6.6287e-04
Validation prc-auc = 0.980336
Validation auc = 0.970772
Epoch 7
Loss = 2.3724e-01, PNorm = 44.1245, GNorm = 0.2952, lr_0 = 6.4439e-04
Loss = 2.8257e-01, PNorm = 44.1861, GNorm = 0.7746, lr_0 = 6.2805e-04
Loss = 2.8765e-01, PNorm = 44.2426, GNorm = 0.6726, lr_0 = 6.1211e-04
Loss = 2.5881e-01, PNorm = 44.2983, GNorm = 0.4326, lr_0 = 5.9658e-04
Validation prc-auc = 0.978879
Validation auc = 0.969990
Epoch 8
Loss = 2.7746e-01, PNorm = 44.3511, GNorm = 1.2909, lr_0 = 5.8145e-04
Loss = 2.8703e-01, PNorm = 44.3979, GNorm = 0.6825, lr_0 = 5.6669e-04
Loss = 2.5868e-01, PNorm = 44.4507, GNorm = 0.4310, lr_0 = 5.5232e-04
Validation prc-auc = 0.977365
Validation auc = 0.966373
Epoch 9
Loss = 2.4469e-01, PNorm = 44.5122, GNorm = 0.6396, lr_0 = 5.3692e-04
Loss = 2.7448e-01, PNorm = 44.5705, GNorm = 0.2615, lr_0 = 5.2330e-04
Loss = 2.3267e-01, PNorm = 44.6178, GNorm = 0.4779, lr_0 = 5.1002e-04
Validation prc-auc = 0.977373
Validation auc = 0.966178
Epoch 10
Loss = 2.5542e-01, PNorm = 44.6783, GNorm = 0.3873, lr_0 = 4.9708e-04
Loss = 2.3528e-01, PNorm = 44.7335, GNorm = 0.4966, lr_0 = 4.8447e-04
Loss = 2.3819e-01, PNorm = 44.7819, GNorm = 0.6692, lr_0 = 4.7218e-04
Validation prc-auc = 0.977860
Validation auc = 0.967449
Epoch 11
Loss = 2.1420e-01, PNorm = 44.8334, GNorm = 0.5082, lr_0 = 4.5902e-04
Loss = 2.2185e-01, PNorm = 44.8939, GNorm = 0.3382, lr_0 = 4.4737e-04
Loss = 2.7060e-01, PNorm = 44.9405, GNorm = 0.3969, lr_0 = 4.3602e-04
Loss = 2.5004e-01, PNorm = 44.9732, GNorm = 1.1848, lr_0 = 4.2496e-04
Validation prc-auc = 0.977131
Validation auc = 0.965885
Epoch 12
Loss = 2.8091e-01, PNorm = 45.0304, GNorm = 0.4259, lr_0 = 4.1418e-04
Loss = 2.0597e-01, PNorm = 45.0843, GNorm = 0.6299, lr_0 = 4.0367e-04
Loss = 2.3577e-01, PNorm = 45.1204, GNorm = 0.8305, lr_0 = 3.9343e-04
Validation prc-auc = 0.977975
Validation auc = 0.967937
Epoch 13
Loss = 2.2795e-01, PNorm = 45.1676, GNorm = 0.3975, lr_0 = 3.8345e-04
Loss = 2.2737e-01, PNorm = 45.2218, GNorm = 0.7613, lr_0 = 3.7372e-04
Loss = 2.0382e-01, PNorm = 45.2551, GNorm = 0.4244, lr_0 = 3.6424e-04
Validation prc-auc = 0.975896
Validation auc = 0.964712
Epoch 14
Loss = 1.6065e-01, PNorm = 45.3037, GNorm = 0.4925, lr_0 = 3.5408e-04
Loss = 2.4065e-01, PNorm = 45.3459, GNorm = 0.7296, lr_0 = 3.4510e-04
Loss = 1.9963e-01, PNorm = 45.3891, GNorm = 0.9382, lr_0 = 3.3635e-04
Validation prc-auc = 0.975967
Validation auc = 0.964516
Epoch 15
Loss = 1.9321e-01, PNorm = 45.4285, GNorm = 0.4366, lr_0 = 3.2781e-04
Loss = 2.0509e-01, PNorm = 45.4799, GNorm = 0.4898, lr_0 = 3.1950e-04
Loss = 1.9918e-01, PNorm = 45.5216, GNorm = 0.4163, lr_0 = 3.1139e-04
Loss = 2.1877e-01, PNorm = 45.5643, GNorm = 0.5858, lr_0 = 3.0349e-04
Loss = 8.6906e-02, PNorm = 45.5668, GNorm = 0.5409, lr_0 = 3.0271e-04
Validation prc-auc = 0.972695
Validation auc = 0.958651
Epoch 16
Loss = 2.2474e-01, PNorm = 45.5905, GNorm = 0.6005, lr_0 = 2.9503e-04
Loss = 1.9983e-01, PNorm = 45.6226, GNorm = 1.4926, lr_0 = 2.8754e-04
Loss = 1.9772e-01, PNorm = 45.6620, GNorm = 0.4043, lr_0 = 2.8025e-04
Validation prc-auc = 0.974883
Validation auc = 0.964418
Epoch 17
Loss = 2.1013e-01, PNorm = 45.7014, GNorm = 0.5737, lr_0 = 2.7314e-04
Loss = 1.6258e-01, PNorm = 45.7435, GNorm = 0.4700, lr_0 = 2.6621e-04
Loss = 2.0876e-01, PNorm = 45.7787, GNorm = 0.8469, lr_0 = 2.5946e-04
Validation prc-auc = 0.971949
Validation auc = 0.958847
Epoch 18
Loss = 1.8223e-01, PNorm = 45.8182, GNorm = 1.0927, lr_0 = 2.5222e-04
Loss = 1.9331e-01, PNorm = 45.8550, GNorm = 0.3952, lr_0 = 2.4582e-04
Loss = 1.9386e-01, PNorm = 45.8839, GNorm = 0.5879, lr_0 = 2.3959e-04
Validation prc-auc = 0.972916
Validation auc = 0.962757
Epoch 19
Loss = 1.4927e-01, PNorm = 45.9207, GNorm = 0.2720, lr_0 = 2.3351e-04
Loss = 1.6483e-01, PNorm = 45.9541, GNorm = 0.4878, lr_0 = 2.2758e-04
Loss = 1.7270e-01, PNorm = 45.9921, GNorm = 0.8624, lr_0 = 2.2181e-04
Loss = 1.9122e-01, PNorm = 46.0233, GNorm = 0.4248, lr_0 = 2.1618e-04
Loss = 1.1176e-01, PNorm = 46.0266, GNorm = 0.5408, lr_0 = 2.1563e-04
Validation prc-auc = 0.970692
Validation auc = 0.958944
Epoch 20
Loss = 1.5356e-01, PNorm = 46.0576, GNorm = 0.7324, lr_0 = 2.1016e-04
Loss = 1.7466e-01, PNorm = 46.0878, GNorm = 0.4875, lr_0 = 2.0483e-04
Loss = 1.6522e-01, PNorm = 46.1210, GNorm = 0.8150, lr_0 = 1.9963e-04
Validation prc-auc = 0.969438
Validation auc = 0.957674
Epoch 21
Loss = 1.4923e-01, PNorm = 46.1462, GNorm = 0.6325, lr_0 = 1.9456e-04
Loss = 1.5226e-01, PNorm = 46.1756, GNorm = 0.4932, lr_0 = 1.8963e-04
Loss = 1.6847e-01, PNorm = 46.2034, GNorm = 0.5940, lr_0 = 1.8482e-04
Validation prc-auc = 0.969054
Validation auc = 0.957674
Epoch 22
Loss = 1.4056e-01, PNorm = 46.2337, GNorm = 0.9522, lr_0 = 1.7967e-04
Loss = 1.8080e-01, PNorm = 46.2580, GNorm = 0.8838, lr_0 = 1.7511e-04
Loss = 1.4238e-01, PNorm = 46.2857, GNorm = 0.6182, lr_0 = 1.7066e-04
Validation prc-auc = 0.970871
Validation auc = 0.960215
Epoch 23
Loss = 2.0806e-01, PNorm = 46.3129, GNorm = 1.3312, lr_0 = 1.6633e-04
Loss = 1.4214e-01, PNorm = 46.3383, GNorm = 1.0242, lr_0 = 1.6211e-04
Loss = 1.5739e-01, PNorm = 46.3605, GNorm = 0.8261, lr_0 = 1.5800e-04
Loss = 1.6022e-01, PNorm = 46.3843, GNorm = 0.6151, lr_0 = 1.5399e-04
Loss = 9.4542e-02, PNorm = 46.3872, GNorm = 0.7082, lr_0 = 1.5360e-04
Validation prc-auc = 0.969331
Validation auc = 0.956109
Epoch 24
Loss = 1.7649e-01, PNorm = 46.4098, GNorm = 0.4749, lr_0 = 1.4970e-04
Loss = 1.3042e-01, PNorm = 46.4346, GNorm = 0.8409, lr_0 = 1.4590e-04
Loss = 1.4418e-01, PNorm = 46.4577, GNorm = 0.6319, lr_0 = 1.4220e-04
Validation prc-auc = 0.969582
Validation auc = 0.958651
Epoch 25
Loss = 1.2747e-01, PNorm = 46.4771, GNorm = 0.4682, lr_0 = 1.3859e-04
Loss = 1.4223e-01, PNorm = 46.4990, GNorm = 0.4478, lr_0 = 1.3508e-04
Loss = 1.5750e-01, PNorm = 46.5176, GNorm = 0.8755, lr_0 = 1.3165e-04
Validation prc-auc = 0.969128
Validation auc = 0.955230
Epoch 26
Loss = 1.4478e-01, PNorm = 46.5363, GNorm = 0.5626, lr_0 = 1.2831e-04
Loss = 1.5312e-01, PNorm = 46.5554, GNorm = 0.7230, lr_0 = 1.2505e-04
Loss = 1.3372e-01, PNorm = 46.5711, GNorm = 1.1867, lr_0 = 1.2188e-04
Validation prc-auc = 0.970313
Validation auc = 0.960704
Epoch 27
Loss = 1.2348e-01, PNorm = 46.5923, GNorm = 0.9939, lr_0 = 1.1848e-04
Loss = 1.3486e-01, PNorm = 46.6126, GNorm = 0.4971, lr_0 = 1.1548e-04
Loss = 1.3967e-01, PNorm = 46.6312, GNorm = 0.9508, lr_0 = 1.1255e-04
Loss = 1.4257e-01, PNorm = 46.6473, GNorm = 1.0678, lr_0 = 1.0969e-04
Validation prc-auc = 0.966285
Validation auc = 0.956305
Epoch 28
Loss = 1.2259e-01, PNorm = 46.6628, GNorm = 0.4157, lr_0 = 1.0691e-04
Loss = 1.4509e-01, PNorm = 46.6789, GNorm = 1.7861, lr_0 = 1.0420e-04
Loss = 1.2520e-01, PNorm = 46.6922, GNorm = 0.4314, lr_0 = 1.0155e-04
Validation prc-auc = 0.968938
Validation auc = 0.956989
Epoch 29
Loss = 1.2954e-01, PNorm = 46.7108, GNorm = 0.4654, lr_0 = 1.0000e-04
Loss = 1.1945e-01, PNorm = 46.7255, GNorm = 0.7478, lr_0 = 1.0000e-04
Loss = 1.3317e-01, PNorm = 46.7387, GNorm = 0.8529, lr_0 = 1.0000e-04
Validation prc-auc = 0.969082
Validation auc = 0.959238
Model 0 best validation prc-auc = 0.982560 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.947602
Model 0 test auc = 0.944600
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.2932e-01, PNorm = 43.2489, GNorm = 0.8516, lr_0 = 2.5469e-04
Loss = 4.7032e-01, PNorm = 43.2678, GNorm = 1.0526, lr_0 = 3.9531e-04
Loss = 3.9285e-01, PNorm = 43.2961, GNorm = 1.6288, lr_0 = 5.3594e-04
Validation prc-auc = 0.975866
Validation auc = 0.967449
Epoch 1
Loss = 3.6561e-01, PNorm = 43.3268, GNorm = 0.4808, lr_0 = 6.9063e-04
Loss = 3.5381e-01, PNorm = 43.3593, GNorm = 0.5540, lr_0 = 8.3125e-04
Loss = 3.7226e-01, PNorm = 43.3995, GNorm = 0.5882, lr_0 = 9.7187e-04
Validation prc-auc = 0.977173
Validation auc = 0.965689
Epoch 2
Loss = 3.5217e-01, PNorm = 43.4454, GNorm = 0.6894, lr_0 = 9.7965e-04
Loss = 3.6401e-01, PNorm = 43.4908, GNorm = 0.4823, lr_0 = 9.5480e-04
Loss = 3.2875e-01, PNorm = 43.5370, GNorm = 0.3315, lr_0 = 9.3057e-04
Validation prc-auc = 0.978196
Validation auc = 0.969404
Epoch 3
Loss = 3.0739e-01, PNorm = 43.5872, GNorm = 0.5722, lr_0 = 9.0463e-04
Loss = 3.1279e-01, PNorm = 43.6361, GNorm = 0.4297, lr_0 = 8.8168e-04
Loss = 3.2106e-01, PNorm = 43.6788, GNorm = 0.3579, lr_0 = 8.5931e-04
Loss = 3.5298e-01, PNorm = 43.7228, GNorm = 1.0047, lr_0 = 8.3751e-04
Validation prc-auc = 0.978350
Validation auc = 0.969013
Epoch 4
Loss = 2.9227e-01, PNorm = 43.7790, GNorm = 0.3397, lr_0 = 8.1626e-04
Loss = 3.2193e-01, PNorm = 43.8292, GNorm = 0.2724, lr_0 = 7.9555e-04
Loss = 3.1379e-01, PNorm = 43.8716, GNorm = 0.7745, lr_0 = 7.7537e-04
Validation prc-auc = 0.979287
Validation auc = 0.969892
Epoch 5
Loss = 2.6485e-01, PNorm = 43.9318, GNorm = 1.3864, lr_0 = 7.5376e-04
Loss = 3.3137e-01, PNorm = 43.9841, GNorm = 0.4417, lr_0 = 7.3463e-04
Loss = 2.9402e-01, PNorm = 44.0257, GNorm = 0.5005, lr_0 = 7.1600e-04
Validation prc-auc = 0.979611
Validation auc = 0.969599
Epoch 6
Loss = 3.0923e-01, PNorm = 44.0741, GNorm = 0.3859, lr_0 = 6.9783e-04
Loss = 2.7750e-01, PNorm = 44.1279, GNorm = 0.8289, lr_0 = 6.8013e-04
Loss = 2.9764e-01, PNorm = 44.1779, GNorm = 0.5099, lr_0 = 6.6287e-04
Validation prc-auc = 0.976994
Validation auc = 0.963441
Epoch 7
Loss = 2.7892e-01, PNorm = 44.2323, GNorm = 0.6504, lr_0 = 6.4439e-04
Loss = 2.3350e-01, PNorm = 44.2872, GNorm = 0.3427, lr_0 = 6.2805e-04
Loss = 2.6200e-01, PNorm = 44.3496, GNorm = 0.3633, lr_0 = 6.1211e-04
Loss = 3.3127e-01, PNorm = 44.3934, GNorm = 1.3268, lr_0 = 5.9658e-04
Validation prc-auc = 0.978319
Validation auc = 0.966569
Epoch 8
Loss = 2.2967e-01, PNorm = 44.4431, GNorm = 0.2421, lr_0 = 5.8145e-04
Loss = 2.8991e-01, PNorm = 44.4985, GNorm = 0.8050, lr_0 = 5.6669e-04
Loss = 2.8907e-01, PNorm = 44.5512, GNorm = 0.4730, lr_0 = 5.5232e-04
Validation prc-auc = 0.976688
Validation auc = 0.964418
Epoch 9
Loss = 2.5448e-01, PNorm = 44.6069, GNorm = 0.4223, lr_0 = 5.3692e-04
Loss = 2.3815e-01, PNorm = 44.6560, GNorm = 0.6682, lr_0 = 5.2330e-04
Loss = 2.7099e-01, PNorm = 44.7111, GNorm = 0.6939, lr_0 = 5.1002e-04
Validation prc-auc = 0.975205
Validation auc = 0.960704
Epoch 10
Loss = 2.2518e-01, PNorm = 44.7684, GNorm = 0.5332, lr_0 = 4.9708e-04
Loss = 2.6211e-01, PNorm = 44.8243, GNorm = 0.3722, lr_0 = 4.8447e-04
Loss = 2.6029e-01, PNorm = 44.8868, GNorm = 0.5876, lr_0 = 4.7218e-04
Validation prc-auc = 0.974356
Validation auc = 0.960704
Epoch 11
Loss = 1.9293e-01, PNorm = 44.9301, GNorm = 0.2490, lr_0 = 4.5902e-04
Loss = 2.4832e-01, PNorm = 44.9863, GNorm = 1.1101, lr_0 = 4.4737e-04
Loss = 2.3020e-01, PNorm = 45.0424, GNorm = 0.3459, lr_0 = 4.3602e-04
Loss = 2.4220e-01, PNorm = 45.0926, GNorm = 0.8348, lr_0 = 4.2496e-04
Validation prc-auc = 0.975315
Validation auc = 0.962463
Epoch 12
Loss = 2.3163e-01, PNorm = 45.1512, GNorm = 0.4122, lr_0 = 4.1418e-04
Loss = 2.5341e-01, PNorm = 45.2107, GNorm = 0.5289, lr_0 = 4.0367e-04
Loss = 2.4755e-01, PNorm = 45.2504, GNorm = 1.0695, lr_0 = 3.9343e-04
Validation prc-auc = 0.975955
Validation auc = 0.964712
Epoch 13
Loss = 2.0773e-01, PNorm = 45.2820, GNorm = 0.8625, lr_0 = 3.8345e-04
Loss = 2.5423e-01, PNorm = 45.3369, GNorm = 1.7885, lr_0 = 3.7372e-04
Loss = 2.3913e-01, PNorm = 45.3742, GNorm = 0.3588, lr_0 = 3.6424e-04
Validation prc-auc = 0.973142
Validation auc = 0.959433
Epoch 14
Loss = 2.0288e-01, PNorm = 45.4244, GNorm = 0.2514, lr_0 = 3.5408e-04
Loss = 2.4598e-01, PNorm = 45.4758, GNorm = 0.5302, lr_0 = 3.4510e-04
Loss = 1.8601e-01, PNorm = 45.5156, GNorm = 0.3384, lr_0 = 3.3635e-04
Validation prc-auc = 0.972465
Validation auc = 0.958065
Epoch 15
Loss = 2.5706e-01, PNorm = 45.5556, GNorm = 0.3220, lr_0 = 3.2781e-04
Loss = 1.8616e-01, PNorm = 45.5947, GNorm = 0.2890, lr_0 = 3.1950e-04
Loss = 1.9604e-01, PNorm = 45.6368, GNorm = 0.6709, lr_0 = 3.1139e-04
Loss = 2.1807e-01, PNorm = 45.6761, GNorm = 0.6619, lr_0 = 3.0349e-04
Loss = 2.1213e-01, PNorm = 45.6794, GNorm = 0.6238, lr_0 = 3.0271e-04
Validation prc-auc = 0.973517
Validation auc = 0.959629
Epoch 16
Loss = 1.7974e-01, PNorm = 45.7243, GNorm = 0.3024, lr_0 = 2.9503e-04
Loss = 1.8847e-01, PNorm = 45.7684, GNorm = 0.9010, lr_0 = 2.8754e-04
Loss = 2.1428e-01, PNorm = 45.8164, GNorm = 0.7998, lr_0 = 2.8025e-04
Validation prc-auc = 0.970199
Validation auc = 0.954154
Epoch 17
Loss = 1.7048e-01, PNorm = 45.8507, GNorm = 0.4561, lr_0 = 2.7314e-04
Loss = 1.9782e-01, PNorm = 45.8926, GNorm = 0.5311, lr_0 = 2.6621e-04
Loss = 1.8005e-01, PNorm = 45.9291, GNorm = 0.8609, lr_0 = 2.5946e-04
Validation prc-auc = 0.973333
Validation auc = 0.961193
Epoch 18
Loss = 2.2113e-01, PNorm = 45.9668, GNorm = 0.7802, lr_0 = 2.5222e-04
Loss = 1.4705e-01, PNorm = 46.0085, GNorm = 0.5404, lr_0 = 2.4582e-04
Loss = 2.1241e-01, PNorm = 46.0423, GNorm = 0.8260, lr_0 = 2.3959e-04
Validation prc-auc = 0.970072
Validation auc = 0.957087
Epoch 19
Loss = 2.2226e-01, PNorm = 46.0715, GNorm = 0.5140, lr_0 = 2.3351e-04
Loss = 1.8020e-01, PNorm = 46.1103, GNorm = 0.7914, lr_0 = 2.2758e-04
Loss = 1.7102e-01, PNorm = 46.1394, GNorm = 0.6756, lr_0 = 2.2181e-04
Loss = 1.7770e-01, PNorm = 46.1781, GNorm = 0.5552, lr_0 = 2.1618e-04
Loss = 8.2043e-02, PNorm = 46.1805, GNorm = 0.8823, lr_0 = 2.1563e-04
Validation prc-auc = 0.972108
Validation auc = 0.957380
Epoch 20
Loss = 1.7023e-01, PNorm = 46.2106, GNorm = 0.5069, lr_0 = 2.1016e-04
Loss = 1.6814e-01, PNorm = 46.2413, GNorm = 0.7128, lr_0 = 2.0483e-04
Loss = 1.5774e-01, PNorm = 46.2727, GNorm = 0.8543, lr_0 = 1.9963e-04
Validation prc-auc = 0.970473
Validation auc = 0.956403
Epoch 21
Loss = 1.7506e-01, PNorm = 46.3008, GNorm = 0.6545, lr_0 = 1.9456e-04
Loss = 1.4709e-01, PNorm = 46.3337, GNorm = 0.6133, lr_0 = 1.8963e-04
Loss = 1.6223e-01, PNorm = 46.3620, GNorm = 0.7990, lr_0 = 1.8482e-04
Validation prc-auc = 0.968482
Validation auc = 0.955034
Epoch 22
Loss = 1.9468e-01, PNorm = 46.3880, GNorm = 1.1059, lr_0 = 1.7967e-04
Loss = 1.3902e-01, PNorm = 46.4117, GNorm = 0.5146, lr_0 = 1.7511e-04
Loss = 1.6552e-01, PNorm = 46.4411, GNorm = 0.5998, lr_0 = 1.7066e-04
Validation prc-auc = 0.966952
Validation auc = 0.950538
Epoch 23
Loss = 1.2497e-01, PNorm = 46.4661, GNorm = 0.5473, lr_0 = 1.6633e-04
Loss = 1.6363e-01, PNorm = 46.4852, GNorm = 0.9955, lr_0 = 1.6211e-04
Loss = 1.6686e-01, PNorm = 46.5071, GNorm = 0.5744, lr_0 = 1.5800e-04
Loss = 1.3411e-01, PNorm = 46.5341, GNorm = 0.6418, lr_0 = 1.5399e-04
Loss = 1.2287e-01, PNorm = 46.5371, GNorm = 1.1932, lr_0 = 1.5360e-04
Validation prc-auc = 0.970109
Validation auc = 0.955132
Epoch 24
Loss = 1.6464e-01, PNorm = 46.5607, GNorm = 0.7692, lr_0 = 1.4970e-04
Loss = 1.4073e-01, PNorm = 46.5835, GNorm = 0.7627, lr_0 = 1.4590e-04
Loss = 1.2989e-01, PNorm = 46.6095, GNorm = 0.6780, lr_0 = 1.4220e-04
Validation prc-auc = 0.966626
Validation auc = 0.953959
Epoch 25
Loss = 1.5438e-01, PNorm = 46.6311, GNorm = 1.1599, lr_0 = 1.3859e-04
Loss = 1.6351e-01, PNorm = 46.6587, GNorm = 0.9239, lr_0 = 1.3508e-04
Loss = 1.2363e-01, PNorm = 46.6756, GNorm = 0.5815, lr_0 = 1.3165e-04
Validation prc-auc = 0.967052
Validation auc = 0.953861
Epoch 26
Loss = 1.3387e-01, PNorm = 46.6943, GNorm = 0.5504, lr_0 = 1.2831e-04
Loss = 1.0832e-01, PNorm = 46.7114, GNorm = 0.4723, lr_0 = 1.2505e-04
Loss = 1.4667e-01, PNorm = 46.7308, GNorm = 0.8431, lr_0 = 1.2188e-04
Validation prc-auc = 0.966226
Validation auc = 0.951417
Epoch 27
Loss = 1.1991e-01, PNorm = 46.7517, GNorm = 0.5425, lr_0 = 1.1848e-04
Loss = 1.4278e-01, PNorm = 46.7727, GNorm = 0.7802, lr_0 = 1.1548e-04
Loss = 1.2216e-01, PNorm = 46.7893, GNorm = 0.8790, lr_0 = 1.1255e-04
Loss = 1.3947e-01, PNorm = 46.8046, GNorm = 0.5539, lr_0 = 1.0969e-04
Validation prc-auc = 0.968866
Validation auc = 0.957478
Epoch 28
Loss = 1.2863e-01, PNorm = 46.8200, GNorm = 0.7970, lr_0 = 1.0691e-04
Loss = 1.3440e-01, PNorm = 46.8357, GNorm = 0.5930, lr_0 = 1.0420e-04
Loss = 1.2097e-01, PNorm = 46.8517, GNorm = 0.6007, lr_0 = 1.0155e-04
Validation prc-auc = 0.969021
Validation auc = 0.955621
Epoch 29
Loss = 1.0654e-01, PNorm = 46.8647, GNorm = 0.5973, lr_0 = 1.0000e-04
Loss = 1.2990e-01, PNorm = 46.8813, GNorm = 0.6548, lr_0 = 1.0000e-04
Loss = 1.3198e-01, PNorm = 46.8964, GNorm = 1.1197, lr_0 = 1.0000e-04
Validation prc-auc = 0.964935
Validation auc = 0.953861
Model 1 best validation prc-auc = 0.979611 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.953519
Model 1 test auc = 0.945852
Ensemble test prc-auc = 0.950800
Ensemble test auc = 0.945563
Fold 1
Splitting data with seed 1
Total scaffolds = 1,229 | train scaffolds = 955 | val scaffolds = 126 | test scaffolds = 148
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 142 | target average = 0.169014


Scaffold 1
Task 0: count = 118 | target average = 0.440678


Scaffold 2
Task 0: count = 20 | target average = 0.000000


Scaffold 3
Task 0: count = 16 | target average = 0.187500


Scaffold 4
Task 0: count = 16 | target average = 0.062500


Scaffold 5
Task 0: count = 14 | target average = 0.000000


Scaffold 6
Task 0: count = 12 | target average = 0.000000


Scaffold 7
Task 0: count = 11 | target average = 0.181818


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 9 | target average = 0.888889


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 5.8207e-01, PNorm = 43.2248, GNorm = 0.8517, lr_0 = 2.5469e-04
Loss = 4.3124e-01, PNorm = 43.2502, GNorm = 0.5964, lr_0 = 3.9531e-04
Loss = 3.7900e-01, PNorm = 43.2745, GNorm = 0.9708, lr_0 = 5.3594e-04
Validation prc-auc = 0.944957
Validation auc = 0.927154
Epoch 1
Loss = 3.6795e-01, PNorm = 43.2980, GNorm = 1.0269, lr_0 = 6.9063e-04
Loss = 3.5530e-01, PNorm = 43.3249, GNorm = 0.7645, lr_0 = 8.3125e-04
Loss = 3.4593e-01, PNorm = 43.3589, GNorm = 0.6103, lr_0 = 9.7187e-04
Validation prc-auc = 0.940295
Validation auc = 0.925209
Epoch 2
Loss = 2.8770e-01, PNorm = 43.4036, GNorm = 0.8690, lr_0 = 9.7965e-04
Loss = 3.7136e-01, PNorm = 43.4459, GNorm = 1.0300, lr_0 = 9.5480e-04
Loss = 3.7392e-01, PNorm = 43.4809, GNorm = 1.1408, lr_0 = 9.3057e-04
Validation prc-auc = 0.940472
Validation auc = 0.924917
Epoch 3
Loss = 3.4385e-01, PNorm = 43.5262, GNorm = 0.3030, lr_0 = 9.0463e-04
Loss = 3.1795e-01, PNorm = 43.5679, GNorm = 0.4856, lr_0 = 8.8168e-04
Loss = 2.9566e-01, PNorm = 43.5966, GNorm = 0.4056, lr_0 = 8.5931e-04
Loss = 3.2114e-01, PNorm = 43.6337, GNorm = 1.0255, lr_0 = 8.3751e-04
Validation prc-auc = 0.940169
Validation auc = 0.922680
Epoch 4
Loss = 2.8852e-01, PNorm = 43.6708, GNorm = 0.4318, lr_0 = 8.1626e-04
Loss = 2.9796e-01, PNorm = 43.7188, GNorm = 0.3376, lr_0 = 7.9555e-04
Loss = 2.9652e-01, PNorm = 43.7662, GNorm = 0.5526, lr_0 = 7.7537e-04
Validation prc-auc = 0.941003
Validation auc = 0.920930
Epoch 5
Loss = 2.7631e-01, PNorm = 43.8154, GNorm = 0.3820, lr_0 = 7.5376e-04
Loss = 3.0007e-01, PNorm = 43.8560, GNorm = 0.5505, lr_0 = 7.3463e-04
Loss = 2.9185e-01, PNorm = 43.9066, GNorm = 0.3566, lr_0 = 7.1600e-04
Validation prc-auc = 0.945127
Validation auc = 0.926862
Epoch 6
Loss = 2.8796e-01, PNorm = 43.9504, GNorm = 0.2086, lr_0 = 6.9783e-04
Loss = 2.6964e-01, PNorm = 44.0023, GNorm = 0.3009, lr_0 = 6.8013e-04
Loss = 2.7307e-01, PNorm = 44.0504, GNorm = 0.4062, lr_0 = 6.6287e-04
Validation prc-auc = 0.942262
Validation auc = 0.921319
Epoch 7
Loss = 2.1400e-01, PNorm = 44.1035, GNorm = 0.6513, lr_0 = 6.4439e-04
Loss = 2.3248e-01, PNorm = 44.1641, GNorm = 0.4146, lr_0 = 6.2805e-04
Loss = 3.0731e-01, PNorm = 44.2138, GNorm = 0.9793, lr_0 = 6.1211e-04
Loss = 2.9527e-01, PNorm = 44.2569, GNorm = 0.8236, lr_0 = 5.9658e-04
Validation prc-auc = 0.941890
Validation auc = 0.918498
Epoch 8
Loss = 2.6215e-01, PNorm = 44.3154, GNorm = 0.4669, lr_0 = 5.8145e-04
Loss = 2.3442e-01, PNorm = 44.3742, GNorm = 0.3487, lr_0 = 5.6669e-04
Loss = 2.6849e-01, PNorm = 44.4184, GNorm = 0.3272, lr_0 = 5.5232e-04
Validation prc-auc = 0.947092
Validation auc = 0.927154
Epoch 9
Loss = 2.5378e-01, PNorm = 44.4638, GNorm = 0.5425, lr_0 = 5.3692e-04
Loss = 2.5449e-01, PNorm = 44.5065, GNorm = 0.2933, lr_0 = 5.2330e-04
Loss = 2.6868e-01, PNorm = 44.5501, GNorm = 0.4639, lr_0 = 5.1002e-04
Validation prc-auc = 0.945458
Validation auc = 0.922778
Epoch 10
Loss = 2.4788e-01, PNorm = 44.5986, GNorm = 0.7863, lr_0 = 4.9708e-04
Loss = 2.5328e-01, PNorm = 44.6437, GNorm = 0.6614, lr_0 = 4.8447e-04
Loss = 1.9009e-01, PNorm = 44.7051, GNorm = 0.4474, lr_0 = 4.7218e-04
Validation prc-auc = 0.947506
Validation auc = 0.927154
Epoch 11
Loss = 2.6447e-01, PNorm = 44.7563, GNorm = 0.5077, lr_0 = 4.5902e-04
Loss = 2.3029e-01, PNorm = 44.7992, GNorm = 0.4236, lr_0 = 4.4737e-04
Loss = 2.0872e-01, PNorm = 44.8477, GNorm = 0.4992, lr_0 = 4.3602e-04
Loss = 2.4436e-01, PNorm = 44.8927, GNorm = 0.9404, lr_0 = 4.2496e-04
Validation prc-auc = 0.944713
Validation auc = 0.921027
Epoch 12
Loss = 2.3225e-01, PNorm = 44.9416, GNorm = 0.7085, lr_0 = 4.1418e-04
Loss = 2.1293e-01, PNorm = 44.9953, GNorm = 0.4262, lr_0 = 4.0367e-04
Loss = 2.4179e-01, PNorm = 45.0333, GNorm = 0.5559, lr_0 = 3.9343e-04
Validation prc-auc = 0.946353
Validation auc = 0.925306
Epoch 13
Loss = 2.2158e-01, PNorm = 45.0751, GNorm = 0.3758, lr_0 = 3.8345e-04
Loss = 2.2060e-01, PNorm = 45.1222, GNorm = 0.5198, lr_0 = 3.7372e-04
Loss = 2.0624e-01, PNorm = 45.1672, GNorm = 0.3167, lr_0 = 3.6424e-04
Validation prc-auc = 0.945621
Validation auc = 0.922778
Epoch 14
Loss = 1.7778e-01, PNorm = 45.2091, GNorm = 0.6918, lr_0 = 3.5408e-04
Loss = 1.7660e-01, PNorm = 45.2527, GNorm = 0.4632, lr_0 = 3.4510e-04
Loss = 2.1508e-01, PNorm = 45.3035, GNorm = 0.5381, lr_0 = 3.3635e-04
Validation prc-auc = 0.946140
Validation auc = 0.923848
Epoch 15
Loss = 2.2654e-01, PNorm = 45.3360, GNorm = 0.4485, lr_0 = 3.2781e-04
Loss = 1.6522e-01, PNorm = 45.3681, GNorm = 0.3783, lr_0 = 3.1950e-04
Loss = 2.1653e-01, PNorm = 45.3983, GNorm = 0.7415, lr_0 = 3.1139e-04
Loss = 2.1671e-01, PNorm = 45.4364, GNorm = 0.3628, lr_0 = 3.0349e-04
Loss = 5.7156e-02, PNorm = 45.4414, GNorm = 0.5811, lr_0 = 3.0271e-04
Validation prc-auc = 0.942468
Validation auc = 0.916650
Epoch 16
Loss = 1.9903e-01, PNorm = 45.4869, GNorm = 0.5528, lr_0 = 2.9503e-04
Loss = 1.9015e-01, PNorm = 45.5235, GNorm = 0.3762, lr_0 = 2.8754e-04
Loss = 1.8333e-01, PNorm = 45.5595, GNorm = 0.4956, lr_0 = 2.8025e-04
Validation prc-auc = 0.943211
Validation auc = 0.919957
Epoch 17
Loss = 1.6833e-01, PNorm = 45.5883, GNorm = 0.5074, lr_0 = 2.7314e-04
Loss = 1.9473e-01, PNorm = 45.6226, GNorm = 0.8718, lr_0 = 2.6621e-04
Loss = 2.0232e-01, PNorm = 45.6540, GNorm = 0.8425, lr_0 = 2.5946e-04
Validation prc-auc = 0.942779
Validation auc = 0.920443
Epoch 18
Loss = 1.6279e-01, PNorm = 45.6943, GNorm = 0.6601, lr_0 = 2.5222e-04
Loss = 1.7081e-01, PNorm = 45.7322, GNorm = 0.4433, lr_0 = 2.4582e-04
Loss = 2.0397e-01, PNorm = 45.7640, GNorm = 0.5007, lr_0 = 2.3959e-04
Validation prc-auc = 0.941253
Validation auc = 0.920346
Epoch 19
Loss = 1.8527e-01, PNorm = 45.7944, GNorm = 0.4046, lr_0 = 2.3351e-04
Loss = 1.6808e-01, PNorm = 45.8300, GNorm = 0.6272, lr_0 = 2.2758e-04
Loss = 1.7205e-01, PNorm = 45.8617, GNorm = 0.5532, lr_0 = 2.2181e-04
Loss = 1.9207e-01, PNorm = 45.8899, GNorm = 0.7472, lr_0 = 2.1618e-04
Loss = 1.6341e-01, PNorm = 45.8923, GNorm = 0.6387, lr_0 = 2.1563e-04
Validation prc-auc = 0.942236
Validation auc = 0.919082
Epoch 20
Loss = 1.4275e-01, PNorm = 45.9228, GNorm = 0.4335, lr_0 = 2.1016e-04
Loss = 1.6695e-01, PNorm = 45.9502, GNorm = 0.6985, lr_0 = 2.0483e-04
Loss = 2.0933e-01, PNorm = 45.9695, GNorm = 0.5270, lr_0 = 1.9963e-04
Validation prc-auc = 0.941547
Validation auc = 0.917720
Epoch 21
Loss = 1.3211e-01, PNorm = 45.9940, GNorm = 0.4145, lr_0 = 1.9456e-04
Loss = 1.7289e-01, PNorm = 46.0218, GNorm = 0.4789, lr_0 = 1.8963e-04
Loss = 1.8147e-01, PNorm = 46.0487, GNorm = 0.8731, lr_0 = 1.8482e-04
Validation prc-auc = 0.938570
Validation auc = 0.918109
Epoch 22
Loss = 1.3342e-01, PNorm = 46.0789, GNorm = 0.7985, lr_0 = 1.7967e-04
Loss = 1.6920e-01, PNorm = 46.1068, GNorm = 0.8597, lr_0 = 1.7511e-04
Loss = 1.5219e-01, PNorm = 46.1299, GNorm = 0.4430, lr_0 = 1.7066e-04
Validation prc-auc = 0.937061
Validation auc = 0.915483
Epoch 23
Loss = 1.5790e-01, PNorm = 46.1532, GNorm = 0.4700, lr_0 = 1.6633e-04
Loss = 1.4043e-01, PNorm = 46.1761, GNorm = 0.5043, lr_0 = 1.6211e-04
Loss = 1.5274e-01, PNorm = 46.2023, GNorm = 0.7406, lr_0 = 1.5800e-04
Loss = 1.6977e-01, PNorm = 46.2216, GNorm = 0.9925, lr_0 = 1.5399e-04
Loss = 1.3814e-01, PNorm = 46.2236, GNorm = 2.0829, lr_0 = 1.5360e-04
Validation prc-auc = 0.937463
Validation auc = 0.918207
Epoch 24
Loss = 1.5066e-01, PNorm = 46.2449, GNorm = 0.7438, lr_0 = 1.4970e-04
Loss = 1.5204e-01, PNorm = 46.2648, GNorm = 0.5108, lr_0 = 1.4590e-04
Loss = 1.5785e-01, PNorm = 46.2782, GNorm = 0.8022, lr_0 = 1.4220e-04
Validation prc-auc = 0.937219
Validation auc = 0.917234
Epoch 25
Loss = 1.4994e-01, PNorm = 46.2955, GNorm = 0.3806, lr_0 = 1.3859e-04
Loss = 1.3697e-01, PNorm = 46.3152, GNorm = 0.7883, lr_0 = 1.3508e-04
Loss = 1.5305e-01, PNorm = 46.3376, GNorm = 0.5763, lr_0 = 1.3165e-04
Validation prc-auc = 0.936584
Validation auc = 0.916164
Epoch 26
Loss = 1.1830e-01, PNorm = 46.3535, GNorm = 0.4894, lr_0 = 1.2831e-04
Loss = 1.4266e-01, PNorm = 46.3730, GNorm = 0.7774, lr_0 = 1.2505e-04
Loss = 1.6776e-01, PNorm = 46.3889, GNorm = 0.6892, lr_0 = 1.2188e-04
Validation prc-auc = 0.933237
Validation auc = 0.914608
Epoch 27
Loss = 1.4095e-01, PNorm = 46.4081, GNorm = 0.4796, lr_0 = 1.1848e-04
Loss = 1.2314e-01, PNorm = 46.4292, GNorm = 0.7924, lr_0 = 1.1548e-04
Loss = 1.6097e-01, PNorm = 46.4446, GNorm = 0.5364, lr_0 = 1.1255e-04
Loss = 1.2933e-01, PNorm = 46.4586, GNorm = 1.7142, lr_0 = 1.0969e-04
Validation prc-auc = 0.933935
Validation auc = 0.915678
Epoch 28
Loss = 1.3428e-01, PNorm = 46.4735, GNorm = 0.7723, lr_0 = 1.0691e-04
Loss = 1.3783e-01, PNorm = 46.4881, GNorm = 0.8470, lr_0 = 1.0420e-04
Loss = 1.1802e-01, PNorm = 46.5060, GNorm = 0.4527, lr_0 = 1.0155e-04
Validation prc-auc = 0.930846
Validation auc = 0.910912
Epoch 29
Loss = 1.0190e-01, PNorm = 46.5217, GNorm = 0.5050, lr_0 = 1.0000e-04
Loss = 1.4376e-01, PNorm = 46.5372, GNorm = 0.8538, lr_0 = 1.0000e-04
Loss = 1.3705e-01, PNorm = 46.5487, GNorm = 0.5220, lr_0 = 1.0000e-04
Validation prc-auc = 0.931030
Validation auc = 0.914900
Model 0 best validation prc-auc = 0.947506 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.977848
Model 0 test auc = 0.974286
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.0886e-01, PNorm = 43.2501, GNorm = 1.6573, lr_0 = 2.5469e-04
Loss = 4.2692e-01, PNorm = 43.2743, GNorm = 0.7842, lr_0 = 3.9531e-04
Loss = 4.3841e-01, PNorm = 43.2993, GNorm = 1.6594, lr_0 = 5.3594e-04
Validation prc-auc = 0.945416
Validation auc = 0.929975
Epoch 1
Loss = 3.5038e-01, PNorm = 43.3277, GNorm = 0.9481, lr_0 = 6.9063e-04
Loss = 3.5039e-01, PNorm = 43.3575, GNorm = 0.3959, lr_0 = 8.3125e-04
Loss = 3.2559e-01, PNorm = 43.3910, GNorm = 0.5762, lr_0 = 9.7187e-04
Validation prc-auc = 0.941288
Validation auc = 0.925015
Epoch 2
Loss = 2.6806e-01, PNorm = 43.4358, GNorm = 0.5795, lr_0 = 9.7965e-04
Loss = 3.5072e-01, PNorm = 43.4799, GNorm = 0.9268, lr_0 = 9.5480e-04
Loss = 3.0508e-01, PNorm = 43.5175, GNorm = 0.5575, lr_0 = 9.3057e-04
Validation prc-auc = 0.940277
Validation auc = 0.922680
Epoch 3
Loss = 2.4166e-01, PNorm = 43.5729, GNorm = 0.3577, lr_0 = 9.0463e-04
Loss = 3.0775e-01, PNorm = 43.6206, GNorm = 0.8594, lr_0 = 8.8168e-04
Loss = 3.3240e-01, PNorm = 43.6636, GNorm = 0.4242, lr_0 = 8.5931e-04
Loss = 3.0420e-01, PNorm = 43.7143, GNorm = 0.7995, lr_0 = 8.3751e-04
Validation prc-auc = 0.938634
Validation auc = 0.919471
Epoch 4
Loss = 3.0038e-01, PNorm = 43.7677, GNorm = 1.4281, lr_0 = 8.1626e-04
Loss = 2.9995e-01, PNorm = 43.8168, GNorm = 0.4915, lr_0 = 7.9555e-04
Loss = 2.9300e-01, PNorm = 43.8627, GNorm = 0.5042, lr_0 = 7.7537e-04
Validation prc-auc = 0.940708
Validation auc = 0.921902
Epoch 5
Loss = 2.6816e-01, PNorm = 43.9265, GNorm = 0.3379, lr_0 = 7.5376e-04
Loss = 2.9303e-01, PNorm = 43.9815, GNorm = 0.5454, lr_0 = 7.3463e-04
Loss = 2.8777e-01, PNorm = 44.0260, GNorm = 1.5701, lr_0 = 7.1600e-04
Validation prc-auc = 0.936379
Validation auc = 0.913733
Epoch 6
Loss = 2.7815e-01, PNorm = 44.0701, GNorm = 0.6083, lr_0 = 6.9783e-04
Loss = 2.8137e-01, PNorm = 44.1281, GNorm = 0.6007, lr_0 = 6.8013e-04
Loss = 2.6670e-01, PNorm = 44.1759, GNorm = 0.3331, lr_0 = 6.6287e-04
Validation prc-auc = 0.943491
Validation auc = 0.921708
Epoch 7
Loss = 3.0167e-01, PNorm = 44.2367, GNorm = 1.3558, lr_0 = 6.4439e-04
Loss = 2.8333e-01, PNorm = 44.2918, GNorm = 0.3553, lr_0 = 6.2805e-04
Loss = 2.6915e-01, PNorm = 44.3487, GNorm = 0.3418, lr_0 = 6.1211e-04
Loss = 2.7861e-01, PNorm = 44.4083, GNorm = 0.9621, lr_0 = 5.9658e-04
Validation prc-auc = 0.939349
Validation auc = 0.919374
Epoch 8
Loss = 2.4001e-01, PNorm = 44.4594, GNorm = 0.6912, lr_0 = 5.8145e-04
Loss = 2.7167e-01, PNorm = 44.5123, GNorm = 0.7802, lr_0 = 5.6669e-04
Loss = 2.8671e-01, PNorm = 44.5680, GNorm = 0.3437, lr_0 = 5.5232e-04
Validation prc-auc = 0.939151
Validation auc = 0.915775
Epoch 9
Loss = 2.2521e-01, PNorm = 44.6122, GNorm = 0.3464, lr_0 = 5.3692e-04
Loss = 2.6361e-01, PNorm = 44.6620, GNorm = 0.3967, lr_0 = 5.2330e-04
Loss = 2.3178e-01, PNorm = 44.7071, GNorm = 0.4882, lr_0 = 5.1002e-04
Validation prc-auc = 0.939550
Validation auc = 0.917234
Epoch 10
Loss = 2.1408e-01, PNorm = 44.7582, GNorm = 0.4023, lr_0 = 4.9708e-04
Loss = 2.5074e-01, PNorm = 44.8234, GNorm = 0.5809, lr_0 = 4.8447e-04
Loss = 2.4414e-01, PNorm = 44.8718, GNorm = 0.2578, lr_0 = 4.7218e-04
Validation prc-auc = 0.942058
Validation auc = 0.919276
Epoch 11
Loss = 1.7087e-01, PNorm = 44.9233, GNorm = 0.3011, lr_0 = 4.5902e-04
Loss = 2.5576e-01, PNorm = 44.9788, GNorm = 0.7839, lr_0 = 4.4737e-04
Loss = 2.2275e-01, PNorm = 45.0228, GNorm = 0.3581, lr_0 = 4.3602e-04
Loss = 2.5488e-01, PNorm = 45.0714, GNorm = 1.2316, lr_0 = 4.2496e-04
Validation prc-auc = 0.940237
Validation auc = 0.917234
Epoch 12
Loss = 2.0564e-01, PNorm = 45.1253, GNorm = 0.4691, lr_0 = 4.1418e-04
Loss = 2.3939e-01, PNorm = 45.1598, GNorm = 0.7217, lr_0 = 4.0367e-04
Loss = 2.2890e-01, PNorm = 45.2119, GNorm = 0.7584, lr_0 = 3.9343e-04
Validation prc-auc = 0.940446
Validation auc = 0.917720
Epoch 13
Loss = 2.3004e-01, PNorm = 45.2498, GNorm = 0.9195, lr_0 = 3.8345e-04
Loss = 2.0215e-01, PNorm = 45.2923, GNorm = 0.3981, lr_0 = 3.7372e-04
Loss = 2.0995e-01, PNorm = 45.3372, GNorm = 0.4839, lr_0 = 3.6424e-04
Validation prc-auc = 0.940391
Validation auc = 0.919568
Epoch 14
Loss = 2.3533e-01, PNorm = 45.3858, GNorm = 1.0701, lr_0 = 3.5408e-04
Loss = 1.7849e-01, PNorm = 45.4371, GNorm = 0.7909, lr_0 = 3.4510e-04
Loss = 2.1163e-01, PNorm = 45.4800, GNorm = 0.5777, lr_0 = 3.3635e-04
Validation prc-auc = 0.938111
Validation auc = 0.914900
Epoch 15
Loss = 1.6612e-01, PNorm = 45.5192, GNorm = 0.4877, lr_0 = 3.2781e-04
Loss = 2.2641e-01, PNorm = 45.5636, GNorm = 0.4686, lr_0 = 3.1950e-04
Loss = 1.8729e-01, PNorm = 45.6008, GNorm = 0.8022, lr_0 = 3.1139e-04
Loss = 1.9637e-01, PNorm = 45.6443, GNorm = 0.5559, lr_0 = 3.0349e-04
Loss = 3.5909e-01, PNorm = 45.6464, GNorm = 1.4043, lr_0 = 3.0271e-04
Validation prc-auc = 0.941573
Validation auc = 0.919374
Epoch 16
Loss = 1.7109e-01, PNorm = 45.6825, GNorm = 0.7467, lr_0 = 2.9503e-04
Loss = 2.0477e-01, PNorm = 45.7217, GNorm = 0.5859, lr_0 = 2.8754e-04
Loss = 2.0207e-01, PNorm = 45.7509, GNorm = 0.4324, lr_0 = 2.8025e-04
Validation prc-auc = 0.942302
Validation auc = 0.917623
Epoch 17
Loss = 1.9640e-01, PNorm = 45.7881, GNorm = 0.7860, lr_0 = 2.7314e-04
Loss = 1.9573e-01, PNorm = 45.8231, GNorm = 0.8145, lr_0 = 2.6621e-04
Loss = 1.8115e-01, PNorm = 45.8581, GNorm = 0.6946, lr_0 = 2.5946e-04
Validation prc-auc = 0.943749
Validation auc = 0.922194
Epoch 18
Loss = 2.0255e-01, PNorm = 45.8966, GNorm = 0.5894, lr_0 = 2.5222e-04
Loss = 1.9757e-01, PNorm = 45.9314, GNorm = 1.3058, lr_0 = 2.4582e-04
Loss = 1.9422e-01, PNorm = 45.9604, GNorm = 0.5499, lr_0 = 2.3959e-04
Validation prc-auc = 0.943849
Validation auc = 0.921902
Epoch 19
Loss = 1.2931e-01, PNorm = 45.9905, GNorm = 0.6806, lr_0 = 2.3351e-04
Loss = 2.0874e-01, PNorm = 46.0265, GNorm = 0.8929, lr_0 = 2.2758e-04
Loss = 1.5205e-01, PNorm = 46.0571, GNorm = 0.4904, lr_0 = 2.2181e-04
Loss = 1.7928e-01, PNorm = 46.0869, GNorm = 0.4704, lr_0 = 2.1618e-04
Loss = 1.5470e-01, PNorm = 46.0898, GNorm = 0.6262, lr_0 = 2.1563e-04
Validation prc-auc = 0.942746
Validation auc = 0.920638
Epoch 20
Loss = 1.4226e-01, PNorm = 46.1183, GNorm = 0.4734, lr_0 = 2.1016e-04
Loss = 1.7278e-01, PNorm = 46.1505, GNorm = 0.5146, lr_0 = 2.0483e-04
Loss = 1.7227e-01, PNorm = 46.1758, GNorm = 0.7110, lr_0 = 1.9963e-04
Validation prc-auc = 0.939222
Validation auc = 0.918207
Epoch 21
Loss = 1.3974e-01, PNorm = 46.2045, GNorm = 0.4391, lr_0 = 1.9456e-04
Loss = 1.7420e-01, PNorm = 46.2327, GNorm = 0.7898, lr_0 = 1.8963e-04
Loss = 1.8418e-01, PNorm = 46.2581, GNorm = 1.3836, lr_0 = 1.8482e-04
Validation prc-auc = 0.938179
Validation auc = 0.913344
Epoch 22
Loss = 1.6049e-01, PNorm = 46.2868, GNorm = 0.7887, lr_0 = 1.7967e-04
Loss = 1.6103e-01, PNorm = 46.3149, GNorm = 0.5210, lr_0 = 1.7511e-04
Loss = 1.3156e-01, PNorm = 46.3432, GNorm = 0.5922, lr_0 = 1.7066e-04
Validation prc-auc = 0.938445
Validation auc = 0.918109
Epoch 23
Loss = 2.1638e-01, PNorm = 46.3670, GNorm = 0.8201, lr_0 = 1.6633e-04
Loss = 1.5615e-01, PNorm = 46.3912, GNorm = 0.5647, lr_0 = 1.6211e-04
Loss = 1.3778e-01, PNorm = 46.4163, GNorm = 0.7681, lr_0 = 1.5800e-04
Loss = 1.4416e-01, PNorm = 46.4413, GNorm = 0.9312, lr_0 = 1.5399e-04
Loss = 3.1424e-01, PNorm = 46.4429, GNorm = 1.2613, lr_0 = 1.5360e-04
Validation prc-auc = 0.939361
Validation auc = 0.918401
Epoch 24
Loss = 1.3559e-01, PNorm = 46.4626, GNorm = 0.6765, lr_0 = 1.4970e-04
Loss = 1.3752e-01, PNorm = 46.4885, GNorm = 0.4848, lr_0 = 1.4590e-04
Loss = 1.8197e-01, PNorm = 46.5052, GNorm = 0.7167, lr_0 = 1.4220e-04
Validation prc-auc = 0.941447
Validation auc = 0.920833
Epoch 25
Loss = 1.3405e-01, PNorm = 46.5262, GNorm = 0.8639, lr_0 = 1.3859e-04
Loss = 1.5872e-01, PNorm = 46.5496, GNorm = 0.9444, lr_0 = 1.3508e-04
Loss = 1.7042e-01, PNorm = 46.5667, GNorm = 0.7160, lr_0 = 1.3165e-04
Validation prc-auc = 0.941342
Validation auc = 0.920735
Epoch 26
Loss = 1.4199e-01, PNorm = 46.5867, GNorm = 0.5389, lr_0 = 1.2831e-04
Loss = 1.4508e-01, PNorm = 46.6079, GNorm = 1.8549, lr_0 = 1.2505e-04
Loss = 1.3683e-01, PNorm = 46.6250, GNorm = 0.4884, lr_0 = 1.2188e-04
Validation prc-auc = 0.938458
Validation auc = 0.918790
Epoch 27
Loss = 9.6480e-02, PNorm = 46.6451, GNorm = 0.5804, lr_0 = 1.1848e-04
Loss = 1.7138e-01, PNorm = 46.6588, GNorm = 0.7614, lr_0 = 1.1548e-04
Loss = 1.2115e-01, PNorm = 46.6773, GNorm = 0.3680, lr_0 = 1.1255e-04
Loss = 1.3280e-01, PNorm = 46.6905, GNorm = 0.8559, lr_0 = 1.0969e-04
Validation prc-auc = 0.937709
Validation auc = 0.917915
Epoch 28
Loss = 1.1601e-01, PNorm = 46.7074, GNorm = 1.1115, lr_0 = 1.0691e-04
Loss = 1.2591e-01, PNorm = 46.7273, GNorm = 0.5030, lr_0 = 1.0420e-04
Loss = 1.4772e-01, PNorm = 46.7409, GNorm = 0.9398, lr_0 = 1.0155e-04
Validation prc-auc = 0.936785
Validation auc = 0.916942
Epoch 29
Loss = 1.0806e-01, PNorm = 46.7563, GNorm = 0.3879, lr_0 = 1.0000e-04
Loss = 1.2261e-01, PNorm = 46.7727, GNorm = 0.6410, lr_0 = 1.0000e-04
Loss = 1.5405e-01, PNorm = 46.7856, GNorm = 1.6704, lr_0 = 1.0000e-04
Validation prc-auc = 0.936391
Validation auc = 0.916164
Model 1 best validation prc-auc = 0.945416 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.977928
Model 1 test auc = 0.968519
Ensemble test prc-auc = 0.979712
Ensemble test auc = 0.973325
Fold 2
Splitting data with seed 2
Total scaffolds = 1,229 | train scaffolds = 951 | val scaffolds = 117 | test scaffolds = 161
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 142 | target average = 0.169014


Scaffold 1
Task 0: count = 118 | target average = 0.440678


Scaffold 2
Task 0: count = 20 | target average = 0.000000


Scaffold 3
Task 0: count = 16 | target average = 0.062500


Scaffold 4
Task 0: count = 16 | target average = 0.187500


Scaffold 5
Task 0: count = 14 | target average = 0.000000


Scaffold 6
Task 0: count = 12 | target average = 0.000000


Scaffold 7
Task 0: count = 11 | target average = 0.181818


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 9 | target average = 1.000000


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 5.7735e-01, PNorm = 43.2253, GNorm = 1.3785, lr_0 = 2.5469e-04
Loss = 4.0644e-01, PNorm = 43.2487, GNorm = 1.2988, lr_0 = 3.9531e-04
Loss = 3.9721e-01, PNorm = 43.2737, GNorm = 2.3024, lr_0 = 5.3594e-04
Validation prc-auc = 0.914956
Validation auc = 0.941302
Epoch 1
Loss = 3.2085e-01, PNorm = 43.2970, GNorm = 0.9511, lr_0 = 6.9063e-04
Loss = 3.5113e-01, PNorm = 43.3217, GNorm = 0.6495, lr_0 = 8.3125e-04
Loss = 3.4132e-01, PNorm = 43.3553, GNorm = 0.3441, lr_0 = 9.7187e-04
Validation prc-auc = 0.936830
Validation auc = 0.947911
Epoch 2
Loss = 3.7014e-01, PNorm = 43.3910, GNorm = 0.8814, lr_0 = 9.7965e-04
Loss = 3.3184e-01, PNorm = 43.4351, GNorm = 0.5640, lr_0 = 9.5480e-04
Loss = 2.9777e-01, PNorm = 43.4774, GNorm = 0.3909, lr_0 = 9.3057e-04
Validation prc-auc = 0.940691
Validation auc = 0.950534
Epoch 3
Loss = 3.1353e-01, PNorm = 43.5141, GNorm = 0.3254, lr_0 = 9.0463e-04
Loss = 2.8574e-01, PNorm = 43.5488, GNorm = 0.5364, lr_0 = 8.8168e-04
Loss = 3.0172e-01, PNorm = 43.5948, GNorm = 0.4558, lr_0 = 8.5931e-04
Loss = 3.3259e-01, PNorm = 43.6224, GNorm = 0.3550, lr_0 = 8.3751e-04
Validation prc-auc = 0.944225
Validation auc = 0.949368
Epoch 4
Loss = 2.5222e-01, PNorm = 43.6672, GNorm = 0.4454, lr_0 = 8.1626e-04
Loss = 2.9164e-01, PNorm = 43.7070, GNorm = 0.3397, lr_0 = 7.9555e-04
Loss = 3.2685e-01, PNorm = 43.7461, GNorm = 0.3198, lr_0 = 7.7537e-04
Validation prc-auc = 0.944557
Validation auc = 0.952672
Epoch 5
Loss = 2.6296e-01, PNorm = 43.7941, GNorm = 0.3469, lr_0 = 7.5376e-04
Loss = 2.5336e-01, PNorm = 43.8379, GNorm = 0.3643, lr_0 = 7.3463e-04
Loss = 3.4388e-01, PNorm = 43.8797, GNorm = 0.5141, lr_0 = 7.1600e-04
Validation prc-auc = 0.945387
Validation auc = 0.951603
Epoch 6
Loss = 2.9816e-01, PNorm = 43.9305, GNorm = 1.1527, lr_0 = 6.9783e-04
Loss = 2.7003e-01, PNorm = 43.9813, GNorm = 0.4066, lr_0 = 6.8013e-04
Loss = 2.8447e-01, PNorm = 44.0281, GNorm = 0.4309, lr_0 = 6.6287e-04
Validation prc-auc = 0.949606
Validation auc = 0.957920
Epoch 7
Loss = 2.8793e-01, PNorm = 44.0736, GNorm = 0.3733, lr_0 = 6.4439e-04
Loss = 2.5256e-01, PNorm = 44.1265, GNorm = 0.5219, lr_0 = 6.2805e-04
Loss = 2.6775e-01, PNorm = 44.1749, GNorm = 0.3925, lr_0 = 6.1211e-04
Loss = 2.7195e-01, PNorm = 44.2233, GNorm = 0.4693, lr_0 = 5.9658e-04
Validation prc-auc = 0.953199
Validation auc = 0.958989
Epoch 8
Loss = 2.6538e-01, PNorm = 44.2702, GNorm = 0.4482, lr_0 = 5.8145e-04
Loss = 2.7100e-01, PNorm = 44.3195, GNorm = 0.7009, lr_0 = 5.6669e-04
Loss = 2.8558e-01, PNorm = 44.3763, GNorm = 0.7272, lr_0 = 5.5232e-04
Validation prc-auc = 0.946949
Validation auc = 0.954908
Epoch 9
Loss = 2.3228e-01, PNorm = 44.4275, GNorm = 0.4585, lr_0 = 5.3692e-04
Loss = 2.6505e-01, PNorm = 44.4841, GNorm = 0.8735, lr_0 = 5.2330e-04
Loss = 2.2878e-01, PNorm = 44.5243, GNorm = 0.2760, lr_0 = 5.1002e-04
Validation prc-auc = 0.953184
Validation auc = 0.961613
Epoch 10
Loss = 2.6196e-01, PNorm = 44.5719, GNorm = 0.3718, lr_0 = 4.9708e-04
Loss = 2.4254e-01, PNorm = 44.6402, GNorm = 0.4809, lr_0 = 4.8447e-04
Loss = 2.5213e-01, PNorm = 44.6797, GNorm = 0.9351, lr_0 = 4.7218e-04
Validation prc-auc = 0.953380
Validation auc = 0.960933
Epoch 11
Loss = 2.0900e-01, PNorm = 44.7263, GNorm = 0.6647, lr_0 = 4.5902e-04
Loss = 2.4108e-01, PNorm = 44.7693, GNorm = 0.3950, lr_0 = 4.4737e-04
Loss = 2.2268e-01, PNorm = 44.8274, GNorm = 0.4012, lr_0 = 4.3602e-04
Loss = 2.2664e-01, PNorm = 44.8778, GNorm = 0.6857, lr_0 = 4.2496e-04
Validation prc-auc = 0.958121
Validation auc = 0.965986
Epoch 12
Loss = 2.2438e-01, PNorm = 44.9387, GNorm = 0.4871, lr_0 = 4.1418e-04
Loss = 2.1962e-01, PNorm = 44.9926, GNorm = 0.3867, lr_0 = 4.0367e-04
Loss = 2.4176e-01, PNorm = 45.0384, GNorm = 1.0539, lr_0 = 3.9343e-04
Validation prc-auc = 0.961481
Validation auc = 0.966181
Epoch 13
Loss = 1.9732e-01, PNorm = 45.0841, GNorm = 0.7709, lr_0 = 3.8345e-04
Loss = 2.2218e-01, PNorm = 45.1288, GNorm = 0.7823, lr_0 = 3.7372e-04
Loss = 2.4405e-01, PNorm = 45.1810, GNorm = 0.7286, lr_0 = 3.6424e-04
Validation prc-auc = 0.959655
Validation auc = 0.966278
Epoch 14
Loss = 2.3490e-01, PNorm = 45.2214, GNorm = 0.6602, lr_0 = 3.5408e-04
Loss = 1.9857e-01, PNorm = 45.2781, GNorm = 0.2892, lr_0 = 3.4510e-04
Loss = 2.1382e-01, PNorm = 45.3213, GNorm = 0.6421, lr_0 = 3.3635e-04
Validation prc-auc = 0.955208
Validation auc = 0.963654
Epoch 15
Loss = 1.9058e-01, PNorm = 45.3668, GNorm = 0.6316, lr_0 = 3.2781e-04
Loss = 1.8042e-01, PNorm = 45.4095, GNorm = 0.4707, lr_0 = 3.1950e-04
Loss = 1.8117e-01, PNorm = 45.4543, GNorm = 0.8885, lr_0 = 3.1139e-04
Loss = 2.3988e-01, PNorm = 45.4882, GNorm = 0.5369, lr_0 = 3.0349e-04
Loss = 3.1629e-01, PNorm = 45.4919, GNorm = 1.4249, lr_0 = 3.0271e-04
Validation prc-auc = 0.957317
Validation auc = 0.965695
Epoch 16
Loss = 2.0277e-01, PNorm = 45.5298, GNorm = 0.3040, lr_0 = 2.9503e-04
Loss = 2.1048e-01, PNorm = 45.5789, GNorm = 0.5769, lr_0 = 2.8754e-04
Loss = 1.9004e-01, PNorm = 45.6169, GNorm = 0.3981, lr_0 = 2.8025e-04
Validation prc-auc = 0.959749
Validation auc = 0.967736
Epoch 17
Loss = 2.0332e-01, PNorm = 45.6629, GNorm = 0.8352, lr_0 = 2.7314e-04
Loss = 1.9243e-01, PNorm = 45.7026, GNorm = 0.4085, lr_0 = 2.6621e-04
Loss = 1.7227e-01, PNorm = 45.7388, GNorm = 0.4326, lr_0 = 2.5946e-04
Validation prc-auc = 0.952248
Validation auc = 0.964140
Epoch 18
Loss = 1.7613e-01, PNorm = 45.7782, GNorm = 0.4054, lr_0 = 2.5222e-04
Loss = 1.8867e-01, PNorm = 45.8157, GNorm = 0.9353, lr_0 = 2.4582e-04
Loss = 1.8790e-01, PNorm = 45.8547, GNorm = 0.6571, lr_0 = 2.3959e-04
Validation prc-auc = 0.957126
Validation auc = 0.965792
Epoch 19
Loss = 1.5060e-01, PNorm = 45.8926, GNorm = 0.8182, lr_0 = 2.3351e-04
Loss = 1.7024e-01, PNorm = 45.9267, GNorm = 0.3456, lr_0 = 2.2758e-04
Loss = 1.6768e-01, PNorm = 45.9675, GNorm = 0.6951, lr_0 = 2.2181e-04
Loss = 1.7753e-01, PNorm = 45.9964, GNorm = 0.5878, lr_0 = 2.1618e-04
Loss = 1.5108e-01, PNorm = 45.9992, GNorm = 0.5567, lr_0 = 2.1563e-04
Validation prc-auc = 0.956493
Validation auc = 0.965403
Epoch 20
Loss = 1.6928e-01, PNorm = 46.0334, GNorm = 0.7363, lr_0 = 2.1016e-04
Loss = 1.6422e-01, PNorm = 46.0678, GNorm = 0.7028, lr_0 = 2.0483e-04
Loss = 1.5269e-01, PNorm = 46.1058, GNorm = 0.5238, lr_0 = 1.9963e-04
Validation prc-auc = 0.951176
Validation auc = 0.961710
Epoch 21
Loss = 1.5351e-01, PNorm = 46.1325, GNorm = 0.6693, lr_0 = 1.9456e-04
Loss = 1.4632e-01, PNorm = 46.1698, GNorm = 0.9274, lr_0 = 1.8963e-04
Loss = 1.7937e-01, PNorm = 46.2004, GNorm = 0.3362, lr_0 = 1.8482e-04
Validation prc-auc = 0.954899
Validation auc = 0.965598
Epoch 22
Loss = 1.7915e-01, PNorm = 46.2310, GNorm = 0.7564, lr_0 = 1.7967e-04
Loss = 1.4686e-01, PNorm = 46.2569, GNorm = 0.5969, lr_0 = 1.7511e-04
Loss = 1.3269e-01, PNorm = 46.2897, GNorm = 0.5867, lr_0 = 1.7066e-04
Validation prc-auc = 0.950120
Validation auc = 0.960447
Epoch 23
Loss = 1.4581e-01, PNorm = 46.3154, GNorm = 0.8199, lr_0 = 1.6633e-04
Loss = 1.2717e-01, PNorm = 46.3383, GNorm = 0.4378, lr_0 = 1.6211e-04
Loss = 1.4855e-01, PNorm = 46.3642, GNorm = 0.7081, lr_0 = 1.5800e-04
Loss = 1.6301e-01, PNorm = 46.3888, GNorm = 0.5539, lr_0 = 1.5399e-04
Loss = 8.8888e-02, PNorm = 46.3917, GNorm = 0.4496, lr_0 = 1.5360e-04
Validation prc-auc = 0.953665
Validation auc = 0.964431
Epoch 24
Loss = 1.3936e-01, PNorm = 46.4130, GNorm = 0.7260, lr_0 = 1.4970e-04
Loss = 1.2523e-01, PNorm = 46.4350, GNorm = 0.9934, lr_0 = 1.4590e-04
Loss = 1.6174e-01, PNorm = 46.4542, GNorm = 0.7397, lr_0 = 1.4220e-04
Validation prc-auc = 0.957169
Validation auc = 0.962488
Epoch 25
Loss = 1.4196e-01, PNorm = 46.4829, GNorm = 1.9095, lr_0 = 1.3859e-04
Loss = 1.3624e-01, PNorm = 46.5065, GNorm = 0.8115, lr_0 = 1.3508e-04
Loss = 1.3272e-01, PNorm = 46.5254, GNorm = 1.1174, lr_0 = 1.3165e-04
Validation prc-auc = 0.954710
Validation auc = 0.961516
Epoch 26
Loss = 1.4035e-01, PNorm = 46.5460, GNorm = 0.6970, lr_0 = 1.2831e-04
Loss = 1.4493e-01, PNorm = 46.5687, GNorm = 0.7046, lr_0 = 1.2505e-04
Loss = 1.3149e-01, PNorm = 46.5868, GNorm = 1.3828, lr_0 = 1.2188e-04
Validation prc-auc = 0.951073
Validation auc = 0.960739
Epoch 27
Loss = 1.2204e-01, PNorm = 46.6134, GNorm = 0.6537, lr_0 = 1.1848e-04
Loss = 1.2137e-01, PNorm = 46.6305, GNorm = 1.2629, lr_0 = 1.1548e-04
Loss = 1.1312e-01, PNorm = 46.6490, GNorm = 1.0465, lr_0 = 1.1255e-04
Loss = 1.5212e-01, PNorm = 46.6668, GNorm = 1.1317, lr_0 = 1.0969e-04
Validation prc-auc = 0.949572
Validation auc = 0.959281
Epoch 28
Loss = 1.3139e-01, PNorm = 46.6798, GNorm = 0.8460, lr_0 = 1.0691e-04
Loss = 1.1194e-01, PNorm = 46.6990, GNorm = 1.5183, lr_0 = 1.0420e-04
Loss = 1.4403e-01, PNorm = 46.7125, GNorm = 0.7925, lr_0 = 1.0155e-04
Validation prc-auc = 0.952879
Validation auc = 0.961419
Epoch 29
Loss = 1.3852e-01, PNorm = 46.7288, GNorm = 1.0679, lr_0 = 1.0000e-04
Loss = 1.2142e-01, PNorm = 46.7460, GNorm = 0.8495, lr_0 = 1.0000e-04
Loss = 9.8357e-02, PNorm = 46.7595, GNorm = 0.5996, lr_0 = 1.0000e-04
Validation prc-auc = 0.951237
Validation auc = 0.960836
Model 0 best validation prc-auc = 0.961481 on epoch 12
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.954759
Model 0 test auc = 0.941222
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.2615e-01, PNorm = 43.2484, GNorm = 1.1091, lr_0 = 2.5469e-04
Loss = 4.5768e-01, PNorm = 43.2685, GNorm = 0.6374, lr_0 = 3.9531e-04
Loss = 3.4585e-01, PNorm = 43.3010, GNorm = 0.9490, lr_0 = 5.3594e-04
Validation prc-auc = 0.927239
Validation auc = 0.938873
Epoch 1
Loss = 4.0941e-01, PNorm = 43.3298, GNorm = 1.0367, lr_0 = 6.9063e-04
Loss = 3.8116e-01, PNorm = 43.3527, GNorm = 0.6602, lr_0 = 8.3125e-04
Loss = 3.2484e-01, PNorm = 43.3913, GNorm = 0.5685, lr_0 = 9.7187e-04
Validation prc-auc = 0.934637
Validation auc = 0.942663
Epoch 2
Loss = 3.0486e-01, PNorm = 43.4379, GNorm = 0.7134, lr_0 = 9.7965e-04
Loss = 3.4373e-01, PNorm = 43.4834, GNorm = 0.6322, lr_0 = 9.5480e-04
Loss = 3.2710e-01, PNorm = 43.5213, GNorm = 0.3727, lr_0 = 9.3057e-04
Validation prc-auc = 0.936187
Validation auc = 0.945384
Epoch 3
Loss = 3.4054e-01, PNorm = 43.5562, GNorm = 1.2708, lr_0 = 9.0463e-04
Loss = 3.0407e-01, PNorm = 43.5970, GNorm = 0.7630, lr_0 = 8.8168e-04
Loss = 3.1298e-01, PNorm = 43.6295, GNorm = 0.3148, lr_0 = 8.5931e-04
Loss = 2.9944e-01, PNorm = 43.6698, GNorm = 0.3078, lr_0 = 8.3751e-04
Validation prc-auc = 0.945223
Validation auc = 0.951506
Epoch 4
Loss = 3.1408e-01, PNorm = 43.7165, GNorm = 0.5186, lr_0 = 8.1626e-04
Loss = 2.8861e-01, PNorm = 43.7622, GNorm = 0.5945, lr_0 = 7.9555e-04
Loss = 2.8710e-01, PNorm = 43.8038, GNorm = 0.4548, lr_0 = 7.7537e-04
Validation prc-auc = 0.946138
Validation auc = 0.952867
Epoch 5
Loss = 2.6983e-01, PNorm = 43.8409, GNorm = 0.2872, lr_0 = 7.5376e-04
Loss = 2.5809e-01, PNorm = 43.8807, GNorm = 0.6296, lr_0 = 7.3463e-04
Loss = 3.1693e-01, PNorm = 43.9275, GNorm = 0.3222, lr_0 = 7.1600e-04
Validation prc-auc = 0.953058
Validation auc = 0.955782
Epoch 6
Loss = 2.7777e-01, PNorm = 43.9748, GNorm = 0.4207, lr_0 = 6.9783e-04
Loss = 2.3736e-01, PNorm = 44.0301, GNorm = 0.6215, lr_0 = 6.8013e-04
Loss = 3.0195e-01, PNorm = 44.0869, GNorm = 0.4903, lr_0 = 6.6287e-04
Validation prc-auc = 0.949946
Validation auc = 0.955199
Epoch 7
Loss = 2.8643e-01, PNorm = 44.1415, GNorm = 0.8084, lr_0 = 6.4439e-04
Loss = 2.6432e-01, PNorm = 44.1924, GNorm = 0.6893, lr_0 = 6.2805e-04
Loss = 2.5967e-01, PNorm = 44.2544, GNorm = 0.7585, lr_0 = 6.1211e-04
Loss = 2.6556e-01, PNorm = 44.3056, GNorm = 0.8914, lr_0 = 5.9658e-04
Validation prc-auc = 0.955323
Validation auc = 0.957823
Epoch 8
Loss = 2.1029e-01, PNorm = 44.3724, GNorm = 0.6349, lr_0 = 5.8145e-04
Loss = 2.7011e-01, PNorm = 44.4132, GNorm = 0.4034, lr_0 = 5.6669e-04
Loss = 2.6681e-01, PNorm = 44.4684, GNorm = 0.6026, lr_0 = 5.5232e-04
Validation prc-auc = 0.954765
Validation auc = 0.959086
Epoch 9
Loss = 2.2041e-01, PNorm = 44.5233, GNorm = 0.8760, lr_0 = 5.3692e-04
Loss = 2.3280e-01, PNorm = 44.5788, GNorm = 0.4341, lr_0 = 5.2330e-04
Loss = 2.4795e-01, PNorm = 44.6347, GNorm = 0.3829, lr_0 = 5.1002e-04
Validation prc-auc = 0.955326
Validation auc = 0.959961
Epoch 10
Loss = 2.7557e-01, PNorm = 44.6935, GNorm = 0.5388, lr_0 = 4.9708e-04
Loss = 1.9919e-01, PNorm = 44.7434, GNorm = 0.5666, lr_0 = 4.8447e-04
Loss = 2.2466e-01, PNorm = 44.7856, GNorm = 0.7965, lr_0 = 4.7218e-04
Validation prc-auc = 0.956957
Validation auc = 0.961224
Epoch 11
Loss = 2.2566e-01, PNorm = 44.8453, GNorm = 0.4907, lr_0 = 4.5902e-04
Loss = 2.4390e-01, PNorm = 44.8983, GNorm = 0.4986, lr_0 = 4.4737e-04
Loss = 2.1712e-01, PNorm = 44.9483, GNorm = 0.6179, lr_0 = 4.3602e-04
Loss = 2.5755e-01, PNorm = 44.9951, GNorm = 0.8312, lr_0 = 4.2496e-04
Validation prc-auc = 0.947559
Validation auc = 0.958017
Epoch 12
Loss = 2.1152e-01, PNorm = 45.0426, GNorm = 1.4367, lr_0 = 4.1418e-04
Loss = 2.2770e-01, PNorm = 45.1003, GNorm = 0.4911, lr_0 = 4.0367e-04
Loss = 2.3401e-01, PNorm = 45.1433, GNorm = 0.5972, lr_0 = 3.9343e-04
Validation prc-auc = 0.945286
Validation auc = 0.958503
Epoch 13
Loss = 2.2833e-01, PNorm = 45.1811, GNorm = 0.7382, lr_0 = 3.8345e-04
Loss = 1.9933e-01, PNorm = 45.2317, GNorm = 0.4130, lr_0 = 3.7372e-04
Loss = 2.2484e-01, PNorm = 45.2742, GNorm = 0.4148, lr_0 = 3.6424e-04
Validation prc-auc = 0.954656
Validation auc = 0.961127
Epoch 14
Loss = 1.7995e-01, PNorm = 45.3171, GNorm = 0.4537, lr_0 = 3.5408e-04
Loss = 2.2237e-01, PNorm = 45.3679, GNorm = 0.6309, lr_0 = 3.4510e-04
Loss = 2.3581e-01, PNorm = 45.4060, GNorm = 0.9739, lr_0 = 3.3635e-04
Validation prc-auc = 0.955096
Validation auc = 0.961127
Epoch 15
Loss = 2.4309e-01, PNorm = 45.4523, GNorm = 0.6822, lr_0 = 3.2781e-04
Loss = 1.6197e-01, PNorm = 45.4988, GNorm = 0.4180, lr_0 = 3.1950e-04
Loss = 1.9534e-01, PNorm = 45.5398, GNorm = 0.4897, lr_0 = 3.1139e-04
Loss = 2.2738e-01, PNorm = 45.5729, GNorm = 0.4713, lr_0 = 3.0349e-04
Loss = 2.2848e-01, PNorm = 45.5772, GNorm = 0.6153, lr_0 = 3.0271e-04
Validation prc-auc = 0.956490
Validation auc = 0.962779
Epoch 16
Loss = 1.9166e-01, PNorm = 45.6223, GNorm = 0.8720, lr_0 = 2.9503e-04
Loss = 2.0037e-01, PNorm = 45.6619, GNorm = 0.4551, lr_0 = 2.8754e-04
Loss = 1.9559e-01, PNorm = 45.6948, GNorm = 0.7862, lr_0 = 2.8025e-04
Validation prc-auc = 0.950947
Validation auc = 0.960155
Epoch 17
Loss = 1.5749e-01, PNorm = 45.7290, GNorm = 0.6041, lr_0 = 2.7314e-04
Loss = 1.5962e-01, PNorm = 45.7706, GNorm = 1.2477, lr_0 = 2.6621e-04
Loss = 2.0362e-01, PNorm = 45.8021, GNorm = 0.7767, lr_0 = 2.5946e-04
Validation prc-auc = 0.951905
Validation auc = 0.960641
Epoch 18
Loss = 2.0928e-01, PNorm = 45.8455, GNorm = 0.7024, lr_0 = 2.5222e-04
Loss = 1.7412e-01, PNorm = 45.8843, GNorm = 0.3451, lr_0 = 2.4582e-04
Loss = 1.5497e-01, PNorm = 45.9187, GNorm = 0.7264, lr_0 = 2.3959e-04
Validation prc-auc = 0.948032
Validation auc = 0.959378
Epoch 19
Loss = 1.4811e-01, PNorm = 45.9516, GNorm = 0.5961, lr_0 = 2.3351e-04
Loss = 1.7670e-01, PNorm = 45.9858, GNorm = 1.0033, lr_0 = 2.2758e-04
Loss = 1.6558e-01, PNorm = 46.0288, GNorm = 0.5339, lr_0 = 2.2181e-04
Loss = 1.7584e-01, PNorm = 46.0564, GNorm = 0.9251, lr_0 = 2.1618e-04
Loss = 2.3454e-01, PNorm = 46.0591, GNorm = 1.0842, lr_0 = 2.1563e-04
Validation prc-auc = 0.950138
Validation auc = 0.960155
Epoch 20
Loss = 1.4602e-01, PNorm = 46.0918, GNorm = 0.8406, lr_0 = 2.1016e-04
Loss = 1.8481e-01, PNorm = 46.1265, GNorm = 0.6389, lr_0 = 2.0483e-04
Loss = 1.7799e-01, PNorm = 46.1595, GNorm = 0.5591, lr_0 = 1.9963e-04
Validation prc-auc = 0.952054
Validation auc = 0.959767
Epoch 21
Loss = 1.6902e-01, PNorm = 46.1813, GNorm = 1.4152, lr_0 = 1.9456e-04
Loss = 1.5680e-01, PNorm = 46.2124, GNorm = 0.9639, lr_0 = 1.8963e-04
Loss = 1.8016e-01, PNorm = 46.2402, GNorm = 0.9630, lr_0 = 1.8482e-04
Validation prc-auc = 0.958630
Validation auc = 0.962002
Epoch 22
Loss = 1.2856e-01, PNorm = 46.2729, GNorm = 0.4311, lr_0 = 1.7967e-04
Loss = 1.4441e-01, PNorm = 46.2977, GNorm = 0.8467, lr_0 = 1.7511e-04
Loss = 1.5329e-01, PNorm = 46.3243, GNorm = 0.8357, lr_0 = 1.7066e-04
Validation prc-auc = 0.955232
Validation auc = 0.961516
Epoch 23
Loss = 1.2820e-01, PNorm = 46.3497, GNorm = 0.4528, lr_0 = 1.6633e-04
Loss = 1.6389e-01, PNorm = 46.3827, GNorm = 0.7671, lr_0 = 1.6211e-04
Loss = 1.2752e-01, PNorm = 46.4075, GNorm = 0.9999, lr_0 = 1.5800e-04
Loss = 1.5870e-01, PNorm = 46.4277, GNorm = 1.4502, lr_0 = 1.5399e-04
Loss = 8.6784e-02, PNorm = 46.4304, GNorm = 0.5601, lr_0 = 1.5360e-04
Validation prc-auc = 0.947617
Validation auc = 0.956560
Epoch 24
Loss = 1.3941e-01, PNorm = 46.4540, GNorm = 0.5102, lr_0 = 1.4970e-04
Loss = 1.4783e-01, PNorm = 46.4806, GNorm = 0.7898, lr_0 = 1.4590e-04
Loss = 1.3138e-01, PNorm = 46.4981, GNorm = 1.5522, lr_0 = 1.4220e-04
Validation prc-auc = 0.951053
Validation auc = 0.959475
Epoch 25
Loss = 1.5924e-01, PNorm = 46.5242, GNorm = 1.8103, lr_0 = 1.3859e-04
Loss = 1.3139e-01, PNorm = 46.5455, GNorm = 0.5804, lr_0 = 1.3508e-04
Loss = 1.2535e-01, PNorm = 46.5667, GNorm = 0.5731, lr_0 = 1.3165e-04
Validation prc-auc = 0.952426
Validation auc = 0.958115
Epoch 26
Loss = 1.4054e-01, PNorm = 46.5858, GNorm = 1.1405, lr_0 = 1.2831e-04
Loss = 1.3859e-01, PNorm = 46.6071, GNorm = 0.6765, lr_0 = 1.2505e-04
Loss = 1.2804e-01, PNorm = 46.6253, GNorm = 1.3341, lr_0 = 1.2188e-04
Validation prc-auc = 0.948511
Validation auc = 0.957629
Epoch 27
Loss = 1.0506e-01, PNorm = 46.6460, GNorm = 0.7325, lr_0 = 1.1848e-04
Loss = 1.2433e-01, PNorm = 46.6650, GNorm = 0.4893, lr_0 = 1.1548e-04
Loss = 1.4314e-01, PNorm = 46.6831, GNorm = 0.6686, lr_0 = 1.1255e-04
Loss = 1.2785e-01, PNorm = 46.7011, GNorm = 0.7358, lr_0 = 1.0969e-04
Validation prc-auc = 0.949489
Validation auc = 0.957532
Epoch 28
Loss = 1.2863e-01, PNorm = 46.7188, GNorm = 0.8367, lr_0 = 1.0691e-04
Loss = 1.1705e-01, PNorm = 46.7360, GNorm = 1.0062, lr_0 = 1.0420e-04
Loss = 1.0486e-01, PNorm = 46.7518, GNorm = 0.5051, lr_0 = 1.0155e-04
Validation prc-auc = 0.952404
Validation auc = 0.957629
Epoch 29
Loss = 1.0625e-01, PNorm = 46.7669, GNorm = 0.6506, lr_0 = 1.0000e-04
Loss = 1.1295e-01, PNorm = 46.7799, GNorm = 0.8059, lr_0 = 1.0000e-04
Loss = 1.3923e-01, PNorm = 46.7959, GNorm = 0.4346, lr_0 = 1.0000e-04
Validation prc-auc = 0.950212
Validation auc = 0.957337
Model 1 best validation prc-auc = 0.958630 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.948309
Model 1 test auc = 0.934007
Ensemble test prc-auc = 0.953384
Ensemble test auc = 0.939394
Fold 3
Splitting data with seed 3
Total scaffolds = 1,229 | train scaffolds = 973 | val scaffolds = 122 | test scaffolds = 134
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 142 | target average = 0.169014


Scaffold 1
Task 0: count = 118 | target average = 0.440678


Scaffold 2
Task 0: count = 20 | target average = 0.000000


Scaffold 3
Task 0: count = 16 | target average = 0.062500


Scaffold 4
Task 0: count = 16 | target average = 0.187500


Scaffold 5
Task 0: count = 14 | target average = 0.000000


Scaffold 6
Task 0: count = 12 | target average = 0.000000


Scaffold 7
Task 0: count = 11 | target average = 0.181818


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 9 | target average = 1.000000


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 5.9473e-01, PNorm = 43.2231, GNorm = 0.9000, lr_0 = 2.5469e-04
Loss = 4.3053e-01, PNorm = 43.2464, GNorm = 0.5897, lr_0 = 3.9531e-04
Loss = 3.7512e-01, PNorm = 43.2753, GNorm = 1.5964, lr_0 = 5.3594e-04
Validation prc-auc = 0.947458
Validation auc = 0.933398
Epoch 1
Loss = 3.3916e-01, PNorm = 43.3041, GNorm = 0.5671, lr_0 = 6.9063e-04
Loss = 3.7066e-01, PNorm = 43.3274, GNorm = 1.2770, lr_0 = 8.3125e-04
Loss = 3.1420e-01, PNorm = 43.3603, GNorm = 0.3513, lr_0 = 9.7187e-04
Validation prc-auc = 0.948880
Validation auc = 0.936505
Epoch 2
Loss = 3.3209e-01, PNorm = 43.4025, GNorm = 0.8022, lr_0 = 9.7965e-04
Loss = 3.2262e-01, PNorm = 43.4448, GNorm = 0.9350, lr_0 = 9.5480e-04
Loss = 3.1609e-01, PNorm = 43.4863, GNorm = 1.7100, lr_0 = 9.3057e-04
Validation prc-auc = 0.949836
Validation auc = 0.938350
Epoch 3
Loss = 2.2418e-01, PNorm = 43.5304, GNorm = 0.3209, lr_0 = 9.0463e-04
Loss = 3.3141e-01, PNorm = 43.5757, GNorm = 0.6565, lr_0 = 8.8168e-04
Loss = 3.0486e-01, PNorm = 43.6242, GNorm = 0.4661, lr_0 = 8.5931e-04
Loss = 2.9907e-01, PNorm = 43.6598, GNorm = 0.7656, lr_0 = 8.3751e-04
Validation prc-auc = 0.949468
Validation auc = 0.937961
Epoch 4
Loss = 2.9179e-01, PNorm = 43.7053, GNorm = 0.2903, lr_0 = 8.1626e-04
Loss = 2.9510e-01, PNorm = 43.7536, GNorm = 0.7027, lr_0 = 7.9555e-04
Loss = 2.7283e-01, PNorm = 43.7940, GNorm = 0.3767, lr_0 = 7.7537e-04
Validation prc-auc = 0.949775
Validation auc = 0.938932
Epoch 5
Loss = 2.4545e-01, PNorm = 43.8431, GNorm = 0.2872, lr_0 = 7.5376e-04
Loss = 2.8206e-01, PNorm = 43.8870, GNorm = 0.3388, lr_0 = 7.3463e-04
Loss = 2.9522e-01, PNorm = 43.9294, GNorm = 0.3501, lr_0 = 7.1600e-04
Validation prc-auc = 0.947216
Validation auc = 0.936408
Epoch 6
Loss = 2.5048e-01, PNorm = 43.9743, GNorm = 0.3064, lr_0 = 6.9783e-04
Loss = 2.5439e-01, PNorm = 44.0308, GNorm = 1.1123, lr_0 = 6.8013e-04
Loss = 2.3750e-01, PNorm = 44.0945, GNorm = 0.3145, lr_0 = 6.6287e-04
Validation prc-auc = 0.948816
Validation auc = 0.937670
Epoch 7
Loss = 1.9180e-01, PNorm = 44.1475, GNorm = 0.9289, lr_0 = 6.4439e-04
Loss = 2.7542e-01, PNorm = 44.1819, GNorm = 0.6727, lr_0 = 6.2805e-04
Loss = 2.9392e-01, PNorm = 44.2384, GNorm = 0.9786, lr_0 = 6.1211e-04
Loss = 2.4654e-01, PNorm = 44.2867, GNorm = 0.3599, lr_0 = 5.9658e-04
Validation prc-auc = 0.946690
Validation auc = 0.933592
Epoch 8
Loss = 2.6624e-01, PNorm = 44.3343, GNorm = 0.5342, lr_0 = 5.8145e-04
Loss = 2.5496e-01, PNorm = 44.3951, GNorm = 0.3333, lr_0 = 5.6669e-04
Loss = 2.3637e-01, PNorm = 44.4473, GNorm = 0.3365, lr_0 = 5.5232e-04
Validation prc-auc = 0.950953
Validation auc = 0.939903
Epoch 9
Loss = 2.3308e-01, PNorm = 44.5086, GNorm = 0.4951, lr_0 = 5.3692e-04
Loss = 2.8697e-01, PNorm = 44.5585, GNorm = 0.4751, lr_0 = 5.2330e-04
Loss = 2.5548e-01, PNorm = 44.6075, GNorm = 0.5702, lr_0 = 5.1002e-04
Validation prc-auc = 0.954577
Validation auc = 0.946990
Epoch 10
Loss = 2.2962e-01, PNorm = 44.6644, GNorm = 0.2166, lr_0 = 4.9708e-04
Loss = 2.5990e-01, PNorm = 44.7137, GNorm = 0.3388, lr_0 = 4.8447e-04
Loss = 2.4943e-01, PNorm = 44.7565, GNorm = 0.4325, lr_0 = 4.7218e-04
Validation prc-auc = 0.948503
Validation auc = 0.935146
Epoch 11
Loss = 1.9576e-01, PNorm = 44.8227, GNorm = 0.5717, lr_0 = 4.5902e-04
Loss = 2.1100e-01, PNorm = 44.8655, GNorm = 0.4456, lr_0 = 4.4737e-04
Loss = 2.3110e-01, PNorm = 44.9258, GNorm = 0.3598, lr_0 = 4.3602e-04
Loss = 2.4635e-01, PNorm = 44.9730, GNorm = 0.6989, lr_0 = 4.2496e-04
Validation prc-auc = 0.951117
Validation auc = 0.941456
Epoch 12
Loss = 2.1077e-01, PNorm = 45.0253, GNorm = 0.3973, lr_0 = 4.1418e-04
Loss = 2.2366e-01, PNorm = 45.0703, GNorm = 0.6128, lr_0 = 4.0367e-04
Loss = 2.4123e-01, PNorm = 45.1132, GNorm = 0.7797, lr_0 = 3.9343e-04
Validation prc-auc = 0.952323
Validation auc = 0.944854
Epoch 13
Loss = 2.2699e-01, PNorm = 45.1685, GNorm = 0.4850, lr_0 = 3.8345e-04
Loss = 2.2502e-01, PNorm = 45.2224, GNorm = 0.5297, lr_0 = 3.7372e-04
Loss = 1.9704e-01, PNorm = 45.2739, GNorm = 0.4555, lr_0 = 3.6424e-04
Validation prc-auc = 0.951646
Validation auc = 0.942718
Epoch 14
Loss = 2.0509e-01, PNorm = 45.3309, GNorm = 0.6235, lr_0 = 3.5408e-04
Loss = 1.9456e-01, PNorm = 45.3720, GNorm = 0.6322, lr_0 = 3.4510e-04
Loss = 2.0900e-01, PNorm = 45.4135, GNorm = 0.3912, lr_0 = 3.3635e-04
Validation prc-auc = 0.949706
Validation auc = 0.939223
Epoch 15
Loss = 2.3158e-01, PNorm = 45.4669, GNorm = 0.4633, lr_0 = 3.2781e-04
Loss = 2.0269e-01, PNorm = 45.5308, GNorm = 0.4057, lr_0 = 3.1950e-04
Loss = 1.9723e-01, PNorm = 45.5752, GNorm = 0.8889, lr_0 = 3.1139e-04
Loss = 1.8594e-01, PNorm = 45.6072, GNorm = 0.6058, lr_0 = 3.0349e-04
Loss = 9.7040e-02, PNorm = 45.6104, GNorm = 0.7313, lr_0 = 3.0271e-04
Validation prc-auc = 0.948778
Validation auc = 0.941262
Epoch 16
Loss = 2.0240e-01, PNorm = 45.6512, GNorm = 0.9986, lr_0 = 2.9503e-04
Loss = 2.1209e-01, PNorm = 45.6883, GNorm = 1.3290, lr_0 = 2.8754e-04
Loss = 1.6389e-01, PNorm = 45.7339, GNorm = 0.6501, lr_0 = 2.8025e-04
Validation prc-auc = 0.951382
Validation auc = 0.945243
Epoch 17
Loss = 1.7126e-01, PNorm = 45.7793, GNorm = 0.3817, lr_0 = 2.7314e-04
Loss = 1.8547e-01, PNorm = 45.8194, GNorm = 0.9234, lr_0 = 2.6621e-04
Loss = 1.5705e-01, PNorm = 45.8533, GNorm = 0.3649, lr_0 = 2.5946e-04
Validation prc-auc = 0.944804
Validation auc = 0.927670
Epoch 18
Loss = 1.8504e-01, PNorm = 45.8962, GNorm = 0.5128, lr_0 = 2.5222e-04
Loss = 1.5494e-01, PNorm = 45.9324, GNorm = 0.6109, lr_0 = 2.4582e-04
Loss = 1.9131e-01, PNorm = 45.9612, GNorm = 0.4201, lr_0 = 2.3959e-04
Validation prc-auc = 0.947112
Validation auc = 0.935437
Epoch 19
Loss = 1.3693e-01, PNorm = 45.9982, GNorm = 0.5687, lr_0 = 2.3351e-04
Loss = 1.7462e-01, PNorm = 46.0353, GNorm = 0.4660, lr_0 = 2.2758e-04
Loss = 1.6728e-01, PNorm = 46.0721, GNorm = 0.5292, lr_0 = 2.2181e-04
Loss = 1.5912e-01, PNorm = 46.1018, GNorm = 0.5610, lr_0 = 2.1618e-04
Loss = 1.3928e-01, PNorm = 46.1053, GNorm = 0.6578, lr_0 = 2.1563e-04
Validation prc-auc = 0.945338
Validation auc = 0.936019
Epoch 20
Loss = 1.4654e-01, PNorm = 46.1421, GNorm = 0.6184, lr_0 = 2.1016e-04
Loss = 1.6443e-01, PNorm = 46.1805, GNorm = 0.5106, lr_0 = 2.0483e-04
Loss = 1.6118e-01, PNorm = 46.2148, GNorm = 1.1882, lr_0 = 1.9963e-04
Validation prc-auc = 0.943937
Validation auc = 0.936117
Epoch 21
Loss = 1.5599e-01, PNorm = 46.2466, GNorm = 0.8251, lr_0 = 1.9456e-04
Loss = 1.4919e-01, PNorm = 46.2751, GNorm = 0.5307, lr_0 = 1.8963e-04
Loss = 1.6094e-01, PNorm = 46.3061, GNorm = 1.5202, lr_0 = 1.8482e-04
Validation prc-auc = 0.945999
Validation auc = 0.933883
Epoch 22
Loss = 1.3117e-01, PNorm = 46.3357, GNorm = 0.6513, lr_0 = 1.7967e-04
Loss = 1.4598e-01, PNorm = 46.3634, GNorm = 0.5341, lr_0 = 1.7511e-04
Loss = 1.4552e-01, PNorm = 46.3920, GNorm = 0.8527, lr_0 = 1.7066e-04
Validation prc-auc = 0.936947
Validation auc = 0.929223
Epoch 23
Loss = 1.7367e-01, PNorm = 46.4170, GNorm = 1.0281, lr_0 = 1.6633e-04
Loss = 1.5147e-01, PNorm = 46.4500, GNorm = 0.6205, lr_0 = 1.6211e-04
Loss = 1.5654e-01, PNorm = 46.4784, GNorm = 0.6021, lr_0 = 1.5800e-04
Loss = 1.3291e-01, PNorm = 46.5034, GNorm = 0.5043, lr_0 = 1.5399e-04
Loss = 8.7601e-02, PNorm = 46.5054, GNorm = 0.4291, lr_0 = 1.5360e-04
Validation prc-auc = 0.944537
Validation auc = 0.934854
Epoch 24
Loss = 1.3851e-01, PNorm = 46.5226, GNorm = 0.8665, lr_0 = 1.4970e-04
Loss = 1.3344e-01, PNorm = 46.5445, GNorm = 0.4201, lr_0 = 1.4590e-04
Loss = 1.3683e-01, PNorm = 46.5708, GNorm = 0.4874, lr_0 = 1.4220e-04
Validation prc-auc = 0.943459
Validation auc = 0.932816
Epoch 25
Loss = 1.6153e-01, PNorm = 46.5922, GNorm = 0.5242, lr_0 = 1.3859e-04
Loss = 1.3691e-01, PNorm = 46.6137, GNorm = 1.1449, lr_0 = 1.3508e-04
Loss = 1.0781e-01, PNorm = 46.6336, GNorm = 0.5212, lr_0 = 1.3165e-04
Validation prc-auc = 0.940719
Validation auc = 0.931456
Epoch 26
Loss = 1.1362e-01, PNorm = 46.6546, GNorm = 0.7995, lr_0 = 1.2831e-04
Loss = 1.3515e-01, PNorm = 46.6830, GNorm = 0.6247, lr_0 = 1.2505e-04
Loss = 1.3370e-01, PNorm = 46.6981, GNorm = 0.6034, lr_0 = 1.2188e-04
Validation prc-auc = 0.941630
Validation auc = 0.930777
Epoch 27
Loss = 7.4684e-02, PNorm = 46.7204, GNorm = 0.5910, lr_0 = 1.1848e-04
Loss = 1.3894e-01, PNorm = 46.7377, GNorm = 0.6104, lr_0 = 1.1548e-04
Loss = 1.2577e-01, PNorm = 46.7570, GNorm = 0.6099, lr_0 = 1.1255e-04
Loss = 1.1087e-01, PNorm = 46.7724, GNorm = 0.7494, lr_0 = 1.0969e-04
Validation prc-auc = 0.940964
Validation auc = 0.931456
Epoch 28
Loss = 1.2852e-01, PNorm = 46.7914, GNorm = 0.7023, lr_0 = 1.0691e-04
Loss = 1.4264e-01, PNorm = 46.8075, GNorm = 0.6134, lr_0 = 1.0420e-04
Loss = 1.0185e-01, PNorm = 46.8239, GNorm = 0.5594, lr_0 = 1.0155e-04
Validation prc-auc = 0.941036
Validation auc = 0.931650
Epoch 29
Loss = 8.5940e-02, PNorm = 46.8403, GNorm = 0.4721, lr_0 = 1.0000e-04
Loss = 1.3852e-01, PNorm = 46.8566, GNorm = 0.9978, lr_0 = 1.0000e-04
Loss = 1.1137e-01, PNorm = 46.8740, GNorm = 0.8438, lr_0 = 1.0000e-04
Validation prc-auc = 0.939116
Validation auc = 0.928544
Model 0 best validation prc-auc = 0.954577 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.948919
Model 0 test auc = 0.951996
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.0698e-01, PNorm = 43.2506, GNorm = 0.8557, lr_0 = 2.5469e-04
Loss = 4.4501e-01, PNorm = 43.2758, GNorm = 0.5808, lr_0 = 3.9531e-04
Loss = 3.6932e-01, PNorm = 43.3080, GNorm = 2.3818, lr_0 = 5.3594e-04
Validation prc-auc = 0.951266
Validation auc = 0.938447
Epoch 1
Loss = 3.4835e-01, PNorm = 43.3322, GNorm = 0.6958, lr_0 = 6.9063e-04
Loss = 3.8404e-01, PNorm = 43.3558, GNorm = 0.9778, lr_0 = 8.3125e-04
Loss = 3.3466e-01, PNorm = 43.3908, GNorm = 0.6311, lr_0 = 9.7187e-04
Validation prc-auc = 0.950399
Validation auc = 0.937670
Epoch 2
Loss = 3.6410e-01, PNorm = 43.4307, GNorm = 0.7781, lr_0 = 9.7965e-04
Loss = 3.0719e-01, PNorm = 43.4728, GNorm = 0.3369, lr_0 = 9.5480e-04
Loss = 3.4101e-01, PNorm = 43.5126, GNorm = 0.9332, lr_0 = 9.3057e-04
Validation prc-auc = 0.948117
Validation auc = 0.934757
Epoch 3
Loss = 3.3893e-01, PNorm = 43.5555, GNorm = 0.5176, lr_0 = 9.0463e-04
Loss = 3.0686e-01, PNorm = 43.5994, GNorm = 0.8728, lr_0 = 8.8168e-04
Loss = 3.6472e-01, PNorm = 43.6470, GNorm = 1.1152, lr_0 = 8.5931e-04
Loss = 2.7962e-01, PNorm = 43.6950, GNorm = 0.5881, lr_0 = 8.3751e-04
Validation prc-auc = 0.949659
Validation auc = 0.938641
Epoch 4
Loss = 3.3077e-01, PNorm = 43.7483, GNorm = 1.2279, lr_0 = 8.1626e-04
Loss = 2.8110e-01, PNorm = 43.7889, GNorm = 0.3564, lr_0 = 7.9555e-04
Loss = 2.5207e-01, PNorm = 43.8293, GNorm = 0.5241, lr_0 = 7.7537e-04
Validation prc-auc = 0.948536
Validation auc = 0.935728
Epoch 5
Loss = 2.7219e-01, PNorm = 43.8706, GNorm = 0.5551, lr_0 = 7.5376e-04
Loss = 3.2053e-01, PNorm = 43.9159, GNorm = 0.3310, lr_0 = 7.3463e-04
Loss = 2.6259e-01, PNorm = 43.9690, GNorm = 0.4511, lr_0 = 7.1600e-04
Validation prc-auc = 0.952400
Validation auc = 0.941990
Epoch 6
Loss = 2.7498e-01, PNorm = 44.0235, GNorm = 0.3817, lr_0 = 6.9783e-04
Loss = 2.9584e-01, PNorm = 44.0749, GNorm = 0.7889, lr_0 = 6.8013e-04
Loss = 2.5670e-01, PNorm = 44.1274, GNorm = 0.3852, lr_0 = 6.6287e-04
Validation prc-auc = 0.948666
Validation auc = 0.936699
Epoch 7
Loss = 3.0720e-01, PNorm = 44.1868, GNorm = 1.2606, lr_0 = 6.4439e-04
Loss = 2.5876e-01, PNorm = 44.2415, GNorm = 0.4261, lr_0 = 6.2805e-04
Loss = 2.2498e-01, PNorm = 44.2920, GNorm = 0.4360, lr_0 = 6.1211e-04
Loss = 2.8341e-01, PNorm = 44.3383, GNorm = 0.4061, lr_0 = 5.9658e-04
Validation prc-auc = 0.948812
Validation auc = 0.937767
Epoch 8
Loss = 2.5846e-01, PNorm = 44.3977, GNorm = 0.4061, lr_0 = 5.8145e-04
Loss = 2.5660e-01, PNorm = 44.4557, GNorm = 0.3729, lr_0 = 5.6669e-04
Loss = 2.3291e-01, PNorm = 44.5039, GNorm = 0.8212, lr_0 = 5.5232e-04
Validation prc-auc = 0.952409
Validation auc = 0.942039
Epoch 9
Loss = 2.3950e-01, PNorm = 44.5620, GNorm = 0.8141, lr_0 = 5.3692e-04
Loss = 2.3591e-01, PNorm = 44.6294, GNorm = 0.6963, lr_0 = 5.2330e-04
Loss = 2.2285e-01, PNorm = 44.6679, GNorm = 0.4602, lr_0 = 5.1002e-04
Validation prc-auc = 0.951381
Validation auc = 0.942039
Epoch 10
Loss = 2.1677e-01, PNorm = 44.7192, GNorm = 0.8664, lr_0 = 4.9708e-04
Loss = 2.5378e-01, PNorm = 44.7608, GNorm = 0.4529, lr_0 = 4.8447e-04
Loss = 2.5219e-01, PNorm = 44.8049, GNorm = 0.7141, lr_0 = 4.7218e-04
Validation prc-auc = 0.949684
Validation auc = 0.938835
Epoch 11
Loss = 2.1548e-01, PNorm = 44.8546, GNorm = 0.3144, lr_0 = 4.5902e-04
Loss = 2.0482e-01, PNorm = 44.9029, GNorm = 0.4500, lr_0 = 4.4737e-04
Loss = 2.0315e-01, PNorm = 44.9583, GNorm = 0.3897, lr_0 = 4.3602e-04
Loss = 2.7091e-01, PNorm = 44.9956, GNorm = 1.2696, lr_0 = 4.2496e-04
Validation prc-auc = 0.948250
Validation auc = 0.937282
Epoch 12
Loss = 2.6336e-01, PNorm = 45.0478, GNorm = 0.5335, lr_0 = 4.1418e-04
Loss = 2.0192e-01, PNorm = 45.1050, GNorm = 0.5514, lr_0 = 4.0367e-04
Loss = 2.2376e-01, PNorm = 45.1479, GNorm = 0.7280, lr_0 = 3.9343e-04
Validation prc-auc = 0.949485
Validation auc = 0.941456
Epoch 13
Loss = 1.9441e-01, PNorm = 45.1955, GNorm = 0.5818, lr_0 = 3.8345e-04
Loss = 2.0529e-01, PNorm = 45.2474, GNorm = 0.3405, lr_0 = 3.7372e-04
Loss = 1.9582e-01, PNorm = 45.2990, GNorm = 0.3780, lr_0 = 3.6424e-04
Validation prc-auc = 0.953567
Validation auc = 0.945728
Epoch 14
Loss = 2.1778e-01, PNorm = 45.3452, GNorm = 0.6986, lr_0 = 3.5408e-04
Loss = 1.7434e-01, PNorm = 45.3983, GNorm = 0.6688, lr_0 = 3.4510e-04
Loss = 2.2302e-01, PNorm = 45.4408, GNorm = 0.3568, lr_0 = 3.3635e-04
Validation prc-auc = 0.945929
Validation auc = 0.938155
Epoch 15
Loss = 2.0469e-01, PNorm = 45.4867, GNorm = 0.6762, lr_0 = 3.2781e-04
Loss = 1.6455e-01, PNorm = 45.5325, GNorm = 0.8738, lr_0 = 3.1950e-04
Loss = 1.9270e-01, PNorm = 45.5754, GNorm = 0.9535, lr_0 = 3.1139e-04
Loss = 2.1955e-01, PNorm = 45.6117, GNorm = 0.5942, lr_0 = 3.0349e-04
Loss = 1.9288e-01, PNorm = 45.6145, GNorm = 0.8404, lr_0 = 3.0271e-04
Validation prc-auc = 0.948799
Validation auc = 0.936019
Epoch 16
Loss = 2.1003e-01, PNorm = 45.6538, GNorm = 1.6983, lr_0 = 2.9503e-04
Loss = 1.9735e-01, PNorm = 45.7050, GNorm = 0.4397, lr_0 = 2.8754e-04
Loss = 1.3830e-01, PNorm = 45.7520, GNorm = 0.4902, lr_0 = 2.8025e-04
Validation prc-auc = 0.945160
Validation auc = 0.935825
Epoch 17
Loss = 1.7820e-01, PNorm = 45.7866, GNorm = 0.4215, lr_0 = 2.7314e-04
Loss = 1.8802e-01, PNorm = 45.8155, GNorm = 1.5651, lr_0 = 2.6621e-04
Loss = 1.8896e-01, PNorm = 45.8472, GNorm = 0.4778, lr_0 = 2.5946e-04
Validation prc-auc = 0.948838
Validation auc = 0.940485
Epoch 18
Loss = 1.5350e-01, PNorm = 45.8946, GNorm = 1.1169, lr_0 = 2.5222e-04
Loss = 1.5458e-01, PNorm = 45.9242, GNorm = 0.8973, lr_0 = 2.4582e-04
Loss = 1.8079e-01, PNorm = 45.9671, GNorm = 0.7335, lr_0 = 2.3959e-04
Validation prc-auc = 0.944348
Validation auc = 0.934466
Epoch 19
Loss = 2.0481e-01, PNorm = 45.9988, GNorm = 0.7389, lr_0 = 2.3351e-04
Loss = 1.8970e-01, PNorm = 46.0338, GNorm = 1.0687, lr_0 = 2.2758e-04
Loss = 1.5958e-01, PNorm = 46.0614, GNorm = 0.4693, lr_0 = 2.2181e-04
Loss = 1.5583e-01, PNorm = 46.0977, GNorm = 0.6026, lr_0 = 2.1618e-04
Loss = 2.8684e-01, PNorm = 46.1016, GNorm = 0.6924, lr_0 = 2.1563e-04
Validation prc-auc = 0.947898
Validation auc = 0.938252
Epoch 20
Loss = 1.5584e-01, PNorm = 46.1397, GNorm = 0.9987, lr_0 = 2.1016e-04
Loss = 1.7851e-01, PNorm = 46.1781, GNorm = 0.5778, lr_0 = 2.0483e-04
Loss = 1.5467e-01, PNorm = 46.2078, GNorm = 0.7952, lr_0 = 1.9963e-04
Validation prc-auc = 0.945898
Validation auc = 0.936505
Epoch 21
Loss = 1.8616e-01, PNorm = 46.2349, GNorm = 1.5276, lr_0 = 1.9456e-04
Loss = 1.5415e-01, PNorm = 46.2702, GNorm = 0.5280, lr_0 = 1.8963e-04
Loss = 1.4611e-01, PNorm = 46.2976, GNorm = 0.2811, lr_0 = 1.8482e-04
Validation prc-auc = 0.944396
Validation auc = 0.935437
Epoch 22
Loss = 2.1358e-01, PNorm = 46.3231, GNorm = 0.5695, lr_0 = 1.7967e-04
Loss = 1.4222e-01, PNorm = 46.3484, GNorm = 0.6077, lr_0 = 1.7511e-04
Loss = 1.3721e-01, PNorm = 46.3747, GNorm = 0.6276, lr_0 = 1.7066e-04
Validation prc-auc = 0.941378
Validation auc = 0.928252
Epoch 23
Loss = 1.6126e-01, PNorm = 46.4055, GNorm = 0.4336, lr_0 = 1.6633e-04
Loss = 1.6395e-01, PNorm = 46.4349, GNorm = 0.3780, lr_0 = 1.6211e-04
Loss = 1.3359e-01, PNorm = 46.4583, GNorm = 0.4974, lr_0 = 1.5800e-04
Loss = 1.5167e-01, PNorm = 46.4824, GNorm = 0.9208, lr_0 = 1.5399e-04
Loss = 1.0916e-01, PNorm = 46.4840, GNorm = 0.7294, lr_0 = 1.5360e-04
Validation prc-auc = 0.942783
Validation auc = 0.934466
Epoch 24
Loss = 1.3236e-01, PNorm = 46.5034, GNorm = 0.7657, lr_0 = 1.4970e-04
Loss = 1.2536e-01, PNorm = 46.5291, GNorm = 0.3192, lr_0 = 1.4590e-04
Loss = 1.4649e-01, PNorm = 46.5497, GNorm = 1.0381, lr_0 = 1.4220e-04
Validation prc-auc = 0.941693
Validation auc = 0.932718
Epoch 25
Loss = 1.0475e-01, PNorm = 46.5741, GNorm = 0.5194, lr_0 = 1.3859e-04
Loss = 1.4385e-01, PNorm = 46.6012, GNorm = 1.6167, lr_0 = 1.3508e-04
Loss = 1.2316e-01, PNorm = 46.6239, GNorm = 0.7209, lr_0 = 1.3165e-04
Validation prc-auc = 0.940009
Validation auc = 0.932524
Epoch 26
Loss = 1.3509e-01, PNorm = 46.6404, GNorm = 0.7355, lr_0 = 1.2831e-04
Loss = 1.1691e-01, PNorm = 46.6605, GNorm = 1.6374, lr_0 = 1.2505e-04
Loss = 1.2887e-01, PNorm = 46.6809, GNorm = 0.4522, lr_0 = 1.2188e-04
Validation prc-auc = 0.937685
Validation auc = 0.929417
Epoch 27
Loss = 1.3928e-01, PNorm = 46.7001, GNorm = 0.9762, lr_0 = 1.1848e-04
Loss = 1.1721e-01, PNorm = 46.7224, GNorm = 0.5724, lr_0 = 1.1548e-04
Loss = 1.3558e-01, PNorm = 46.7365, GNorm = 0.4720, lr_0 = 1.1255e-04
Loss = 1.2066e-01, PNorm = 46.7561, GNorm = 1.2212, lr_0 = 1.0969e-04
Validation prc-auc = 0.938942
Validation auc = 0.925049
Epoch 28
Loss = 1.4218e-01, PNorm = 46.7698, GNorm = 0.6350, lr_0 = 1.0691e-04
Loss = 1.0679e-01, PNorm = 46.7884, GNorm = 0.7757, lr_0 = 1.0420e-04
Loss = 1.3316e-01, PNorm = 46.8034, GNorm = 0.8248, lr_0 = 1.0155e-04
Validation prc-auc = 0.939588
Validation auc = 0.933010
Epoch 29
Loss = 1.2838e-01, PNorm = 46.8184, GNorm = 0.4819, lr_0 = 1.0000e-04
Loss = 1.2192e-01, PNorm = 46.8319, GNorm = 0.5677, lr_0 = 1.0000e-04
Loss = 1.1606e-01, PNorm = 46.8454, GNorm = 0.6663, lr_0 = 1.0000e-04
Validation prc-auc = 0.938474
Validation auc = 0.930000
Model 1 best validation prc-auc = 0.953567 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.936058
Model 1 test auc = 0.936797
Ensemble test prc-auc = 0.942857
Ensemble test auc = 0.946705
Fold 4
Splitting data with seed 4
Total scaffolds = 1,229 | train scaffolds = 941 | val scaffolds = 146 | test scaffolds = 142
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 142 | target average = 0.169014


Scaffold 1
Task 0: count = 118 | target average = 0.440678


Scaffold 2
Task 0: count = 20 | target average = 0.000000


Scaffold 3
Task 0: count = 16 | target average = 0.062500


Scaffold 4
Task 0: count = 16 | target average = 0.187500


Scaffold 5
Task 0: count = 14 | target average = 0.000000


Scaffold 6
Task 0: count = 12 | target average = 0.000000


Scaffold 7
Task 0: count = 11 | target average = 0.181818


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 9 | target average = 0.888889


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 5.6667e-01, PNorm = 43.2262, GNorm = 0.7171, lr_0 = 2.5469e-04
Loss = 4.3702e-01, PNorm = 43.2501, GNorm = 0.7382, lr_0 = 3.9531e-04
Loss = 3.7582e-01, PNorm = 43.2712, GNorm = 0.5790, lr_0 = 5.3594e-04
Validation prc-auc = 0.900043
Validation auc = 0.891156
Epoch 1
Loss = 3.5402e-01, PNorm = 43.3003, GNorm = 1.2046, lr_0 = 6.9063e-04
Loss = 3.2849e-01, PNorm = 43.3246, GNorm = 0.6327, lr_0 = 8.3125e-04
Loss = 3.3814e-01, PNorm = 43.3590, GNorm = 0.4455, lr_0 = 9.7187e-04
Validation prc-auc = 0.907795
Validation auc = 0.897862
Epoch 2
Loss = 3.4661e-01, PNorm = 43.4053, GNorm = 0.4828, lr_0 = 9.7965e-04
Loss = 3.2690e-01, PNorm = 43.4482, GNorm = 0.3682, lr_0 = 9.5480e-04
Loss = 2.8979e-01, PNorm = 43.4970, GNorm = 0.5414, lr_0 = 9.3057e-04
Validation prc-auc = 0.912585
Validation auc = 0.901263
Epoch 3
Loss = 3.3873e-01, PNorm = 43.5338, GNorm = 0.4504, lr_0 = 9.0463e-04
Loss = 2.9321e-01, PNorm = 43.5749, GNorm = 0.3804, lr_0 = 8.8168e-04
Loss = 2.6425e-01, PNorm = 43.6151, GNorm = 0.4524, lr_0 = 8.5931e-04
Loss = 3.0277e-01, PNorm = 43.6442, GNorm = 0.4162, lr_0 = 8.3751e-04
Validation prc-auc = 0.917793
Validation auc = 0.902527
Epoch 4
Loss = 3.0458e-01, PNorm = 43.6873, GNorm = 0.5911, lr_0 = 8.1626e-04
Loss = 2.9272e-01, PNorm = 43.7324, GNorm = 1.3304, lr_0 = 7.9555e-04
Loss = 3.5250e-01, PNorm = 43.7681, GNorm = 0.6370, lr_0 = 7.7537e-04
Validation prc-auc = 0.913830
Validation auc = 0.902430
Epoch 5
Loss = 3.0216e-01, PNorm = 43.8142, GNorm = 0.4132, lr_0 = 7.5376e-04
Loss = 2.8147e-01, PNorm = 43.8602, GNorm = 0.2462, lr_0 = 7.3463e-04
Loss = 2.7514e-01, PNorm = 43.9007, GNorm = 0.2754, lr_0 = 7.1600e-04
Validation prc-auc = 0.917997
Validation auc = 0.903304
Epoch 6
Loss = 2.0802e-01, PNorm = 43.9454, GNorm = 0.5697, lr_0 = 6.9783e-04
Loss = 2.8618e-01, PNorm = 43.9915, GNorm = 0.5254, lr_0 = 6.8013e-04
Loss = 2.7706e-01, PNorm = 44.0409, GNorm = 0.5279, lr_0 = 6.6287e-04
Validation prc-auc = 0.920852
Validation auc = 0.905053
Epoch 7
Loss = 2.3486e-01, PNorm = 44.0807, GNorm = 0.4160, lr_0 = 6.4439e-04
Loss = 2.7279e-01, PNorm = 44.1293, GNorm = 0.3603, lr_0 = 6.2805e-04
Loss = 2.6842e-01, PNorm = 44.1798, GNorm = 0.5135, lr_0 = 6.1211e-04
Loss = 2.4713e-01, PNorm = 44.2344, GNorm = 0.5294, lr_0 = 5.9658e-04
Validation prc-auc = 0.922030
Validation auc = 0.905248
Epoch 8
Loss = 2.5657e-01, PNorm = 44.2893, GNorm = 0.4330, lr_0 = 5.8145e-04
Loss = 2.3125e-01, PNorm = 44.3460, GNorm = 0.2972, lr_0 = 5.6669e-04
Loss = 2.7066e-01, PNorm = 44.3929, GNorm = 0.4265, lr_0 = 5.5232e-04
Validation prc-auc = 0.923953
Validation auc = 0.905539
Epoch 9
Loss = 2.4847e-01, PNorm = 44.4396, GNorm = 0.7413, lr_0 = 5.3692e-04
Loss = 2.5532e-01, PNorm = 44.4971, GNorm = 0.3141, lr_0 = 5.2330e-04
Loss = 2.3233e-01, PNorm = 44.5540, GNorm = 0.3000, lr_0 = 5.1002e-04
Validation prc-auc = 0.923636
Validation auc = 0.906706
Epoch 10
Loss = 1.8938e-01, PNorm = 44.6031, GNorm = 0.2849, lr_0 = 4.9708e-04
Loss = 2.5531e-01, PNorm = 44.6646, GNorm = 0.8680, lr_0 = 4.8447e-04
Loss = 2.3199e-01, PNorm = 44.7183, GNorm = 0.3703, lr_0 = 4.7218e-04
Validation prc-auc = 0.923036
Validation auc = 0.905248
Epoch 11
Loss = 2.1278e-01, PNorm = 44.7743, GNorm = 0.4330, lr_0 = 4.5902e-04
Loss = 2.4763e-01, PNorm = 44.8312, GNorm = 1.0977, lr_0 = 4.4737e-04
Loss = 2.1718e-01, PNorm = 44.8920, GNorm = 0.6958, lr_0 = 4.3602e-04
Loss = 2.0184e-01, PNorm = 44.9420, GNorm = 0.6884, lr_0 = 4.2496e-04
Validation prc-auc = 0.922464
Validation auc = 0.904373
Epoch 12
Loss = 2.1069e-01, PNorm = 45.0013, GNorm = 1.1293, lr_0 = 4.1418e-04
Loss = 2.6553e-01, PNorm = 45.0492, GNorm = 0.5823, lr_0 = 4.0367e-04
Loss = 2.0709e-01, PNorm = 45.0906, GNorm = 0.2184, lr_0 = 3.9343e-04
Validation prc-auc = 0.923608
Validation auc = 0.905151
Epoch 13
Loss = 1.8156e-01, PNorm = 45.1313, GNorm = 0.3651, lr_0 = 3.8345e-04
Loss = 2.1203e-01, PNorm = 45.1745, GNorm = 0.3421, lr_0 = 3.7372e-04
Loss = 2.2882e-01, PNorm = 45.2190, GNorm = 0.4879, lr_0 = 3.6424e-04
Validation prc-auc = 0.921651
Validation auc = 0.902332
Epoch 14
Loss = 1.8284e-01, PNorm = 45.2670, GNorm = 0.6266, lr_0 = 3.5408e-04
Loss = 1.9010e-01, PNorm = 45.3150, GNorm = 1.2215, lr_0 = 3.4510e-04
Loss = 2.8310e-01, PNorm = 45.3675, GNorm = 0.6758, lr_0 = 3.3635e-04
Validation prc-auc = 0.922539
Validation auc = 0.903207
Epoch 15
Loss = 1.6235e-01, PNorm = 45.4092, GNorm = 0.3795, lr_0 = 3.2781e-04
Loss = 1.9305e-01, PNorm = 45.4440, GNorm = 0.5857, lr_0 = 3.1950e-04
Loss = 1.9075e-01, PNorm = 45.4896, GNorm = 0.5847, lr_0 = 3.1139e-04
Loss = 2.2068e-01, PNorm = 45.5361, GNorm = 0.6875, lr_0 = 3.0349e-04
Loss = 2.5229e-01, PNorm = 45.5417, GNorm = 1.0227, lr_0 = 3.0271e-04
Validation prc-auc = 0.921553
Validation auc = 0.901069
Epoch 16
Loss = 1.9139e-01, PNorm = 45.5806, GNorm = 0.3803, lr_0 = 2.9503e-04
Loss = 2.0248e-01, PNorm = 45.6206, GNorm = 1.1111, lr_0 = 2.8754e-04
Loss = 2.0149e-01, PNorm = 45.6561, GNorm = 0.7146, lr_0 = 2.8025e-04
Validation prc-auc = 0.918386
Validation auc = 0.896599
Epoch 17
Loss = 2.1373e-01, PNorm = 45.6842, GNorm = 0.4084, lr_0 = 2.7314e-04
Loss = 1.7499e-01, PNorm = 45.7205, GNorm = 0.2780, lr_0 = 2.6621e-04
Loss = 2.0050e-01, PNorm = 45.7590, GNorm = 0.5589, lr_0 = 2.5946e-04
Validation prc-auc = 0.923884
Validation auc = 0.905345
Epoch 18
Loss = 1.3687e-01, PNorm = 45.7982, GNorm = 0.9153, lr_0 = 2.5222e-04
Loss = 1.9814e-01, PNorm = 45.8327, GNorm = 0.5259, lr_0 = 2.4582e-04
Loss = 1.6144e-01, PNorm = 45.8656, GNorm = 0.3160, lr_0 = 2.3959e-04
Validation prc-auc = 0.924250
Validation auc = 0.905151
Epoch 19
Loss = 1.7799e-01, PNorm = 45.8980, GNorm = 0.6742, lr_0 = 2.3351e-04
Loss = 1.3855e-01, PNorm = 45.9345, GNorm = 0.3583, lr_0 = 2.2758e-04
Loss = 1.9365e-01, PNorm = 45.9654, GNorm = 1.2910, lr_0 = 2.2181e-04
Loss = 1.8636e-01, PNorm = 46.0015, GNorm = 0.6867, lr_0 = 2.1618e-04
Loss = 2.7007e-01, PNorm = 46.0054, GNorm = 1.2000, lr_0 = 2.1563e-04
Validation prc-auc = 0.920605
Validation auc = 0.899903
Epoch 20
Loss = 1.4975e-01, PNorm = 46.0425, GNorm = 0.4519, lr_0 = 2.1016e-04
Loss = 1.8970e-01, PNorm = 46.0698, GNorm = 0.9094, lr_0 = 2.0483e-04
Loss = 2.0140e-01, PNorm = 46.0983, GNorm = 0.7547, lr_0 = 1.9963e-04
Validation prc-auc = 0.922272
Validation auc = 0.903110
Epoch 21
Loss = 1.4606e-01, PNorm = 46.1244, GNorm = 0.5894, lr_0 = 1.9456e-04
Loss = 1.6047e-01, PNorm = 46.1519, GNorm = 0.4525, lr_0 = 1.8963e-04
Loss = 1.4782e-01, PNorm = 46.1807, GNorm = 0.9372, lr_0 = 1.8482e-04
Validation prc-auc = 0.920717
Validation auc = 0.899320
Epoch 22
Loss = 1.3542e-01, PNorm = 46.2140, GNorm = 0.5844, lr_0 = 1.7967e-04
Loss = 1.5552e-01, PNorm = 46.2412, GNorm = 0.5069, lr_0 = 1.7511e-04
Loss = 1.5414e-01, PNorm = 46.2686, GNorm = 0.4228, lr_0 = 1.7066e-04
Validation prc-auc = 0.920160
Validation auc = 0.897182
Epoch 23
Loss = 1.2361e-01, PNorm = 46.2938, GNorm = 1.0834, lr_0 = 1.6633e-04
Loss = 1.4352e-01, PNorm = 46.3178, GNorm = 0.7011, lr_0 = 1.6211e-04
Loss = 1.4963e-01, PNorm = 46.3431, GNorm = 0.7963, lr_0 = 1.5800e-04
Loss = 1.7307e-01, PNorm = 46.3692, GNorm = 0.7406, lr_0 = 1.5399e-04
Loss = 1.6139e-01, PNorm = 46.3712, GNorm = 1.0371, lr_0 = 1.5360e-04
Validation prc-auc = 0.921342
Validation auc = 0.899417
Epoch 24
Loss = 1.5692e-01, PNorm = 46.3913, GNorm = 1.3226, lr_0 = 1.4970e-04
Loss = 1.3700e-01, PNorm = 46.4159, GNorm = 0.6054, lr_0 = 1.4590e-04
Loss = 1.4241e-01, PNorm = 46.4366, GNorm = 0.8037, lr_0 = 1.4220e-04
Validation prc-auc = 0.920476
Validation auc = 0.900389
Epoch 25
Loss = 1.5523e-01, PNorm = 46.4589, GNorm = 0.9354, lr_0 = 1.3859e-04
Loss = 1.3602e-01, PNorm = 46.4805, GNorm = 0.3891, lr_0 = 1.3508e-04
Loss = 1.3207e-01, PNorm = 46.4992, GNorm = 0.6990, lr_0 = 1.3165e-04
Validation prc-auc = 0.919959
Validation auc = 0.898348
Epoch 26
Loss = 1.2835e-01, PNorm = 46.5166, GNorm = 0.3758, lr_0 = 1.2831e-04
Loss = 1.3388e-01, PNorm = 46.5335, GNorm = 0.5312, lr_0 = 1.2505e-04
Loss = 1.3784e-01, PNorm = 46.5545, GNorm = 1.5292, lr_0 = 1.2188e-04
Validation prc-auc = 0.921158
Validation auc = 0.899320
Epoch 27
Loss = 1.4031e-01, PNorm = 46.5709, GNorm = 0.5797, lr_0 = 1.1848e-04
Loss = 1.0897e-01, PNorm = 46.5889, GNorm = 0.5880, lr_0 = 1.1548e-04
Loss = 1.5298e-01, PNorm = 46.6039, GNorm = 0.6911, lr_0 = 1.1255e-04
Loss = 1.3920e-01, PNorm = 46.6200, GNorm = 1.2603, lr_0 = 1.0969e-04
Validation prc-auc = 0.919899
Validation auc = 0.899320
Epoch 28
Loss = 1.4081e-01, PNorm = 46.6337, GNorm = 1.3448, lr_0 = 1.0691e-04
Loss = 1.1712e-01, PNorm = 46.6491, GNorm = 1.5322, lr_0 = 1.0420e-04
Loss = 1.1805e-01, PNorm = 46.6621, GNorm = 0.8779, lr_0 = 1.0155e-04
Validation prc-auc = 0.922030
Validation auc = 0.901069
Epoch 29
Loss = 1.3339e-01, PNorm = 46.6814, GNorm = 0.5214, lr_0 = 1.0000e-04
Loss = 1.1444e-01, PNorm = 46.6965, GNorm = 0.4936, lr_0 = 1.0000e-04
Loss = 1.5587e-01, PNorm = 46.7108, GNorm = 0.3510, lr_0 = 1.0000e-04
Validation prc-auc = 0.921806
Validation auc = 0.900972
Model 0 best validation prc-auc = 0.924250 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.982476
Model 0 test auc = 0.975926
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.1516e-01, PNorm = 43.2495, GNorm = 1.0957, lr_0 = 2.5469e-04
Loss = 4.4602e-01, PNorm = 43.2735, GNorm = 0.9317, lr_0 = 3.9531e-04
Loss = 3.3640e-01, PNorm = 43.3059, GNorm = 1.6481, lr_0 = 5.3594e-04
Validation prc-auc = 0.896704
Validation auc = 0.886686
Epoch 1
Loss = 3.3775e-01, PNorm = 43.3307, GNorm = 1.5873, lr_0 = 6.9063e-04
Loss = 3.6532e-01, PNorm = 43.3602, GNorm = 0.4848, lr_0 = 8.3125e-04
Loss = 3.2523e-01, PNorm = 43.3895, GNorm = 0.4411, lr_0 = 9.7187e-04
Validation prc-auc = 0.896806
Validation auc = 0.888921
Epoch 2
Loss = 3.2574e-01, PNorm = 43.4265, GNorm = 0.4763, lr_0 = 9.7965e-04
Loss = 3.4074e-01, PNorm = 43.4632, GNorm = 0.4694, lr_0 = 9.5480e-04
Loss = 3.1038e-01, PNorm = 43.5011, GNorm = 0.7025, lr_0 = 9.3057e-04
Validation prc-auc = 0.902811
Validation auc = 0.890671
Epoch 3
Loss = 2.7947e-01, PNorm = 43.5484, GNorm = 0.7211, lr_0 = 9.0463e-04
Loss = 3.3576e-01, PNorm = 43.5815, GNorm = 1.1254, lr_0 = 8.8168e-04
Loss = 3.1001e-01, PNorm = 43.6210, GNorm = 0.3395, lr_0 = 8.5931e-04
Loss = 3.0692e-01, PNorm = 43.6647, GNorm = 0.9935, lr_0 = 8.3751e-04
Validation prc-auc = 0.908474
Validation auc = 0.899028
Epoch 4
Loss = 3.0282e-01, PNorm = 43.7056, GNorm = 0.7755, lr_0 = 8.1626e-04
Loss = 2.5520e-01, PNorm = 43.7531, GNorm = 0.4661, lr_0 = 7.9555e-04
Loss = 3.3315e-01, PNorm = 43.7854, GNorm = 0.7148, lr_0 = 7.7537e-04
Validation prc-auc = 0.914508
Validation auc = 0.902138
Epoch 5
Loss = 2.8641e-01, PNorm = 43.8342, GNorm = 0.5824, lr_0 = 7.5376e-04
Loss = 2.6603e-01, PNorm = 43.8819, GNorm = 0.4239, lr_0 = 7.3463e-04
Loss = 2.6960e-01, PNorm = 43.9264, GNorm = 0.6025, lr_0 = 7.1600e-04
Validation prc-auc = 0.916059
Validation auc = 0.904082
Epoch 6
Loss = 2.2420e-01, PNorm = 43.9747, GNorm = 0.3474, lr_0 = 6.9783e-04
Loss = 2.9124e-01, PNorm = 44.0246, GNorm = 0.5644, lr_0 = 6.8013e-04
Loss = 2.5745e-01, PNorm = 44.0860, GNorm = 0.5997, lr_0 = 6.6287e-04
Validation prc-auc = 0.919128
Validation auc = 0.904179
Epoch 7
Loss = 2.4192e-01, PNorm = 44.1467, GNorm = 0.5528, lr_0 = 6.4439e-04
Loss = 2.1885e-01, PNorm = 44.2015, GNorm = 0.3813, lr_0 = 6.2805e-04
Loss = 2.7578e-01, PNorm = 44.2625, GNorm = 0.4036, lr_0 = 6.1211e-04
Loss = 2.8686e-01, PNorm = 44.3099, GNorm = 0.7142, lr_0 = 5.9658e-04
Validation prc-auc = 0.919578
Validation auc = 0.902138
Epoch 8
Loss = 2.2893e-01, PNorm = 44.3666, GNorm = 0.4858, lr_0 = 5.8145e-04
Loss = 3.1810e-01, PNorm = 44.4100, GNorm = 1.2765, lr_0 = 5.6669e-04
Loss = 2.4756e-01, PNorm = 44.4538, GNorm = 0.7607, lr_0 = 5.5232e-04
Validation prc-auc = 0.918069
Validation auc = 0.899417
Epoch 9
Loss = 2.4925e-01, PNorm = 44.5278, GNorm = 0.4658, lr_0 = 5.3692e-04
Loss = 2.5179e-01, PNorm = 44.5721, GNorm = 0.6318, lr_0 = 5.2330e-04
Loss = 2.4281e-01, PNorm = 44.6298, GNorm = 0.3178, lr_0 = 5.1002e-04
Validation prc-auc = 0.920640
Validation auc = 0.904373
Epoch 10
Loss = 2.4382e-01, PNorm = 44.6868, GNorm = 0.6608, lr_0 = 4.9708e-04
Loss = 2.6225e-01, PNorm = 44.7479, GNorm = 0.4419, lr_0 = 4.8447e-04
Loss = 2.1998e-01, PNorm = 44.7859, GNorm = 0.7572, lr_0 = 4.7218e-04
Validation prc-auc = 0.920869
Validation auc = 0.904082
Epoch 11
Loss = 2.9480e-01, PNorm = 44.8452, GNorm = 0.4617, lr_0 = 4.5902e-04
Loss = 2.1901e-01, PNorm = 44.9013, GNorm = 0.9276, lr_0 = 4.4737e-04
Loss = 2.0735e-01, PNorm = 44.9594, GNorm = 0.7054, lr_0 = 4.3602e-04
Loss = 2.4866e-01, PNorm = 44.9918, GNorm = 1.0650, lr_0 = 4.2496e-04
Validation prc-auc = 0.920925
Validation auc = 0.903110
Epoch 12
Loss = 2.3480e-01, PNorm = 45.0315, GNorm = 0.4089, lr_0 = 4.1418e-04
Loss = 2.0259e-01, PNorm = 45.0829, GNorm = 0.4071, lr_0 = 4.0367e-04
Loss = 2.1729e-01, PNorm = 45.1259, GNorm = 0.4586, lr_0 = 3.9343e-04
Validation prc-auc = 0.922180
Validation auc = 0.905151
Epoch 13
Loss = 1.8779e-01, PNorm = 45.1747, GNorm = 0.4115, lr_0 = 3.8345e-04
Loss = 1.8669e-01, PNorm = 45.2223, GNorm = 1.3826, lr_0 = 3.7372e-04
Loss = 2.2147e-01, PNorm = 45.2614, GNorm = 0.4325, lr_0 = 3.6424e-04
Validation prc-auc = 0.920284
Validation auc = 0.902527
Epoch 14
Loss = 2.0990e-01, PNorm = 45.3116, GNorm = 2.3289, lr_0 = 3.5408e-04
Loss = 2.0800e-01, PNorm = 45.3561, GNorm = 0.6220, lr_0 = 3.4510e-04
Loss = 2.0549e-01, PNorm = 45.3977, GNorm = 0.4669, lr_0 = 3.3635e-04
Validation prc-auc = 0.920962
Validation auc = 0.903790
Epoch 15
Loss = 2.4786e-01, PNorm = 45.4351, GNorm = 0.8839, lr_0 = 3.2781e-04
Loss = 2.1285e-01, PNorm = 45.4762, GNorm = 1.0468, lr_0 = 3.1950e-04
Loss = 1.8888e-01, PNorm = 45.5233, GNorm = 0.4395, lr_0 = 3.1139e-04
Loss = 1.9171e-01, PNorm = 45.5579, GNorm = 0.9950, lr_0 = 3.0349e-04
Loss = 1.5330e-01, PNorm = 45.5624, GNorm = 0.7571, lr_0 = 3.0271e-04
Validation prc-auc = 0.920638
Validation auc = 0.903110
Epoch 16
Loss = 1.7240e-01, PNorm = 45.6061, GNorm = 0.3992, lr_0 = 2.9503e-04
Loss = 1.8107e-01, PNorm = 45.6450, GNorm = 0.4708, lr_0 = 2.8754e-04
Loss = 2.0669e-01, PNorm = 45.6855, GNorm = 0.3814, lr_0 = 2.8025e-04
Validation prc-auc = 0.922690
Validation auc = 0.904470
Epoch 17
Loss = 1.8330e-01, PNorm = 45.7248, GNorm = 0.6110, lr_0 = 2.7314e-04
Loss = 1.9133e-01, PNorm = 45.7584, GNorm = 0.6667, lr_0 = 2.6621e-04
Loss = 1.8432e-01, PNorm = 45.8012, GNorm = 1.0582, lr_0 = 2.5946e-04
Validation prc-auc = 0.920701
Validation auc = 0.903110
Epoch 18
Loss = 1.8409e-01, PNorm = 45.8433, GNorm = 0.8471, lr_0 = 2.5222e-04
Loss = 1.9066e-01, PNorm = 45.8826, GNorm = 0.6497, lr_0 = 2.4582e-04
Loss = 2.0624e-01, PNorm = 45.9165, GNorm = 0.8092, lr_0 = 2.3959e-04
Validation prc-auc = 0.920452
Validation auc = 0.902332
Epoch 19
Loss = 1.4979e-01, PNorm = 45.9478, GNorm = 0.4608, lr_0 = 2.3351e-04
Loss = 1.5738e-01, PNorm = 45.9839, GNorm = 0.4563, lr_0 = 2.2758e-04
Loss = 2.0728e-01, PNorm = 46.0164, GNorm = 0.4537, lr_0 = 2.2181e-04
Loss = 1.5072e-01, PNorm = 46.0520, GNorm = 0.5506, lr_0 = 2.1618e-04
Loss = 1.4692e-01, PNorm = 46.0549, GNorm = 0.7581, lr_0 = 2.1563e-04
Validation prc-auc = 0.920851
Validation auc = 0.902527
Epoch 20
Loss = 1.3726e-01, PNorm = 46.0863, GNorm = 0.3322, lr_0 = 2.1016e-04
Loss = 1.7009e-01, PNorm = 46.1239, GNorm = 0.3427, lr_0 = 2.0483e-04
Loss = 1.7104e-01, PNorm = 46.1514, GNorm = 0.6760, lr_0 = 1.9963e-04
Validation prc-auc = 0.920954
Validation auc = 0.902527
Epoch 21
Loss = 1.8228e-01, PNorm = 46.1745, GNorm = 0.4574, lr_0 = 1.9456e-04
Loss = 1.5422e-01, PNorm = 46.2079, GNorm = 0.7879, lr_0 = 1.8963e-04
Loss = 1.4814e-01, PNorm = 46.2323, GNorm = 0.6032, lr_0 = 1.8482e-04
Validation prc-auc = 0.919403
Validation auc = 0.899903
Epoch 22
Loss = 2.0246e-01, PNorm = 46.2611, GNorm = 0.3726, lr_0 = 1.7967e-04
Loss = 1.6834e-01, PNorm = 46.2844, GNorm = 0.6423, lr_0 = 1.7511e-04
Loss = 1.5077e-01, PNorm = 46.3105, GNorm = 0.5172, lr_0 = 1.7066e-04
Validation prc-auc = 0.919955
Validation auc = 0.900972
Epoch 23
Loss = 1.1952e-01, PNorm = 46.3397, GNorm = 0.5496, lr_0 = 1.6633e-04
Loss = 1.4373e-01, PNorm = 46.3675, GNorm = 0.8583, lr_0 = 1.6211e-04
Loss = 1.6715e-01, PNorm = 46.3904, GNorm = 0.4186, lr_0 = 1.5800e-04
Loss = 1.3775e-01, PNorm = 46.4147, GNorm = 0.3932, lr_0 = 1.5399e-04
Loss = 6.2804e-02, PNorm = 46.4173, GNorm = 0.4990, lr_0 = 1.5360e-04
Validation prc-auc = 0.920150
Validation auc = 0.901944
Epoch 24
Loss = 1.6837e-01, PNorm = 46.4358, GNorm = 0.8459, lr_0 = 1.4970e-04
Loss = 1.4703e-01, PNorm = 46.4595, GNorm = 0.9652, lr_0 = 1.4590e-04
Loss = 1.4466e-01, PNorm = 46.4844, GNorm = 0.6493, lr_0 = 1.4220e-04
Validation prc-auc = 0.920628
Validation auc = 0.901263
Epoch 25
Loss = 1.3096e-01, PNorm = 46.5075, GNorm = 0.7052, lr_0 = 1.3859e-04
Loss = 1.5437e-01, PNorm = 46.5324, GNorm = 0.5552, lr_0 = 1.3508e-04
Loss = 1.3267e-01, PNorm = 46.5565, GNorm = 0.7892, lr_0 = 1.3165e-04
Validation prc-auc = 0.919428
Validation auc = 0.900000
Epoch 26
Loss = 1.3293e-01, PNorm = 46.5696, GNorm = 0.9603, lr_0 = 1.2831e-04
Loss = 1.4554e-01, PNorm = 46.5887, GNorm = 0.6075, lr_0 = 1.2505e-04
Loss = 1.2064e-01, PNorm = 46.6051, GNorm = 0.6855, lr_0 = 1.2188e-04
Validation prc-auc = 0.921575
Validation auc = 0.900875
Epoch 27
Loss = 1.1198e-01, PNorm = 46.6238, GNorm = 0.4750, lr_0 = 1.1848e-04
Loss = 1.3469e-01, PNorm = 46.6447, GNorm = 1.0919, lr_0 = 1.1548e-04
Loss = 1.0879e-01, PNorm = 46.6642, GNorm = 0.2844, lr_0 = 1.1255e-04
Loss = 1.3889e-01, PNorm = 46.6813, GNorm = 0.6714, lr_0 = 1.0969e-04
Validation prc-auc = 0.918516
Validation auc = 0.899320
Epoch 28
Loss = 1.2572e-01, PNorm = 46.6947, GNorm = 0.3271, lr_0 = 1.0691e-04
Loss = 1.2891e-01, PNorm = 46.7103, GNorm = 0.4372, lr_0 = 1.0420e-04
Loss = 1.0732e-01, PNorm = 46.7263, GNorm = 0.8419, lr_0 = 1.0155e-04
Validation prc-auc = 0.918545
Validation auc = 0.900000
Epoch 29
Loss = 1.0579e-01, PNorm = 46.7382, GNorm = 1.1789, lr_0 = 1.0000e-04
Loss = 1.4631e-01, PNorm = 46.7547, GNorm = 0.9037, lr_0 = 1.0000e-04
Loss = 1.3806e-01, PNorm = 46.7676, GNorm = 1.5566, lr_0 = 1.0000e-04
Validation prc-auc = 0.917747
Validation auc = 0.898639
Model 1 best validation prc-auc = 0.922690 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.984283
Model 1 test auc = 0.978558
Ensemble test prc-auc = 0.983590
Ensemble test auc = 0.977388
5-fold cross validation
	Seed 0 ==> test prc-auc = 0.950800
	Seed 0 ==> test auc = 0.945563
	Seed 1 ==> test prc-auc = 0.979712
	Seed 1 ==> test auc = 0.973325
	Seed 2 ==> test prc-auc = 0.953384
	Seed 2 ==> test auc = 0.939394
	Seed 3 ==> test prc-auc = 0.942857
	Seed 3 ==> test auc = 0.946705
	Seed 4 ==> test prc-auc = 0.983590
	Seed 4 ==> test auc = 0.977388
Overall test prc-auc = 0.962069 +/- 0.016407
Overall test auc = 0.956475 +/- 0.015669
Elapsed time = 0:27:02
