Command line
python /home/jackievaleri8/.conda/envs/chemprop/bin/chemprop_train --dropout 0.1 --hidden_size 500 --ffn_num_layers 2 --depth 3 --metric prc-auc --extra_metrics auc --save_dir models/controls_with_diff_neg_datasets/similar_N=1017/ --data_path data/controls_with_diff_neg_datasets/similar_N=1017.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --num_folds 5 --ensemble_size 2 --split_type scaffold_balanced --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --gpu 0
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/controls_with_diff_neg_datasets/similar_N=1017.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda', index=0),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 2,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 500,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'models/controls_with_diff_neg_datasets/similar_N=1017/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'scaffold_balanced',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 672 | train scaffolds = 544 | val scaffolds = 44 | test scaffolds = 84
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 96 | target average = 0.062500


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 38 | target average = 0.157895


Scaffold 3
Task 0: count = 31 | target average = 0.774194


Scaffold 4
Task 0: count = 30 | target average = 0.100000


Scaffold 5
Task 0: count = 28 | target average = 0.107143


Scaffold 6
Task 0: count = 27 | target average = 0.111111


Scaffold 7
Task 0: count = 26 | target average = 0.038462


Scaffold 8
Task 0: count = 26 | target average = 0.038462


Scaffold 9
Task 0: count = 25 | target average = 0.200000


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.6888e-01, PNorm = 43.2212, GNorm = 0.7411, lr_0 = 2.5469e-04
Loss = 5.2656e-01, PNorm = 43.2427, GNorm = 0.6713, lr_0 = 3.9531e-04
Loss = 5.1091e-01, PNorm = 43.2762, GNorm = 3.5413, lr_0 = 5.3594e-04
Validation prc-auc = 0.885076
Validation auc = 0.881218
Epoch 1
Loss = 4.5658e-01, PNorm = 43.3165, GNorm = 1.2364, lr_0 = 6.9063e-04
Loss = 4.7040e-01, PNorm = 43.3579, GNorm = 1.4576, lr_0 = 8.3125e-04
Loss = 4.4250e-01, PNorm = 43.4111, GNorm = 0.6006, lr_0 = 9.7187e-04
Validation prc-auc = 0.887117
Validation auc = 0.889346
Epoch 2
Loss = 4.2155e-01, PNorm = 43.4656, GNorm = 0.5266, lr_0 = 9.7965e-04
Loss = 4.3093e-01, PNorm = 43.5131, GNorm = 1.5764, lr_0 = 9.5480e-04
Loss = 3.8219e-01, PNorm = 43.5540, GNorm = 0.7418, lr_0 = 9.3057e-04
Validation prc-auc = 0.887195
Validation auc = 0.895221
Epoch 3
Loss = 3.4936e-01, PNorm = 43.5966, GNorm = 1.0506, lr_0 = 9.0463e-04
Loss = 3.6307e-01, PNorm = 43.6406, GNorm = 0.8028, lr_0 = 8.8168e-04
Loss = 3.5841e-01, PNorm = 43.6793, GNorm = 0.7589, lr_0 = 8.5931e-04
Loss = 4.2081e-01, PNorm = 43.7115, GNorm = 0.8869, lr_0 = 8.3751e-04
Validation prc-auc = 0.888806
Validation auc = 0.892186
Epoch 4
Loss = 3.4212e-01, PNorm = 43.7388, GNorm = 1.1919, lr_0 = 8.1626e-04
Loss = 4.0354e-01, PNorm = 43.7673, GNorm = 0.4536, lr_0 = 7.9555e-04
Loss = 3.4245e-01, PNorm = 43.8110, GNorm = 0.7488, lr_0 = 7.7537e-04
Validation prc-auc = 0.893250
Validation auc = 0.895025
Epoch 5
Loss = 3.7969e-01, PNorm = 43.8474, GNorm = 0.7490, lr_0 = 7.5376e-04
Loss = 3.9224e-01, PNorm = 43.8820, GNorm = 0.4101, lr_0 = 7.3463e-04
Loss = 3.6057e-01, PNorm = 43.9282, GNorm = 0.9985, lr_0 = 7.1600e-04
Validation prc-auc = 0.895552
Validation auc = 0.896005
Epoch 6
Loss = 3.1189e-01, PNorm = 43.9766, GNorm = 0.7693, lr_0 = 6.9783e-04
Loss = 3.3990e-01, PNorm = 44.0168, GNorm = 1.2097, lr_0 = 6.8013e-04
Loss = 3.6097e-01, PNorm = 44.0533, GNorm = 0.3213, lr_0 = 6.6287e-04
Validation prc-auc = 0.886215
Validation auc = 0.893850
Epoch 7
Loss = 5.0184e-01, PNorm = 44.0969, GNorm = 1.7790, lr_0 = 6.4439e-04
Loss = 4.0020e-01, PNorm = 44.1304, GNorm = 0.5933, lr_0 = 6.2805e-04
Loss = 3.3419e-01, PNorm = 44.1738, GNorm = 0.7839, lr_0 = 6.1211e-04
Loss = 3.4798e-01, PNorm = 44.2240, GNorm = 1.3711, lr_0 = 5.9658e-04
Validation prc-auc = 0.898034
Validation auc = 0.898747
Epoch 8
Loss = 3.5860e-01, PNorm = 44.2456, GNorm = 0.5552, lr_0 = 5.8145e-04
Loss = 3.5440e-01, PNorm = 44.2822, GNorm = 0.6672, lr_0 = 5.6669e-04
Loss = 3.4181e-01, PNorm = 44.3154, GNorm = 0.8877, lr_0 = 5.5232e-04
Validation prc-auc = 0.899139
Validation auc = 0.897571
Epoch 9
Loss = 3.8763e-01, PNorm = 44.3610, GNorm = 0.3784, lr_0 = 5.3692e-04
Loss = 3.0616e-01, PNorm = 44.3994, GNorm = 1.0563, lr_0 = 5.2330e-04
Loss = 3.8764e-01, PNorm = 44.4257, GNorm = 0.6324, lr_0 = 5.1002e-04
Validation prc-auc = 0.900131
Validation auc = 0.899824
Epoch 10
Loss = 3.9384e-01, PNorm = 44.4737, GNorm = 2.1428, lr_0 = 4.9708e-04
Loss = 3.7898e-01, PNorm = 44.4987, GNorm = 0.7236, lr_0 = 4.8447e-04
Loss = 3.4159e-01, PNorm = 44.5428, GNorm = 0.4776, lr_0 = 4.7218e-04
Validation prc-auc = 0.903851
Validation auc = 0.900313
Epoch 11
Loss = 3.4673e-01, PNorm = 44.5981, GNorm = 1.1668, lr_0 = 4.5902e-04
Loss = 3.3016e-01, PNorm = 44.6363, GNorm = 0.6481, lr_0 = 4.4737e-04
Loss = 3.2041e-01, PNorm = 44.6594, GNorm = 0.3172, lr_0 = 4.3602e-04
Loss = 3.4153e-01, PNorm = 44.6950, GNorm = 1.8663, lr_0 = 4.2496e-04
Validation prc-auc = 0.907480
Validation auc = 0.903741
Epoch 12
Loss = 3.4697e-01, PNorm = 44.7322, GNorm = 1.1020, lr_0 = 4.1418e-04
Loss = 3.4260e-01, PNorm = 44.7685, GNorm = 0.4803, lr_0 = 4.0367e-04
Loss = 3.2332e-01, PNorm = 44.7995, GNorm = 0.7156, lr_0 = 3.9343e-04
Validation prc-auc = 0.909079
Validation auc = 0.904524
Epoch 13
Loss = 3.7115e-01, PNorm = 44.8125, GNorm = 0.8835, lr_0 = 3.8345e-04
Loss = 3.1951e-01, PNorm = 44.8395, GNorm = 0.6130, lr_0 = 3.7372e-04
Loss = 3.5046e-01, PNorm = 44.8697, GNorm = 0.4012, lr_0 = 3.6424e-04
Validation prc-auc = 0.908748
Validation auc = 0.903251
Epoch 14
Loss = 3.3569e-01, PNorm = 44.9109, GNorm = 0.4728, lr_0 = 3.5408e-04
Loss = 3.3320e-01, PNorm = 44.9355, GNorm = 0.8703, lr_0 = 3.4510e-04
Loss = 2.9894e-01, PNorm = 44.9688, GNorm = 0.5189, lr_0 = 3.3635e-04
Validation prc-auc = 0.913114
Validation auc = 0.906678
Epoch 15
Loss = 3.0859e-01, PNorm = 44.9890, GNorm = 0.3555, lr_0 = 3.2781e-04
Loss = 3.3920e-01, PNorm = 45.0230, GNorm = 0.5253, lr_0 = 3.1950e-04
Loss = 3.1617e-01, PNorm = 45.0440, GNorm = 0.4721, lr_0 = 3.1139e-04
Loss = 3.3046e-01, PNorm = 45.0612, GNorm = 0.6410, lr_0 = 3.0349e-04
Loss = 3.0859e-01, PNorm = 45.0628, GNorm = 1.3799, lr_0 = 3.0271e-04
Validation prc-auc = 0.915389
Validation auc = 0.908147
Epoch 16
Loss = 3.0247e-01, PNorm = 45.0929, GNorm = 0.5230, lr_0 = 2.9503e-04
Loss = 2.7698e-01, PNorm = 45.1142, GNorm = 0.4414, lr_0 = 2.8754e-04
Loss = 3.7852e-01, PNorm = 45.1424, GNorm = 1.6220, lr_0 = 2.8025e-04
Validation prc-auc = 0.914769
Validation auc = 0.906727
Epoch 17
Loss = 3.6793e-01, PNorm = 45.1482, GNorm = 0.5125, lr_0 = 2.7314e-04
Loss = 3.0104e-01, PNorm = 45.1676, GNorm = 0.3980, lr_0 = 2.6621e-04
Loss = 3.1212e-01, PNorm = 45.1938, GNorm = 0.3845, lr_0 = 2.5946e-04
Validation prc-auc = 0.916919
Validation auc = 0.909469
Epoch 18
Loss = 2.7321e-01, PNorm = 45.2218, GNorm = 0.5927, lr_0 = 2.5222e-04
Loss = 3.1072e-01, PNorm = 45.2421, GNorm = 0.9071, lr_0 = 2.4582e-04
Loss = 3.5414e-01, PNorm = 45.2618, GNorm = 0.5558, lr_0 = 2.3959e-04
Validation prc-auc = 0.916193
Validation auc = 0.907364
Epoch 19
Loss = 3.5389e-01, PNorm = 45.2803, GNorm = 1.1066, lr_0 = 2.3351e-04
Loss = 3.0067e-01, PNorm = 45.2877, GNorm = 0.4846, lr_0 = 2.2758e-04
Loss = 2.8973e-01, PNorm = 45.3143, GNorm = 0.4432, lr_0 = 2.2181e-04
Loss = 3.5016e-01, PNorm = 45.3320, GNorm = 0.5964, lr_0 = 2.1618e-04
Loss = 3.0736e-01, PNorm = 45.3325, GNorm = 1.1108, lr_0 = 2.1563e-04
Validation prc-auc = 0.919064
Validation auc = 0.911085
Epoch 20
Loss = 2.9996e-01, PNorm = 45.3513, GNorm = 0.3480, lr_0 = 2.1016e-04
Loss = 2.9171e-01, PNorm = 45.3729, GNorm = 0.4718, lr_0 = 2.0483e-04
Loss = 3.4241e-01, PNorm = 45.3857, GNorm = 0.8225, lr_0 = 1.9963e-04
Validation prc-auc = 0.920723
Validation auc = 0.910302
Epoch 21
Loss = 2.9211e-01, PNorm = 45.4018, GNorm = 0.5495, lr_0 = 1.9456e-04
Loss = 3.4104e-01, PNorm = 45.4116, GNorm = 1.1122, lr_0 = 1.8963e-04
Loss = 3.2278e-01, PNorm = 45.4249, GNorm = 1.2286, lr_0 = 1.8482e-04
Validation prc-auc = 0.919493
Validation auc = 0.910253
Epoch 22
Loss = 2.7180e-01, PNorm = 45.4395, GNorm = 0.4730, lr_0 = 1.7967e-04
Loss = 2.7882e-01, PNorm = 45.4559, GNorm = 0.5814, lr_0 = 1.7511e-04
Loss = 3.5189e-01, PNorm = 45.4707, GNorm = 0.8660, lr_0 = 1.7066e-04
Validation prc-auc = 0.920407
Validation auc = 0.909127
Epoch 23
Loss = 4.1141e-01, PNorm = 45.4833, GNorm = 0.4288, lr_0 = 1.6633e-04
Loss = 2.8757e-01, PNorm = 45.4897, GNorm = 1.1272, lr_0 = 1.6211e-04
Loss = 2.9993e-01, PNorm = 45.5097, GNorm = 0.4337, lr_0 = 1.5800e-04
Loss = 3.1655e-01, PNorm = 45.5217, GNorm = 0.6082, lr_0 = 1.5399e-04
Loss = 1.3883e-01, PNorm = 45.5229, GNorm = 0.5890, lr_0 = 1.5360e-04
Validation prc-auc = 0.922051
Validation auc = 0.911085
Epoch 24
Loss = 2.8627e-01, PNorm = 45.5361, GNorm = 0.4681, lr_0 = 1.4970e-04
Loss = 3.1546e-01, PNorm = 45.5486, GNorm = 0.3907, lr_0 = 1.4590e-04
Loss = 3.0144e-01, PNorm = 45.5580, GNorm = 0.5127, lr_0 = 1.4220e-04
Validation prc-auc = 0.923021
Validation auc = 0.910889
Epoch 25
Loss = 2.3778e-01, PNorm = 45.5751, GNorm = 1.0807, lr_0 = 1.3859e-04
Loss = 2.9392e-01, PNorm = 45.5835, GNorm = 0.8144, lr_0 = 1.3508e-04
Loss = 3.4175e-01, PNorm = 45.5956, GNorm = 0.5768, lr_0 = 1.3165e-04
Validation prc-auc = 0.922806
Validation auc = 0.911477
Epoch 26
Loss = 2.9862e-01, PNorm = 45.6012, GNorm = 0.4415, lr_0 = 1.2831e-04
Loss = 3.0896e-01, PNorm = 45.6144, GNorm = 1.1653, lr_0 = 1.2505e-04
Loss = 2.7677e-01, PNorm = 45.6229, GNorm = 0.4090, lr_0 = 1.2188e-04
Validation prc-auc = 0.922590
Validation auc = 0.911428
Epoch 27
Loss = 1.7707e-01, PNorm = 45.6344, GNorm = 0.5900, lr_0 = 1.1848e-04
Loss = 3.0886e-01, PNorm = 45.6506, GNorm = 0.3988, lr_0 = 1.1548e-04
Loss = 2.9822e-01, PNorm = 45.6594, GNorm = 0.5381, lr_0 = 1.1255e-04
Loss = 3.0441e-01, PNorm = 45.6673, GNorm = 0.5583, lr_0 = 1.0969e-04
Validation prc-auc = 0.923783
Validation auc = 0.911575
Epoch 28
Loss = 2.9169e-01, PNorm = 45.6786, GNorm = 0.7038, lr_0 = 1.0691e-04
Loss = 2.7943e-01, PNorm = 45.6854, GNorm = 0.6342, lr_0 = 1.0420e-04
Loss = 2.9997e-01, PNorm = 45.6931, GNorm = 0.5853, lr_0 = 1.0155e-04
Validation prc-auc = 0.923621
Validation auc = 0.912505
Epoch 29
Loss = 2.9179e-01, PNorm = 45.7028, GNorm = 0.3850, lr_0 = 1.0000e-04
Loss = 2.9787e-01, PNorm = 45.7045, GNorm = 0.5057, lr_0 = 1.0000e-04
Loss = 2.9108e-01, PNorm = 45.7147, GNorm = 0.5471, lr_0 = 1.0000e-04
Validation prc-auc = 0.925146
Validation auc = 0.912554
Model 0 best validation prc-auc = 0.925146 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.891291
Model 0 test auc = 0.860824
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.4188e-01, PNorm = 43.2482, GNorm = 0.7785, lr_0 = 2.5469e-04
Loss = 5.3714e-01, PNorm = 43.2699, GNorm = 0.7396, lr_0 = 3.9531e-04
Loss = 4.7397e-01, PNorm = 43.2993, GNorm = 0.9776, lr_0 = 5.3594e-04
Validation prc-auc = 0.895609
Validation auc = 0.892969
Epoch 1
Loss = 4.2875e-01, PNorm = 43.3451, GNorm = 0.7925, lr_0 = 6.9063e-04
Loss = 4.7449e-01, PNorm = 43.3856, GNorm = 3.2826, lr_0 = 8.3125e-04
Loss = 4.4740e-01, PNorm = 43.4384, GNorm = 1.9667, lr_0 = 9.7187e-04
Validation prc-auc = 0.889192
Validation auc = 0.898844
Epoch 2
Loss = 3.5687e-01, PNorm = 43.4955, GNorm = 0.4315, lr_0 = 9.7965e-04
Loss = 4.2813e-01, PNorm = 43.5437, GNorm = 0.3456, lr_0 = 9.5480e-04
Loss = 3.8537e-01, PNorm = 43.5791, GNorm = 0.9921, lr_0 = 9.3057e-04
Validation prc-auc = 0.896203
Validation auc = 0.897327
Epoch 3
Loss = 3.7649e-01, PNorm = 43.6215, GNorm = 0.4014, lr_0 = 9.0463e-04
Loss = 3.6662e-01, PNorm = 43.6637, GNorm = 1.0025, lr_0 = 8.8168e-04
Loss = 4.2753e-01, PNorm = 43.6962, GNorm = 1.1688, lr_0 = 8.5931e-04
Loss = 3.5554e-01, PNorm = 43.7285, GNorm = 1.3539, lr_0 = 8.3751e-04
Validation prc-auc = 0.899476
Validation auc = 0.903545
Epoch 4
Loss = 3.6813e-01, PNorm = 43.7625, GNorm = 0.3658, lr_0 = 8.1626e-04
Loss = 3.5739e-01, PNorm = 43.8019, GNorm = 0.4157, lr_0 = 7.9555e-04
Loss = 4.0968e-01, PNorm = 43.8374, GNorm = 0.8848, lr_0 = 7.7537e-04
Validation prc-auc = 0.902824
Validation auc = 0.901097
Epoch 5
Loss = 3.6591e-01, PNorm = 43.8658, GNorm = 0.4608, lr_0 = 7.5376e-04
Loss = 3.6003e-01, PNorm = 43.9018, GNorm = 0.6755, lr_0 = 7.3463e-04
Loss = 3.2346e-01, PNorm = 43.9399, GNorm = 0.3336, lr_0 = 7.1600e-04
Validation prc-auc = 0.907203
Validation auc = 0.902859
Epoch 6
Loss = 3.7461e-01, PNorm = 43.9811, GNorm = 0.4493, lr_0 = 6.9783e-04
Loss = 3.9186e-01, PNorm = 44.0085, GNorm = 0.7678, lr_0 = 6.8013e-04
Loss = 3.2427e-01, PNorm = 44.0378, GNorm = 0.7587, lr_0 = 6.6287e-04
Validation prc-auc = 0.907477
Validation auc = 0.903545
Epoch 7
Loss = 4.0827e-01, PNorm = 44.0819, GNorm = 1.3855, lr_0 = 6.4439e-04
Loss = 3.8376e-01, PNorm = 44.1156, GNorm = 0.4902, lr_0 = 6.2805e-04
Loss = 3.1647e-01, PNorm = 44.1461, GNorm = 0.3464, lr_0 = 6.1211e-04
Loss = 3.6194e-01, PNorm = 44.1995, GNorm = 1.1658, lr_0 = 5.9658e-04
Validation prc-auc = 0.906897
Validation auc = 0.903349
Epoch 8
Loss = 3.5313e-01, PNorm = 44.2317, GNorm = 0.6726, lr_0 = 5.8145e-04
Loss = 3.5679e-01, PNorm = 44.2746, GNorm = 0.2876, lr_0 = 5.6669e-04
Loss = 3.6889e-01, PNorm = 44.3147, GNorm = 0.5329, lr_0 = 5.5232e-04
Validation prc-auc = 0.910069
Validation auc = 0.904818
Epoch 9
Loss = 3.2063e-01, PNorm = 44.3627, GNorm = 0.9683, lr_0 = 5.3692e-04
Loss = 3.6309e-01, PNorm = 44.4003, GNorm = 0.5071, lr_0 = 5.2330e-04
Loss = 3.3951e-01, PNorm = 44.4379, GNorm = 0.6537, lr_0 = 5.1002e-04
Validation prc-auc = 0.911207
Validation auc = 0.905797
Epoch 10
Loss = 3.4414e-01, PNorm = 44.4841, GNorm = 1.6524, lr_0 = 4.9708e-04
Loss = 3.4289e-01, PNorm = 44.5086, GNorm = 1.2695, lr_0 = 4.8447e-04
Loss = 3.3943e-01, PNorm = 44.5657, GNorm = 0.3663, lr_0 = 4.7218e-04
Validation prc-auc = 0.911511
Validation auc = 0.906287
Epoch 11
Loss = 4.3540e-01, PNorm = 44.5998, GNorm = 0.3879, lr_0 = 4.5902e-04
Loss = 3.1763e-01, PNorm = 44.6291, GNorm = 0.4537, lr_0 = 4.4737e-04
Loss = 3.1441e-01, PNorm = 44.6799, GNorm = 0.3721, lr_0 = 4.3602e-04
Loss = 3.4672e-01, PNorm = 44.7094, GNorm = 0.8227, lr_0 = 4.2496e-04
Validation prc-auc = 0.910257
Validation auc = 0.905699
Epoch 12
Loss = 3.2449e-01, PNorm = 44.7399, GNorm = 0.4121, lr_0 = 4.1418e-04
Loss = 3.4084e-01, PNorm = 44.7739, GNorm = 1.1198, lr_0 = 4.0367e-04
Loss = 3.3969e-01, PNorm = 44.7937, GNorm = 0.4415, lr_0 = 3.9343e-04
Validation prc-auc = 0.913379
Validation auc = 0.905895
Epoch 13
Loss = 3.4812e-01, PNorm = 44.8284, GNorm = 0.4482, lr_0 = 3.8345e-04
Loss = 3.4077e-01, PNorm = 44.8598, GNorm = 0.5782, lr_0 = 3.7372e-04
Loss = 3.2326e-01, PNorm = 44.8985, GNorm = 0.4628, lr_0 = 3.6424e-04
Validation prc-auc = 0.917000
Validation auc = 0.910497
Epoch 14
Loss = 3.3632e-01, PNorm = 44.9361, GNorm = 0.3558, lr_0 = 3.5408e-04
Loss = 3.3623e-01, PNorm = 44.9604, GNorm = 0.4921, lr_0 = 3.4510e-04
Loss = 3.0201e-01, PNorm = 44.9846, GNorm = 0.9501, lr_0 = 3.3635e-04
Validation prc-auc = 0.914562
Validation auc = 0.908343
Epoch 15
Loss = 2.0257e-01, PNorm = 45.0131, GNorm = 0.5004, lr_0 = 3.2781e-04
Loss = 3.5191e-01, PNorm = 45.0437, GNorm = 0.9742, lr_0 = 3.1950e-04
Loss = 3.4775e-01, PNorm = 45.0687, GNorm = 0.5779, lr_0 = 3.1139e-04
Loss = 3.0251e-01, PNorm = 45.0834, GNorm = 0.4621, lr_0 = 3.0349e-04
Loss = 2.7380e-01, PNorm = 45.0868, GNorm = 0.5142, lr_0 = 3.0271e-04
Validation prc-auc = 0.915330
Validation auc = 0.909518
Epoch 16
Loss = 3.0747e-01, PNorm = 45.1231, GNorm = 0.7883, lr_0 = 2.9503e-04
Loss = 2.7946e-01, PNorm = 45.1526, GNorm = 1.2648, lr_0 = 2.8754e-04
Loss = 3.6511e-01, PNorm = 45.1843, GNorm = 0.8354, lr_0 = 2.8025e-04
Validation prc-auc = 0.914925
Validation auc = 0.909029
Epoch 17
Loss = 3.1429e-01, PNorm = 45.1951, GNorm = 0.4762, lr_0 = 2.7314e-04
Loss = 2.9617e-01, PNorm = 45.2234, GNorm = 0.4658, lr_0 = 2.6621e-04
Loss = 3.3509e-01, PNorm = 45.2456, GNorm = 0.5729, lr_0 = 2.5946e-04
Validation prc-auc = 0.918577
Validation auc = 0.912750
Epoch 18
Loss = 3.1514e-01, PNorm = 45.2642, GNorm = 0.7431, lr_0 = 2.5222e-04
Loss = 3.1014e-01, PNorm = 45.2868, GNorm = 0.4304, lr_0 = 2.4582e-04
Loss = 3.2370e-01, PNorm = 45.3187, GNorm = 0.4757, lr_0 = 2.3959e-04
Validation prc-auc = 0.919619
Validation auc = 0.912554
Epoch 19
Loss = 3.3482e-01, PNorm = 45.3309, GNorm = 0.5545, lr_0 = 2.3351e-04
Loss = 2.7618e-01, PNorm = 45.3601, GNorm = 0.6328, lr_0 = 2.2758e-04
Loss = 3.2244e-01, PNorm = 45.3765, GNorm = 0.9955, lr_0 = 2.2181e-04
Loss = 3.4684e-01, PNorm = 45.3973, GNorm = 0.3577, lr_0 = 2.1618e-04
Loss = 3.6876e-01, PNorm = 45.3982, GNorm = 0.7476, lr_0 = 2.1563e-04
Validation prc-auc = 0.919919
Validation auc = 0.911183
Epoch 20
Loss = 3.2078e-01, PNorm = 45.4129, GNorm = 0.4061, lr_0 = 2.1016e-04
Loss = 3.3588e-01, PNorm = 45.4368, GNorm = 1.1642, lr_0 = 2.0483e-04
Loss = 2.9177e-01, PNorm = 45.4496, GNorm = 0.5488, lr_0 = 1.9963e-04
Validation prc-auc = 0.920361
Validation auc = 0.912456
Epoch 21
Loss = 2.9656e-01, PNorm = 45.4703, GNorm = 0.4141, lr_0 = 1.9456e-04
Loss = 3.0339e-01, PNorm = 45.4964, GNorm = 0.7490, lr_0 = 1.8963e-04
Loss = 3.2649e-01, PNorm = 45.5102, GNorm = 0.4710, lr_0 = 1.8482e-04
Validation prc-auc = 0.922225
Validation auc = 0.912162
Epoch 22
Loss = 3.4084e-01, PNorm = 45.5260, GNorm = 0.4010, lr_0 = 1.7967e-04
Loss = 3.1145e-01, PNorm = 45.5418, GNorm = 0.5817, lr_0 = 1.7511e-04
Loss = 3.1892e-01, PNorm = 45.5568, GNorm = 0.6449, lr_0 = 1.7066e-04
Validation prc-auc = 0.922099
Validation auc = 0.911966
Epoch 23
Loss = 3.0862e-01, PNorm = 45.5755, GNorm = 1.0780, lr_0 = 1.6633e-04
Loss = 2.8362e-01, PNorm = 45.5933, GNorm = 0.3337, lr_0 = 1.6211e-04
Loss = 3.1365e-01, PNorm = 45.6133, GNorm = 0.5270, lr_0 = 1.5800e-04
Loss = 3.2574e-01, PNorm = 45.6190, GNorm = 1.0666, lr_0 = 1.5399e-04
Loss = 1.9020e-01, PNorm = 45.6204, GNorm = 0.7339, lr_0 = 1.5360e-04
Validation prc-auc = 0.922036
Validation auc = 0.912113
Epoch 24
Loss = 2.9675e-01, PNorm = 45.6369, GNorm = 0.6905, lr_0 = 1.4970e-04
Loss = 2.7674e-01, PNorm = 45.6494, GNorm = 0.6658, lr_0 = 1.4590e-04
Loss = 3.1719e-01, PNorm = 45.6657, GNorm = 1.1329, lr_0 = 1.4220e-04
Validation prc-auc = 0.923021
Validation auc = 0.910889
Epoch 25
Loss = 2.8874e-01, PNorm = 45.6732, GNorm = 0.5522, lr_0 = 1.3859e-04
Loss = 3.3177e-01, PNorm = 45.6841, GNorm = 0.6643, lr_0 = 1.3508e-04
Loss = 3.0090e-01, PNorm = 45.6949, GNorm = 0.4209, lr_0 = 1.3165e-04
Validation prc-auc = 0.923299
Validation auc = 0.912946
Epoch 26
Loss = 2.7392e-01, PNorm = 45.7065, GNorm = 0.4640, lr_0 = 1.2831e-04
Loss = 3.0527e-01, PNorm = 45.7245, GNorm = 0.4696, lr_0 = 1.2505e-04
Loss = 3.0429e-01, PNorm = 45.7374, GNorm = 0.4986, lr_0 = 1.2188e-04
Validation prc-auc = 0.924270
Validation auc = 0.912652
Epoch 27
Loss = 2.5603e-01, PNorm = 45.7426, GNorm = 1.1486, lr_0 = 1.1848e-04
Loss = 2.7899e-01, PNorm = 45.7535, GNorm = 0.8296, lr_0 = 1.1548e-04
Loss = 2.9362e-01, PNorm = 45.7621, GNorm = 0.8897, lr_0 = 1.1255e-04
Loss = 3.2796e-01, PNorm = 45.7680, GNorm = 0.4992, lr_0 = 1.0969e-04
Validation prc-auc = 0.924739
Validation auc = 0.912946
Epoch 28
Loss = 2.7130e-01, PNorm = 45.7756, GNorm = 0.3240, lr_0 = 1.0691e-04
Loss = 2.9102e-01, PNorm = 45.7853, GNorm = 0.5264, lr_0 = 1.0420e-04
Loss = 3.0984e-01, PNorm = 45.7929, GNorm = 0.7546, lr_0 = 1.0155e-04
Validation prc-auc = 0.923990
Validation auc = 0.910791
Epoch 29
Loss = 2.4771e-01, PNorm = 45.8052, GNorm = 0.4955, lr_0 = 1.0000e-04
Loss = 3.1409e-01, PNorm = 45.8136, GNorm = 0.7986, lr_0 = 1.0000e-04
Loss = 2.9383e-01, PNorm = 45.8221, GNorm = 1.1561, lr_0 = 1.0000e-04
Validation prc-auc = 0.925108
Validation auc = 0.912162
Model 1 best validation prc-auc = 0.925108 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.901068
Model 1 test auc = 0.871064
Ensemble test prc-auc = 0.896537
Ensemble test auc = 0.866271
Fold 1
Splitting data with seed 1
Total scaffolds = 672 | train scaffolds = 570 | val scaffolds = 52 | test scaffolds = 50
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 96 | target average = 0.062500


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 38 | target average = 0.157895


Scaffold 3
Task 0: count = 31 | target average = 0.774194


Scaffold 4
Task 0: count = 30 | target average = 0.100000


Scaffold 5
Task 0: count = 28 | target average = 0.107143


Scaffold 6
Task 0: count = 27 | target average = 0.111111


Scaffold 7
Task 0: count = 26 | target average = 0.038462


Scaffold 8
Task 0: count = 26 | target average = 0.038462


Scaffold 9
Task 0: count = 25 | target average = 0.200000


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.7285e-01, PNorm = 43.2220, GNorm = 1.5576, lr_0 = 2.5469e-04
Loss = 6.0009e-01, PNorm = 43.2363, GNorm = 2.9746, lr_0 = 3.9531e-04
Loss = 4.9707e-01, PNorm = 43.2645, GNorm = 0.5972, lr_0 = 5.3594e-04
Validation prc-auc = 0.877062
Validation auc = 0.908335
Epoch 1
Loss = 4.3030e-01, PNorm = 43.3066, GNorm = 0.7721, lr_0 = 6.9063e-04
Loss = 4.1677e-01, PNorm = 43.3563, GNorm = 0.6315, lr_0 = 8.3125e-04
Loss = 4.2326e-01, PNorm = 43.4178, GNorm = 0.4851, lr_0 = 9.7187e-04
Validation prc-auc = 0.839428
Validation auc = 0.900846
Epoch 2
Loss = 3.4821e-01, PNorm = 43.4806, GNorm = 0.6211, lr_0 = 9.7965e-04
Loss = 4.0488e-01, PNorm = 43.5472, GNorm = 1.8718, lr_0 = 9.5480e-04
Loss = 4.1144e-01, PNorm = 43.5972, GNorm = 1.0328, lr_0 = 9.3057e-04
Validation prc-auc = 0.808571
Validation auc = 0.896275
Epoch 3
Loss = 3.2455e-01, PNorm = 43.6648, GNorm = 1.1842, lr_0 = 9.0463e-04
Loss = 3.4530e-01, PNorm = 43.7236, GNorm = 2.4306, lr_0 = 8.8168e-04
Loss = 4.1129e-01, PNorm = 43.7843, GNorm = 1.5263, lr_0 = 8.5931e-04
Loss = 4.1723e-01, PNorm = 43.8197, GNorm = 0.6191, lr_0 = 8.3751e-04
Validation prc-auc = 0.820184
Validation auc = 0.899290
Epoch 4
Loss = 4.1560e-01, PNorm = 43.8595, GNorm = 0.3915, lr_0 = 8.1626e-04
Loss = 3.7612e-01, PNorm = 43.9062, GNorm = 0.7112, lr_0 = 7.9555e-04
Loss = 3.3816e-01, PNorm = 43.9587, GNorm = 0.5424, lr_0 = 7.7537e-04
Validation prc-auc = 0.844596
Validation auc = 0.904931
Epoch 5
Loss = 3.2956e-01, PNorm = 44.0194, GNorm = 0.5857, lr_0 = 7.5376e-04
Loss = 3.9268e-01, PNorm = 44.0610, GNorm = 0.3665, lr_0 = 7.3463e-04
Loss = 3.6336e-01, PNorm = 44.1150, GNorm = 0.7475, lr_0 = 7.1600e-04
Validation prc-auc = 0.837162
Validation auc = 0.903180
Epoch 6
Loss = 3.8982e-01, PNorm = 44.1631, GNorm = 0.3778, lr_0 = 6.9783e-04
Loss = 3.5140e-01, PNorm = 44.2089, GNorm = 1.3098, lr_0 = 6.8013e-04
Loss = 3.5025e-01, PNorm = 44.2539, GNorm = 1.4034, lr_0 = 6.6287e-04
Validation prc-auc = 0.828739
Validation auc = 0.900457
Epoch 7
Loss = 3.4811e-01, PNorm = 44.3037, GNorm = 0.4202, lr_0 = 6.4439e-04
Loss = 3.6917e-01, PNorm = 44.3416, GNorm = 0.9381, lr_0 = 6.2805e-04
Loss = 3.3560e-01, PNorm = 44.4059, GNorm = 0.8400, lr_0 = 6.1211e-04
Loss = 3.4090e-01, PNorm = 44.4411, GNorm = 0.5187, lr_0 = 5.9658e-04
Validation prc-auc = 0.829382
Validation auc = 0.900846
Epoch 8
Loss = 3.3886e-01, PNorm = 44.4998, GNorm = 1.3068, lr_0 = 5.8145e-04
Loss = 3.6391e-01, PNorm = 44.5339, GNorm = 0.6121, lr_0 = 5.6669e-04
Loss = 3.1294e-01, PNorm = 44.5695, GNorm = 0.7226, lr_0 = 5.5232e-04
Validation prc-auc = 0.830252
Validation auc = 0.903278
Epoch 9
Loss = 3.4819e-01, PNorm = 44.6128, GNorm = 1.0680, lr_0 = 5.3692e-04
Loss = 2.9436e-01, PNorm = 44.6640, GNorm = 0.4250, lr_0 = 5.2330e-04
Loss = 3.4338e-01, PNorm = 44.7077, GNorm = 0.4623, lr_0 = 5.1002e-04
Validation prc-auc = 0.841180
Validation auc = 0.904056
Epoch 10
Loss = 3.1072e-01, PNorm = 44.7469, GNorm = 0.4239, lr_0 = 4.9708e-04
Loss = 3.2522e-01, PNorm = 44.7901, GNorm = 0.9685, lr_0 = 4.8447e-04
Loss = 3.2263e-01, PNorm = 44.8242, GNorm = 0.4584, lr_0 = 4.7218e-04
Validation prc-auc = 0.846663
Validation auc = 0.906973
Epoch 11
Loss = 3.2223e-01, PNorm = 44.8571, GNorm = 0.4228, lr_0 = 4.5902e-04
Loss = 3.4086e-01, PNorm = 44.9053, GNorm = 0.8983, lr_0 = 4.4737e-04
Loss = 3.2969e-01, PNorm = 44.9536, GNorm = 0.6518, lr_0 = 4.3602e-04
Loss = 3.3808e-01, PNorm = 44.9888, GNorm = 0.9772, lr_0 = 4.2496e-04
Validation prc-auc = 0.858523
Validation auc = 0.909210
Epoch 12
Loss = 3.4194e-01, PNorm = 45.0219, GNorm = 0.5623, lr_0 = 4.1418e-04
Loss = 3.2587e-01, PNorm = 45.0577, GNorm = 0.5172, lr_0 = 4.0367e-04
Loss = 3.0025e-01, PNorm = 45.1056, GNorm = 0.6999, lr_0 = 3.9343e-04
Validation prc-auc = 0.834353
Validation auc = 0.903861
Epoch 13
Loss = 2.9407e-01, PNorm = 45.1409, GNorm = 0.7068, lr_0 = 3.8345e-04
Loss = 3.3771e-01, PNorm = 45.1640, GNorm = 0.6194, lr_0 = 3.7372e-04
Loss = 3.4262e-01, PNorm = 45.1933, GNorm = 0.5314, lr_0 = 3.6424e-04
Validation prc-auc = 0.838252
Validation auc = 0.904542
Epoch 14
Loss = 3.8557e-01, PNorm = 45.2407, GNorm = 1.6159, lr_0 = 3.5408e-04
Loss = 2.7904e-01, PNorm = 45.2756, GNorm = 0.5236, lr_0 = 3.4510e-04
Loss = 3.0648e-01, PNorm = 45.3179, GNorm = 0.6385, lr_0 = 3.3635e-04
Validation prc-auc = 0.847313
Validation auc = 0.906779
Epoch 15
Loss = 2.5685e-01, PNorm = 45.3304, GNorm = 0.5667, lr_0 = 3.2781e-04
Loss = 2.7878e-01, PNorm = 45.3670, GNorm = 0.7115, lr_0 = 3.1950e-04
Loss = 3.1670e-01, PNorm = 45.4031, GNorm = 1.3344, lr_0 = 3.1139e-04
Loss = 3.2796e-01, PNorm = 45.4295, GNorm = 0.7294, lr_0 = 3.0349e-04
Loss = 2.4294e-01, PNorm = 45.4296, GNorm = 1.2434, lr_0 = 3.0271e-04
Validation prc-auc = 0.845666
Validation auc = 0.906293
Epoch 16
Loss = 2.9420e-01, PNorm = 45.4490, GNorm = 0.5112, lr_0 = 2.9503e-04
Loss = 3.2942e-01, PNorm = 45.4702, GNorm = 0.7636, lr_0 = 2.8754e-04
Loss = 3.0362e-01, PNorm = 45.4888, GNorm = 1.0430, lr_0 = 2.8025e-04
Validation prc-auc = 0.857258
Validation auc = 0.909988
Epoch 17
Loss = 3.4348e-01, PNorm = 45.5206, GNorm = 0.4696, lr_0 = 2.7314e-04
Loss = 3.0345e-01, PNorm = 45.5380, GNorm = 0.4724, lr_0 = 2.6621e-04
Loss = 3.1010e-01, PNorm = 45.5684, GNorm = 0.5098, lr_0 = 2.5946e-04
Validation prc-auc = 0.851856
Validation auc = 0.906195
Epoch 18
Loss = 3.4868e-01, PNorm = 45.5965, GNorm = 0.7408, lr_0 = 2.5222e-04
Loss = 3.0605e-01, PNorm = 45.6119, GNorm = 0.7971, lr_0 = 2.4582e-04
Loss = 2.8230e-01, PNorm = 45.6372, GNorm = 0.7870, lr_0 = 2.3959e-04
Validation prc-auc = 0.858764
Validation auc = 0.907849
Epoch 19
Loss = 2.1931e-01, PNorm = 45.6586, GNorm = 0.6275, lr_0 = 2.3351e-04
Loss = 2.6041e-01, PNorm = 45.6824, GNorm = 0.7298, lr_0 = 2.2758e-04
Loss = 3.5854e-01, PNorm = 45.7015, GNorm = 0.9027, lr_0 = 2.2181e-04
Loss = 3.0948e-01, PNorm = 45.7180, GNorm = 0.8259, lr_0 = 2.1618e-04
Loss = 1.3230e-01, PNorm = 45.7201, GNorm = 0.6638, lr_0 = 2.1563e-04
Validation prc-auc = 0.845214
Validation auc = 0.904542
Epoch 20
Loss = 3.0618e-01, PNorm = 45.7405, GNorm = 0.8946, lr_0 = 2.1016e-04
Loss = 3.1001e-01, PNorm = 45.7587, GNorm = 0.9610, lr_0 = 2.0483e-04
Loss = 2.7618e-01, PNorm = 45.7795, GNorm = 0.7344, lr_0 = 1.9963e-04
Validation prc-auc = 0.862709
Validation auc = 0.905709
Epoch 21
Loss = 3.0125e-01, PNorm = 45.7989, GNorm = 0.8447, lr_0 = 1.9456e-04
Loss = 2.8304e-01, PNorm = 45.8175, GNorm = 0.8274, lr_0 = 1.8963e-04
Loss = 2.9368e-01, PNorm = 45.8312, GNorm = 1.0106, lr_0 = 1.8482e-04
Validation prc-auc = 0.854989
Validation auc = 0.906973
Epoch 22
Loss = 2.5325e-01, PNorm = 45.8427, GNorm = 0.6345, lr_0 = 1.7967e-04
Loss = 2.7831e-01, PNorm = 45.8647, GNorm = 1.0826, lr_0 = 1.7511e-04
Loss = 3.1688e-01, PNorm = 45.8714, GNorm = 0.6668, lr_0 = 1.7066e-04
Validation prc-auc = 0.858875
Validation auc = 0.908238
Epoch 23
Loss = 2.6483e-01, PNorm = 45.8973, GNorm = 0.8506, lr_0 = 1.6633e-04
Loss = 3.1785e-01, PNorm = 45.9103, GNorm = 1.1398, lr_0 = 1.6211e-04
Loss = 2.5975e-01, PNorm = 45.9254, GNorm = 0.4026, lr_0 = 1.5800e-04
Loss = 2.8918e-01, PNorm = 45.9451, GNorm = 0.9086, lr_0 = 1.5399e-04
Loss = 3.0177e-01, PNorm = 45.9462, GNorm = 0.8655, lr_0 = 1.5360e-04
Validation prc-auc = 0.859506
Validation auc = 0.907362
Epoch 24
Loss = 2.3756e-01, PNorm = 45.9612, GNorm = 0.6940, lr_0 = 1.4970e-04
Loss = 3.3128e-01, PNorm = 45.9748, GNorm = 0.5517, lr_0 = 1.4590e-04
Loss = 2.8630e-01, PNorm = 45.9795, GNorm = 0.8698, lr_0 = 1.4220e-04
Validation prc-auc = 0.861187
Validation auc = 0.908238
Epoch 25
Loss = 2.4342e-01, PNorm = 45.9904, GNorm = 0.5506, lr_0 = 1.3859e-04
Loss = 2.5580e-01, PNorm = 46.0111, GNorm = 0.7142, lr_0 = 1.3508e-04
Loss = 3.2297e-01, PNorm = 46.0172, GNorm = 1.0764, lr_0 = 1.3165e-04
Validation prc-auc = 0.864922
Validation auc = 0.908335
Epoch 26
Loss = 2.5392e-01, PNorm = 46.0329, GNorm = 0.3657, lr_0 = 1.2831e-04
Loss = 2.8788e-01, PNorm = 46.0434, GNorm = 0.5951, lr_0 = 1.2505e-04
Loss = 2.7393e-01, PNorm = 46.0533, GNorm = 1.4141, lr_0 = 1.2188e-04
Validation prc-auc = 0.872958
Validation auc = 0.909016
Epoch 27
Loss = 3.4760e-01, PNorm = 46.0649, GNorm = 0.5242, lr_0 = 1.1848e-04
Loss = 2.7458e-01, PNorm = 46.0700, GNorm = 1.3465, lr_0 = 1.1548e-04
Loss = 2.6089e-01, PNorm = 46.0853, GNorm = 0.9003, lr_0 = 1.1255e-04
Loss = 2.9199e-01, PNorm = 46.0933, GNorm = 1.1808, lr_0 = 1.0969e-04
Validation prc-auc = 0.870468
Validation auc = 0.908335
Epoch 28
Loss = 3.1521e-01, PNorm = 46.0995, GNorm = 1.1867, lr_0 = 1.0691e-04
Loss = 2.7849e-01, PNorm = 46.1114, GNorm = 0.4610, lr_0 = 1.0420e-04
Loss = 2.4355e-01, PNorm = 46.1204, GNorm = 0.6372, lr_0 = 1.0155e-04
Validation prc-auc = 0.871377
Validation auc = 0.907800
Epoch 29
Loss = 2.6910e-01, PNorm = 46.1328, GNorm = 1.2963, lr_0 = 1.0000e-04
Loss = 3.0656e-01, PNorm = 46.1347, GNorm = 1.3186, lr_0 = 1.0000e-04
Loss = 2.7698e-01, PNorm = 46.1504, GNorm = 0.6676, lr_0 = 1.0000e-04
Validation prc-auc = 0.870094
Validation auc = 0.908238
Model 0 best validation prc-auc = 0.877062 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.851660
Model 0 test auc = 0.855917
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.6166e-01, PNorm = 43.2461, GNorm = 0.8310, lr_0 = 2.5469e-04
Loss = 5.7362e-01, PNorm = 43.2626, GNorm = 1.2085, lr_0 = 3.9531e-04
Loss = 4.9298e-01, PNorm = 43.2949, GNorm = 1.5945, lr_0 = 5.3594e-04
Validation prc-auc = 0.889336
Validation auc = 0.912323
Epoch 1
Loss = 4.0639e-01, PNorm = 43.3444, GNorm = 0.6395, lr_0 = 6.9063e-04
Loss = 4.3911e-01, PNorm = 43.3996, GNorm = 0.5483, lr_0 = 8.3125e-04
Loss = 4.3903e-01, PNorm = 43.4568, GNorm = 2.3952, lr_0 = 9.7187e-04
Validation prc-auc = 0.820108
Validation auc = 0.900068
Epoch 2
Loss = 4.0217e-01, PNorm = 43.5229, GNorm = 1.0162, lr_0 = 9.7965e-04
Loss = 3.8574e-01, PNorm = 43.5955, GNorm = 1.3569, lr_0 = 9.5480e-04
Loss = 3.7436e-01, PNorm = 43.6509, GNorm = 0.4078, lr_0 = 9.3057e-04
Validation prc-auc = 0.863021
Validation auc = 0.907654
Epoch 3
Loss = 3.5529e-01, PNorm = 43.6993, GNorm = 0.3871, lr_0 = 9.0463e-04
Loss = 3.7298e-01, PNorm = 43.7571, GNorm = 0.4972, lr_0 = 8.8168e-04
Loss = 3.6812e-01, PNorm = 43.8017, GNorm = 0.5244, lr_0 = 8.5931e-04
Loss = 3.7502e-01, PNorm = 43.8418, GNorm = 1.0942, lr_0 = 8.3751e-04
Validation prc-auc = 0.865477
Validation auc = 0.906390
Epoch 4
Loss = 3.6900e-01, PNorm = 43.8990, GNorm = 0.5133, lr_0 = 8.1626e-04
Loss = 3.4650e-01, PNorm = 43.9454, GNorm = 0.7225, lr_0 = 7.9555e-04
Loss = 3.9350e-01, PNorm = 43.9751, GNorm = 0.3641, lr_0 = 7.7537e-04
Validation prc-auc = 0.871284
Validation auc = 0.908238
Epoch 5
Loss = 3.3051e-01, PNorm = 44.0212, GNorm = 0.4679, lr_0 = 7.5376e-04
Loss = 3.9058e-01, PNorm = 44.0769, GNorm = 0.5113, lr_0 = 7.3463e-04
Loss = 3.7083e-01, PNorm = 44.1213, GNorm = 0.4978, lr_0 = 7.1600e-04
Validation prc-auc = 0.875194
Validation auc = 0.911058
Epoch 6
Loss = 3.9479e-01, PNorm = 44.1690, GNorm = 0.8613, lr_0 = 6.9783e-04
Loss = 3.7042e-01, PNorm = 44.2146, GNorm = 1.6016, lr_0 = 6.8013e-04
Loss = 3.3075e-01, PNorm = 44.2708, GNorm = 0.9403, lr_0 = 6.6287e-04
Validation prc-auc = 0.869843
Validation auc = 0.910280
Epoch 7
Loss = 3.3384e-01, PNorm = 44.3251, GNorm = 0.6339, lr_0 = 6.4439e-04
Loss = 3.4707e-01, PNorm = 44.3706, GNorm = 0.4896, lr_0 = 6.2805e-04
Loss = 2.8452e-01, PNorm = 44.4238, GNorm = 0.4844, lr_0 = 6.1211e-04
Loss = 3.9848e-01, PNorm = 44.4621, GNorm = 0.7369, lr_0 = 5.9658e-04
Validation prc-auc = 0.853700
Validation auc = 0.908529
Epoch 8
Loss = 3.5319e-01, PNorm = 44.5039, GNorm = 0.4634, lr_0 = 5.8145e-04
Loss = 3.0941e-01, PNorm = 44.5438, GNorm = 0.4465, lr_0 = 5.6669e-04
Loss = 3.3217e-01, PNorm = 44.5985, GNorm = 0.5707, lr_0 = 5.5232e-04
Validation prc-auc = 0.846895
Validation auc = 0.903861
Epoch 9
Loss = 3.2338e-01, PNorm = 44.6474, GNorm = 0.4770, lr_0 = 5.3692e-04
Loss = 3.5321e-01, PNorm = 44.6749, GNorm = 0.5167, lr_0 = 5.2330e-04
Loss = 3.5750e-01, PNorm = 44.7170, GNorm = 0.9364, lr_0 = 5.1002e-04
Validation prc-auc = 0.857451
Validation auc = 0.910183
Epoch 10
Loss = 3.2684e-01, PNorm = 44.7733, GNorm = 0.6100, lr_0 = 4.9708e-04
Loss = 3.6835e-01, PNorm = 44.8221, GNorm = 0.4955, lr_0 = 4.8447e-04
Loss = 2.9552e-01, PNorm = 44.8609, GNorm = 0.9949, lr_0 = 4.7218e-04
Validation prc-auc = 0.856909
Validation auc = 0.909794
Epoch 11
Loss = 4.6140e-01, PNorm = 44.8992, GNorm = 0.7700, lr_0 = 4.5902e-04
Loss = 3.3536e-01, PNorm = 44.9337, GNorm = 0.9377, lr_0 = 4.4737e-04
Loss = 2.9144e-01, PNorm = 44.9758, GNorm = 0.6828, lr_0 = 4.3602e-04
Loss = 3.1643e-01, PNorm = 45.0171, GNorm = 0.9979, lr_0 = 4.2496e-04
Validation prc-auc = 0.858003
Validation auc = 0.911155
Epoch 12
Loss = 2.7885e-01, PNorm = 45.0513, GNorm = 0.5916, lr_0 = 4.1418e-04
Loss = 3.7770e-01, PNorm = 45.0878, GNorm = 1.4996, lr_0 = 4.0367e-04
Loss = 3.3104e-01, PNorm = 45.1193, GNorm = 0.4179, lr_0 = 3.9343e-04
Validation prc-auc = 0.866875
Validation auc = 0.911447
Epoch 13
Loss = 2.8946e-01, PNorm = 45.1623, GNorm = 0.5343, lr_0 = 3.8345e-04
Loss = 3.4903e-01, PNorm = 45.2111, GNorm = 0.7501, lr_0 = 3.7372e-04
Loss = 2.7830e-01, PNorm = 45.2361, GNorm = 0.3573, lr_0 = 3.6424e-04
Validation prc-auc = 0.857462
Validation auc = 0.908918
Epoch 14
Loss = 2.5907e-01, PNorm = 45.2688, GNorm = 0.6983, lr_0 = 3.5408e-04
Loss = 3.3981e-01, PNorm = 45.3050, GNorm = 0.7375, lr_0 = 3.4510e-04
Loss = 3.4516e-01, PNorm = 45.3218, GNorm = 0.7110, lr_0 = 3.3635e-04
Validation prc-auc = 0.867749
Validation auc = 0.913587
Epoch 15
Loss = 4.1161e-01, PNorm = 45.3553, GNorm = 1.0058, lr_0 = 3.2781e-04
Loss = 2.9575e-01, PNorm = 45.3901, GNorm = 0.5836, lr_0 = 3.1950e-04
Loss = 3.0322e-01, PNorm = 45.4288, GNorm = 0.3486, lr_0 = 3.1139e-04
Loss = 3.1921e-01, PNorm = 45.4560, GNorm = 0.5322, lr_0 = 3.0349e-04
Loss = 2.9780e-01, PNorm = 45.4585, GNorm = 0.7155, lr_0 = 3.0271e-04
Validation prc-auc = 0.880345
Validation auc = 0.915240
Epoch 16
Loss = 3.0388e-01, PNorm = 45.4778, GNorm = 0.7734, lr_0 = 2.9503e-04
Loss = 3.3088e-01, PNorm = 45.5045, GNorm = 0.6194, lr_0 = 2.8754e-04
Loss = 3.0743e-01, PNorm = 45.5275, GNorm = 0.5853, lr_0 = 2.8025e-04
Validation prc-auc = 0.866039
Validation auc = 0.914073
Epoch 17
Loss = 3.0173e-01, PNorm = 45.5583, GNorm = 0.6120, lr_0 = 2.7314e-04
Loss = 2.7549e-01, PNorm = 45.5973, GNorm = 0.7398, lr_0 = 2.6621e-04
Loss = 3.4247e-01, PNorm = 45.6108, GNorm = 0.7040, lr_0 = 2.5946e-04
Validation prc-auc = 0.859563
Validation auc = 0.909502
Epoch 18
Loss = 3.0629e-01, PNorm = 45.6385, GNorm = 1.5435, lr_0 = 2.5222e-04
Loss = 3.2284e-01, PNorm = 45.6682, GNorm = 0.3987, lr_0 = 2.4582e-04
Loss = 2.8305e-01, PNorm = 45.6882, GNorm = 0.4647, lr_0 = 2.3959e-04
Validation prc-auc = 0.863880
Validation auc = 0.910961
Epoch 19
Loss = 2.5481e-01, PNorm = 45.7109, GNorm = 0.8263, lr_0 = 2.3351e-04
Loss = 3.2179e-01, PNorm = 45.7296, GNorm = 1.3412, lr_0 = 2.2758e-04
Loss = 2.8564e-01, PNorm = 45.7479, GNorm = 0.8833, lr_0 = 2.2181e-04
Loss = 2.9036e-01, PNorm = 45.7733, GNorm = 0.7489, lr_0 = 2.1618e-04
Loss = 2.1232e-01, PNorm = 45.7749, GNorm = 1.0191, lr_0 = 2.1563e-04
Validation prc-auc = 0.857798
Validation auc = 0.909988
Epoch 20
Loss = 2.9732e-01, PNorm = 45.7847, GNorm = 0.9945, lr_0 = 2.1016e-04
Loss = 3.3522e-01, PNorm = 45.8078, GNorm = 0.4199, lr_0 = 2.0483e-04
Loss = 2.6992e-01, PNorm = 45.8220, GNorm = 0.3974, lr_0 = 1.9963e-04
Validation prc-auc = 0.865614
Validation auc = 0.911739
Epoch 21
Loss = 2.9352e-01, PNorm = 45.8389, GNorm = 0.5892, lr_0 = 1.9456e-04
Loss = 3.1121e-01, PNorm = 45.8643, GNorm = 1.6469, lr_0 = 1.8963e-04
Loss = 2.9506e-01, PNorm = 45.8789, GNorm = 0.3144, lr_0 = 1.8482e-04
Validation prc-auc = 0.855146
Validation auc = 0.911155
Epoch 22
Loss = 2.7061e-01, PNorm = 45.9005, GNorm = 0.8189, lr_0 = 1.7967e-04
Loss = 3.2357e-01, PNorm = 45.9136, GNorm = 0.6737, lr_0 = 1.7511e-04
Loss = 2.7107e-01, PNorm = 45.9323, GNorm = 0.5349, lr_0 = 1.7066e-04
Validation prc-auc = 0.863204
Validation auc = 0.912614
Epoch 23
Loss = 3.5365e-01, PNorm = 45.9492, GNorm = 1.0071, lr_0 = 1.6633e-04
Loss = 2.9291e-01, PNorm = 45.9654, GNorm = 1.2895, lr_0 = 1.6211e-04
Loss = 2.9246e-01, PNorm = 45.9791, GNorm = 0.7845, lr_0 = 1.5800e-04
Loss = 2.8849e-01, PNorm = 45.9870, GNorm = 0.9619, lr_0 = 1.5399e-04
Loss = 2.4627e-01, PNorm = 45.9886, GNorm = 0.5298, lr_0 = 1.5360e-04
Validation prc-auc = 0.865880
Validation auc = 0.911739
Epoch 24
Loss = 3.0436e-01, PNorm = 46.0054, GNorm = 0.5916, lr_0 = 1.4970e-04
Loss = 2.5802e-01, PNorm = 46.0178, GNorm = 0.4328, lr_0 = 1.4590e-04
Loss = 2.9391e-01, PNorm = 46.0295, GNorm = 0.6404, lr_0 = 1.4220e-04
Validation prc-auc = 0.865682
Validation auc = 0.912323
Epoch 25
Loss = 2.7211e-01, PNorm = 46.0445, GNorm = 0.6744, lr_0 = 1.3859e-04
Loss = 2.7462e-01, PNorm = 46.0543, GNorm = 0.3375, lr_0 = 1.3508e-04
Loss = 2.7680e-01, PNorm = 46.0697, GNorm = 0.8854, lr_0 = 1.3165e-04
Validation prc-auc = 0.867063
Validation auc = 0.912031
Epoch 26
Loss = 2.5812e-01, PNorm = 46.0786, GNorm = 0.3685, lr_0 = 1.2831e-04
Loss = 2.4509e-01, PNorm = 46.0922, GNorm = 0.4826, lr_0 = 1.2505e-04
Loss = 3.1887e-01, PNorm = 46.1066, GNorm = 0.6895, lr_0 = 1.2188e-04
Validation prc-auc = 0.868996
Validation auc = 0.913879
Epoch 27
Loss = 2.5473e-01, PNorm = 46.1080, GNorm = 0.4444, lr_0 = 1.1848e-04
Loss = 2.9484e-01, PNorm = 46.1203, GNorm = 0.3905, lr_0 = 1.1548e-04
Loss = 2.9830e-01, PNorm = 46.1287, GNorm = 0.8540, lr_0 = 1.1255e-04
Loss = 2.5557e-01, PNorm = 46.1390, GNorm = 0.7061, lr_0 = 1.0969e-04
Validation prc-auc = 0.867112
Validation auc = 0.912031
Epoch 28
Loss = 2.6331e-01, PNorm = 46.1497, GNorm = 0.9728, lr_0 = 1.0691e-04
Loss = 2.8021e-01, PNorm = 46.1623, GNorm = 0.6200, lr_0 = 1.0420e-04
Loss = 3.0797e-01, PNorm = 46.1682, GNorm = 0.4347, lr_0 = 1.0155e-04
Validation prc-auc = 0.868346
Validation auc = 0.912906
Epoch 29
Loss = 2.5066e-01, PNorm = 46.1800, GNorm = 0.3430, lr_0 = 1.0000e-04
Loss = 2.4735e-01, PNorm = 46.1867, GNorm = 0.5751, lr_0 = 1.0000e-04
Loss = 3.2180e-01, PNorm = 46.1916, GNorm = 0.4465, lr_0 = 1.0000e-04
Validation prc-auc = 0.868153
Validation auc = 0.912809
Model 1 best validation prc-auc = 0.889336 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.840818
Model 1 test auc = 0.839173
Ensemble test prc-auc = 0.844795
Ensemble test auc = 0.843618
Fold 2
Splitting data with seed 2
Total scaffolds = 672 | train scaffolds = 544 | val scaffolds = 69 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 96 | target average = 0.062500


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 38 | target average = 0.157895


Scaffold 3
Task 0: count = 31 | target average = 0.774194


Scaffold 4
Task 0: count = 30 | target average = 0.100000


Scaffold 5
Task 0: count = 28 | target average = 0.107143


Scaffold 6
Task 0: count = 27 | target average = 0.111111


Scaffold 7
Task 0: count = 26 | target average = 0.038462


Scaffold 8
Task 0: count = 26 | target average = 0.038462


Scaffold 9
Task 0: count = 25 | target average = 0.200000


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.8641e-01, PNorm = 43.2213, GNorm = 1.1342, lr_0 = 2.5469e-04
Loss = 5.6467e-01, PNorm = 43.2396, GNorm = 0.5727, lr_0 = 3.9531e-04
Loss = 5.2200e-01, PNorm = 43.2696, GNorm = 0.8220, lr_0 = 5.3594e-04
Validation prc-auc = 0.866780
Validation auc = 0.818177
Epoch 1
Loss = 4.7754e-01, PNorm = 43.3090, GNorm = 1.4875, lr_0 = 6.9063e-04
Loss = 4.2677e-01, PNorm = 43.3576, GNorm = 1.8946, lr_0 = 8.3125e-04
Loss = 3.8696e-01, PNorm = 43.4238, GNorm = 0.6800, lr_0 = 9.7187e-04
Validation prc-auc = 0.843536
Validation auc = 0.822392
Epoch 2
Loss = 3.3807e-01, PNorm = 43.4830, GNorm = 0.5679, lr_0 = 9.7965e-04
Loss = 3.7726e-01, PNorm = 43.5372, GNorm = 0.4279, lr_0 = 9.5480e-04
Loss = 4.3618e-01, PNorm = 43.5839, GNorm = 2.6523, lr_0 = 9.3057e-04
Validation prc-auc = 0.855491
Validation auc = 0.827977
Epoch 3
Loss = 3.4991e-01, PNorm = 43.6363, GNorm = 1.8112, lr_0 = 9.0463e-04
Loss = 3.9820e-01, PNorm = 43.6761, GNorm = 0.3568, lr_0 = 8.8168e-04
Loss = 3.5720e-01, PNorm = 43.7195, GNorm = 0.4649, lr_0 = 8.5931e-04
Loss = 3.9163e-01, PNorm = 43.7572, GNorm = 0.7256, lr_0 = 8.3751e-04
Validation prc-auc = 0.849839
Validation auc = 0.840622
Epoch 4
Loss = 3.8733e-01, PNorm = 43.7998, GNorm = 0.7570, lr_0 = 8.1626e-04
Loss = 3.7550e-01, PNorm = 43.8390, GNorm = 1.2278, lr_0 = 7.9555e-04
Loss = 4.0142e-01, PNorm = 43.8891, GNorm = 0.5673, lr_0 = 7.7537e-04
Validation prc-auc = 0.843741
Validation auc = 0.834932
Epoch 5
Loss = 3.6461e-01, PNorm = 43.9350, GNorm = 1.0252, lr_0 = 7.5376e-04
Loss = 3.6390e-01, PNorm = 43.9770, GNorm = 0.5541, lr_0 = 7.3463e-04
Loss = 3.3802e-01, PNorm = 44.0250, GNorm = 0.9109, lr_0 = 7.1600e-04
Validation prc-auc = 0.847579
Validation auc = 0.837882
Epoch 6
Loss = 3.5505e-01, PNorm = 44.0703, GNorm = 1.0192, lr_0 = 6.9783e-04
Loss = 3.4716e-01, PNorm = 44.1015, GNorm = 0.6692, lr_0 = 6.8013e-04
Loss = 3.8006e-01, PNorm = 44.1358, GNorm = 0.7656, lr_0 = 6.6287e-04
Validation prc-auc = 0.859222
Validation auc = 0.841570
Epoch 7
Loss = 3.2921e-01, PNorm = 44.1854, GNorm = 0.9990, lr_0 = 6.4439e-04
Loss = 3.4085e-01, PNorm = 44.2295, GNorm = 0.9882, lr_0 = 6.2805e-04
Loss = 3.6245e-01, PNorm = 44.2685, GNorm = 1.6488, lr_0 = 6.1211e-04
Loss = 3.4126e-01, PNorm = 44.3179, GNorm = 0.4602, lr_0 = 5.9658e-04
Validation prc-auc = 0.880667
Validation auc = 0.846207
Epoch 8
Loss = 3.4890e-01, PNorm = 44.3584, GNorm = 0.4796, lr_0 = 5.8145e-04
Loss = 3.4213e-01, PNorm = 44.3956, GNorm = 0.5546, lr_0 = 5.6669e-04
Loss = 3.5816e-01, PNorm = 44.4331, GNorm = 1.8899, lr_0 = 5.5232e-04
Validation prc-auc = 0.873605
Validation auc = 0.854531
Epoch 9
Loss = 3.4937e-01, PNorm = 44.4838, GNorm = 0.5873, lr_0 = 5.3692e-04
Loss = 3.2116e-01, PNorm = 44.5344, GNorm = 0.5570, lr_0 = 5.2330e-04
Loss = 3.6684e-01, PNorm = 44.5611, GNorm = 1.2495, lr_0 = 5.1002e-04
Validation prc-auc = 0.879953
Validation auc = 0.859589
Epoch 10
Loss = 3.1924e-01, PNorm = 44.5934, GNorm = 0.3962, lr_0 = 4.9708e-04
Loss = 3.3996e-01, PNorm = 44.6348, GNorm = 0.3810, lr_0 = 4.8447e-04
Loss = 3.3538e-01, PNorm = 44.6656, GNorm = 0.7829, lr_0 = 4.7218e-04
Validation prc-auc = 0.851934
Validation auc = 0.848841
Epoch 11
Loss = 2.8479e-01, PNorm = 44.7066, GNorm = 0.4315, lr_0 = 4.5902e-04
Loss = 3.2798e-01, PNorm = 44.7482, GNorm = 1.1551, lr_0 = 4.4737e-04
Loss = 3.3793e-01, PNorm = 44.7837, GNorm = 0.5442, lr_0 = 4.3602e-04
Loss = 3.6138e-01, PNorm = 44.8250, GNorm = 0.6036, lr_0 = 4.2496e-04
Validation prc-auc = 0.840308
Validation auc = 0.839884
Epoch 12
Loss = 3.3378e-01, PNorm = 44.8576, GNorm = 0.3746, lr_0 = 4.1418e-04
Loss = 3.0014e-01, PNorm = 44.8944, GNorm = 0.6840, lr_0 = 4.0367e-04
Loss = 3.5123e-01, PNorm = 44.9376, GNorm = 1.0941, lr_0 = 3.9343e-04
Validation prc-auc = 0.859217
Validation auc = 0.851897
Epoch 13
Loss = 2.8494e-01, PNorm = 44.9580, GNorm = 0.8464, lr_0 = 3.8345e-04
Loss = 3.5690e-01, PNorm = 44.9982, GNorm = 1.0670, lr_0 = 3.7372e-04
Loss = 3.2125e-01, PNorm = 45.0248, GNorm = 0.3758, lr_0 = 3.6424e-04
Validation prc-auc = 0.869956
Validation auc = 0.857692
Epoch 14
Loss = 3.1144e-01, PNorm = 45.0572, GNorm = 0.4879, lr_0 = 3.5408e-04
Loss = 3.6193e-01, PNorm = 45.0917, GNorm = 1.0429, lr_0 = 3.4510e-04
Loss = 3.2273e-01, PNorm = 45.1135, GNorm = 0.6013, lr_0 = 3.3635e-04
Validation prc-auc = 0.890144
Validation auc = 0.869600
Epoch 15
Loss = 3.0331e-01, PNorm = 45.1408, GNorm = 0.5525, lr_0 = 3.2781e-04
Loss = 3.0198e-01, PNorm = 45.1677, GNorm = 0.4100, lr_0 = 3.1950e-04
Loss = 3.4029e-01, PNorm = 45.2009, GNorm = 0.3828, lr_0 = 3.1139e-04
Loss = 3.2398e-01, PNorm = 45.2182, GNorm = 0.5080, lr_0 = 3.0349e-04
Loss = 2.7104e-01, PNorm = 45.2221, GNorm = 0.6113, lr_0 = 3.0271e-04
Validation prc-auc = 0.887031
Validation auc = 0.864331
Epoch 16
Loss = 3.2087e-01, PNorm = 45.2488, GNorm = 0.8877, lr_0 = 2.9503e-04
Loss = 3.2219e-01, PNorm = 45.2781, GNorm = 0.3155, lr_0 = 2.8754e-04
Loss = 3.0481e-01, PNorm = 45.3112, GNorm = 0.7670, lr_0 = 2.8025e-04
Validation prc-auc = 0.899170
Validation auc = 0.869073
Epoch 17
Loss = 2.5955e-01, PNorm = 45.3345, GNorm = 0.5981, lr_0 = 2.7314e-04
Loss = 3.0854e-01, PNorm = 45.3514, GNorm = 0.4232, lr_0 = 2.6621e-04
Loss = 3.4456e-01, PNorm = 45.3774, GNorm = 0.3060, lr_0 = 2.5946e-04
Validation prc-auc = 0.887239
Validation auc = 0.862118
Epoch 18
Loss = 3.0593e-01, PNorm = 45.3964, GNorm = 0.4221, lr_0 = 2.5222e-04
Loss = 3.1076e-01, PNorm = 45.4235, GNorm = 2.5803, lr_0 = 2.4582e-04
Loss = 3.2165e-01, PNorm = 45.4400, GNorm = 0.8344, lr_0 = 2.3959e-04
Validation prc-auc = 0.884723
Validation auc = 0.862118
Epoch 19
Loss = 2.7195e-01, PNorm = 45.4601, GNorm = 0.4322, lr_0 = 2.3351e-04
Loss = 2.9929e-01, PNorm = 45.4822, GNorm = 0.7019, lr_0 = 2.2758e-04
Loss = 3.5359e-01, PNorm = 45.5040, GNorm = 0.6893, lr_0 = 2.2181e-04
Loss = 2.8854e-01, PNorm = 45.5275, GNorm = 0.3704, lr_0 = 2.1618e-04
Loss = 3.9531e-01, PNorm = 45.5304, GNorm = 0.6171, lr_0 = 2.1563e-04
Validation prc-auc = 0.875538
Validation auc = 0.856533
Epoch 20
Loss = 2.8084e-01, PNorm = 45.5491, GNorm = 0.4067, lr_0 = 2.1016e-04
Loss = 3.0389e-01, PNorm = 45.5646, GNorm = 0.5835, lr_0 = 2.0483e-04
Loss = 3.2007e-01, PNorm = 45.5822, GNorm = 0.4341, lr_0 = 1.9963e-04
Validation prc-auc = 0.892480
Validation auc = 0.863488
Epoch 21
Loss = 3.2403e-01, PNorm = 45.5966, GNorm = 1.4145, lr_0 = 1.9456e-04
Loss = 3.1561e-01, PNorm = 45.6052, GNorm = 0.4279, lr_0 = 1.8963e-04
Loss = 2.8452e-01, PNorm = 45.6286, GNorm = 0.3898, lr_0 = 1.8482e-04
Validation prc-auc = 0.890735
Validation auc = 0.862540
Epoch 22
Loss = 2.6444e-01, PNorm = 45.6493, GNorm = 0.4589, lr_0 = 1.7967e-04
Loss = 3.0291e-01, PNorm = 45.6661, GNorm = 0.4458, lr_0 = 1.7511e-04
Loss = 3.2788e-01, PNorm = 45.6812, GNorm = 0.5150, lr_0 = 1.7066e-04
Validation prc-auc = 0.898117
Validation auc = 0.867387
Epoch 23
Loss = 2.8003e-01, PNorm = 45.6931, GNorm = 0.5285, lr_0 = 1.6633e-04
Loss = 2.5199e-01, PNorm = 45.7148, GNorm = 0.6668, lr_0 = 1.6211e-04
Loss = 3.2221e-01, PNorm = 45.7287, GNorm = 1.3203, lr_0 = 1.5800e-04
Loss = 3.3643e-01, PNorm = 45.7328, GNorm = 0.6348, lr_0 = 1.5399e-04
Loss = 2.3988e-01, PNorm = 45.7351, GNorm = 1.0599, lr_0 = 1.5360e-04
Validation prc-auc = 0.899077
Validation auc = 0.867808
Epoch 24
Loss = 3.0238e-01, PNorm = 45.7584, GNorm = 2.6116, lr_0 = 1.4970e-04
Loss = 3.6348e-01, PNorm = 45.7560, GNorm = 1.4488, lr_0 = 1.4590e-04
Loss = 2.7329e-01, PNorm = 45.7796, GNorm = 0.5206, lr_0 = 1.4220e-04
Validation prc-auc = 0.900891
Validation auc = 0.870548
Epoch 25
Loss = 3.1926e-01, PNorm = 45.7922, GNorm = 0.8796, lr_0 = 1.3859e-04
Loss = 2.9821e-01, PNorm = 45.8008, GNorm = 0.4704, lr_0 = 1.3508e-04
Loss = 3.0814e-01, PNorm = 45.8207, GNorm = 0.7334, lr_0 = 1.3165e-04
Validation prc-auc = 0.899284
Validation auc = 0.868124
Epoch 26
Loss = 2.4929e-01, PNorm = 45.8309, GNorm = 0.4234, lr_0 = 1.2831e-04
Loss = 2.9332e-01, PNorm = 45.8411, GNorm = 0.5876, lr_0 = 1.2505e-04
Loss = 3.0518e-01, PNorm = 45.8475, GNorm = 0.3923, lr_0 = 1.2188e-04
Validation prc-auc = 0.895605
Validation auc = 0.866122
Epoch 27
Loss = 1.7859e-01, PNorm = 45.8581, GNorm = 0.2803, lr_0 = 1.1848e-04
Loss = 2.7483e-01, PNorm = 45.8729, GNorm = 0.4493, lr_0 = 1.1548e-04
Loss = 3.0879e-01, PNorm = 45.8811, GNorm = 1.2069, lr_0 = 1.1255e-04
Loss = 3.1958e-01, PNorm = 45.8905, GNorm = 0.6139, lr_0 = 1.0969e-04
Validation prc-auc = 0.907591
Validation auc = 0.874763
Epoch 28
Loss = 3.0313e-01, PNorm = 45.8950, GNorm = 0.5490, lr_0 = 1.0691e-04
Loss = 2.7331e-01, PNorm = 45.8999, GNorm = 0.8074, lr_0 = 1.0420e-04
Loss = 3.1419e-01, PNorm = 45.9129, GNorm = 0.7138, lr_0 = 1.0155e-04
Validation prc-auc = 0.907347
Validation auc = 0.874131
Epoch 29
Loss = 2.6025e-01, PNorm = 45.9204, GNorm = 0.6294, lr_0 = 1.0000e-04
Loss = 2.9222e-01, PNorm = 45.9314, GNorm = 0.7441, lr_0 = 1.0000e-04
Loss = 2.8563e-01, PNorm = 45.9396, GNorm = 0.6303, lr_0 = 1.0000e-04
Validation prc-auc = 0.905412
Validation auc = 0.871707
Model 0 best validation prc-auc = 0.907591 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.874418
Model 0 test auc = 0.915032
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.7131e-01, PNorm = 43.2463, GNorm = 1.0427, lr_0 = 2.5469e-04
Loss = 5.6938e-01, PNorm = 43.2651, GNorm = 1.2544, lr_0 = 3.9531e-04
Loss = 4.4663e-01, PNorm = 43.2970, GNorm = 0.9002, lr_0 = 5.3594e-04
Validation prc-auc = 0.866110
Validation auc = 0.806902
Epoch 1
Loss = 4.2962e-01, PNorm = 43.3455, GNorm = 3.5610, lr_0 = 6.9063e-04
Loss = 4.6198e-01, PNorm = 43.3918, GNorm = 0.7267, lr_0 = 8.3125e-04
Loss = 4.1057e-01, PNorm = 43.4442, GNorm = 2.5269, lr_0 = 9.7187e-04
Validation prc-auc = 0.849943
Validation auc = 0.839568
Epoch 2
Loss = 4.1086e-01, PNorm = 43.4954, GNorm = 0.4966, lr_0 = 9.7965e-04
Loss = 4.0976e-01, PNorm = 43.5523, GNorm = 1.2007, lr_0 = 9.5480e-04
Loss = 4.0208e-01, PNorm = 43.5987, GNorm = 0.4642, lr_0 = 9.3057e-04
Validation prc-auc = 0.865604
Validation auc = 0.842202
Epoch 3
Loss = 4.3082e-01, PNorm = 43.6551, GNorm = 0.6376, lr_0 = 9.0463e-04
Loss = 3.2645e-01, PNorm = 43.7086, GNorm = 0.9526, lr_0 = 8.8168e-04
Loss = 4.1072e-01, PNorm = 43.7497, GNorm = 0.9296, lr_0 = 8.5931e-04
Loss = 3.6335e-01, PNorm = 43.7808, GNorm = 1.1141, lr_0 = 8.3751e-04
Validation prc-auc = 0.875408
Validation auc = 0.853477
Epoch 4
Loss = 4.0101e-01, PNorm = 43.8200, GNorm = 1.0402, lr_0 = 8.1626e-04
Loss = 3.7121e-01, PNorm = 43.8672, GNorm = 2.0042, lr_0 = 7.9555e-04
Loss = 3.6593e-01, PNorm = 43.9045, GNorm = 1.1504, lr_0 = 7.7537e-04
Validation prc-auc = 0.883245
Validation auc = 0.854636
Epoch 5
Loss = 3.4221e-01, PNorm = 43.9637, GNorm = 0.5542, lr_0 = 7.5376e-04
Loss = 3.8979e-01, PNorm = 44.0149, GNorm = 0.7532, lr_0 = 7.3463e-04
Loss = 3.4442e-01, PNorm = 44.0610, GNorm = 1.0248, lr_0 = 7.1600e-04
Validation prc-auc = 0.855994
Validation auc = 0.841886
Epoch 6
Loss = 3.6673e-01, PNorm = 44.1015, GNorm = 0.5491, lr_0 = 6.9783e-04
Loss = 3.9327e-01, PNorm = 44.1439, GNorm = 0.9744, lr_0 = 6.8013e-04
Loss = 3.4761e-01, PNorm = 44.1899, GNorm = 0.7810, lr_0 = 6.6287e-04
Validation prc-auc = 0.869660
Validation auc = 0.846839
Epoch 7
Loss = 3.9189e-01, PNorm = 44.2450, GNorm = 1.3154, lr_0 = 6.4439e-04
Loss = 3.4645e-01, PNorm = 44.2841, GNorm = 1.4095, lr_0 = 6.2805e-04
Loss = 3.3570e-01, PNorm = 44.3286, GNorm = 0.3751, lr_0 = 6.1211e-04
Loss = 3.6027e-01, PNorm = 44.3733, GNorm = 1.7776, lr_0 = 5.9658e-04
Validation prc-auc = 0.883088
Validation auc = 0.857587
Epoch 8
Loss = 3.2343e-01, PNorm = 44.4261, GNorm = 0.8165, lr_0 = 5.8145e-04
Loss = 3.6300e-01, PNorm = 44.4711, GNorm = 0.4204, lr_0 = 5.6669e-04
Loss = 3.3578e-01, PNorm = 44.5044, GNorm = 0.4101, lr_0 = 5.5232e-04
Validation prc-auc = 0.871646
Validation auc = 0.852950
Epoch 9
Loss = 3.3502e-01, PNorm = 44.5545, GNorm = 1.1132, lr_0 = 5.3692e-04
Loss = 3.6091e-01, PNorm = 44.5796, GNorm = 0.7445, lr_0 = 5.2330e-04
Loss = 3.3745e-01, PNorm = 44.6350, GNorm = 0.8209, lr_0 = 5.1002e-04
Validation prc-auc = 0.865426
Validation auc = 0.846733
Epoch 10
Loss = 3.0713e-01, PNorm = 44.6970, GNorm = 0.5642, lr_0 = 4.9708e-04
Loss = 3.5982e-01, PNorm = 44.7288, GNorm = 0.6759, lr_0 = 4.8447e-04
Loss = 3.4411e-01, PNorm = 44.7690, GNorm = 0.5005, lr_0 = 4.7218e-04
Validation prc-auc = 0.860508
Validation auc = 0.849368
Epoch 11
Loss = 2.9134e-01, PNorm = 44.8159, GNorm = 0.5889, lr_0 = 4.5902e-04
Loss = 3.4021e-01, PNorm = 44.8569, GNorm = 0.8483, lr_0 = 4.4737e-04
Loss = 3.2528e-01, PNorm = 44.8793, GNorm = 1.1637, lr_0 = 4.3602e-04
Loss = 3.3231e-01, PNorm = 44.9142, GNorm = 0.5164, lr_0 = 4.2496e-04
Validation prc-auc = 0.879529
Validation auc = 0.859905
Epoch 12
Loss = 3.3153e-01, PNorm = 44.9451, GNorm = 0.4315, lr_0 = 4.1418e-04
Loss = 3.3117e-01, PNorm = 44.9950, GNorm = 0.8681, lr_0 = 4.0367e-04
Loss = 3.3505e-01, PNorm = 45.0229, GNorm = 0.7264, lr_0 = 3.9343e-04
Validation prc-auc = 0.869167
Validation auc = 0.852424
Epoch 13
Loss = 2.8678e-01, PNorm = 45.0636, GNorm = 1.0044, lr_0 = 3.8345e-04
Loss = 3.4090e-01, PNorm = 45.0918, GNorm = 0.6532, lr_0 = 3.7372e-04
Loss = 3.5831e-01, PNorm = 45.1175, GNorm = 0.8335, lr_0 = 3.6424e-04
Validation prc-auc = 0.873268
Validation auc = 0.857165
Epoch 14
Loss = 3.4090e-01, PNorm = 45.1506, GNorm = 1.0673, lr_0 = 3.5408e-04
Loss = 3.1973e-01, PNorm = 45.1753, GNorm = 0.9814, lr_0 = 3.4510e-04
Loss = 3.0512e-01, PNorm = 45.1976, GNorm = 0.3235, lr_0 = 3.3635e-04
Validation prc-auc = 0.884360
Validation auc = 0.864015
Epoch 15
Loss = 2.5039e-01, PNorm = 45.2387, GNorm = 0.9039, lr_0 = 3.2781e-04
Loss = 3.1274e-01, PNorm = 45.2727, GNorm = 0.4947, lr_0 = 3.1950e-04
Loss = 3.5703e-01, PNorm = 45.2945, GNorm = 0.7716, lr_0 = 3.1139e-04
Loss = 3.1864e-01, PNorm = 45.3090, GNorm = 0.5010, lr_0 = 3.0349e-04
Loss = 3.1214e-01, PNorm = 45.3122, GNorm = 1.2630, lr_0 = 3.0271e-04
Validation prc-auc = 0.895244
Validation auc = 0.869073
Epoch 16
Loss = 3.4460e-01, PNorm = 45.3331, GNorm = 0.5131, lr_0 = 2.9503e-04
Loss = 3.0821e-01, PNorm = 45.3662, GNorm = 0.6639, lr_0 = 2.8754e-04
Loss = 2.9687e-01, PNorm = 45.3949, GNorm = 0.4593, lr_0 = 2.8025e-04
Validation prc-auc = 0.887927
Validation auc = 0.864226
Epoch 17
Loss = 3.3737e-01, PNorm = 45.4173, GNorm = 0.5554, lr_0 = 2.7314e-04
Loss = 2.8551e-01, PNorm = 45.4462, GNorm = 0.4172, lr_0 = 2.6621e-04
Loss = 3.3402e-01, PNorm = 45.4544, GNorm = 0.8183, lr_0 = 2.5946e-04
Validation prc-auc = 0.887114
Validation auc = 0.864963
Epoch 18
Loss = 3.3021e-01, PNorm = 45.4804, GNorm = 0.5088, lr_0 = 2.5222e-04
Loss = 2.9614e-01, PNorm = 45.4987, GNorm = 0.5496, lr_0 = 2.4582e-04
Loss = 2.8864e-01, PNorm = 45.5276, GNorm = 0.5558, lr_0 = 2.3959e-04
Validation prc-auc = 0.888655
Validation auc = 0.863699
Epoch 19
Loss = 2.8110e-01, PNorm = 45.5466, GNorm = 0.8399, lr_0 = 2.3351e-04
Loss = 3.1761e-01, PNorm = 45.5708, GNorm = 1.8651, lr_0 = 2.2758e-04
Loss = 2.9550e-01, PNorm = 45.5882, GNorm = 0.6192, lr_0 = 2.2181e-04
Loss = 3.3500e-01, PNorm = 45.6100, GNorm = 0.7730, lr_0 = 2.1618e-04
Loss = 1.8210e-01, PNorm = 45.6121, GNorm = 0.5114, lr_0 = 2.1563e-04
Validation prc-auc = 0.892479
Validation auc = 0.867071
Epoch 20
Loss = 3.0031e-01, PNorm = 45.6266, GNorm = 0.8538, lr_0 = 2.1016e-04
Loss = 3.2177e-01, PNorm = 45.6492, GNorm = 0.9010, lr_0 = 2.0483e-04
Loss = 2.9000e-01, PNorm = 45.6682, GNorm = 1.1140, lr_0 = 1.9963e-04
Validation prc-auc = 0.889203
Validation auc = 0.862645
Epoch 21
Loss = 3.1500e-01, PNorm = 45.6862, GNorm = 0.7962, lr_0 = 1.9456e-04
Loss = 3.1642e-01, PNorm = 45.7040, GNorm = 0.6694, lr_0 = 1.8963e-04
Loss = 2.8175e-01, PNorm = 45.7144, GNorm = 0.4124, lr_0 = 1.8482e-04
Validation prc-auc = 0.899673
Validation auc = 0.870443
Epoch 22
Loss = 2.7243e-01, PNorm = 45.7427, GNorm = 1.5868, lr_0 = 1.7967e-04
Loss = 3.0882e-01, PNorm = 45.7483, GNorm = 0.6304, lr_0 = 1.7511e-04
Loss = 3.2774e-01, PNorm = 45.7707, GNorm = 0.3525, lr_0 = 1.7066e-04
Validation prc-auc = 0.899248
Validation auc = 0.872023
Epoch 23
Loss = 2.5089e-01, PNorm = 45.7811, GNorm = 0.8732, lr_0 = 1.6633e-04
Loss = 2.9259e-01, PNorm = 45.8027, GNorm = 0.4770, lr_0 = 1.6211e-04
Loss = 3.0420e-01, PNorm = 45.8216, GNorm = 0.6636, lr_0 = 1.5800e-04
Loss = 3.0953e-01, PNorm = 45.8288, GNorm = 0.5179, lr_0 = 1.5399e-04
Loss = 3.2840e-01, PNorm = 45.8310, GNorm = 1.3139, lr_0 = 1.5360e-04
Validation prc-auc = 0.891089
Validation auc = 0.866754
Epoch 24
Loss = 2.9423e-01, PNorm = 45.8450, GNorm = 0.5842, lr_0 = 1.4970e-04
Loss = 3.4163e-01, PNorm = 45.8577, GNorm = 1.5080, lr_0 = 1.4590e-04
Loss = 2.6375e-01, PNorm = 45.8683, GNorm = 0.5555, lr_0 = 1.4220e-04
Validation prc-auc = 0.900125
Validation auc = 0.870443
Epoch 25
Loss = 3.1237e-01, PNorm = 45.8881, GNorm = 0.9583, lr_0 = 1.3859e-04
Loss = 2.9623e-01, PNorm = 45.8968, GNorm = 0.3493, lr_0 = 1.3508e-04
Loss = 2.9426e-01, PNorm = 45.9061, GNorm = 0.4324, lr_0 = 1.3165e-04
Validation prc-auc = 0.898779
Validation auc = 0.869705
Epoch 26
Loss = 3.5416e-01, PNorm = 45.9191, GNorm = 0.4524, lr_0 = 1.2831e-04
Loss = 3.1084e-01, PNorm = 45.9250, GNorm = 0.8850, lr_0 = 1.2505e-04
Loss = 2.7431e-01, PNorm = 45.9372, GNorm = 0.7330, lr_0 = 1.2188e-04
Validation prc-auc = 0.905888
Validation auc = 0.874974
Epoch 27
Loss = 2.2236e-01, PNorm = 45.9489, GNorm = 0.4477, lr_0 = 1.1848e-04
Loss = 3.0740e-01, PNorm = 45.9629, GNorm = 0.7177, lr_0 = 1.1548e-04
Loss = 2.9235e-01, PNorm = 45.9719, GNorm = 0.5273, lr_0 = 1.1255e-04
Loss = 2.7925e-01, PNorm = 45.9780, GNorm = 0.4985, lr_0 = 1.0969e-04
Validation prc-auc = 0.907315
Validation auc = 0.876976
Epoch 28
Loss = 3.1898e-01, PNorm = 45.9863, GNorm = 1.5222, lr_0 = 1.0691e-04
Loss = 2.9425e-01, PNorm = 45.9977, GNorm = 1.5392, lr_0 = 1.0420e-04
Loss = 2.9986e-01, PNorm = 46.0056, GNorm = 0.9698, lr_0 = 1.0155e-04
Validation prc-auc = 0.901878
Validation auc = 0.871812
Epoch 29
Loss = 2.7954e-01, PNorm = 46.0212, GNorm = 1.4886, lr_0 = 1.0000e-04
Loss = 2.8621e-01, PNorm = 46.0273, GNorm = 1.5308, lr_0 = 1.0000e-04
Loss = 3.3459e-01, PNorm = 46.0435, GNorm = 1.1972, lr_0 = 1.0000e-04
Validation prc-auc = 0.902387
Validation auc = 0.872023
Model 1 best validation prc-auc = 0.907315 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.884912
Model 1 test auc = 0.919723
Ensemble test prc-auc = 0.880456
Ensemble test auc = 0.917377
Fold 3
Splitting data with seed 3
Total scaffolds = 672 | train scaffolds = 550 | val scaffolds = 42 | test scaffolds = 80
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 96 | target average = 0.062500


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 38 | target average = 0.157895


Scaffold 3
Task 0: count = 31 | target average = 0.774194


Scaffold 4
Task 0: count = 30 | target average = 0.100000


Scaffold 5
Task 0: count = 28 | target average = 0.107143


Scaffold 6
Task 0: count = 27 | target average = 0.111111


Scaffold 7
Task 0: count = 26 | target average = 0.038462


Scaffold 8
Task 0: count = 26 | target average = 0.038462


Scaffold 9
Task 0: count = 25 | target average = 0.200000


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.6795e-01, PNorm = 43.2225, GNorm = 1.5349, lr_0 = 2.5469e-04
Loss = 5.4788e-01, PNorm = 43.2427, GNorm = 0.8219, lr_0 = 3.9531e-04
Loss = 5.0112e-01, PNorm = 43.2748, GNorm = 0.9137, lr_0 = 5.3594e-04
Validation prc-auc = 0.848081
Validation auc = 0.878395
Epoch 1
Loss = 4.7393e-01, PNorm = 43.3134, GNorm = 1.1969, lr_0 = 6.9063e-04
Loss = 4.3411e-01, PNorm = 43.3479, GNorm = 1.4218, lr_0 = 8.3125e-04
Loss = 4.2753e-01, PNorm = 43.3999, GNorm = 0.9511, lr_0 = 9.7187e-04
Validation prc-auc = 0.859238
Validation auc = 0.883081
Epoch 2
Loss = 4.6235e-01, PNorm = 43.4546, GNorm = 1.4553, lr_0 = 9.7965e-04
Loss = 4.0785e-01, PNorm = 43.5070, GNorm = 0.5051, lr_0 = 9.5480e-04
Loss = 4.1480e-01, PNorm = 43.5531, GNorm = 1.5091, lr_0 = 9.3057e-04
Validation prc-auc = 0.851093
Validation auc = 0.881038
Epoch 3
Loss = 4.2081e-01, PNorm = 43.6071, GNorm = 0.5658, lr_0 = 9.0463e-04
Loss = 3.8126e-01, PNorm = 43.6489, GNorm = 1.5836, lr_0 = 8.8168e-04
Loss = 4.2682e-01, PNorm = 43.6879, GNorm = 1.9457, lr_0 = 8.5931e-04
Loss = 3.6645e-01, PNorm = 43.7335, GNorm = 1.1087, lr_0 = 8.3751e-04
Validation prc-auc = 0.856775
Validation auc = 0.879476
Epoch 4
Loss = 3.6047e-01, PNorm = 43.7813, GNorm = 0.6565, lr_0 = 8.1626e-04
Loss = 4.3611e-01, PNorm = 43.8207, GNorm = 1.7123, lr_0 = 7.9555e-04
Loss = 4.4020e-01, PNorm = 43.8666, GNorm = 1.1179, lr_0 = 7.7537e-04
Validation prc-auc = 0.842152
Validation auc = 0.872026
Epoch 5
Loss = 3.8295e-01, PNorm = 43.9265, GNorm = 0.6845, lr_0 = 7.5376e-04
Loss = 3.7771e-01, PNorm = 43.9726, GNorm = 0.5164, lr_0 = 7.3463e-04
Loss = 3.7148e-01, PNorm = 44.0178, GNorm = 0.8014, lr_0 = 7.1600e-04
Validation prc-auc = 0.848811
Validation auc = 0.879476
Epoch 6
Loss = 2.9859e-01, PNorm = 44.0577, GNorm = 0.4239, lr_0 = 6.9783e-04
Loss = 3.9330e-01, PNorm = 44.1140, GNorm = 0.9032, lr_0 = 6.8013e-04
Loss = 3.8767e-01, PNorm = 44.1558, GNorm = 0.5249, lr_0 = 6.6287e-04
Validation prc-auc = 0.861209
Validation auc = 0.885604
Epoch 7
Loss = 3.4873e-01, PNorm = 44.2000, GNorm = 0.3625, lr_0 = 6.4439e-04
Loss = 3.2264e-01, PNorm = 44.2609, GNorm = 0.9955, lr_0 = 6.2805e-04
Loss = 3.9155e-01, PNorm = 44.3139, GNorm = 0.8783, lr_0 = 6.1211e-04
Loss = 4.2449e-01, PNorm = 44.3304, GNorm = 1.1827, lr_0 = 5.9658e-04
Validation prc-auc = 0.860590
Validation auc = 0.883682
Epoch 8
Loss = 3.7075e-01, PNorm = 44.3666, GNorm = 0.8987, lr_0 = 5.8145e-04
Loss = 3.8899e-01, PNorm = 44.4128, GNorm = 2.4017, lr_0 = 5.6669e-04
Loss = 3.4749e-01, PNorm = 44.4497, GNorm = 0.4822, lr_0 = 5.5232e-04
Validation prc-auc = 0.856649
Validation auc = 0.886806
Epoch 9
Loss = 3.6583e-01, PNorm = 44.4886, GNorm = 0.7162, lr_0 = 5.3692e-04
Loss = 3.3844e-01, PNorm = 44.5263, GNorm = 1.3177, lr_0 = 5.2330e-04
Loss = 3.5469e-01, PNorm = 44.5617, GNorm = 0.4613, lr_0 = 5.1002e-04
Validation prc-auc = 0.864652
Validation auc = 0.889690
Epoch 10
Loss = 2.9352e-01, PNorm = 44.5991, GNorm = 0.4369, lr_0 = 4.9708e-04
Loss = 3.4122e-01, PNorm = 44.6424, GNorm = 0.5320, lr_0 = 4.8447e-04
Loss = 3.9525e-01, PNorm = 44.6813, GNorm = 0.7540, lr_0 = 4.7218e-04
Validation prc-auc = 0.857409
Validation auc = 0.888729
Epoch 11
Loss = 3.0845e-01, PNorm = 44.7138, GNorm = 1.2798, lr_0 = 4.5902e-04
Loss = 3.2990e-01, PNorm = 44.7566, GNorm = 1.3798, lr_0 = 4.4737e-04
Loss = 3.9765e-01, PNorm = 44.7858, GNorm = 0.6671, lr_0 = 4.3602e-04
Loss = 3.4650e-01, PNorm = 44.8070, GNorm = 0.4885, lr_0 = 4.2496e-04
Validation prc-auc = 0.868370
Validation auc = 0.894617
Epoch 12
Loss = 3.9082e-01, PNorm = 44.8310, GNorm = 0.5265, lr_0 = 4.1418e-04
Loss = 3.5797e-01, PNorm = 44.8656, GNorm = 1.0939, lr_0 = 4.0367e-04
Loss = 3.3423e-01, PNorm = 44.9168, GNorm = 1.4805, lr_0 = 3.9343e-04
Validation prc-auc = 0.861239
Validation auc = 0.892213
Epoch 13
Loss = 3.4583e-01, PNorm = 44.9533, GNorm = 1.3015, lr_0 = 3.8345e-04
Loss = 3.3249e-01, PNorm = 44.9934, GNorm = 0.6911, lr_0 = 3.7372e-04
Loss = 3.2652e-01, PNorm = 45.0245, GNorm = 0.5126, lr_0 = 3.6424e-04
Validation prc-auc = 0.858921
Validation auc = 0.889329
Epoch 14
Loss = 3.8035e-01, PNorm = 45.0517, GNorm = 0.4764, lr_0 = 3.5408e-04
Loss = 3.2865e-01, PNorm = 45.0809, GNorm = 0.7177, lr_0 = 3.4510e-04
Loss = 3.3360e-01, PNorm = 45.1089, GNorm = 0.9694, lr_0 = 3.3635e-04
Validation prc-auc = 0.871615
Validation auc = 0.896059
Epoch 15
Loss = 3.0826e-01, PNorm = 45.1330, GNorm = 0.7103, lr_0 = 3.2781e-04
Loss = 3.4820e-01, PNorm = 45.1550, GNorm = 1.0957, lr_0 = 3.1950e-04
Loss = 3.5161e-01, PNorm = 45.1810, GNorm = 1.2365, lr_0 = 3.1139e-04
Loss = 3.3858e-01, PNorm = 45.2175, GNorm = 0.5336, lr_0 = 3.0349e-04
Loss = 3.7018e-01, PNorm = 45.2212, GNorm = 1.0151, lr_0 = 3.0271e-04
Validation prc-auc = 0.867352
Validation auc = 0.897140
Epoch 16
Loss = 3.2439e-01, PNorm = 45.2388, GNorm = 0.3599, lr_0 = 2.9503e-04
Loss = 3.4625e-01, PNorm = 45.2640, GNorm = 0.4743, lr_0 = 2.8754e-04
Loss = 3.2690e-01, PNorm = 45.2880, GNorm = 0.4005, lr_0 = 2.8025e-04
Validation prc-auc = 0.862939
Validation auc = 0.895458
Epoch 17
Loss = 3.0873e-01, PNorm = 45.3207, GNorm = 0.9705, lr_0 = 2.7314e-04
Loss = 3.4800e-01, PNorm = 45.3405, GNorm = 0.4293, lr_0 = 2.6621e-04
Loss = 3.2586e-01, PNorm = 45.3566, GNorm = 0.9050, lr_0 = 2.5946e-04
Validation prc-auc = 0.876376
Validation auc = 0.900985
Epoch 18
Loss = 2.5948e-01, PNorm = 45.3832, GNorm = 0.3898, lr_0 = 2.5222e-04
Loss = 3.7481e-01, PNorm = 45.4017, GNorm = 1.2798, lr_0 = 2.4582e-04
Loss = 3.4424e-01, PNorm = 45.4301, GNorm = 1.0509, lr_0 = 2.3959e-04
Validation prc-auc = 0.873112
Validation auc = 0.898222
Epoch 19
Loss = 2.6564e-01, PNorm = 45.4489, GNorm = 0.4573, lr_0 = 2.3351e-04
Loss = 3.0350e-01, PNorm = 45.4788, GNorm = 0.4694, lr_0 = 2.2758e-04
Loss = 3.4182e-01, PNorm = 45.4995, GNorm = 0.6347, lr_0 = 2.2181e-04
Loss = 3.1127e-01, PNorm = 45.5161, GNorm = 0.5461, lr_0 = 2.1618e-04
Loss = 3.5687e-01, PNorm = 45.5173, GNorm = 0.9095, lr_0 = 2.1563e-04
Validation prc-auc = 0.863768
Validation auc = 0.897140
Epoch 20
Loss = 3.3502e-01, PNorm = 45.5272, GNorm = 0.5023, lr_0 = 2.1016e-04
Loss = 3.2557e-01, PNorm = 45.5453, GNorm = 0.5606, lr_0 = 2.0483e-04
Loss = 3.2666e-01, PNorm = 45.5588, GNorm = 0.8062, lr_0 = 1.9963e-04
Validation prc-auc = 0.877020
Validation auc = 0.899303
Epoch 21
Loss = 3.3509e-01, PNorm = 45.5775, GNorm = 0.3522, lr_0 = 1.9456e-04
Loss = 3.0338e-01, PNorm = 45.5986, GNorm = 1.4387, lr_0 = 1.8963e-04
Loss = 3.3814e-01, PNorm = 45.6107, GNorm = 0.3736, lr_0 = 1.8482e-04
Validation prc-auc = 0.874764
Validation auc = 0.899904
Epoch 22
Loss = 3.2898e-01, PNorm = 45.6297, GNorm = 1.6466, lr_0 = 1.7967e-04
Loss = 3.1725e-01, PNorm = 45.6439, GNorm = 1.0432, lr_0 = 1.7511e-04
Loss = 3.0930e-01, PNorm = 45.6597, GNorm = 0.4309, lr_0 = 1.7066e-04
Validation prc-auc = 0.871836
Validation auc = 0.900024
Epoch 23
Loss = 3.1131e-01, PNorm = 45.6721, GNorm = 0.5537, lr_0 = 1.6633e-04
Loss = 3.2512e-01, PNorm = 45.6859, GNorm = 0.5448, lr_0 = 1.6211e-04
Loss = 2.8825e-01, PNorm = 45.7036, GNorm = 0.9502, lr_0 = 1.5800e-04
Loss = 3.2847e-01, PNorm = 45.7115, GNorm = 0.3982, lr_0 = 1.5399e-04
Loss = 1.7853e-01, PNorm = 45.7128, GNorm = 0.8641, lr_0 = 1.5360e-04
Validation prc-auc = 0.880831
Validation auc = 0.903509
Epoch 24
Loss = 3.1242e-01, PNorm = 45.7266, GNorm = 0.4436, lr_0 = 1.4970e-04
Loss = 3.2221e-01, PNorm = 45.7404, GNorm = 0.5826, lr_0 = 1.4590e-04
Loss = 3.0327e-01, PNorm = 45.7552, GNorm = 1.3925, lr_0 = 1.4220e-04
Validation prc-auc = 0.867224
Validation auc = 0.899063
Epoch 25
Loss = 3.4822e-01, PNorm = 45.7628, GNorm = 0.6720, lr_0 = 1.3859e-04
Loss = 3.3411e-01, PNorm = 45.7799, GNorm = 0.5404, lr_0 = 1.3508e-04
Loss = 2.6354e-01, PNorm = 45.7919, GNorm = 0.9972, lr_0 = 1.3165e-04
Validation prc-auc = 0.868114
Validation auc = 0.899664
Epoch 26
Loss = 3.3525e-01, PNorm = 45.8001, GNorm = 0.6638, lr_0 = 1.2831e-04
Loss = 3.0626e-01, PNorm = 45.8138, GNorm = 0.4756, lr_0 = 1.2505e-04
Loss = 2.9218e-01, PNorm = 45.8273, GNorm = 0.5805, lr_0 = 1.2188e-04
Validation prc-auc = 0.869941
Validation auc = 0.901346
Epoch 27
Loss = 4.5754e-01, PNorm = 45.8327, GNorm = 0.8922, lr_0 = 1.1848e-04
Loss = 3.3633e-01, PNorm = 45.8448, GNorm = 1.8709, lr_0 = 1.1548e-04
Loss = 2.8321e-01, PNorm = 45.8497, GNorm = 0.4982, lr_0 = 1.1255e-04
Loss = 3.0394e-01, PNorm = 45.8655, GNorm = 0.8672, lr_0 = 1.0969e-04
Validation prc-auc = 0.876854
Validation auc = 0.902908
Epoch 28
Loss = 3.0938e-01, PNorm = 45.8722, GNorm = 0.5581, lr_0 = 1.0691e-04
Loss = 2.8947e-01, PNorm = 45.8889, GNorm = 0.3940, lr_0 = 1.0420e-04
Loss = 3.4107e-01, PNorm = 45.8984, GNorm = 0.5350, lr_0 = 1.0155e-04
Validation prc-auc = 0.874165
Validation auc = 0.902668
Epoch 29
Loss = 2.8822e-01, PNorm = 45.9016, GNorm = 1.5873, lr_0 = 1.0000e-04
Loss = 3.0813e-01, PNorm = 45.9129, GNorm = 0.6393, lr_0 = 1.0000e-04
Loss = 2.7478e-01, PNorm = 45.9264, GNorm = 0.5641, lr_0 = 1.0000e-04
Validation prc-auc = 0.868468
Validation auc = 0.901706
Model 0 best validation prc-auc = 0.880831 on epoch 23
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.963283
Model 0 test auc = 0.950169
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.7514e-01, PNorm = 43.2449, GNorm = 0.8113, lr_0 = 2.5469e-04
Loss = 5.6753e-01, PNorm = 43.2653, GNorm = 0.6206, lr_0 = 3.9531e-04
Loss = 4.8371e-01, PNorm = 43.2978, GNorm = 0.5967, lr_0 = 5.3594e-04
Validation prc-auc = 0.840788
Validation auc = 0.874549
Epoch 1
Loss = 4.9236e-01, PNorm = 43.3373, GNorm = 1.6215, lr_0 = 6.9063e-04
Loss = 4.3068e-01, PNorm = 43.3820, GNorm = 2.1818, lr_0 = 8.3125e-04
Loss = 4.4337e-01, PNorm = 43.4398, GNorm = 0.8332, lr_0 = 9.7187e-04
Validation prc-auc = 0.843188
Validation auc = 0.875391
Epoch 2
Loss = 4.2725e-01, PNorm = 43.4988, GNorm = 1.0818, lr_0 = 9.7965e-04
Loss = 4.1824e-01, PNorm = 43.5610, GNorm = 1.0387, lr_0 = 9.5480e-04
Loss = 4.2795e-01, PNorm = 43.6105, GNorm = 1.4749, lr_0 = 9.3057e-04
Validation prc-auc = 0.858844
Validation auc = 0.882600
Epoch 3
Loss = 4.4885e-01, PNorm = 43.6442, GNorm = 0.4380, lr_0 = 9.0463e-04
Loss = 4.2073e-01, PNorm = 43.6771, GNorm = 0.7758, lr_0 = 8.8168e-04
Loss = 3.5971e-01, PNorm = 43.7286, GNorm = 1.5215, lr_0 = 8.5931e-04
Loss = 3.9222e-01, PNorm = 43.7595, GNorm = 1.5635, lr_0 = 8.3751e-04
Validation prc-auc = 0.847336
Validation auc = 0.877433
Epoch 4
Loss = 3.9148e-01, PNorm = 43.7879, GNorm = 0.4185, lr_0 = 8.1626e-04
Loss = 3.7347e-01, PNorm = 43.8116, GNorm = 0.5058, lr_0 = 7.9555e-04
Loss = 3.8045e-01, PNorm = 43.8489, GNorm = 0.7551, lr_0 = 7.7537e-04
Validation prc-auc = 0.848747
Validation auc = 0.877313
Epoch 5
Loss = 4.0419e-01, PNorm = 43.8950, GNorm = 0.5915, lr_0 = 7.5376e-04
Loss = 3.8044e-01, PNorm = 43.9319, GNorm = 0.6989, lr_0 = 7.3463e-04
Loss = 3.8786e-01, PNorm = 43.9692, GNorm = 0.4277, lr_0 = 7.1600e-04
Validation prc-auc = 0.848836
Validation auc = 0.878995
Epoch 6
Loss = 3.6270e-01, PNorm = 44.0123, GNorm = 0.9139, lr_0 = 6.9783e-04
Loss = 3.9170e-01, PNorm = 44.0426, GNorm = 0.4494, lr_0 = 6.8013e-04
Loss = 3.7882e-01, PNorm = 44.0776, GNorm = 1.1702, lr_0 = 6.6287e-04
Validation prc-auc = 0.862309
Validation auc = 0.889810
Epoch 7
Loss = 3.2521e-01, PNorm = 44.1187, GNorm = 0.7505, lr_0 = 6.4439e-04
Loss = 3.6254e-01, PNorm = 44.1534, GNorm = 0.3468, lr_0 = 6.2805e-04
Loss = 3.7209e-01, PNorm = 44.1888, GNorm = 0.4640, lr_0 = 6.1211e-04
Loss = 3.4940e-01, PNorm = 44.2286, GNorm = 0.5904, lr_0 = 5.9658e-04
Validation prc-auc = 0.868864
Validation auc = 0.896780
Epoch 8
Loss = 3.4598e-01, PNorm = 44.2787, GNorm = 0.5657, lr_0 = 5.8145e-04
Loss = 3.6806e-01, PNorm = 44.3168, GNorm = 0.6726, lr_0 = 5.6669e-04
Loss = 3.7678e-01, PNorm = 44.3636, GNorm = 1.1796, lr_0 = 5.5232e-04
Validation prc-auc = 0.857355
Validation auc = 0.889209
Epoch 9
Loss = 3.7650e-01, PNorm = 44.3916, GNorm = 0.7071, lr_0 = 5.3692e-04
Loss = 3.3757e-01, PNorm = 44.4310, GNorm = 0.9700, lr_0 = 5.2330e-04
Loss = 3.9727e-01, PNorm = 44.4711, GNorm = 0.6401, lr_0 = 5.1002e-04
Validation prc-auc = 0.866517
Validation auc = 0.888248
Epoch 10
Loss = 4.2297e-01, PNorm = 44.5057, GNorm = 0.4990, lr_0 = 4.9708e-04
Loss = 3.2568e-01, PNorm = 44.5414, GNorm = 0.5537, lr_0 = 4.8447e-04
Loss = 3.7216e-01, PNorm = 44.5927, GNorm = 0.4280, lr_0 = 4.7218e-04
Validation prc-auc = 0.861687
Validation auc = 0.892093
Epoch 11
Loss = 3.4115e-01, PNorm = 44.6272, GNorm = 0.4316, lr_0 = 4.5902e-04
Loss = 3.2128e-01, PNorm = 44.6711, GNorm = 0.8131, lr_0 = 4.4737e-04
Loss = 3.5930e-01, PNorm = 44.7004, GNorm = 0.5162, lr_0 = 4.3602e-04
Loss = 3.3522e-01, PNorm = 44.7287, GNorm = 0.7402, lr_0 = 4.2496e-04
Validation prc-auc = 0.871892
Validation auc = 0.898943
Epoch 12
Loss = 3.7952e-01, PNorm = 44.7640, GNorm = 1.8286, lr_0 = 4.1418e-04
Loss = 3.3750e-01, PNorm = 44.8119, GNorm = 0.4300, lr_0 = 4.0367e-04
Loss = 3.5459e-01, PNorm = 44.8346, GNorm = 0.7650, lr_0 = 3.9343e-04
Validation prc-auc = 0.856811
Validation auc = 0.888609
Epoch 13
Loss = 3.4084e-01, PNorm = 44.8800, GNorm = 0.5516, lr_0 = 3.8345e-04
Loss = 3.6275e-01, PNorm = 44.9108, GNorm = 0.5899, lr_0 = 3.7372e-04
Loss = 3.4381e-01, PNorm = 44.9370, GNorm = 1.2749, lr_0 = 3.6424e-04
Validation prc-auc = 0.872683
Validation auc = 0.900385
Epoch 14
Loss = 3.1146e-01, PNorm = 44.9763, GNorm = 0.9154, lr_0 = 3.5408e-04
Loss = 3.8262e-01, PNorm = 45.0065, GNorm = 0.4733, lr_0 = 3.4510e-04
Loss = 3.3809e-01, PNorm = 45.0327, GNorm = 1.2648, lr_0 = 3.3635e-04
Validation prc-auc = 0.872392
Validation auc = 0.900024
Epoch 15
Loss = 4.4482e-01, PNorm = 45.0836, GNorm = 1.4731, lr_0 = 3.2781e-04
Loss = 3.5490e-01, PNorm = 45.0951, GNorm = 0.7242, lr_0 = 3.1950e-04
Loss = 3.7478e-01, PNorm = 45.1277, GNorm = 0.7752, lr_0 = 3.1139e-04
Loss = 3.0365e-01, PNorm = 45.1575, GNorm = 0.3524, lr_0 = 3.0349e-04
Loss = 2.5791e-01, PNorm = 45.1620, GNorm = 0.4160, lr_0 = 3.0271e-04
Validation prc-auc = 0.869063
Validation auc = 0.899063
Epoch 16
Loss = 3.4026e-01, PNorm = 45.1940, GNorm = 0.7989, lr_0 = 2.9503e-04
Loss = 3.1910e-01, PNorm = 45.2219, GNorm = 0.4844, lr_0 = 2.8754e-04
Loss = 3.2634e-01, PNorm = 45.2487, GNorm = 0.4625, lr_0 = 2.8025e-04
Validation prc-auc = 0.875924
Validation auc = 0.901947
Epoch 17
Loss = 3.2463e-01, PNorm = 45.2686, GNorm = 0.5009, lr_0 = 2.7314e-04
Loss = 3.4346e-01, PNorm = 45.2903, GNorm = 0.9151, lr_0 = 2.6621e-04
Loss = 3.4786e-01, PNorm = 45.3204, GNorm = 0.4974, lr_0 = 2.5946e-04
Validation prc-auc = 0.874066
Validation auc = 0.897020
Epoch 18
Loss = 2.7629e-01, PNorm = 45.3489, GNorm = 0.4500, lr_0 = 2.5222e-04
Loss = 3.2762e-01, PNorm = 45.3772, GNorm = 0.8096, lr_0 = 2.4582e-04
Loss = 3.1034e-01, PNorm = 45.4037, GNorm = 1.0643, lr_0 = 2.3959e-04
Validation prc-auc = 0.873441
Validation auc = 0.903148
Epoch 19
Loss = 3.9488e-01, PNorm = 45.4163, GNorm = 0.4426, lr_0 = 2.3351e-04
Loss = 3.4352e-01, PNorm = 45.4352, GNorm = 0.6599, lr_0 = 2.2758e-04
Loss = 3.2722e-01, PNorm = 45.4451, GNorm = 0.6750, lr_0 = 2.2181e-04
Loss = 2.8574e-01, PNorm = 45.4710, GNorm = 0.7451, lr_0 = 2.1618e-04
Loss = 4.8373e-01, PNorm = 45.4721, GNorm = 2.3755, lr_0 = 2.1563e-04
Validation prc-auc = 0.866974
Validation auc = 0.900264
Epoch 20
Loss = 2.8375e-01, PNorm = 45.4894, GNorm = 0.4395, lr_0 = 2.1016e-04
Loss = 3.6045e-01, PNorm = 45.5120, GNorm = 0.6693, lr_0 = 2.0483e-04
Loss = 3.4256e-01, PNorm = 45.5259, GNorm = 0.3691, lr_0 = 1.9963e-04
Validation prc-auc = 0.875876
Validation auc = 0.905071
Epoch 21
Loss = 3.7033e-01, PNorm = 45.5422, GNorm = 0.4020, lr_0 = 1.9456e-04
Loss = 3.2309e-01, PNorm = 45.5615, GNorm = 0.8519, lr_0 = 1.8963e-04
Loss = 2.7770e-01, PNorm = 45.5801, GNorm = 0.3719, lr_0 = 1.8482e-04
Validation prc-auc = 0.875862
Validation auc = 0.903989
Epoch 22
Loss = 3.0083e-01, PNorm = 45.6018, GNorm = 0.4968, lr_0 = 1.7967e-04
Loss = 3.1992e-01, PNorm = 45.6110, GNorm = 0.4194, lr_0 = 1.7511e-04
Loss = 3.2214e-01, PNorm = 45.6238, GNorm = 0.6539, lr_0 = 1.7066e-04
Validation prc-auc = 0.880928
Validation auc = 0.906994
Epoch 23
Loss = 3.1766e-01, PNorm = 45.6413, GNorm = 0.4430, lr_0 = 1.6633e-04
Loss = 3.3814e-01, PNorm = 45.6579, GNorm = 0.5181, lr_0 = 1.6211e-04
Loss = 2.8978e-01, PNorm = 45.6704, GNorm = 0.4008, lr_0 = 1.5800e-04
Loss = 3.0906e-01, PNorm = 45.6862, GNorm = 0.5780, lr_0 = 1.5399e-04
Loss = 3.0063e-01, PNorm = 45.6876, GNorm = 0.6995, lr_0 = 1.5360e-04
Validation prc-auc = 0.878477
Validation auc = 0.906032
Epoch 24
Loss = 3.2571e-01, PNorm = 45.7029, GNorm = 0.6180, lr_0 = 1.4970e-04
Loss = 3.1180e-01, PNorm = 45.7129, GNorm = 0.5177, lr_0 = 1.4590e-04
Loss = 3.2162e-01, PNorm = 45.7243, GNorm = 0.7879, lr_0 = 1.4220e-04
Validation prc-auc = 0.875807
Validation auc = 0.906273
Epoch 25
Loss = 3.6660e-01, PNorm = 45.7402, GNorm = 0.7484, lr_0 = 1.3859e-04
Loss = 2.6752e-01, PNorm = 45.7522, GNorm = 0.4700, lr_0 = 1.3508e-04
Loss = 3.2167e-01, PNorm = 45.7729, GNorm = 0.3937, lr_0 = 1.3165e-04
Validation prc-auc = 0.881424
Validation auc = 0.908435
Epoch 26
Loss = 2.8087e-01, PNorm = 45.7745, GNorm = 0.7215, lr_0 = 1.2831e-04
Loss = 3.3722e-01, PNorm = 45.7894, GNorm = 0.7692, lr_0 = 1.2505e-04
Loss = 3.1648e-01, PNorm = 45.8034, GNorm = 0.7816, lr_0 = 1.2188e-04
Validation prc-auc = 0.877317
Validation auc = 0.906513
Epoch 27
Loss = 3.5375e-01, PNorm = 45.8059, GNorm = 1.1147, lr_0 = 1.1848e-04
Loss = 3.0505e-01, PNorm = 45.8231, GNorm = 0.3767, lr_0 = 1.1548e-04
Loss = 2.9864e-01, PNorm = 45.8335, GNorm = 0.4690, lr_0 = 1.1255e-04
Loss = 3.1535e-01, PNorm = 45.8449, GNorm = 0.8316, lr_0 = 1.0969e-04
Validation prc-auc = 0.881612
Validation auc = 0.910118
Epoch 28
Loss = 2.8481e-01, PNorm = 45.8524, GNorm = 0.4222, lr_0 = 1.0691e-04
Loss = 3.2738e-01, PNorm = 45.8649, GNorm = 1.0615, lr_0 = 1.0420e-04
Loss = 3.1031e-01, PNorm = 45.8699, GNorm = 0.4366, lr_0 = 1.0155e-04
Validation prc-auc = 0.883557
Validation auc = 0.910118
Epoch 29
Loss = 3.2527e-01, PNorm = 45.8768, GNorm = 0.6185, lr_0 = 1.0000e-04
Loss = 3.0788e-01, PNorm = 45.8852, GNorm = 0.4891, lr_0 = 1.0000e-04
Loss = 2.9190e-01, PNorm = 45.8979, GNorm = 0.8998, lr_0 = 1.0000e-04
Validation prc-auc = 0.882907
Validation auc = 0.909757
Model 1 best validation prc-auc = 0.883557 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.966373
Model 1 test auc = 0.949686
Ensemble test prc-auc = 0.965786
Ensemble test auc = 0.951328
Fold 4
Splitting data with seed 4
Total scaffolds = 672 | train scaffolds = 552 | val scaffolds = 26 | test scaffolds = 94
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 96 | target average = 0.062500


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 38 | target average = 0.157895


Scaffold 3
Task 0: count = 31 | target average = 0.774194


Scaffold 4
Task 0: count = 30 | target average = 0.100000


Scaffold 5
Task 0: count = 28 | target average = 0.107143


Scaffold 6
Task 0: count = 27 | target average = 0.111111


Scaffold 7
Task 0: count = 26 | target average = 0.038462


Scaffold 8
Task 0: count = 26 | target average = 0.038462


Scaffold 9
Task 0: count = 25 | target average = 0.200000


Class sizes
hit 0: 50.00%, 1: 50.00%
Total size = 2,034 | train size = 1,627 | val size = 203 | test size = 204
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.5684e-01, PNorm = 43.2232, GNorm = 1.1281, lr_0 = 2.5469e-04
Loss = 5.6624e-01, PNorm = 43.2429, GNorm = 1.4182, lr_0 = 3.9531e-04
Loss = 4.8639e-01, PNorm = 43.2725, GNorm = 0.8334, lr_0 = 5.3594e-04
Validation prc-auc = 0.675619
Validation auc = 0.839795
Epoch 1
Loss = 4.3835e-01, PNorm = 43.3189, GNorm = 1.8693, lr_0 = 6.9063e-04
Loss = 4.7772e-01, PNorm = 43.3647, GNorm = 0.7516, lr_0 = 8.3125e-04
Loss = 4.3680e-01, PNorm = 43.4096, GNorm = 0.7836, lr_0 = 9.7187e-04
Validation prc-auc = 0.726950
Validation auc = 0.845749
Epoch 2
Loss = 3.8249e-01, PNorm = 43.4588, GNorm = 0.8203, lr_0 = 9.7965e-04
Loss = 4.3539e-01, PNorm = 43.5051, GNorm = 0.8805, lr_0 = 9.5480e-04
Loss = 3.8386e-01, PNorm = 43.5478, GNorm = 1.4543, lr_0 = 9.3057e-04
Validation prc-auc = 0.713022
Validation auc = 0.837441
Epoch 3
Loss = 3.3023e-01, PNorm = 43.5962, GNorm = 0.4148, lr_0 = 9.0463e-04
Loss = 4.0522e-01, PNorm = 43.6439, GNorm = 0.5961, lr_0 = 8.8168e-04
Loss = 4.1985e-01, PNorm = 43.6827, GNorm = 1.0223, lr_0 = 8.5931e-04
Loss = 4.0588e-01, PNorm = 43.7302, GNorm = 0.6972, lr_0 = 8.3751e-04
Validation prc-auc = 0.709899
Validation auc = 0.828164
Epoch 4
Loss = 3.5468e-01, PNorm = 43.7814, GNorm = 0.6174, lr_0 = 8.1626e-04
Loss = 3.9971e-01, PNorm = 43.8166, GNorm = 0.3266, lr_0 = 7.9555e-04
Loss = 4.0037e-01, PNorm = 43.8517, GNorm = 1.3817, lr_0 = 7.7537e-04
Validation prc-auc = 0.690537
Validation auc = 0.825533
Epoch 5
Loss = 3.9620e-01, PNorm = 43.8870, GNorm = 0.9384, lr_0 = 7.5376e-04
Loss = 3.6988e-01, PNorm = 43.9233, GNorm = 0.5466, lr_0 = 7.3463e-04
Loss = 3.3488e-01, PNorm = 43.9627, GNorm = 0.9054, lr_0 = 7.1600e-04
Validation prc-auc = 0.730452
Validation auc = 0.835918
Epoch 6
Loss = 3.6853e-01, PNorm = 43.9913, GNorm = 0.6460, lr_0 = 6.9783e-04
Loss = 3.6901e-01, PNorm = 44.0291, GNorm = 1.5252, lr_0 = 6.8013e-04
Loss = 3.6959e-01, PNorm = 44.0615, GNorm = 0.7173, lr_0 = 6.6287e-04
Validation prc-auc = 0.723971
Validation auc = 0.828441
Epoch 7
Loss = 3.3581e-01, PNorm = 44.0985, GNorm = 0.3395, lr_0 = 6.4439e-04
Loss = 3.9736e-01, PNorm = 44.1317, GNorm = 0.6786, lr_0 = 6.2805e-04
Loss = 3.7178e-01, PNorm = 44.1626, GNorm = 0.5140, lr_0 = 6.1211e-04
Loss = 3.5960e-01, PNorm = 44.2054, GNorm = 0.9394, lr_0 = 5.9658e-04
Validation prc-auc = 0.728085
Validation auc = 0.829549
Epoch 8
Loss = 3.4041e-01, PNorm = 44.2401, GNorm = 0.4264, lr_0 = 5.8145e-04
Loss = 3.8515e-01, PNorm = 44.2702, GNorm = 0.4571, lr_0 = 5.6669e-04
Loss = 3.6065e-01, PNorm = 44.2948, GNorm = 1.0613, lr_0 = 5.5232e-04
Validation prc-auc = 0.727330
Validation auc = 0.824979
Epoch 9
Loss = 3.4454e-01, PNorm = 44.3314, GNorm = 0.5748, lr_0 = 5.3692e-04
Loss = 3.5084e-01, PNorm = 44.3662, GNorm = 0.5801, lr_0 = 5.2330e-04
Loss = 3.6067e-01, PNorm = 44.3925, GNorm = 1.1748, lr_0 = 5.1002e-04
Validation prc-auc = 0.727508
Validation auc = 0.832733
Epoch 10
Loss = 3.3630e-01, PNorm = 44.4188, GNorm = 0.6201, lr_0 = 4.9708e-04
Loss = 3.4298e-01, PNorm = 44.4514, GNorm = 0.3894, lr_0 = 4.8447e-04
Loss = 3.5770e-01, PNorm = 44.4780, GNorm = 0.4447, lr_0 = 4.7218e-04
Validation prc-auc = 0.704174
Validation auc = 0.827195
Epoch 11
Loss = 3.7717e-01, PNorm = 44.5093, GNorm = 0.6146, lr_0 = 4.5902e-04
Loss = 3.2214e-01, PNorm = 44.5532, GNorm = 0.9007, lr_0 = 4.4737e-04
Loss = 4.0656e-01, PNorm = 44.5798, GNorm = 0.7627, lr_0 = 4.3602e-04
Loss = 3.3026e-01, PNorm = 44.6111, GNorm = 1.5016, lr_0 = 4.2496e-04
Validation prc-auc = 0.730412
Validation auc = 0.836195
Epoch 12
Loss = 3.4502e-01, PNorm = 44.6459, GNorm = 0.6033, lr_0 = 4.1418e-04
Loss = 3.4990e-01, PNorm = 44.6690, GNorm = 0.4259, lr_0 = 4.0367e-04
Loss = 3.3628e-01, PNorm = 44.7032, GNorm = 0.5578, lr_0 = 3.9343e-04
Validation prc-auc = 0.731360
Validation auc = 0.836333
Epoch 13
Loss = 2.9289e-01, PNorm = 44.7287, GNorm = 0.3940, lr_0 = 3.8345e-04
Loss = 3.0853e-01, PNorm = 44.7568, GNorm = 0.6340, lr_0 = 3.7372e-04
Loss = 3.9194e-01, PNorm = 44.7811, GNorm = 0.6932, lr_0 = 3.6424e-04
Validation prc-auc = 0.700381
Validation auc = 0.830102
Epoch 14
Loss = 3.2248e-01, PNorm = 44.8173, GNorm = 0.6697, lr_0 = 3.5408e-04
Loss = 3.4525e-01, PNorm = 44.8434, GNorm = 1.4281, lr_0 = 3.4510e-04
Loss = 3.5495e-01, PNorm = 44.8672, GNorm = 0.4081, lr_0 = 3.3635e-04
Validation prc-auc = 0.731424
Validation auc = 0.837026
Epoch 15
Loss = 2.7439e-01, PNorm = 44.8981, GNorm = 0.4102, lr_0 = 3.2781e-04
Loss = 3.3897e-01, PNorm = 44.9211, GNorm = 0.7185, lr_0 = 3.1950e-04
Loss = 3.0861e-01, PNorm = 44.9506, GNorm = 0.4472, lr_0 = 3.1139e-04
Loss = 3.6203e-01, PNorm = 44.9756, GNorm = 0.8047, lr_0 = 3.0349e-04
Loss = 4.7843e-01, PNorm = 44.9799, GNorm = 1.0984, lr_0 = 3.0271e-04
Validation prc-auc = 0.727581
Validation auc = 0.834672
Epoch 16
Loss = 3.4686e-01, PNorm = 45.0014, GNorm = 0.3792, lr_0 = 2.9503e-04
Loss = 3.2619e-01, PNorm = 45.0382, GNorm = 0.3752, lr_0 = 2.8754e-04
Loss = 3.4905e-01, PNorm = 45.0599, GNorm = 0.6200, lr_0 = 2.8025e-04
Validation prc-auc = 0.735633
Validation auc = 0.837857
Epoch 17
Loss = 3.3749e-01, PNorm = 45.0841, GNorm = 1.2465, lr_0 = 2.7314e-04
Loss = 3.2227e-01, PNorm = 45.0992, GNorm = 0.5283, lr_0 = 2.6621e-04
Loss = 3.4296e-01, PNorm = 45.1312, GNorm = 0.5009, lr_0 = 2.5946e-04
Validation prc-auc = 0.736801
Validation auc = 0.837857
Epoch 18
Loss = 2.6738e-01, PNorm = 45.1498, GNorm = 0.3343, lr_0 = 2.5222e-04
Loss = 3.0609e-01, PNorm = 45.1808, GNorm = 0.4788, lr_0 = 2.4582e-04
Loss = 3.3902e-01, PNorm = 45.1992, GNorm = 0.5417, lr_0 = 2.3959e-04
Validation prc-auc = 0.742249
Validation auc = 0.837026
Epoch 19
Loss = 4.1260e-01, PNorm = 45.2160, GNorm = 0.5353, lr_0 = 2.3351e-04
Loss = 3.0246e-01, PNorm = 45.2322, GNorm = 0.6410, lr_0 = 2.2758e-04
Loss = 3.0483e-01, PNorm = 45.2618, GNorm = 0.8217, lr_0 = 2.2181e-04
Loss = 3.3746e-01, PNorm = 45.2762, GNorm = 0.9940, lr_0 = 2.1618e-04
Loss = 4.4787e-01, PNorm = 45.2760, GNorm = 2.4851, lr_0 = 2.1563e-04
Validation prc-auc = 0.737589
Validation auc = 0.834949
Epoch 20
Loss = 3.0225e-01, PNorm = 45.2997, GNorm = 0.4906, lr_0 = 2.1016e-04
Loss = 3.0713e-01, PNorm = 45.3173, GNorm = 0.5724, lr_0 = 2.0483e-04
Loss = 3.9880e-01, PNorm = 45.3407, GNorm = 0.4572, lr_0 = 1.9963e-04
Validation prc-auc = 0.741513
Validation auc = 0.834672
Epoch 21
Loss = 3.1104e-01, PNorm = 45.3553, GNorm = 0.3852, lr_0 = 1.9456e-04
Loss = 3.1908e-01, PNorm = 45.3752, GNorm = 0.5813, lr_0 = 1.8963e-04
Loss = 3.2807e-01, PNorm = 45.3949, GNorm = 0.9367, lr_0 = 1.8482e-04
Validation prc-auc = 0.742479
Validation auc = 0.835503
Epoch 22
Loss = 3.2983e-01, PNorm = 45.4109, GNorm = 0.4963, lr_0 = 1.7967e-04
Loss = 3.0136e-01, PNorm = 45.4260, GNorm = 0.6435, lr_0 = 1.7511e-04
Loss = 2.9548e-01, PNorm = 45.4419, GNorm = 1.0931, lr_0 = 1.7066e-04
Validation prc-auc = 0.737076
Validation auc = 0.837580
Epoch 23
Loss = 2.5342e-01, PNorm = 45.4570, GNorm = 0.5999, lr_0 = 1.6633e-04
Loss = 3.2900e-01, PNorm = 45.4752, GNorm = 0.5808, lr_0 = 1.6211e-04
Loss = 3.0979e-01, PNorm = 45.4826, GNorm = 0.4415, lr_0 = 1.5800e-04
Loss = 2.9990e-01, PNorm = 45.4975, GNorm = 0.5476, lr_0 = 1.5399e-04
Loss = 3.4446e-01, PNorm = 45.4993, GNorm = 0.5124, lr_0 = 1.5360e-04
Validation prc-auc = 0.747980
Validation auc = 0.838272
Epoch 24
Loss = 3.3426e-01, PNorm = 45.5147, GNorm = 0.4473, lr_0 = 1.4970e-04
Loss = 3.0468e-01, PNorm = 45.5295, GNorm = 0.5565, lr_0 = 1.4590e-04
Loss = 3.2383e-01, PNorm = 45.5413, GNorm = 0.5467, lr_0 = 1.4220e-04
Validation prc-auc = 0.746308
Validation auc = 0.841872
Epoch 25
Loss = 3.0313e-01, PNorm = 45.5627, GNorm = 0.8169, lr_0 = 1.3859e-04
Loss = 3.0796e-01, PNorm = 45.5750, GNorm = 0.4172, lr_0 = 1.3508e-04
Loss = 3.1992e-01, PNorm = 45.5839, GNorm = 0.5002, lr_0 = 1.3165e-04
Validation prc-auc = 0.755085
Validation auc = 0.841872
Epoch 26
Loss = 3.7216e-01, PNorm = 45.5983, GNorm = 0.9580, lr_0 = 1.2831e-04
Loss = 2.8896e-01, PNorm = 45.6097, GNorm = 0.4857, lr_0 = 1.2505e-04
Loss = 2.9537e-01, PNorm = 45.6257, GNorm = 1.7771, lr_0 = 1.2188e-04
Validation prc-auc = 0.747261
Validation auc = 0.838272
Epoch 27
Loss = 2.9809e-01, PNorm = 45.6328, GNorm = 0.5642, lr_0 = 1.1848e-04
Loss = 2.9988e-01, PNorm = 45.6443, GNorm = 0.6159, lr_0 = 1.1548e-04
Loss = 2.9280e-01, PNorm = 45.6548, GNorm = 0.6986, lr_0 = 1.1255e-04
Loss = 3.2799e-01, PNorm = 45.6659, GNorm = 0.9967, lr_0 = 1.0969e-04
Validation prc-auc = 0.742663
Validation auc = 0.838549
Epoch 28
Loss = 2.8552e-01, PNorm = 45.6759, GNorm = 0.7590, lr_0 = 1.0691e-04
Loss = 3.4101e-01, PNorm = 45.6813, GNorm = 1.4663, lr_0 = 1.0420e-04
Loss = 2.9732e-01, PNorm = 45.6946, GNorm = 1.7337, lr_0 = 1.0155e-04
Validation prc-auc = 0.748765
Validation auc = 0.839657
Epoch 29
Loss = 2.9422e-01, PNorm = 45.7015, GNorm = 0.5037, lr_0 = 1.0000e-04
Loss = 2.9345e-01, PNorm = 45.7146, GNorm = 1.2018, lr_0 = 1.0000e-04
Loss = 3.1339e-01, PNorm = 45.7196, GNorm = 0.5583, lr_0 = 1.0000e-04
Validation prc-auc = 0.747875
Validation auc = 0.839657
Model 0 best validation prc-auc = 0.755085 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.973099
Model 0 test auc = 0.958633
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.5140e-01, PNorm = 43.2480, GNorm = 0.7860, lr_0 = 2.5469e-04
Loss = 5.6225e-01, PNorm = 43.2662, GNorm = 2.7086, lr_0 = 3.9531e-04
Loss = 4.9751e-01, PNorm = 43.2959, GNorm = 0.8266, lr_0 = 5.3594e-04
Validation prc-auc = 0.627177
Validation auc = 0.829826
Epoch 1
Loss = 4.9160e-01, PNorm = 43.3385, GNorm = 4.1415, lr_0 = 6.9063e-04
Loss = 4.8274e-01, PNorm = 43.3787, GNorm = 1.5159, lr_0 = 8.3125e-04
Loss = 4.6742e-01, PNorm = 43.4277, GNorm = 1.0554, lr_0 = 9.7187e-04
Validation prc-auc = 0.715299
Validation auc = 0.840487
Epoch 2
Loss = 4.4828e-01, PNorm = 43.4800, GNorm = 1.1061, lr_0 = 9.7965e-04
Loss = 4.2944e-01, PNorm = 43.5381, GNorm = 0.5640, lr_0 = 9.5480e-04
Loss = 4.4749e-01, PNorm = 43.5827, GNorm = 0.4448, lr_0 = 9.3057e-04
Validation prc-auc = 0.710063
Validation auc = 0.834256
Epoch 3
Loss = 3.1140e-01, PNorm = 43.6331, GNorm = 0.6657, lr_0 = 9.0463e-04
Loss = 3.6026e-01, PNorm = 43.6726, GNorm = 0.4689, lr_0 = 8.8168e-04
Loss = 4.1943e-01, PNorm = 43.7119, GNorm = 0.5458, lr_0 = 8.5931e-04
Loss = 4.2332e-01, PNorm = 43.7342, GNorm = 0.5529, lr_0 = 8.3751e-04
Validation prc-auc = 0.685767
Validation auc = 0.825948
Epoch 4
Loss = 3.8833e-01, PNorm = 43.7714, GNorm = 1.1442, lr_0 = 8.1626e-04
Loss = 3.7496e-01, PNorm = 43.8056, GNorm = 0.5544, lr_0 = 7.9555e-04
Loss = 3.7453e-01, PNorm = 43.8392, GNorm = 0.4588, lr_0 = 7.7537e-04
Validation prc-auc = 0.726755
Validation auc = 0.834949
Epoch 5
Loss = 3.9277e-01, PNorm = 43.8755, GNorm = 0.5555, lr_0 = 7.5376e-04
Loss = 3.4226e-01, PNorm = 43.9092, GNorm = 1.1040, lr_0 = 7.3463e-04
Loss = 3.9507e-01, PNorm = 43.9466, GNorm = 0.8467, lr_0 = 7.1600e-04
Validation prc-auc = 0.716688
Validation auc = 0.834395
Epoch 6
Loss = 3.2192e-01, PNorm = 43.9862, GNorm = 1.3107, lr_0 = 6.9783e-04
Loss = 4.2149e-01, PNorm = 44.0232, GNorm = 0.8547, lr_0 = 6.8013e-04
Loss = 3.5677e-01, PNorm = 44.0498, GNorm = 1.2453, lr_0 = 6.6287e-04
Validation prc-auc = 0.734067
Validation auc = 0.837857
Epoch 7
Loss = 4.1274e-01, PNorm = 44.0901, GNorm = 0.5251, lr_0 = 6.4439e-04
Loss = 3.4217e-01, PNorm = 44.1160, GNorm = 0.4016, lr_0 = 6.2805e-04
Loss = 4.0164e-01, PNorm = 44.1482, GNorm = 0.6761, lr_0 = 6.1211e-04
Loss = 3.5879e-01, PNorm = 44.1824, GNorm = 1.0182, lr_0 = 5.9658e-04
Validation prc-auc = 0.689057
Validation auc = 0.826087
Epoch 8
Loss = 3.8987e-01, PNorm = 44.2352, GNorm = 1.3630, lr_0 = 5.8145e-04
Loss = 3.5812e-01, PNorm = 44.2709, GNorm = 0.6231, lr_0 = 5.6669e-04
Loss = 3.8051e-01, PNorm = 44.3137, GNorm = 0.8957, lr_0 = 5.5232e-04
Validation prc-auc = 0.714735
Validation auc = 0.828302
Epoch 9
Loss = 3.6495e-01, PNorm = 44.3384, GNorm = 0.8550, lr_0 = 5.3692e-04
Loss = 3.8134e-01, PNorm = 44.3651, GNorm = 1.0384, lr_0 = 5.2330e-04
Loss = 3.2761e-01, PNorm = 44.3996, GNorm = 0.5046, lr_0 = 5.1002e-04
Validation prc-auc = 0.724527
Validation auc = 0.830656
Epoch 10
Loss = 3.7341e-01, PNorm = 44.4369, GNorm = 0.5787, lr_0 = 4.9708e-04
Loss = 3.5552e-01, PNorm = 44.4735, GNorm = 0.4192, lr_0 = 4.8447e-04
Loss = 3.7000e-01, PNorm = 44.4992, GNorm = 0.5469, lr_0 = 4.7218e-04
Validation prc-auc = 0.726797
Validation auc = 0.835503
Epoch 11
Loss = 3.7733e-01, PNorm = 44.5311, GNorm = 0.3705, lr_0 = 4.5902e-04
Loss = 3.3838e-01, PNorm = 44.5586, GNorm = 0.6280, lr_0 = 4.4737e-04
Loss = 3.3842e-01, PNorm = 44.5953, GNorm = 1.2456, lr_0 = 4.3602e-04
Loss = 3.7350e-01, PNorm = 44.6321, GNorm = 0.9806, lr_0 = 4.2496e-04
Validation prc-auc = 0.729455
Validation auc = 0.834949
Epoch 12
Loss = 3.4057e-01, PNorm = 44.6678, GNorm = 0.4294, lr_0 = 4.1418e-04
Loss = 3.4147e-01, PNorm = 44.6982, GNorm = 0.6584, lr_0 = 4.0367e-04
Loss = 3.5943e-01, PNorm = 44.7323, GNorm = 1.1887, lr_0 = 3.9343e-04
Validation prc-auc = 0.747650
Validation auc = 0.837026
Epoch 13
Loss = 3.9136e-01, PNorm = 44.7604, GNorm = 1.0880, lr_0 = 3.8345e-04
Loss = 3.4347e-01, PNorm = 44.7905, GNorm = 0.4355, lr_0 = 3.7372e-04
Loss = 3.5431e-01, PNorm = 44.8197, GNorm = 0.6947, lr_0 = 3.6424e-04
Validation prc-auc = 0.729956
Validation auc = 0.835364
Epoch 14
Loss = 3.4870e-01, PNorm = 44.8516, GNorm = 0.4041, lr_0 = 3.5408e-04
Loss = 3.2400e-01, PNorm = 44.8773, GNorm = 0.8640, lr_0 = 3.4510e-04
Loss = 3.6279e-01, PNorm = 44.9026, GNorm = 0.6166, lr_0 = 3.3635e-04
Validation prc-auc = 0.744405
Validation auc = 0.838687
Epoch 15
Loss = 3.5611e-01, PNorm = 44.9261, GNorm = 0.3904, lr_0 = 3.2781e-04
Loss = 3.3460e-01, PNorm = 44.9491, GNorm = 0.9311, lr_0 = 3.1950e-04
Loss = 3.5809e-01, PNorm = 44.9744, GNorm = 0.4250, lr_0 = 3.1139e-04
Loss = 3.1910e-01, PNorm = 45.0063, GNorm = 0.6753, lr_0 = 3.0349e-04
Loss = 2.6233e-01, PNorm = 45.0102, GNorm = 0.5018, lr_0 = 3.0271e-04
Validation prc-auc = 0.738334
Validation auc = 0.836472
Epoch 16
Loss = 3.4784e-01, PNorm = 45.0314, GNorm = 0.9528, lr_0 = 2.9503e-04
Loss = 2.4757e-01, PNorm = 45.0638, GNorm = 0.3353, lr_0 = 2.8754e-04
Loss = 3.6050e-01, PNorm = 45.0829, GNorm = 0.4569, lr_0 = 2.8025e-04
Validation prc-auc = 0.755678
Validation auc = 0.843257
Epoch 17
Loss = 3.7020e-01, PNorm = 45.0967, GNorm = 0.7757, lr_0 = 2.7314e-04
Loss = 3.2367e-01, PNorm = 45.1208, GNorm = 0.4402, lr_0 = 2.6621e-04
Loss = 3.1559e-01, PNorm = 45.1480, GNorm = 0.8095, lr_0 = 2.5946e-04
Validation prc-auc = 0.747463
Validation auc = 0.841180
Epoch 18
Loss = 3.4170e-01, PNorm = 45.1691, GNorm = 0.5101, lr_0 = 2.5222e-04
Loss = 3.1019e-01, PNorm = 45.1964, GNorm = 0.5653, lr_0 = 2.4582e-04
Loss = 3.3046e-01, PNorm = 45.2149, GNorm = 1.4053, lr_0 = 2.3959e-04
Validation prc-auc = 0.740368
Validation auc = 0.840487
Epoch 19
Loss = 4.5299e-01, PNorm = 45.2390, GNorm = 0.8022, lr_0 = 2.3351e-04
Loss = 3.0487e-01, PNorm = 45.2462, GNorm = 0.5011, lr_0 = 2.2758e-04
Loss = 3.6131e-01, PNorm = 45.2696, GNorm = 0.4385, lr_0 = 2.2181e-04
Loss = 3.0124e-01, PNorm = 45.2892, GNorm = 0.5393, lr_0 = 2.1618e-04
Loss = 2.4148e-01, PNorm = 45.2915, GNorm = 0.5474, lr_0 = 2.1563e-04
Validation prc-auc = 0.750646
Validation auc = 0.845057
Epoch 20
Loss = 3.1332e-01, PNorm = 45.3089, GNorm = 0.7524, lr_0 = 2.1016e-04
Loss = 3.2718e-01, PNorm = 45.3295, GNorm = 0.9636, lr_0 = 2.0483e-04
Loss = 2.8634e-01, PNorm = 45.3478, GNorm = 0.4896, lr_0 = 1.9963e-04
Validation prc-auc = 0.736724
Validation auc = 0.837857
Epoch 21
Loss = 3.1624e-01, PNorm = 45.3570, GNorm = 0.7490, lr_0 = 1.9456e-04
Loss = 3.1088e-01, PNorm = 45.3754, GNorm = 0.5364, lr_0 = 1.8963e-04
Loss = 3.1952e-01, PNorm = 45.3910, GNorm = 0.6388, lr_0 = 1.8482e-04
Validation prc-auc = 0.751334
Validation auc = 0.846303
Epoch 22
Loss = 3.0452e-01, PNorm = 45.4062, GNorm = 0.8838, lr_0 = 1.7967e-04
Loss = 2.7651e-01, PNorm = 45.4262, GNorm = 0.6378, lr_0 = 1.7511e-04
Loss = 3.0672e-01, PNorm = 45.4434, GNorm = 0.8751, lr_0 = 1.7066e-04
Validation prc-auc = 0.747760
Validation auc = 0.846441
Epoch 23
Loss = 2.3688e-01, PNorm = 45.4563, GNorm = 0.3598, lr_0 = 1.6633e-04
Loss = 3.2187e-01, PNorm = 45.4725, GNorm = 0.4396, lr_0 = 1.6211e-04
Loss = 3.3233e-01, PNorm = 45.4863, GNorm = 0.4841, lr_0 = 1.5800e-04
Loss = 3.1083e-01, PNorm = 45.4976, GNorm = 0.8330, lr_0 = 1.5399e-04
Loss = 1.5203e-01, PNorm = 45.4976, GNorm = 0.6974, lr_0 = 1.5360e-04
Validation prc-auc = 0.765634
Validation auc = 0.851149
Epoch 24
Loss = 3.2803e-01, PNorm = 45.5117, GNorm = 0.5408, lr_0 = 1.4970e-04
Loss = 3.2212e-01, PNorm = 45.5241, GNorm = 0.7929, lr_0 = 1.4590e-04
Loss = 3.1522e-01, PNorm = 45.5396, GNorm = 0.5238, lr_0 = 1.4220e-04
Validation prc-auc = 0.766773
Validation auc = 0.852395
Epoch 25
Loss = 2.8372e-01, PNorm = 45.5483, GNorm = 0.6218, lr_0 = 1.3859e-04
Loss = 3.0976e-01, PNorm = 45.5591, GNorm = 0.4852, lr_0 = 1.3508e-04
Loss = 3.2834e-01, PNorm = 45.5701, GNorm = 0.8105, lr_0 = 1.3165e-04
Validation prc-auc = 0.753537
Validation auc = 0.848380
Epoch 26
Loss = 3.0571e-01, PNorm = 45.5795, GNorm = 0.4448, lr_0 = 1.2831e-04
Loss = 3.1466e-01, PNorm = 45.5879, GNorm = 0.5415, lr_0 = 1.2505e-04
Loss = 2.9621e-01, PNorm = 45.6003, GNorm = 0.6564, lr_0 = 1.2188e-04
Validation prc-auc = 0.768395
Validation auc = 0.851980
Epoch 27
Loss = 4.1076e-01, PNorm = 45.6070, GNorm = 2.2373, lr_0 = 1.1848e-04
Loss = 2.8793e-01, PNorm = 45.6219, GNorm = 0.5049, lr_0 = 1.1548e-04
Loss = 2.8686e-01, PNorm = 45.6304, GNorm = 1.3157, lr_0 = 1.1255e-04
Loss = 3.4070e-01, PNorm = 45.6378, GNorm = 0.5068, lr_0 = 1.0969e-04
Validation prc-auc = 0.770440
Validation auc = 0.851980
Epoch 28
Loss = 3.0561e-01, PNorm = 45.6470, GNorm = 0.4561, lr_0 = 1.0691e-04
Loss = 3.5552e-01, PNorm = 45.6511, GNorm = 0.4503, lr_0 = 1.0420e-04
Loss = 2.8994e-01, PNorm = 45.6609, GNorm = 0.5886, lr_0 = 1.0155e-04
Validation prc-auc = 0.755476
Validation auc = 0.847688
Epoch 29
Loss = 3.5872e-01, PNorm = 45.6713, GNorm = 0.5064, lr_0 = 1.0000e-04
Loss = 2.8157e-01, PNorm = 45.6828, GNorm = 0.8047, lr_0 = 1.0000e-04
Loss = 2.9721e-01, PNorm = 45.6894, GNorm = 1.1953, lr_0 = 1.0000e-04
Validation prc-auc = 0.761103
Validation auc = 0.850595
Model 1 best validation prc-auc = 0.770440 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.973196
Model 1 test auc = 0.957620
Ensemble test prc-auc = 0.973031
Ensemble test auc = 0.958430
5-fold cross validation
	Seed 0 ==> test prc-auc = 0.896537
	Seed 0 ==> test auc = 0.866271
	Seed 1 ==> test prc-auc = 0.844795
	Seed 1 ==> test auc = 0.843618
	Seed 2 ==> test prc-auc = 0.880456
	Seed 2 ==> test auc = 0.917377
	Seed 3 ==> test prc-auc = 0.965786
	Seed 3 ==> test auc = 0.951328
	Seed 4 ==> test prc-auc = 0.973031
	Seed 4 ==> test auc = 0.958430
Overall test prc-auc = 0.912121 +/- 0.049736
Overall test auc = 0.907405 +/- 0.045592
Elapsed time = 0:22:53
