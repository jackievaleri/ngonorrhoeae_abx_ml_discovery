Command line
python /home/jackievaleri8/.conda/envs/chemprop/bin/chemprop_train --dropout 0.1 --hidden_size 500 --ffn_num_layers 2 --depth 3 --metric prc-auc --extra_metrics auc --save_dir models/controls_with_diff_neg_datasets/similar_N=2034/ --data_path data/controls_with_diff_neg_datasets/similar_N=2034.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --num_folds 5 --ensemble_size 2 --split_type scaffold_balanced --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --gpu 0
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/controls_with_diff_neg_datasets/similar_N=2034.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda', index=0),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 2,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 500,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'models/controls_with_diff_neg_datasets/similar_N=2034/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'scaffold_balanced',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 746 | train scaffolds = 582 | val scaffolds = 68 | test scaffolds = 96
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 144 | target average = 0.041667


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 53 | target average = 0.018868


Scaffold 3
Task 0: count = 52 | target average = 0.019231


Scaffold 4
Task 0: count = 45 | target average = 0.044444


Scaffold 5
Task 0: count = 45 | target average = 0.066667


Scaffold 6
Task 0: count = 44 | target average = 0.068182


Scaffold 7
Task 0: count = 42 | target average = 0.023810


Scaffold 8
Task 0: count = 38 | target average = 0.157895


Scaffold 9
Task 0: count = 36 | target average = 0.000000


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.1128e-01, PNorm = 43.2201, GNorm = 1.0257, lr_0 = 2.0312e-04
Loss = 4.9037e-01, PNorm = 43.2316, GNorm = 0.8779, lr_0 = 2.9687e-04
Loss = 4.3085e-01, PNorm = 43.2548, GNorm = 0.7998, lr_0 = 3.9062e-04
Loss = 4.1652e-01, PNorm = 43.2844, GNorm = 0.7105, lr_0 = 4.8437e-04
Validation prc-auc = 0.839103
Validation auc = 0.911640
Epoch 1
Loss = 4.1305e-01, PNorm = 43.3213, GNorm = 2.3322, lr_0 = 5.8750e-04
Loss = 3.1587e-01, PNorm = 43.3602, GNorm = 0.4294, lr_0 = 6.8125e-04
Loss = 4.3893e-01, PNorm = 43.3999, GNorm = 1.1944, lr_0 = 7.7500e-04
Loss = 3.7603e-01, PNorm = 43.4383, GNorm = 0.8174, lr_0 = 8.6875e-04
Loss = 2.9227e-01, PNorm = 43.4880, GNorm = 0.6636, lr_0 = 9.6250e-04
Validation prc-auc = 0.819528
Validation auc = 0.923110
Epoch 2
Loss = 3.7342e-01, PNorm = 43.5369, GNorm = 0.4755, lr_0 = 9.8977e-04
Loss = 3.4554e-01, PNorm = 43.5786, GNorm = 0.9498, lr_0 = 9.7296e-04
Loss = 3.7043e-01, PNorm = 43.6182, GNorm = 0.4817, lr_0 = 9.5643e-04
Loss = 3.2056e-01, PNorm = 43.6672, GNorm = 0.8593, lr_0 = 9.4019e-04
Loss = 2.8195e-01, PNorm = 43.7258, GNorm = 0.3778, lr_0 = 9.2422e-04
Validation prc-auc = 0.809670
Validation auc = 0.925092
Epoch 3
Loss = 3.8028e-01, PNorm = 43.7705, GNorm = 0.7500, lr_0 = 9.0852e-04
Loss = 3.2491e-01, PNorm = 43.8131, GNorm = 0.4634, lr_0 = 8.9309e-04
Loss = 2.8695e-01, PNorm = 43.8634, GNorm = 1.3300, lr_0 = 8.7791e-04
Loss = 3.1932e-01, PNorm = 43.9104, GNorm = 0.3961, lr_0 = 8.6300e-04
Loss = 3.5587e-01, PNorm = 43.9572, GNorm = 0.4864, lr_0 = 8.4834e-04
Validation prc-auc = 0.802199
Validation auc = 0.926555
Epoch 4
Loss = 3.0971e-01, PNorm = 43.9803, GNorm = 0.8449, lr_0 = 8.3393e-04
Loss = 3.1955e-01, PNorm = 44.0256, GNorm = 0.7017, lr_0 = 8.1977e-04
Loss = 3.0757e-01, PNorm = 44.0833, GNorm = 0.4084, lr_0 = 8.0584e-04
Loss = 2.7888e-01, PNorm = 44.1320, GNorm = 0.5372, lr_0 = 7.9215e-04
Loss = 3.0481e-01, PNorm = 44.1777, GNorm = 0.6457, lr_0 = 7.7870e-04
Validation prc-auc = 0.798594
Validation auc = 0.924526
Epoch 5
Loss = 2.9978e-01, PNorm = 44.1987, GNorm = 0.6511, lr_0 = 7.6547e-04
Loss = 3.0338e-01, PNorm = 44.2425, GNorm = 1.1734, lr_0 = 7.5247e-04
Loss = 2.9610e-01, PNorm = 44.2987, GNorm = 1.7266, lr_0 = 7.3969e-04
Loss = 3.0994e-01, PNorm = 44.3493, GNorm = 0.4504, lr_0 = 7.2712e-04
Loss = 2.7122e-01, PNorm = 44.4001, GNorm = 0.3201, lr_0 = 7.1477e-04
Validation prc-auc = 0.799802
Validation auc = 0.925564
Epoch 6
Loss = 2.9850e-01, PNorm = 44.4529, GNorm = 1.1073, lr_0 = 7.0143e-04
Loss = 2.5344e-01, PNorm = 44.5054, GNorm = 0.4960, lr_0 = 6.8951e-04
Loss = 2.6747e-01, PNorm = 44.5458, GNorm = 0.6411, lr_0 = 6.7780e-04
Loss = 3.5147e-01, PNorm = 44.5910, GNorm = 0.7677, lr_0 = 6.6629e-04
Loss = 3.0876e-01, PNorm = 44.6451, GNorm = 0.6102, lr_0 = 6.5497e-04
Validation prc-auc = 0.809590
Validation auc = 0.928491
Epoch 7
Loss = 3.3407e-01, PNorm = 44.6921, GNorm = 1.1175, lr_0 = 6.4384e-04
Loss = 2.8128e-01, PNorm = 44.7537, GNorm = 0.7022, lr_0 = 6.3291e-04
Loss = 2.1951e-01, PNorm = 44.8181, GNorm = 0.2633, lr_0 = 6.2216e-04
Loss = 2.8081e-01, PNorm = 44.8715, GNorm = 0.4331, lr_0 = 6.1159e-04
Loss = 3.2647e-01, PNorm = 44.9018, GNorm = 0.4719, lr_0 = 6.0120e-04
Validation prc-auc = 0.801585
Validation auc = 0.924714
Epoch 8
Loss = 2.7782e-01, PNorm = 44.9455, GNorm = 0.5569, lr_0 = 5.9099e-04
Loss = 2.5431e-01, PNorm = 45.0272, GNorm = 1.2706, lr_0 = 5.8095e-04
Loss = 2.6710e-01, PNorm = 45.0617, GNorm = 0.5645, lr_0 = 5.7108e-04
Loss = 2.9325e-01, PNorm = 45.0803, GNorm = 0.6224, lr_0 = 5.6138e-04
Validation prc-auc = 0.801174
Validation auc = 0.923865
Epoch 9
Loss = 3.2048e-01, PNorm = 45.1102, GNorm = 0.4840, lr_0 = 5.5184e-04
Loss = 3.0596e-01, PNorm = 45.1569, GNorm = 0.5387, lr_0 = 5.4247e-04
Loss = 2.4054e-01, PNorm = 45.2306, GNorm = 0.3688, lr_0 = 5.3325e-04
Loss = 3.0456e-01, PNorm = 45.2841, GNorm = 0.4702, lr_0 = 5.2420e-04
Loss = 2.5725e-01, PNorm = 45.3192, GNorm = 0.4597, lr_0 = 5.1529e-04
Validation prc-auc = 0.806593
Validation auc = 0.926178
Epoch 10
Loss = 2.3525e-01, PNorm = 45.3512, GNorm = 0.3733, lr_0 = 5.0654e-04
Loss = 2.5409e-01, PNorm = 45.3890, GNorm = 0.5475, lr_0 = 4.9793e-04
Loss = 2.6560e-01, PNorm = 45.4267, GNorm = 0.4687, lr_0 = 4.8948e-04
Loss = 3.3000e-01, PNorm = 45.4517, GNorm = 1.6633, lr_0 = 4.8116e-04
Loss = 2.6045e-01, PNorm = 45.4984, GNorm = 0.4101, lr_0 = 4.7299e-04
Validation prc-auc = 0.804446
Validation auc = 0.923676
Epoch 11
Loss = 2.8331e-01, PNorm = 45.5620, GNorm = 0.5823, lr_0 = 4.6416e-04
Loss = 2.3324e-01, PNorm = 45.6015, GNorm = 0.7025, lr_0 = 4.5627e-04
Loss = 2.1795e-01, PNorm = 45.6285, GNorm = 0.3148, lr_0 = 4.4852e-04
Loss = 3.1044e-01, PNorm = 45.6512, GNorm = 0.4385, lr_0 = 4.4091e-04
Loss = 3.1632e-01, PNorm = 45.6718, GNorm = 0.5324, lr_0 = 4.3342e-04
Validation prc-auc = 0.803802
Validation auc = 0.922166
Epoch 12
Loss = 2.8219e-01, PNorm = 45.7076, GNorm = 1.1078, lr_0 = 4.2605e-04
Loss = 2.9871e-01, PNorm = 45.7501, GNorm = 0.3336, lr_0 = 4.1882e-04
Loss = 2.6157e-01, PNorm = 45.7898, GNorm = 0.3593, lr_0 = 4.1170e-04
Loss = 2.5869e-01, PNorm = 45.8201, GNorm = 0.4642, lr_0 = 4.0471e-04
Loss = 2.4077e-01, PNorm = 45.8618, GNorm = 0.2753, lr_0 = 3.9783e-04
Validation prc-auc = 0.805766
Validation auc = 0.923298
Epoch 13
Loss = 2.5521e-01, PNorm = 45.9013, GNorm = 0.3509, lr_0 = 3.9108e-04
Loss = 2.4974e-01, PNorm = 45.9469, GNorm = 0.3984, lr_0 = 3.8443e-04
Loss = 2.6473e-01, PNorm = 45.9653, GNorm = 0.5053, lr_0 = 3.7790e-04
Loss = 2.6786e-01, PNorm = 46.0033, GNorm = 1.4640, lr_0 = 3.7148e-04
Loss = 2.8222e-01, PNorm = 46.0148, GNorm = 1.1045, lr_0 = 3.6517e-04
Validation prc-auc = 0.809666
Validation auc = 0.926838
Epoch 14
Loss = 2.6518e-01, PNorm = 46.0395, GNorm = 0.4485, lr_0 = 3.5897e-04
Loss = 2.8277e-01, PNorm = 46.0768, GNorm = 0.5867, lr_0 = 3.5287e-04
Loss = 2.7638e-01, PNorm = 46.0996, GNorm = 0.8588, lr_0 = 3.4688e-04
Loss = 2.2694e-01, PNorm = 46.1448, GNorm = 0.4146, lr_0 = 3.4099e-04
Loss = 2.5530e-01, PNorm = 46.1667, GNorm = 0.3920, lr_0 = 3.3520e-04
Validation prc-auc = 0.804850
Validation auc = 0.922968
Epoch 15
Loss = 2.3534e-01, PNorm = 46.1900, GNorm = 0.2945, lr_0 = 3.2950e-04
Loss = 2.5827e-01, PNorm = 46.2276, GNorm = 0.7218, lr_0 = 3.2390e-04
Loss = 2.6247e-01, PNorm = 46.2690, GNorm = 0.6973, lr_0 = 3.1840e-04
Loss = 2.6345e-01, PNorm = 46.2875, GNorm = 0.8783, lr_0 = 3.1299e-04
Loss = 2.8216e-01, PNorm = 46.3163, GNorm = 0.4600, lr_0 = 3.0768e-04
Loss = 1.7317e-01, PNorm = 46.3184, GNorm = 0.7999, lr_0 = 3.0715e-04
Validation prc-auc = 0.812030
Validation auc = 0.925611
Epoch 16
Loss = 2.7744e-01, PNorm = 46.3369, GNorm = 0.4027, lr_0 = 3.0193e-04
Loss = 1.9396e-01, PNorm = 46.3768, GNorm = 0.4308, lr_0 = 2.9680e-04
Loss = 2.6123e-01, PNorm = 46.4006, GNorm = 0.3614, lr_0 = 2.9176e-04
Loss = 2.3099e-01, PNorm = 46.4257, GNorm = 0.6541, lr_0 = 2.8681e-04
Validation prc-auc = 0.807285
Validation auc = 0.923251
Epoch 17
Loss = 2.3137e-01, PNorm = 46.4378, GNorm = 0.4421, lr_0 = 2.8193e-04
Loss = 2.5426e-01, PNorm = 46.4543, GNorm = 0.5397, lr_0 = 2.7715e-04
Loss = 2.6131e-01, PNorm = 46.4845, GNorm = 0.6087, lr_0 = 2.7244e-04
Loss = 2.4066e-01, PNorm = 46.5053, GNorm = 0.3470, lr_0 = 2.6781e-04
Loss = 2.5965e-01, PNorm = 46.5346, GNorm = 0.7193, lr_0 = 2.6326e-04
Validation prc-auc = 0.810182
Validation auc = 0.926461
Epoch 18
Loss = 1.9838e-01, PNorm = 46.5493, GNorm = 0.4124, lr_0 = 2.5879e-04
Loss = 2.2401e-01, PNorm = 46.5743, GNorm = 0.3550, lr_0 = 2.5439e-04
Loss = 2.5260e-01, PNorm = 46.6041, GNorm = 0.3874, lr_0 = 2.5007e-04
Loss = 2.2906e-01, PNorm = 46.6193, GNorm = 0.5345, lr_0 = 2.4582e-04
Loss = 2.6917e-01, PNorm = 46.6307, GNorm = 0.4396, lr_0 = 2.4165e-04
Validation prc-auc = 0.814871
Validation auc = 0.923959
Epoch 19
Loss = 2.2115e-01, PNorm = 46.6516, GNorm = 0.5061, lr_0 = 2.3754e-04
Loss = 2.5187e-01, PNorm = 46.6779, GNorm = 0.4669, lr_0 = 2.3351e-04
Loss = 2.1180e-01, PNorm = 46.6980, GNorm = 0.6368, lr_0 = 2.2954e-04
Loss = 2.6965e-01, PNorm = 46.7129, GNorm = 0.5081, lr_0 = 2.2564e-04
Loss = 2.5265e-01, PNorm = 46.7304, GNorm = 0.4124, lr_0 = 2.2181e-04
Validation prc-auc = 0.812526
Validation auc = 0.925753
Epoch 20
Loss = 2.0605e-01, PNorm = 46.7496, GNorm = 0.2509, lr_0 = 2.1804e-04
Loss = 2.2587e-01, PNorm = 46.7674, GNorm = 0.4182, lr_0 = 2.1434e-04
Loss = 2.5367e-01, PNorm = 46.7828, GNorm = 0.3515, lr_0 = 2.1070e-04
Loss = 2.3312e-01, PNorm = 46.7956, GNorm = 0.8185, lr_0 = 2.0712e-04
Loss = 2.2492e-01, PNorm = 46.8143, GNorm = 0.6074, lr_0 = 2.0360e-04
Validation prc-auc = 0.812066
Validation auc = 0.926508
Epoch 21
Loss = 2.6375e-01, PNorm = 46.8268, GNorm = 0.5142, lr_0 = 1.9980e-04
Loss = 1.8765e-01, PNorm = 46.8503, GNorm = 1.0735, lr_0 = 1.9641e-04
Loss = 2.3360e-01, PNorm = 46.8668, GNorm = 0.4951, lr_0 = 1.9307e-04
Loss = 2.4967e-01, PNorm = 46.8886, GNorm = 0.5834, lr_0 = 1.8979e-04
Loss = 2.6635e-01, PNorm = 46.8917, GNorm = 1.4741, lr_0 = 1.8657e-04
Validation prc-auc = 0.814852
Validation auc = 0.928868
Epoch 22
Loss = 2.5259e-01, PNorm = 46.9134, GNorm = 0.4155, lr_0 = 1.8340e-04
Loss = 2.4985e-01, PNorm = 46.9278, GNorm = 0.3094, lr_0 = 1.8028e-04
Loss = 2.3200e-01, PNorm = 46.9441, GNorm = 0.7244, lr_0 = 1.7722e-04
Loss = 2.2434e-01, PNorm = 46.9678, GNorm = 0.5199, lr_0 = 1.7421e-04
Loss = 2.1256e-01, PNorm = 46.9838, GNorm = 0.3681, lr_0 = 1.7125e-04
Validation prc-auc = 0.813786
Validation auc = 0.927688
Epoch 23
Loss = 2.3404e-01, PNorm = 46.9991, GNorm = 1.4466, lr_0 = 1.6834e-04
Loss = 2.0126e-01, PNorm = 47.0120, GNorm = 0.8139, lr_0 = 1.6548e-04
Loss = 2.3702e-01, PNorm = 47.0154, GNorm = 0.7079, lr_0 = 1.6267e-04
Loss = 2.2756e-01, PNorm = 47.0280, GNorm = 0.3367, lr_0 = 1.5991e-04
Loss = 2.6501e-01, PNorm = 47.0440, GNorm = 0.4280, lr_0 = 1.5719e-04
Validation prc-auc = 0.821814
Validation auc = 0.926791
Epoch 24
Loss = 2.3927e-01, PNorm = 47.0593, GNorm = 0.9542, lr_0 = 1.5452e-04
Loss = 1.9803e-01, PNorm = 47.0763, GNorm = 0.7844, lr_0 = 1.5190e-04
Loss = 2.5681e-01, PNorm = 47.0842, GNorm = 0.7941, lr_0 = 1.4932e-04
Loss = 2.1989e-01, PNorm = 47.0944, GNorm = 0.5679, lr_0 = 1.4678e-04
Loss = 2.1528e-01, PNorm = 47.1048, GNorm = 0.4412, lr_0 = 1.4429e-04
Validation prc-auc = 0.815715
Validation auc = 0.923251
Epoch 25
Loss = 2.3663e-01, PNorm = 47.1135, GNorm = 0.4873, lr_0 = 1.4184e-04
Loss = 2.5243e-01, PNorm = 47.1272, GNorm = 0.4957, lr_0 = 1.3943e-04
Loss = 2.5828e-01, PNorm = 47.1345, GNorm = 0.7108, lr_0 = 1.3706e-04
Loss = 2.0082e-01, PNorm = 47.1481, GNorm = 0.3897, lr_0 = 1.3473e-04
Validation prc-auc = 0.818618
Validation auc = 0.926083
Epoch 26
Loss = 1.9813e-01, PNorm = 47.1664, GNorm = 0.6557, lr_0 = 1.3221e-04
Loss = 2.4685e-01, PNorm = 47.1732, GNorm = 0.5705, lr_0 = 1.2997e-04
Loss = 2.4143e-01, PNorm = 47.1859, GNorm = 1.0042, lr_0 = 1.2776e-04
Loss = 2.0870e-01, PNorm = 47.1906, GNorm = 0.6034, lr_0 = 1.2559e-04
Loss = 2.2624e-01, PNorm = 47.2069, GNorm = 0.6743, lr_0 = 1.2346e-04
Validation prc-auc = 0.822876
Validation auc = 0.926107
Epoch 27
Loss = 3.1601e-01, PNorm = 47.2177, GNorm = 0.4734, lr_0 = 1.2136e-04
Loss = 2.1039e-01, PNorm = 47.2260, GNorm = 0.4805, lr_0 = 1.1930e-04
Loss = 2.4347e-01, PNorm = 47.2337, GNorm = 0.7217, lr_0 = 1.1727e-04
Loss = 2.0643e-01, PNorm = 47.2442, GNorm = 0.3271, lr_0 = 1.1528e-04
Loss = 2.2690e-01, PNorm = 47.2519, GNorm = 0.5243, lr_0 = 1.1332e-04
Validation prc-auc = 0.821472
Validation auc = 0.926414
Epoch 28
Loss = 2.9651e-01, PNorm = 47.2629, GNorm = 0.7229, lr_0 = 1.1140e-04
Loss = 2.1113e-01, PNorm = 47.2740, GNorm = 0.5526, lr_0 = 1.0951e-04
Loss = 2.5257e-01, PNorm = 47.2862, GNorm = 1.2858, lr_0 = 1.0765e-04
Loss = 1.9660e-01, PNorm = 47.2921, GNorm = 0.3604, lr_0 = 1.0582e-04
Loss = 1.6980e-01, PNorm = 47.3010, GNorm = 0.5542, lr_0 = 1.0402e-04
Validation prc-auc = 0.822973
Validation auc = 0.924408
Epoch 29
Loss = 2.1685e-01, PNorm = 47.3127, GNorm = 0.6276, lr_0 = 1.0225e-04
Loss = 2.3716e-01, PNorm = 47.3142, GNorm = 0.5498, lr_0 = 1.0052e-04
Loss = 1.7652e-01, PNorm = 47.3191, GNorm = 0.3688, lr_0 = 1.0000e-04
Loss = 2.1449e-01, PNorm = 47.3298, GNorm = 0.7101, lr_0 = 1.0000e-04
Loss = 2.4037e-01, PNorm = 47.3411, GNorm = 0.9289, lr_0 = 1.0000e-04
Validation prc-auc = 0.819775
Validation auc = 0.925446
Model 0 best validation prc-auc = 0.839103 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.798696
Model 0 test auc = 0.880759
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.0509e-01, PNorm = 43.2447, GNorm = 0.8702, lr_0 = 2.0312e-04
Loss = 4.7618e-01, PNorm = 43.2573, GNorm = 2.8167, lr_0 = 2.9687e-04
Loss = 4.6737e-01, PNorm = 43.2773, GNorm = 2.2591, lr_0 = 3.9062e-04
Loss = 4.4034e-01, PNorm = 43.3024, GNorm = 1.0011, lr_0 = 4.8437e-04
Validation prc-auc = 0.845076
Validation auc = 0.911262
Epoch 1
Loss = 3.7665e-01, PNorm = 43.3349, GNorm = 1.1050, lr_0 = 5.8750e-04
Loss = 3.9493e-01, PNorm = 43.3688, GNorm = 0.4275, lr_0 = 6.8125e-04
Loss = 3.7250e-01, PNorm = 43.4079, GNorm = 0.4106, lr_0 = 7.7500e-04
Loss = 3.2071e-01, PNorm = 43.4532, GNorm = 1.2620, lr_0 = 8.6875e-04
Loss = 3.5895e-01, PNorm = 43.4984, GNorm = 1.5366, lr_0 = 9.6250e-04
Validation prc-auc = 0.829765
Validation auc = 0.922732
Epoch 2
Loss = 3.8184e-01, PNorm = 43.5566, GNorm = 1.6225, lr_0 = 9.8977e-04
Loss = 3.5623e-01, PNorm = 43.6133, GNorm = 0.6782, lr_0 = 9.7296e-04
Loss = 3.4436e-01, PNorm = 43.6685, GNorm = 1.5756, lr_0 = 9.5643e-04
Loss = 3.5626e-01, PNorm = 43.7150, GNorm = 0.4495, lr_0 = 9.4019e-04
Loss = 3.0743e-01, PNorm = 43.7637, GNorm = 0.3397, lr_0 = 9.2422e-04
Validation prc-auc = 0.818844
Validation auc = 0.925800
Epoch 3
Loss = 2.9388e-01, PNorm = 43.8043, GNorm = 0.5171, lr_0 = 9.0852e-04
Loss = 3.1745e-01, PNorm = 43.8448, GNorm = 0.6497, lr_0 = 8.9309e-04
Loss = 3.2338e-01, PNorm = 43.8708, GNorm = 1.4561, lr_0 = 8.7791e-04
Loss = 3.1716e-01, PNorm = 43.9177, GNorm = 0.3115, lr_0 = 8.6300e-04
Loss = 3.1990e-01, PNorm = 43.9612, GNorm = 0.5628, lr_0 = 8.4834e-04
Validation prc-auc = 0.818448
Validation auc = 0.925281
Epoch 4
Loss = 3.2919e-01, PNorm = 44.0025, GNorm = 0.4384, lr_0 = 8.3393e-04
Loss = 3.2630e-01, PNorm = 44.0434, GNorm = 0.7199, lr_0 = 8.1977e-04
Loss = 3.1735e-01, PNorm = 44.0986, GNorm = 0.6022, lr_0 = 8.0584e-04
Loss = 3.0539e-01, PNorm = 44.1526, GNorm = 0.4818, lr_0 = 7.9215e-04
Loss = 2.9634e-01, PNorm = 44.1872, GNorm = 0.4393, lr_0 = 7.7870e-04
Validation prc-auc = 0.812731
Validation auc = 0.923676
Epoch 5
Loss = 3.1396e-01, PNorm = 44.2396, GNorm = 0.5589, lr_0 = 7.6547e-04
Loss = 3.1939e-01, PNorm = 44.2846, GNorm = 0.3863, lr_0 = 7.5247e-04
Loss = 2.6077e-01, PNorm = 44.3508, GNorm = 0.3981, lr_0 = 7.3969e-04
Loss = 2.8270e-01, PNorm = 44.4022, GNorm = 0.3539, lr_0 = 7.2712e-04
Loss = 3.0101e-01, PNorm = 44.4584, GNorm = 0.7781, lr_0 = 7.1477e-04
Validation prc-auc = 0.811323
Validation auc = 0.924006
Epoch 6
Loss = 3.0988e-01, PNorm = 44.4996, GNorm = 0.4704, lr_0 = 7.0143e-04
Loss = 3.1477e-01, PNorm = 44.5427, GNorm = 0.4080, lr_0 = 6.8951e-04
Loss = 2.9031e-01, PNorm = 44.6046, GNorm = 1.2827, lr_0 = 6.7780e-04
Loss = 2.9336e-01, PNorm = 44.6824, GNorm = 0.3876, lr_0 = 6.6629e-04
Loss = 2.7075e-01, PNorm = 44.7329, GNorm = 1.4803, lr_0 = 6.5497e-04
Validation prc-auc = 0.801552
Validation auc = 0.925186
Epoch 7
Loss = 3.4500e-01, PNorm = 44.7899, GNorm = 0.8801, lr_0 = 6.4384e-04
Loss = 3.4647e-01, PNorm = 44.8559, GNorm = 1.6515, lr_0 = 6.3291e-04
Loss = 3.1415e-01, PNorm = 44.9220, GNorm = 0.3952, lr_0 = 6.2216e-04
Loss = 2.7004e-01, PNorm = 44.9578, GNorm = 0.8122, lr_0 = 6.1159e-04
Loss = 2.6457e-01, PNorm = 44.9950, GNorm = 0.3364, lr_0 = 6.0120e-04
Validation prc-auc = 0.797682
Validation auc = 0.922402
Epoch 8
Loss = 3.2975e-01, PNorm = 45.0291, GNorm = 0.6257, lr_0 = 5.9099e-04
Loss = 2.5491e-01, PNorm = 45.0680, GNorm = 0.4566, lr_0 = 5.8095e-04
Loss = 3.0463e-01, PNorm = 45.1134, GNorm = 0.4181, lr_0 = 5.7108e-04
Loss = 2.7616e-01, PNorm = 45.1468, GNorm = 0.4374, lr_0 = 5.6138e-04
Validation prc-auc = 0.805450
Validation auc = 0.925139
Epoch 9
Loss = 2.2921e-01, PNorm = 45.1841, GNorm = 1.4646, lr_0 = 5.5184e-04
Loss = 3.0007e-01, PNorm = 45.2172, GNorm = 0.9103, lr_0 = 5.4247e-04
Loss = 2.5404e-01, PNorm = 45.2424, GNorm = 0.5206, lr_0 = 5.3325e-04
Loss = 2.8923e-01, PNorm = 45.2880, GNorm = 1.1814, lr_0 = 5.2420e-04
Loss = 2.6485e-01, PNorm = 45.3116, GNorm = 0.4212, lr_0 = 5.1529e-04
Validation prc-auc = 0.802991
Validation auc = 0.924290
Epoch 10
Loss = 2.4174e-01, PNorm = 45.3612, GNorm = 0.5222, lr_0 = 5.0654e-04
Loss = 3.0232e-01, PNorm = 45.4057, GNorm = 0.4991, lr_0 = 4.9793e-04
Loss = 2.3293e-01, PNorm = 45.4477, GNorm = 0.8130, lr_0 = 4.8948e-04
Loss = 3.0363e-01, PNorm = 45.4943, GNorm = 0.4439, lr_0 = 4.8116e-04
Loss = 2.6531e-01, PNorm = 45.5176, GNorm = 0.6024, lr_0 = 4.7299e-04
Validation prc-auc = 0.805553
Validation auc = 0.926414
Epoch 11
Loss = 2.2347e-01, PNorm = 45.5678, GNorm = 0.3950, lr_0 = 4.6416e-04
Loss = 2.5981e-01, PNorm = 45.5927, GNorm = 0.4187, lr_0 = 4.5627e-04
Loss = 2.7599e-01, PNorm = 45.6315, GNorm = 0.5788, lr_0 = 4.4852e-04
Loss = 2.8953e-01, PNorm = 45.6662, GNorm = 0.5800, lr_0 = 4.4091e-04
Loss = 2.8001e-01, PNorm = 45.6877, GNorm = 0.4672, lr_0 = 4.3342e-04
Validation prc-auc = 0.802400
Validation auc = 0.923676
Epoch 12
Loss = 2.2425e-01, PNorm = 45.7238, GNorm = 0.3925, lr_0 = 4.2605e-04
Loss = 2.0745e-01, PNorm = 45.7659, GNorm = 0.4772, lr_0 = 4.1882e-04
Loss = 3.0779e-01, PNorm = 45.7991, GNorm = 0.5255, lr_0 = 4.1170e-04
Loss = 2.7802e-01, PNorm = 45.8233, GNorm = 0.4106, lr_0 = 4.0471e-04
Loss = 3.0517e-01, PNorm = 45.8744, GNorm = 0.5709, lr_0 = 3.9783e-04
Validation prc-auc = 0.813827
Validation auc = 0.927735
Epoch 13
Loss = 2.4319e-01, PNorm = 45.9182, GNorm = 0.4580, lr_0 = 3.9108e-04
Loss = 2.8607e-01, PNorm = 45.9645, GNorm = 0.7914, lr_0 = 3.8443e-04
Loss = 2.2777e-01, PNorm = 45.9871, GNorm = 0.3874, lr_0 = 3.7790e-04
Loss = 2.7019e-01, PNorm = 46.0079, GNorm = 0.3332, lr_0 = 3.7148e-04
Loss = 2.4526e-01, PNorm = 46.0305, GNorm = 0.4062, lr_0 = 3.6517e-04
Validation prc-auc = 0.812844
Validation auc = 0.923723
Epoch 14
Loss = 2.0991e-01, PNorm = 46.0652, GNorm = 0.3169, lr_0 = 3.5897e-04
Loss = 3.0579e-01, PNorm = 46.1071, GNorm = 0.4214, lr_0 = 3.5287e-04
Loss = 2.6496e-01, PNorm = 46.1436, GNorm = 0.3215, lr_0 = 3.4688e-04
Loss = 2.6382e-01, PNorm = 46.1822, GNorm = 0.7656, lr_0 = 3.4099e-04
Loss = 2.4657e-01, PNorm = 46.2064, GNorm = 0.5984, lr_0 = 3.3520e-04
Validation prc-auc = 0.807987
Validation auc = 0.925517
Epoch 15
Loss = 2.4244e-01, PNorm = 46.2372, GNorm = 0.7194, lr_0 = 3.2950e-04
Loss = 2.7010e-01, PNorm = 46.2500, GNorm = 0.6884, lr_0 = 3.2390e-04
Loss = 2.7365e-01, PNorm = 46.2828, GNorm = 0.9854, lr_0 = 3.1840e-04
Loss = 2.7572e-01, PNorm = 46.3024, GNorm = 0.2965, lr_0 = 3.1299e-04
Loss = 2.0468e-01, PNorm = 46.3265, GNorm = 0.5584, lr_0 = 3.0768e-04
Loss = 2.4923e-01, PNorm = 46.3296, GNorm = 0.5491, lr_0 = 3.0715e-04
Validation prc-auc = 0.808364
Validation auc = 0.926933
Epoch 16
Loss = 2.4195e-01, PNorm = 46.3578, GNorm = 0.4908, lr_0 = 3.0193e-04
Loss = 2.4765e-01, PNorm = 46.3906, GNorm = 0.5288, lr_0 = 2.9680e-04
Loss = 2.7967e-01, PNorm = 46.4122, GNorm = 0.6618, lr_0 = 2.9176e-04
Loss = 2.5053e-01, PNorm = 46.4307, GNorm = 0.8956, lr_0 = 2.8681e-04
Validation prc-auc = 0.812272
Validation auc = 0.926862
Epoch 17
Loss = 2.4827e-01, PNorm = 46.4599, GNorm = 0.5751, lr_0 = 2.8193e-04
Loss = 2.6405e-01, PNorm = 46.4844, GNorm = 0.6985, lr_0 = 2.7715e-04
Loss = 2.4663e-01, PNorm = 46.5208, GNorm = 1.0332, lr_0 = 2.7244e-04
Loss = 2.5890e-01, PNorm = 46.5440, GNorm = 0.4520, lr_0 = 2.6781e-04
Loss = 2.2250e-01, PNorm = 46.5613, GNorm = 0.3289, lr_0 = 2.6326e-04
Validation prc-auc = 0.812427
Validation auc = 0.925399
Epoch 18
Loss = 3.4460e-01, PNorm = 46.5822, GNorm = 0.6556, lr_0 = 2.5879e-04
Loss = 2.1528e-01, PNorm = 46.5987, GNorm = 0.4016, lr_0 = 2.5439e-04
Loss = 2.4659e-01, PNorm = 46.6266, GNorm = 0.3068, lr_0 = 2.5007e-04
Loss = 2.2890e-01, PNorm = 46.6544, GNorm = 0.3427, lr_0 = 2.4582e-04
Loss = 2.3448e-01, PNorm = 46.6764, GNorm = 0.5409, lr_0 = 2.4165e-04
Validation prc-auc = 0.806654
Validation auc = 0.925824
Epoch 19
Loss = 2.3016e-01, PNorm = 46.6895, GNorm = 0.4785, lr_0 = 2.3754e-04
Loss = 2.5977e-01, PNorm = 46.7093, GNorm = 0.6611, lr_0 = 2.3351e-04
Loss = 2.4023e-01, PNorm = 46.7235, GNorm = 0.3523, lr_0 = 2.2954e-04
Loss = 2.2882e-01, PNorm = 46.7484, GNorm = 0.5594, lr_0 = 2.2564e-04
Loss = 2.2825e-01, PNorm = 46.7735, GNorm = 0.6633, lr_0 = 2.2181e-04
Validation prc-auc = 0.816188
Validation auc = 0.925352
Epoch 20
Loss = 1.9124e-01, PNorm = 46.7916, GNorm = 0.5174, lr_0 = 2.1804e-04
Loss = 2.2997e-01, PNorm = 46.8116, GNorm = 0.3657, lr_0 = 2.1434e-04
Loss = 2.5852e-01, PNorm = 46.8303, GNorm = 0.6148, lr_0 = 2.1070e-04
Loss = 2.1826e-01, PNorm = 46.8497, GNorm = 0.5236, lr_0 = 2.0712e-04
Loss = 2.5573e-01, PNorm = 46.8697, GNorm = 0.5113, lr_0 = 2.0360e-04
Validation prc-auc = 0.814414
Validation auc = 0.923298
Epoch 21
Loss = 2.6809e-01, PNorm = 46.8863, GNorm = 0.7435, lr_0 = 1.9980e-04
Loss = 2.3821e-01, PNorm = 46.9051, GNorm = 0.4727, lr_0 = 1.9641e-04
Loss = 2.1917e-01, PNorm = 46.9216, GNorm = 0.4826, lr_0 = 1.9307e-04
Loss = 2.0897e-01, PNorm = 46.9426, GNorm = 0.8649, lr_0 = 1.8979e-04
Loss = 2.5041e-01, PNorm = 46.9490, GNorm = 0.4345, lr_0 = 1.8657e-04
Validation prc-auc = 0.813672
Validation auc = 0.922732
Epoch 22
Loss = 2.4867e-01, PNorm = 46.9697, GNorm = 0.4180, lr_0 = 1.8340e-04
Loss = 2.3040e-01, PNorm = 46.9824, GNorm = 0.4727, lr_0 = 1.8028e-04
Loss = 2.1332e-01, PNorm = 47.0007, GNorm = 0.5714, lr_0 = 1.7722e-04
Loss = 2.6129e-01, PNorm = 47.0194, GNorm = 0.4302, lr_0 = 1.7421e-04
Loss = 1.8410e-01, PNorm = 47.0349, GNorm = 0.3822, lr_0 = 1.7125e-04
Validation prc-auc = 0.815744
Validation auc = 0.924573
Epoch 23
Loss = 1.9996e-01, PNorm = 47.0458, GNorm = 0.6801, lr_0 = 1.6834e-04
Loss = 2.5320e-01, PNorm = 47.0658, GNorm = 0.3350, lr_0 = 1.6548e-04
Loss = 2.2496e-01, PNorm = 47.0820, GNorm = 0.4805, lr_0 = 1.6267e-04
Loss = 2.6789e-01, PNorm = 47.0943, GNorm = 0.5110, lr_0 = 1.5991e-04
Loss = 2.1068e-01, PNorm = 47.1073, GNorm = 0.2815, lr_0 = 1.5719e-04
Validation prc-auc = 0.816126
Validation auc = 0.925281
Epoch 24
Loss = 1.8816e-01, PNorm = 47.1221, GNorm = 0.2985, lr_0 = 1.5452e-04
Loss = 1.8974e-01, PNorm = 47.1358, GNorm = 0.5249, lr_0 = 1.5190e-04
Loss = 2.4221e-01, PNorm = 47.1557, GNorm = 0.4514, lr_0 = 1.4932e-04
Loss = 2.4446e-01, PNorm = 47.1676, GNorm = 1.0360, lr_0 = 1.4678e-04
Loss = 2.5406e-01, PNorm = 47.1732, GNorm = 0.5277, lr_0 = 1.4429e-04
Validation prc-auc = 0.813902
Validation auc = 0.923346
Epoch 25
Loss = 2.2492e-01, PNorm = 47.1859, GNorm = 0.3646, lr_0 = 1.4184e-04
Loss = 2.3152e-01, PNorm = 47.1982, GNorm = 0.8308, lr_0 = 1.3943e-04
Loss = 2.1613e-01, PNorm = 47.2123, GNorm = 0.7951, lr_0 = 1.3706e-04
Loss = 2.0987e-01, PNorm = 47.2252, GNorm = 0.5397, lr_0 = 1.3473e-04
Validation prc-auc = 0.813617
Validation auc = 0.923228
Epoch 26
Loss = 1.7719e-01, PNorm = 47.2349, GNorm = 0.3516, lr_0 = 1.3221e-04
Loss = 2.3378e-01, PNorm = 47.2481, GNorm = 1.4939, lr_0 = 1.2997e-04
Loss = 2.2424e-01, PNorm = 47.2569, GNorm = 0.4831, lr_0 = 1.2776e-04
Loss = 2.1083e-01, PNorm = 47.2667, GNorm = 0.5938, lr_0 = 1.2559e-04
Loss = 2.6725e-01, PNorm = 47.2820, GNorm = 0.5508, lr_0 = 1.2346e-04
Validation prc-auc = 0.812054
Validation auc = 0.920938
Epoch 27
Loss = 2.1405e-01, PNorm = 47.2908, GNorm = 0.3855, lr_0 = 1.2136e-04
Loss = 2.1064e-01, PNorm = 47.3033, GNorm = 0.9164, lr_0 = 1.1930e-04
Loss = 2.5296e-01, PNorm = 47.3134, GNorm = 0.7430, lr_0 = 1.1727e-04
Loss = 1.8851e-01, PNorm = 47.3231, GNorm = 0.3146, lr_0 = 1.1528e-04
Loss = 2.2408e-01, PNorm = 47.3340, GNorm = 0.9983, lr_0 = 1.1332e-04
Validation prc-auc = 0.815710
Validation auc = 0.921080
Epoch 28
Loss = 2.0965e-01, PNorm = 47.3439, GNorm = 0.5283, lr_0 = 1.1140e-04
Loss = 2.2050e-01, PNorm = 47.3511, GNorm = 0.7747, lr_0 = 1.0951e-04
Loss = 2.0181e-01, PNorm = 47.3622, GNorm = 0.4065, lr_0 = 1.0765e-04
Loss = 2.2239e-01, PNorm = 47.3710, GNorm = 0.3329, lr_0 = 1.0582e-04
Loss = 2.4369e-01, PNorm = 47.3829, GNorm = 0.5015, lr_0 = 1.0402e-04
Validation prc-auc = 0.811866
Validation auc = 0.919971
Epoch 29
Loss = 2.4901e-01, PNorm = 47.3870, GNorm = 0.9043, lr_0 = 1.0225e-04
Loss = 2.2592e-01, PNorm = 47.3957, GNorm = 0.4462, lr_0 = 1.0052e-04
Loss = 2.3049e-01, PNorm = 47.4039, GNorm = 0.6888, lr_0 = 1.0000e-04
Loss = 1.9574e-01, PNorm = 47.4085, GNorm = 0.3925, lr_0 = 1.0000e-04
Loss = 2.0096e-01, PNorm = 47.4194, GNorm = 0.7996, lr_0 = 1.0000e-04
Validation prc-auc = 0.816502
Validation auc = 0.921458
Model 1 best validation prc-auc = 0.845076 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.816356
Model 1 test auc = 0.886579
Ensemble test prc-auc = 0.810974
Ensemble test auc = 0.883558
Fold 1
Splitting data with seed 1
Total scaffolds = 746 | train scaffolds = 573 | val scaffolds = 68 | test scaffolds = 105
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 144 | target average = 0.041667


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 53 | target average = 0.018868


Scaffold 3
Task 0: count = 52 | target average = 0.019231


Scaffold 4
Task 0: count = 45 | target average = 0.066667


Scaffold 5
Task 0: count = 45 | target average = 0.044444


Scaffold 6
Task 0: count = 44 | target average = 0.068182


Scaffold 7
Task 0: count = 42 | target average = 0.023810


Scaffold 8
Task 0: count = 38 | target average = 0.157895


Scaffold 9
Task 0: count = 36 | target average = 0.000000


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.3453e-01, PNorm = 43.2207, GNorm = 2.3058, lr_0 = 2.0312e-04
Loss = 5.2165e-01, PNorm = 43.2287, GNorm = 1.1099, lr_0 = 2.9687e-04
Loss = 4.6990e-01, PNorm = 43.2486, GNorm = 1.2518, lr_0 = 3.9062e-04
Loss = 4.0091e-01, PNorm = 43.2726, GNorm = 1.4966, lr_0 = 4.8437e-04
Validation prc-auc = 0.862159
Validation auc = 0.897748
Epoch 1
Loss = 3.0288e-01, PNorm = 43.3050, GNorm = 0.5880, lr_0 = 5.8750e-04
Loss = 3.8907e-01, PNorm = 43.3383, GNorm = 2.3459, lr_0 = 6.8125e-04
Loss = 3.6446e-01, PNorm = 43.3798, GNorm = 1.3947, lr_0 = 7.7500e-04
Loss = 3.5909e-01, PNorm = 43.4237, GNorm = 0.9362, lr_0 = 8.6875e-04
Loss = 3.3700e-01, PNorm = 43.4679, GNorm = 1.0137, lr_0 = 9.6250e-04
Validation prc-auc = 0.878940
Validation auc = 0.917169
Epoch 2
Loss = 3.3411e-01, PNorm = 43.5131, GNorm = 0.8693, lr_0 = 9.8977e-04
Loss = 3.5547e-01, PNorm = 43.5637, GNorm = 0.7332, lr_0 = 9.7296e-04
Loss = 3.2278e-01, PNorm = 43.6234, GNorm = 1.1315, lr_0 = 9.5643e-04
Loss = 3.3895e-01, PNorm = 43.6708, GNorm = 0.5741, lr_0 = 9.4019e-04
Loss = 3.0859e-01, PNorm = 43.7121, GNorm = 0.9955, lr_0 = 9.2422e-04
Validation prc-auc = 0.884598
Validation auc = 0.921664
Epoch 3
Loss = 2.9284e-01, PNorm = 43.7460, GNorm = 0.3519, lr_0 = 9.0852e-04
Loss = 3.3977e-01, PNorm = 43.7806, GNorm = 0.3556, lr_0 = 8.9309e-04
Loss = 3.0855e-01, PNorm = 43.8232, GNorm = 1.1035, lr_0 = 8.7791e-04
Loss = 3.4458e-01, PNorm = 43.8593, GNorm = 0.4938, lr_0 = 8.6300e-04
Loss = 3.0849e-01, PNorm = 43.8912, GNorm = 0.3879, lr_0 = 8.4834e-04
Validation prc-auc = 0.886889
Validation auc = 0.923693
Epoch 4
Loss = 2.9957e-01, PNorm = 43.9337, GNorm = 0.3118, lr_0 = 8.3393e-04
Loss = 2.4894e-01, PNorm = 43.9777, GNorm = 0.3703, lr_0 = 8.1977e-04
Loss = 3.1043e-01, PNorm = 44.0086, GNorm = 1.2019, lr_0 = 8.0584e-04
Loss = 3.0139e-01, PNorm = 44.0508, GNorm = 0.9119, lr_0 = 7.9215e-04
Loss = 3.2588e-01, PNorm = 44.0800, GNorm = 0.4909, lr_0 = 7.7870e-04
Validation prc-auc = 0.888391
Validation auc = 0.920485
Epoch 5
Loss = 3.6334e-01, PNorm = 44.0983, GNorm = 0.4819, lr_0 = 7.6547e-04
Loss = 2.8920e-01, PNorm = 44.1329, GNorm = 0.3566, lr_0 = 7.5247e-04
Loss = 3.0851e-01, PNorm = 44.1692, GNorm = 0.5026, lr_0 = 7.3969e-04
Loss = 2.7998e-01, PNorm = 44.1998, GNorm = 0.4631, lr_0 = 7.2712e-04
Loss = 3.1296e-01, PNorm = 44.2417, GNorm = 0.5868, lr_0 = 7.1477e-04
Validation prc-auc = 0.883441
Validation auc = 0.922187
Epoch 6
Loss = 2.7284e-01, PNorm = 44.3075, GNorm = 1.1738, lr_0 = 7.0143e-04
Loss = 3.2064e-01, PNorm = 44.3486, GNorm = 0.8843, lr_0 = 6.8951e-04
Loss = 2.7905e-01, PNorm = 44.3807, GNorm = 0.6896, lr_0 = 6.7780e-04
Loss = 2.7890e-01, PNorm = 44.4233, GNorm = 0.3566, lr_0 = 6.6629e-04
Loss = 3.3138e-01, PNorm = 44.4460, GNorm = 0.4308, lr_0 = 6.5497e-04
Validation prc-auc = 0.889276
Validation auc = 0.924893
Epoch 7
Loss = 2.8787e-01, PNorm = 44.4731, GNorm = 0.4091, lr_0 = 6.4384e-04
Loss = 2.7076e-01, PNorm = 44.5095, GNorm = 1.0617, lr_0 = 6.3291e-04
Loss = 2.6608e-01, PNorm = 44.5521, GNorm = 0.6086, lr_0 = 6.2216e-04
Loss = 3.2225e-01, PNorm = 44.5967, GNorm = 0.9539, lr_0 = 6.1159e-04
Loss = 2.8541e-01, PNorm = 44.6242, GNorm = 0.4010, lr_0 = 6.0120e-04
Validation prc-auc = 0.892914
Validation auc = 0.928035
Epoch 8
Loss = 2.9506e-01, PNorm = 44.6496, GNorm = 0.2847, lr_0 = 5.9099e-04
Loss = 2.7437e-01, PNorm = 44.6902, GNorm = 0.4212, lr_0 = 5.8095e-04
Loss = 2.8320e-01, PNorm = 44.7310, GNorm = 0.3992, lr_0 = 5.7108e-04
Loss = 3.2247e-01, PNorm = 44.7628, GNorm = 0.7734, lr_0 = 5.6138e-04
Validation prc-auc = 0.888733
Validation auc = 0.926202
Epoch 9
Loss = 2.8701e-01, PNorm = 44.8106, GNorm = 0.3503, lr_0 = 5.5184e-04
Loss = 2.8935e-01, PNorm = 44.8562, GNorm = 1.0373, lr_0 = 5.4247e-04
Loss = 2.7513e-01, PNorm = 44.8796, GNorm = 0.5300, lr_0 = 5.3325e-04
Loss = 2.9986e-01, PNorm = 44.9264, GNorm = 0.6327, lr_0 = 5.2420e-04
Loss = 3.2893e-01, PNorm = 44.9684, GNorm = 0.5525, lr_0 = 5.1529e-04
Validation prc-auc = 0.890140
Validation auc = 0.927992
Epoch 10
Loss = 2.5669e-01, PNorm = 44.9935, GNorm = 0.4489, lr_0 = 5.0654e-04
Loss = 3.2651e-01, PNorm = 45.0317, GNorm = 1.1556, lr_0 = 4.9793e-04
Loss = 2.6657e-01, PNorm = 45.0668, GNorm = 0.4932, lr_0 = 4.8948e-04
Loss = 2.5515e-01, PNorm = 45.1054, GNorm = 0.3859, lr_0 = 4.8116e-04
Loss = 2.7235e-01, PNorm = 45.1518, GNorm = 0.6710, lr_0 = 4.7299e-04
Validation prc-auc = 0.893471
Validation auc = 0.929257
Epoch 11
Loss = 2.9071e-01, PNorm = 45.1905, GNorm = 0.8488, lr_0 = 4.6416e-04
Loss = 2.8969e-01, PNorm = 45.2336, GNorm = 0.4778, lr_0 = 4.5627e-04
Loss = 2.9454e-01, PNorm = 45.2602, GNorm = 0.5041, lr_0 = 4.4852e-04
Loss = 2.5126e-01, PNorm = 45.3012, GNorm = 0.4796, lr_0 = 4.4091e-04
Loss = 2.3752e-01, PNorm = 45.3443, GNorm = 0.4025, lr_0 = 4.3342e-04
Validation prc-auc = 0.896189
Validation auc = 0.930283
Epoch 12
Loss = 2.5704e-01, PNorm = 45.3857, GNorm = 0.5495, lr_0 = 4.2605e-04
Loss = 2.6827e-01, PNorm = 45.4221, GNorm = 0.5158, lr_0 = 4.1882e-04
Loss = 2.8101e-01, PNorm = 45.4543, GNorm = 0.2901, lr_0 = 4.1170e-04
Loss = 3.0739e-01, PNorm = 45.4965, GNorm = 0.7940, lr_0 = 4.0471e-04
Loss = 2.4024e-01, PNorm = 45.5101, GNorm = 0.4992, lr_0 = 3.9783e-04
Validation prc-auc = 0.894079
Validation auc = 0.929825
Epoch 13
Loss = 2.9731e-01, PNorm = 45.5580, GNorm = 0.4426, lr_0 = 3.9108e-04
Loss = 2.7031e-01, PNorm = 45.5867, GNorm = 1.0045, lr_0 = 3.8443e-04
Loss = 2.2833e-01, PNorm = 45.6258, GNorm = 0.3755, lr_0 = 3.7790e-04
Loss = 2.5076e-01, PNorm = 45.6586, GNorm = 0.6748, lr_0 = 3.7148e-04
Loss = 2.9589e-01, PNorm = 45.6887, GNorm = 0.7065, lr_0 = 3.6517e-04
Validation prc-auc = 0.898763
Validation auc = 0.933229
Epoch 14
Loss = 2.9120e-01, PNorm = 45.7066, GNorm = 0.4265, lr_0 = 3.5897e-04
Loss = 2.5326e-01, PNorm = 45.7365, GNorm = 0.6175, lr_0 = 3.5287e-04
Loss = 2.7446e-01, PNorm = 45.7697, GNorm = 0.5913, lr_0 = 3.4688e-04
Loss = 2.4019e-01, PNorm = 45.8024, GNorm = 0.4957, lr_0 = 3.4099e-04
Loss = 2.7155e-01, PNorm = 45.8459, GNorm = 0.3345, lr_0 = 3.3520e-04
Validation prc-auc = 0.894529
Validation auc = 0.930566
Epoch 15
Loss = 2.8752e-01, PNorm = 45.8662, GNorm = 1.0461, lr_0 = 3.2950e-04
Loss = 2.2941e-01, PNorm = 45.9037, GNorm = 0.4511, lr_0 = 3.2390e-04
Loss = 2.7509e-01, PNorm = 45.9253, GNorm = 0.5257, lr_0 = 3.1840e-04
Loss = 2.6176e-01, PNorm = 45.9607, GNorm = 0.5953, lr_0 = 3.1299e-04
Loss = 2.3414e-01, PNorm = 45.9900, GNorm = 0.6299, lr_0 = 3.0768e-04
Loss = 2.5579e-01, PNorm = 45.9941, GNorm = 0.9829, lr_0 = 3.0715e-04
Validation prc-auc = 0.896914
Validation auc = 0.932312
Epoch 16
Loss = 2.2097e-01, PNorm = 46.0295, GNorm = 0.4147, lr_0 = 3.0193e-04
Loss = 2.4455e-01, PNorm = 46.0423, GNorm = 0.3644, lr_0 = 2.9680e-04
Loss = 2.6109e-01, PNorm = 46.0692, GNorm = 0.5906, lr_0 = 2.9176e-04
Loss = 2.8141e-01, PNorm = 46.1013, GNorm = 0.6955, lr_0 = 2.8681e-04
Validation prc-auc = 0.898113
Validation auc = 0.932050
Epoch 17
Loss = 3.7668e-01, PNorm = 46.1149, GNorm = 0.6613, lr_0 = 2.8193e-04
Loss = 2.2946e-01, PNorm = 46.1415, GNorm = 1.2100, lr_0 = 2.7715e-04
Loss = 2.2281e-01, PNorm = 46.1698, GNorm = 0.5121, lr_0 = 2.7244e-04
Loss = 3.2570e-01, PNorm = 46.1975, GNorm = 0.9358, lr_0 = 2.6781e-04
Loss = 2.4882e-01, PNorm = 46.2156, GNorm = 0.3425, lr_0 = 2.6326e-04
Validation prc-auc = 0.898471
Validation auc = 0.932814
Epoch 18
Loss = 3.3196e-01, PNorm = 46.2451, GNorm = 0.7794, lr_0 = 2.5879e-04
Loss = 2.7020e-01, PNorm = 46.2695, GNorm = 0.3771, lr_0 = 2.5439e-04
Loss = 2.4528e-01, PNorm = 46.2887, GNorm = 0.3995, lr_0 = 2.5007e-04
Loss = 2.2797e-01, PNorm = 46.3070, GNorm = 0.5170, lr_0 = 2.4582e-04
Loss = 2.5990e-01, PNorm = 46.3433, GNorm = 0.4763, lr_0 = 2.4165e-04
Validation prc-auc = 0.901528
Validation auc = 0.934101
Epoch 19
Loss = 2.9860e-01, PNorm = 46.3609, GNorm = 1.2226, lr_0 = 2.3754e-04
Loss = 2.1991e-01, PNorm = 46.3863, GNorm = 0.7353, lr_0 = 2.3351e-04
Loss = 2.6017e-01, PNorm = 46.4105, GNorm = 0.3076, lr_0 = 2.2954e-04
Loss = 2.3908e-01, PNorm = 46.4252, GNorm = 0.9790, lr_0 = 2.2564e-04
Loss = 2.6410e-01, PNorm = 46.4515, GNorm = 0.5700, lr_0 = 2.2181e-04
Validation prc-auc = 0.889740
Validation auc = 0.924457
Epoch 20
Loss = 2.2971e-01, PNorm = 46.4639, GNorm = 0.8888, lr_0 = 2.1804e-04
Loss = 2.8094e-01, PNorm = 46.4832, GNorm = 0.5005, lr_0 = 2.1434e-04
Loss = 2.1314e-01, PNorm = 46.5036, GNorm = 0.7409, lr_0 = 2.1070e-04
Loss = 2.5240e-01, PNorm = 46.5245, GNorm = 0.7184, lr_0 = 2.0712e-04
Loss = 2.1496e-01, PNorm = 46.5451, GNorm = 0.5155, lr_0 = 2.0360e-04
Validation prc-auc = 0.892739
Validation auc = 0.927162
Epoch 21
Loss = 2.6776e-01, PNorm = 46.5669, GNorm = 0.5864, lr_0 = 1.9980e-04
Loss = 2.9684e-01, PNorm = 46.5782, GNorm = 0.7882, lr_0 = 1.9641e-04
Loss = 2.5955e-01, PNorm = 46.5982, GNorm = 0.4157, lr_0 = 1.9307e-04
Loss = 2.0653e-01, PNorm = 46.6189, GNorm = 0.5333, lr_0 = 1.8979e-04
Loss = 2.1983e-01, PNorm = 46.6382, GNorm = 0.5788, lr_0 = 1.8657e-04
Validation prc-auc = 0.898690
Validation auc = 0.930392
Epoch 22
Loss = 2.0149e-01, PNorm = 46.6617, GNorm = 0.4067, lr_0 = 1.8340e-04
Loss = 2.4248e-01, PNorm = 46.6857, GNorm = 0.9069, lr_0 = 1.8028e-04
Loss = 2.4480e-01, PNorm = 46.6907, GNorm = 0.4031, lr_0 = 1.7722e-04
Loss = 2.7058e-01, PNorm = 46.7114, GNorm = 0.8596, lr_0 = 1.7421e-04
Loss = 2.2783e-01, PNorm = 46.7240, GNorm = 0.3692, lr_0 = 1.7125e-04
Validation prc-auc = 0.901590
Validation auc = 0.931788
Epoch 23
Loss = 2.5501e-01, PNorm = 46.7388, GNorm = 0.6470, lr_0 = 1.6834e-04
Loss = 2.2591e-01, PNorm = 46.7543, GNorm = 0.5302, lr_0 = 1.6548e-04
Loss = 2.5087e-01, PNorm = 46.7689, GNorm = 0.9115, lr_0 = 1.6267e-04
Loss = 2.3546e-01, PNorm = 46.7844, GNorm = 0.3263, lr_0 = 1.5991e-04
Loss = 2.6811e-01, PNorm = 46.7996, GNorm = 0.8239, lr_0 = 1.5719e-04
Validation prc-auc = 0.903788
Validation auc = 0.932661
Epoch 24
Loss = 2.0842e-01, PNorm = 46.8134, GNorm = 0.5507, lr_0 = 1.5452e-04
Loss = 2.5205e-01, PNorm = 46.8287, GNorm = 0.6388, lr_0 = 1.5190e-04
Loss = 2.0618e-01, PNorm = 46.8449, GNorm = 0.3422, lr_0 = 1.4932e-04
Loss = 2.3997e-01, PNorm = 46.8593, GNorm = 0.5577, lr_0 = 1.4678e-04
Loss = 2.7006e-01, PNorm = 46.8711, GNorm = 0.5824, lr_0 = 1.4429e-04
Validation prc-auc = 0.899183
Validation auc = 0.927162
Epoch 25
Loss = 2.2595e-01, PNorm = 46.8832, GNorm = 0.4320, lr_0 = 1.4184e-04
Loss = 2.2000e-01, PNorm = 46.8902, GNorm = 0.6534, lr_0 = 1.3943e-04
Loss = 2.5209e-01, PNorm = 46.9072, GNorm = 0.6644, lr_0 = 1.3706e-04
Loss = 2.7025e-01, PNorm = 46.9087, GNorm = 0.3678, lr_0 = 1.3473e-04
Validation prc-auc = 0.904194
Validation auc = 0.933054
Epoch 26
Loss = 1.6243e-01, PNorm = 46.9274, GNorm = 0.4664, lr_0 = 1.3221e-04
Loss = 2.1610e-01, PNorm = 46.9452, GNorm = 0.6425, lr_0 = 1.2997e-04
Loss = 2.4468e-01, PNorm = 46.9528, GNorm = 0.5579, lr_0 = 1.2776e-04
Loss = 2.3147e-01, PNorm = 46.9649, GNorm = 0.7235, lr_0 = 1.2559e-04
Loss = 2.2151e-01, PNorm = 46.9794, GNorm = 0.6296, lr_0 = 1.2346e-04
Validation prc-auc = 0.899975
Validation auc = 0.929257
Epoch 27
Loss = 3.0341e-01, PNorm = 46.9863, GNorm = 0.6023, lr_0 = 1.2136e-04
Loss = 2.2537e-01, PNorm = 47.0006, GNorm = 0.7716, lr_0 = 1.1930e-04
Loss = 2.1462e-01, PNorm = 47.0129, GNorm = 0.4966, lr_0 = 1.1727e-04
Loss = 2.1178e-01, PNorm = 47.0232, GNorm = 0.5608, lr_0 = 1.1528e-04
Loss = 2.1684e-01, PNorm = 47.0309, GNorm = 0.5537, lr_0 = 1.1332e-04
Validation prc-auc = 0.901477
Validation auc = 0.930065
Epoch 28
Loss = 3.0750e-01, PNorm = 47.0410, GNorm = 0.5082, lr_0 = 1.1140e-04
Loss = 2.2732e-01, PNorm = 47.0479, GNorm = 0.4056, lr_0 = 1.0951e-04
Loss = 1.9448e-01, PNorm = 47.0547, GNorm = 0.3619, lr_0 = 1.0765e-04
Loss = 2.2526e-01, PNorm = 47.0696, GNorm = 0.8234, lr_0 = 1.0582e-04
Loss = 2.4371e-01, PNorm = 47.0791, GNorm = 0.9190, lr_0 = 1.0402e-04
Validation prc-auc = 0.902850
Validation auc = 0.931614
Epoch 29
Loss = 2.2395e-01, PNorm = 47.0831, GNorm = 0.4715, lr_0 = 1.0225e-04
Loss = 2.0907e-01, PNorm = 47.0952, GNorm = 0.6105, lr_0 = 1.0052e-04
Loss = 2.7357e-01, PNorm = 47.1078, GNorm = 0.9192, lr_0 = 1.0000e-04
Loss = 2.3865e-01, PNorm = 47.1113, GNorm = 0.5387, lr_0 = 1.0000e-04
Loss = 2.0041e-01, PNorm = 47.1173, GNorm = 0.4885, lr_0 = 1.0000e-04
Validation prc-auc = 0.905325
Validation auc = 0.933534
Model 0 best validation prc-auc = 0.905325 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.903145
Model 0 test auc = 0.904195
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.4628e-01, PNorm = 43.2432, GNorm = 1.0440, lr_0 = 2.0312e-04
Loss = 5.1994e-01, PNorm = 43.2523, GNorm = 2.3145, lr_0 = 2.9687e-04
Loss = 4.3898e-01, PNorm = 43.2717, GNorm = 0.9451, lr_0 = 3.9062e-04
Loss = 4.2401e-01, PNorm = 43.3001, GNorm = 1.3672, lr_0 = 4.8437e-04
Validation prc-auc = 0.854811
Validation auc = 0.899581
Epoch 1
Loss = 4.0144e-01, PNorm = 43.3321, GNorm = 1.0853, lr_0 = 5.8750e-04
Loss = 3.7946e-01, PNorm = 43.3603, GNorm = 0.6486, lr_0 = 6.8125e-04
Loss = 3.7945e-01, PNorm = 43.3911, GNorm = 0.4188, lr_0 = 7.7500e-04
Loss = 3.0515e-01, PNorm = 43.4389, GNorm = 0.6284, lr_0 = 8.6875e-04
Loss = 3.6673e-01, PNorm = 43.4797, GNorm = 0.4997, lr_0 = 9.6250e-04
Validation prc-auc = 0.879295
Validation auc = 0.913546
Epoch 2
Loss = 3.5440e-01, PNorm = 43.5253, GNorm = 0.9561, lr_0 = 9.8977e-04
Loss = 3.4765e-01, PNorm = 43.5648, GNorm = 0.9326, lr_0 = 9.7296e-04
Loss = 2.9055e-01, PNorm = 43.6075, GNorm = 1.2739, lr_0 = 9.5643e-04
Loss = 3.1980e-01, PNorm = 43.6446, GNorm = 0.3628, lr_0 = 9.4019e-04
Loss = 3.3127e-01, PNorm = 43.6712, GNorm = 1.2281, lr_0 = 9.2422e-04
Validation prc-auc = 0.880836
Validation auc = 0.918216
Epoch 3
Loss = 2.9048e-01, PNorm = 43.7041, GNorm = 0.6282, lr_0 = 9.0852e-04
Loss = 2.8992e-01, PNorm = 43.7410, GNorm = 0.7402, lr_0 = 8.9309e-04
Loss = 3.4649e-01, PNorm = 43.7864, GNorm = 1.4249, lr_0 = 8.7791e-04
Loss = 3.1473e-01, PNorm = 43.8185, GNorm = 0.3351, lr_0 = 8.6300e-04
Loss = 3.3228e-01, PNorm = 43.8542, GNorm = 0.3557, lr_0 = 8.4834e-04
Validation prc-auc = 0.886389
Validation auc = 0.920202
Epoch 4
Loss = 2.8398e-01, PNorm = 43.8944, GNorm = 0.4106, lr_0 = 8.3393e-04
Loss = 2.8277e-01, PNorm = 43.9335, GNorm = 0.6203, lr_0 = 8.1977e-04
Loss = 3.2989e-01, PNorm = 43.9652, GNorm = 1.6666, lr_0 = 8.0584e-04
Loss = 3.1191e-01, PNorm = 43.9912, GNorm = 0.4400, lr_0 = 7.9215e-04
Loss = 3.0712e-01, PNorm = 44.0277, GNorm = 0.4933, lr_0 = 7.7870e-04
Validation prc-auc = 0.888957
Validation auc = 0.921533
Epoch 5
Loss = 2.9272e-01, PNorm = 44.0586, GNorm = 0.7456, lr_0 = 7.6547e-04
Loss = 3.1563e-01, PNorm = 44.0916, GNorm = 0.9781, lr_0 = 7.5247e-04
Loss = 2.6544e-01, PNorm = 44.1381, GNorm = 0.6571, lr_0 = 7.3969e-04
Loss = 3.0225e-01, PNorm = 44.1767, GNorm = 0.4020, lr_0 = 7.2712e-04
Loss = 3.2168e-01, PNorm = 44.2181, GNorm = 0.5982, lr_0 = 7.1477e-04
Validation prc-auc = 0.890797
Validation auc = 0.924849
Epoch 6
Loss = 2.5808e-01, PNorm = 44.2687, GNorm = 0.3026, lr_0 = 7.0143e-04
Loss = 2.8008e-01, PNorm = 44.3210, GNorm = 0.7434, lr_0 = 6.8951e-04
Loss = 2.7522e-01, PNorm = 44.3617, GNorm = 0.2698, lr_0 = 6.7780e-04
Loss = 2.9699e-01, PNorm = 44.3994, GNorm = 0.4981, lr_0 = 6.6629e-04
Loss = 3.2543e-01, PNorm = 44.4249, GNorm = 0.4578, lr_0 = 6.5497e-04
Validation prc-auc = 0.889177
Validation auc = 0.923933
Epoch 7
Loss = 3.0679e-01, PNorm = 44.4599, GNorm = 0.9328, lr_0 = 6.4384e-04
Loss = 2.9868e-01, PNorm = 44.5099, GNorm = 0.3707, lr_0 = 6.3291e-04
Loss = 3.1312e-01, PNorm = 44.5568, GNorm = 0.3548, lr_0 = 6.2216e-04
Loss = 2.3377e-01, PNorm = 44.6088, GNorm = 0.3323, lr_0 = 6.1159e-04
Loss = 3.1029e-01, PNorm = 44.6440, GNorm = 0.5474, lr_0 = 6.0120e-04
Validation prc-auc = 0.893427
Validation auc = 0.925940
Epoch 8
Loss = 2.7990e-01, PNorm = 44.6920, GNorm = 0.4553, lr_0 = 5.9099e-04
Loss = 2.8848e-01, PNorm = 44.7208, GNorm = 0.4704, lr_0 = 5.8095e-04
Loss = 3.2037e-01, PNorm = 44.7531, GNorm = 0.8594, lr_0 = 5.7108e-04
Loss = 2.8856e-01, PNorm = 44.7917, GNorm = 0.3019, lr_0 = 5.6138e-04
Validation prc-auc = 0.874817
Validation auc = 0.921402
Epoch 9
Loss = 3.8775e-01, PNorm = 44.8558, GNorm = 0.9382, lr_0 = 5.5184e-04
Loss = 2.7126e-01, PNorm = 44.9001, GNorm = 0.5240, lr_0 = 5.4247e-04
Loss = 3.0276e-01, PNorm = 44.9398, GNorm = 0.8579, lr_0 = 5.3325e-04
Loss = 2.2449e-01, PNorm = 44.9943, GNorm = 1.0837, lr_0 = 5.2420e-04
Loss = 3.4608e-01, PNorm = 45.0114, GNorm = 0.4326, lr_0 = 5.1529e-04
Validation prc-auc = 0.893832
Validation auc = 0.926377
Epoch 10
Loss = 4.1088e-01, PNorm = 45.0252, GNorm = 0.8195, lr_0 = 5.0654e-04
Loss = 2.6541e-01, PNorm = 45.0592, GNorm = 0.3369, lr_0 = 4.9793e-04
Loss = 2.7017e-01, PNorm = 45.1013, GNorm = 0.7074, lr_0 = 4.8948e-04
Loss = 2.7554e-01, PNorm = 45.1322, GNorm = 0.6427, lr_0 = 4.8116e-04
Loss = 2.8587e-01, PNorm = 45.1614, GNorm = 0.3780, lr_0 = 4.7299e-04
Validation prc-auc = 0.896653
Validation auc = 0.928232
Epoch 11
Loss = 2.0168e-01, PNorm = 45.1940, GNorm = 0.4429, lr_0 = 4.6416e-04
Loss = 2.6743e-01, PNorm = 45.2397, GNorm = 0.7020, lr_0 = 4.5627e-04
Loss = 2.7743e-01, PNorm = 45.2763, GNorm = 0.2665, lr_0 = 4.4852e-04
Loss = 2.6011e-01, PNorm = 45.3079, GNorm = 1.2498, lr_0 = 4.4091e-04
Loss = 3.0010e-01, PNorm = 45.3369, GNorm = 0.3538, lr_0 = 4.3342e-04
Validation prc-auc = 0.893769
Validation auc = 0.926290
Epoch 12
Loss = 3.6167e-01, PNorm = 45.3637, GNorm = 0.3848, lr_0 = 4.2605e-04
Loss = 2.7389e-01, PNorm = 45.3882, GNorm = 0.8605, lr_0 = 4.1882e-04
Loss = 2.1269e-01, PNorm = 45.4255, GNorm = 0.4823, lr_0 = 4.1170e-04
Loss = 2.7458e-01, PNorm = 45.4621, GNorm = 0.4767, lr_0 = 4.0471e-04
Loss = 2.5756e-01, PNorm = 45.4998, GNorm = 0.4130, lr_0 = 3.9783e-04
Validation prc-auc = 0.897584
Validation auc = 0.929388
Epoch 13
Loss = 2.2544e-01, PNorm = 45.5425, GNorm = 0.4104, lr_0 = 3.9108e-04
Loss = 2.9756e-01, PNorm = 45.5710, GNorm = 0.4134, lr_0 = 3.8443e-04
Loss = 2.8671e-01, PNorm = 45.5946, GNorm = 1.0708, lr_0 = 3.7790e-04
Loss = 2.3905e-01, PNorm = 45.6410, GNorm = 0.6378, lr_0 = 3.7148e-04
Loss = 2.7090e-01, PNorm = 45.6720, GNorm = 0.4818, lr_0 = 3.6517e-04
Validation prc-auc = 0.893865
Validation auc = 0.927817
Epoch 14
Loss = 2.3531e-01, PNorm = 45.7100, GNorm = 0.7373, lr_0 = 3.5897e-04
Loss = 2.8071e-01, PNorm = 45.7429, GNorm = 0.6608, lr_0 = 3.5287e-04
Loss = 2.9812e-01, PNorm = 45.7650, GNorm = 0.5613, lr_0 = 3.4688e-04
Loss = 2.4391e-01, PNorm = 45.7964, GNorm = 0.4076, lr_0 = 3.4099e-04
Loss = 2.5853e-01, PNorm = 45.8234, GNorm = 0.3628, lr_0 = 3.3520e-04
Validation prc-auc = 0.893465
Validation auc = 0.927861
Epoch 15
Loss = 2.5198e-01, PNorm = 45.8588, GNorm = 0.3236, lr_0 = 3.2950e-04
Loss = 2.5147e-01, PNorm = 45.8786, GNorm = 0.6947, lr_0 = 3.2390e-04
Loss = 2.2092e-01, PNorm = 45.9122, GNorm = 0.4403, lr_0 = 3.1840e-04
Loss = 3.0945e-01, PNorm = 45.9450, GNorm = 0.6973, lr_0 = 3.1299e-04
Loss = 2.7674e-01, PNorm = 45.9518, GNorm = 0.5846, lr_0 = 3.0768e-04
Loss = 2.3527e-01, PNorm = 45.9543, GNorm = 0.5250, lr_0 = 3.0715e-04
Validation prc-auc = 0.893576
Validation auc = 0.928603
Epoch 16
Loss = 2.6836e-01, PNorm = 45.9929, GNorm = 0.9505, lr_0 = 3.0193e-04
Loss = 2.5320e-01, PNorm = 46.0205, GNorm = 1.0405, lr_0 = 2.9680e-04
Loss = 2.4818e-01, PNorm = 46.0511, GNorm = 0.6663, lr_0 = 2.9176e-04
Loss = 2.6406e-01, PNorm = 46.0789, GNorm = 0.3398, lr_0 = 2.8681e-04
Validation prc-auc = 0.895941
Validation auc = 0.931330
Epoch 17
Loss = 2.0415e-01, PNorm = 46.1030, GNorm = 0.4142, lr_0 = 2.8193e-04
Loss = 2.2425e-01, PNorm = 46.1333, GNorm = 0.4383, lr_0 = 2.7715e-04
Loss = 2.6527e-01, PNorm = 46.1591, GNorm = 0.3391, lr_0 = 2.7244e-04
Loss = 2.2848e-01, PNorm = 46.1814, GNorm = 0.3037, lr_0 = 2.6781e-04
Loss = 2.8212e-01, PNorm = 46.2087, GNorm = 0.3307, lr_0 = 2.6326e-04
Validation prc-auc = 0.891112
Validation auc = 0.926901
Epoch 18
Loss = 3.4153e-01, PNorm = 46.2161, GNorm = 0.3760, lr_0 = 2.5879e-04
Loss = 2.4669e-01, PNorm = 46.2380, GNorm = 1.0864, lr_0 = 2.5439e-04
Loss = 2.2341e-01, PNorm = 46.2608, GNorm = 0.3219, lr_0 = 2.5007e-04
Loss = 2.6981e-01, PNorm = 46.2945, GNorm = 0.3291, lr_0 = 2.4582e-04
Loss = 2.8100e-01, PNorm = 46.3090, GNorm = 1.0813, lr_0 = 2.4165e-04
Validation prc-auc = 0.894454
Validation auc = 0.932836
Epoch 19
Loss = 2.3226e-01, PNorm = 46.3326, GNorm = 0.4426, lr_0 = 2.3754e-04
Loss = 2.2611e-01, PNorm = 46.3520, GNorm = 0.4670, lr_0 = 2.3351e-04
Loss = 2.2637e-01, PNorm = 46.3781, GNorm = 0.9309, lr_0 = 2.2954e-04
Loss = 2.9013e-01, PNorm = 46.4005, GNorm = 0.5205, lr_0 = 2.2564e-04
Loss = 2.8852e-01, PNorm = 46.4089, GNorm = 0.3841, lr_0 = 2.2181e-04
Validation prc-auc = 0.896210
Validation auc = 0.931527
Epoch 20
Loss = 2.5161e-01, PNorm = 46.4285, GNorm = 0.6453, lr_0 = 2.1804e-04
Loss = 2.4907e-01, PNorm = 46.4489, GNorm = 0.6494, lr_0 = 2.1434e-04
Loss = 2.5792e-01, PNorm = 46.4664, GNorm = 0.5130, lr_0 = 2.1070e-04
Loss = 2.2764e-01, PNorm = 46.4861, GNorm = 0.5642, lr_0 = 2.0712e-04
Loss = 2.3324e-01, PNorm = 46.5082, GNorm = 0.5267, lr_0 = 2.0360e-04
Validation prc-auc = 0.887085
Validation auc = 0.926333
Epoch 21
Loss = 2.6906e-01, PNorm = 46.5229, GNorm = 0.7296, lr_0 = 1.9980e-04
Loss = 2.4506e-01, PNorm = 46.5381, GNorm = 1.1623, lr_0 = 1.9641e-04
Loss = 2.1827e-01, PNorm = 46.5606, GNorm = 0.3740, lr_0 = 1.9307e-04
Loss = 2.5269e-01, PNorm = 46.5780, GNorm = 0.5047, lr_0 = 1.8979e-04
Loss = 2.2392e-01, PNorm = 46.5971, GNorm = 0.5432, lr_0 = 1.8657e-04
Validation prc-auc = 0.891527
Validation auc = 0.929912
Epoch 22
Loss = 2.0987e-01, PNorm = 46.6201, GNorm = 0.4879, lr_0 = 1.8340e-04
Loss = 2.4958e-01, PNorm = 46.6389, GNorm = 0.7590, lr_0 = 1.8028e-04
Loss = 2.3510e-01, PNorm = 46.6585, GNorm = 0.7464, lr_0 = 1.7722e-04
Loss = 2.2740e-01, PNorm = 46.6674, GNorm = 1.0085, lr_0 = 1.7421e-04
Loss = 2.9934e-01, PNorm = 46.6944, GNorm = 0.7130, lr_0 = 1.7125e-04
Validation prc-auc = 0.893759
Validation auc = 0.930152
Epoch 23
Loss = 2.6146e-01, PNorm = 46.6934, GNorm = 0.6164, lr_0 = 1.6834e-04
Loss = 2.3559e-01, PNorm = 46.7160, GNorm = 0.3376, lr_0 = 1.6548e-04
Loss = 2.3740e-01, PNorm = 46.7365, GNorm = 0.8353, lr_0 = 1.6267e-04
Loss = 2.7022e-01, PNorm = 46.7508, GNorm = 0.7466, lr_0 = 1.5991e-04
Loss = 2.1627e-01, PNorm = 46.7702, GNorm = 0.6334, lr_0 = 1.5719e-04
Validation prc-auc = 0.893199
Validation auc = 0.929999
Epoch 24
Loss = 2.6848e-01, PNorm = 46.7777, GNorm = 0.7017, lr_0 = 1.5452e-04
Loss = 2.5046e-01, PNorm = 46.7932, GNorm = 0.3843, lr_0 = 1.5190e-04
Loss = 2.5122e-01, PNorm = 46.8112, GNorm = 0.4637, lr_0 = 1.4932e-04
Loss = 2.1133e-01, PNorm = 46.8230, GNorm = 0.3600, lr_0 = 1.4678e-04
Loss = 2.1945e-01, PNorm = 46.8358, GNorm = 0.8687, lr_0 = 1.4429e-04
Validation prc-auc = 0.892491
Validation auc = 0.930086
Epoch 25
Loss = 2.1593e-01, PNorm = 46.8527, GNorm = 0.7901, lr_0 = 1.4184e-04
Loss = 2.2775e-01, PNorm = 46.8586, GNorm = 0.9810, lr_0 = 1.3943e-04
Loss = 2.1869e-01, PNorm = 46.8672, GNorm = 0.5971, lr_0 = 1.3706e-04
Loss = 2.6085e-01, PNorm = 46.8844, GNorm = 0.5647, lr_0 = 1.3473e-04
Validation prc-auc = 0.893861
Validation auc = 0.930174
Epoch 26
Loss = 2.7738e-01, PNorm = 46.8923, GNorm = 1.1335, lr_0 = 1.3221e-04
Loss = 2.3928e-01, PNorm = 46.9081, GNorm = 0.4564, lr_0 = 1.2997e-04
Loss = 2.2752e-01, PNorm = 46.9202, GNorm = 0.5177, lr_0 = 1.2776e-04
Loss = 1.9968e-01, PNorm = 46.9275, GNorm = 0.9022, lr_0 = 1.2559e-04
Loss = 2.5363e-01, PNorm = 46.9460, GNorm = 0.5283, lr_0 = 1.2346e-04
Validation prc-auc = 0.892602
Validation auc = 0.929039
Epoch 27
Loss = 2.4676e-01, PNorm = 46.9538, GNorm = 0.3779, lr_0 = 1.2136e-04
Loss = 2.4260e-01, PNorm = 46.9693, GNorm = 0.5018, lr_0 = 1.1930e-04
Loss = 2.5126e-01, PNorm = 46.9753, GNorm = 0.5013, lr_0 = 1.1727e-04
Loss = 1.9410e-01, PNorm = 46.9857, GNorm = 0.3621, lr_0 = 1.1528e-04
Loss = 2.3370e-01, PNorm = 46.9991, GNorm = 0.5544, lr_0 = 1.1332e-04
Validation prc-auc = 0.893776
Validation auc = 0.929039
Epoch 28
Loss = 2.1936e-01, PNorm = 47.0095, GNorm = 0.6489, lr_0 = 1.1140e-04
Loss = 2.5909e-01, PNorm = 47.0211, GNorm = 0.6470, lr_0 = 1.0951e-04
Loss = 2.0529e-01, PNorm = 47.0290, GNorm = 0.3737, lr_0 = 1.0765e-04
Loss = 2.2420e-01, PNorm = 47.0355, GNorm = 0.4513, lr_0 = 1.0582e-04
Loss = 2.0676e-01, PNorm = 47.0486, GNorm = 0.8546, lr_0 = 1.0402e-04
Validation prc-auc = 0.894737
Validation auc = 0.930130
Epoch 29
Loss = 2.0442e-01, PNorm = 47.0636, GNorm = 1.0445, lr_0 = 1.0225e-04
Loss = 2.3209e-01, PNorm = 47.0697, GNorm = 0.5650, lr_0 = 1.0052e-04
Loss = 2.0722e-01, PNorm = 47.0782, GNorm = 0.5946, lr_0 = 1.0000e-04
Loss = 2.3150e-01, PNorm = 47.0876, GNorm = 0.4799, lr_0 = 1.0000e-04
Loss = 2.2780e-01, PNorm = 47.0953, GNorm = 0.5282, lr_0 = 1.0000e-04
Validation prc-auc = 0.892745
Validation auc = 0.928297
Model 1 best validation prc-auc = 0.897584 on epoch 12
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.910864
Model 1 test auc = 0.908433
Ensemble test prc-auc = 0.909869
Ensemble test auc = 0.909118
Fold 2
Splitting data with seed 2
Total scaffolds = 746 | train scaffolds = 620 | val scaffolds = 33 | test scaffolds = 93
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 144 | target average = 0.041667


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 53 | target average = 0.018868


Scaffold 3
Task 0: count = 52 | target average = 0.019231


Scaffold 4
Task 0: count = 45 | target average = 0.044444


Scaffold 5
Task 0: count = 45 | target average = 0.066667


Scaffold 6
Task 0: count = 44 | target average = 0.068182


Scaffold 7
Task 0: count = 42 | target average = 0.023810


Scaffold 8
Task 0: count = 38 | target average = 0.157895


Scaffold 9
Task 0: count = 36 | target average = 0.000000


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.5711e-01, PNorm = 43.2198, GNorm = 0.8465, lr_0 = 2.0312e-04
Loss = 5.4031e-01, PNorm = 43.2291, GNorm = 0.7941, lr_0 = 2.9687e-04
Loss = 4.5309e-01, PNorm = 43.2490, GNorm = 1.5707, lr_0 = 3.9062e-04
Loss = 4.1356e-01, PNorm = 43.2753, GNorm = 0.6107, lr_0 = 4.8437e-04
Validation prc-auc = 0.783308
Validation auc = 0.898464
Epoch 1
Loss = 5.3450e-01, PNorm = 43.3072, GNorm = 1.7053, lr_0 = 5.8750e-04
Loss = 3.5977e-01, PNorm = 43.3395, GNorm = 0.7254, lr_0 = 6.8125e-04
Loss = 3.2257e-01, PNorm = 43.3816, GNorm = 0.6729, lr_0 = 7.7500e-04
Loss = 3.2974e-01, PNorm = 43.4384, GNorm = 0.7393, lr_0 = 8.6875e-04
Loss = 4.0173e-01, PNorm = 43.4813, GNorm = 1.1350, lr_0 = 9.6250e-04
Validation prc-auc = 0.751303
Validation auc = 0.901710
Epoch 2
Loss = 3.2148e-01, PNorm = 43.5386, GNorm = 1.0943, lr_0 = 9.8977e-04
Loss = 3.6366e-01, PNorm = 43.6017, GNorm = 1.0271, lr_0 = 9.7296e-04
Loss = 3.7534e-01, PNorm = 43.6779, GNorm = 2.4342, lr_0 = 9.5643e-04
Loss = 3.5831e-01, PNorm = 43.7269, GNorm = 0.6468, lr_0 = 9.4019e-04
Loss = 3.6119e-01, PNorm = 43.7784, GNorm = 0.6003, lr_0 = 9.2422e-04
Validation prc-auc = 0.765196
Validation auc = 0.903913
Epoch 3
Loss = 3.2334e-01, PNorm = 43.8243, GNorm = 0.6135, lr_0 = 9.0852e-04
Loss = 3.0069e-01, PNorm = 43.8735, GNorm = 0.4523, lr_0 = 8.9309e-04
Loss = 3.4101e-01, PNorm = 43.9103, GNorm = 0.6873, lr_0 = 8.7791e-04
Loss = 3.4460e-01, PNorm = 43.9385, GNorm = 0.4875, lr_0 = 8.6300e-04
Loss = 3.3464e-01, PNorm = 43.9822, GNorm = 0.6637, lr_0 = 8.4834e-04
Validation prc-auc = 0.751800
Validation auc = 0.903565
Epoch 4
Loss = 3.3387e-01, PNorm = 44.0213, GNorm = 0.5343, lr_0 = 8.3393e-04
Loss = 3.1856e-01, PNorm = 44.0674, GNorm = 0.6335, lr_0 = 8.1977e-04
Loss = 2.9704e-01, PNorm = 44.1189, GNorm = 0.6131, lr_0 = 8.0584e-04
Loss = 3.2751e-01, PNorm = 44.1412, GNorm = 0.8096, lr_0 = 7.9215e-04
Loss = 3.5720e-01, PNorm = 44.1802, GNorm = 0.8933, lr_0 = 7.7870e-04
Validation prc-auc = 0.771787
Validation auc = 0.900899
Epoch 5
Loss = 2.8205e-01, PNorm = 44.2128, GNorm = 0.4309, lr_0 = 7.6547e-04
Loss = 3.2408e-01, PNorm = 44.2515, GNorm = 0.5062, lr_0 = 7.5247e-04
Loss = 2.9998e-01, PNorm = 44.2842, GNorm = 0.7037, lr_0 = 7.3969e-04
Loss = 3.0700e-01, PNorm = 44.3273, GNorm = 1.2358, lr_0 = 7.2712e-04
Loss = 3.4777e-01, PNorm = 44.3660, GNorm = 0.5056, lr_0 = 7.1477e-04
Validation prc-auc = 0.754146
Validation auc = 0.891971
Epoch 6
Loss = 2.8589e-01, PNorm = 44.4182, GNorm = 0.2942, lr_0 = 7.0143e-04
Loss = 3.6668e-01, PNorm = 44.4602, GNorm = 0.3695, lr_0 = 6.8951e-04
Loss = 3.1868e-01, PNorm = 44.5002, GNorm = 0.3248, lr_0 = 6.7780e-04
Loss = 2.8965e-01, PNorm = 44.5491, GNorm = 0.6104, lr_0 = 6.6629e-04
Loss = 2.7596e-01, PNorm = 44.5992, GNorm = 0.7520, lr_0 = 6.5497e-04
Validation prc-auc = 0.746119
Validation auc = 0.899855
Epoch 7
Loss = 2.8021e-01, PNorm = 44.6380, GNorm = 0.5722, lr_0 = 6.4384e-04
Loss = 3.4083e-01, PNorm = 44.6701, GNorm = 0.5507, lr_0 = 6.3291e-04
Loss = 3.2403e-01, PNorm = 44.6935, GNorm = 1.0222, lr_0 = 6.2216e-04
Loss = 2.8207e-01, PNorm = 44.7362, GNorm = 0.4899, lr_0 = 6.1159e-04
Loss = 3.0192e-01, PNorm = 44.7887, GNorm = 0.3811, lr_0 = 6.0120e-04
Validation prc-auc = 0.786625
Validation auc = 0.898000
Epoch 8
Loss = 2.9973e-01, PNorm = 44.8320, GNorm = 0.7176, lr_0 = 5.9099e-04
Loss = 3.1283e-01, PNorm = 44.8656, GNorm = 0.3975, lr_0 = 5.8095e-04
Loss = 3.0171e-01, PNorm = 44.8884, GNorm = 0.4605, lr_0 = 5.7108e-04
Loss = 2.5031e-01, PNorm = 44.9295, GNorm = 0.3874, lr_0 = 5.6138e-04
Validation prc-auc = 0.769365
Validation auc = 0.903913
Epoch 9
Loss = 4.1053e-01, PNorm = 44.9677, GNorm = 0.4633, lr_0 = 5.5184e-04
Loss = 3.2317e-01, PNorm = 44.9973, GNorm = 0.6561, lr_0 = 5.4247e-04
Loss = 2.9780e-01, PNorm = 45.0379, GNorm = 0.3963, lr_0 = 5.3325e-04
Loss = 2.6975e-01, PNorm = 45.0864, GNorm = 0.4944, lr_0 = 5.2420e-04
Loss = 3.1094e-01, PNorm = 45.1186, GNorm = 0.9242, lr_0 = 5.1529e-04
Validation prc-auc = 0.766172
Validation auc = 0.907971
Epoch 10
Loss = 2.9130e-01, PNorm = 45.1790, GNorm = 0.5022, lr_0 = 5.0654e-04
Loss = 2.8060e-01, PNorm = 45.2193, GNorm = 0.4345, lr_0 = 4.9793e-04
Loss = 3.0794e-01, PNorm = 45.2776, GNorm = 0.4364, lr_0 = 4.8948e-04
Loss = 2.8957e-01, PNorm = 45.3054, GNorm = 0.8435, lr_0 = 4.8116e-04
Loss = 3.0368e-01, PNorm = 45.3562, GNorm = 0.4677, lr_0 = 4.7299e-04
Validation prc-auc = 0.772317
Validation auc = 0.905710
Epoch 11
Loss = 3.7874e-01, PNorm = 45.3917, GNorm = 0.4159, lr_0 = 4.6416e-04
Loss = 2.7826e-01, PNorm = 45.4451, GNorm = 0.3713, lr_0 = 4.5627e-04
Loss = 2.4000e-01, PNorm = 45.4775, GNorm = 0.4644, lr_0 = 4.4852e-04
Loss = 2.8380e-01, PNorm = 45.5285, GNorm = 1.8983, lr_0 = 4.4091e-04
Loss = 2.8224e-01, PNorm = 45.5711, GNorm = 0.3635, lr_0 = 4.3342e-04
Validation prc-auc = 0.758077
Validation auc = 0.908087
Epoch 12
Loss = 2.8830e-01, PNorm = 45.6089, GNorm = 1.3490, lr_0 = 4.2605e-04
Loss = 2.6403e-01, PNorm = 45.6539, GNorm = 0.3151, lr_0 = 4.1882e-04
Loss = 3.1410e-01, PNorm = 45.6804, GNorm = 0.5954, lr_0 = 4.1170e-04
Loss = 2.8883e-01, PNorm = 45.7111, GNorm = 0.5682, lr_0 = 4.0471e-04
Loss = 2.8486e-01, PNorm = 45.7438, GNorm = 0.4305, lr_0 = 3.9783e-04
Validation prc-auc = 0.759286
Validation auc = 0.904725
Epoch 13
Loss = 2.2854e-01, PNorm = 45.7807, GNorm = 0.6835, lr_0 = 3.9108e-04
Loss = 3.0717e-01, PNorm = 45.8150, GNorm = 0.3386, lr_0 = 3.8443e-04
Loss = 2.7223e-01, PNorm = 45.8459, GNorm = 0.4177, lr_0 = 3.7790e-04
Loss = 2.8083e-01, PNorm = 45.8853, GNorm = 0.6477, lr_0 = 3.7148e-04
Loss = 2.8272e-01, PNorm = 45.9250, GNorm = 0.4915, lr_0 = 3.6517e-04
Validation prc-auc = 0.743564
Validation auc = 0.900783
Epoch 14
Loss = 2.7388e-01, PNorm = 45.9454, GNorm = 0.5420, lr_0 = 3.5897e-04
Loss = 3.2335e-01, PNorm = 45.9969, GNorm = 0.6727, lr_0 = 3.5287e-04
Loss = 2.5144e-01, PNorm = 46.0200, GNorm = 0.6573, lr_0 = 3.4688e-04
Loss = 2.5261e-01, PNorm = 46.0622, GNorm = 0.7409, lr_0 = 3.4099e-04
Loss = 2.5303e-01, PNorm = 46.0880, GNorm = 0.9480, lr_0 = 3.3520e-04
Validation prc-auc = 0.751538
Validation auc = 0.906464
Epoch 15
Loss = 2.6887e-01, PNorm = 46.1217, GNorm = 0.3727, lr_0 = 3.2950e-04
Loss = 3.1137e-01, PNorm = 46.1495, GNorm = 0.6881, lr_0 = 3.2390e-04
Loss = 2.8640e-01, PNorm = 46.1728, GNorm = 0.5253, lr_0 = 3.1840e-04
Loss = 2.5042e-01, PNorm = 46.2112, GNorm = 0.3868, lr_0 = 3.1299e-04
Loss = 2.2334e-01, PNorm = 46.2352, GNorm = 0.3311, lr_0 = 3.0768e-04
Loss = 2.3700e-01, PNorm = 46.2383, GNorm = 0.5546, lr_0 = 3.0715e-04
Validation prc-auc = 0.745031
Validation auc = 0.912435
Epoch 16
Loss = 2.6607e-01, PNorm = 46.2757, GNorm = 0.3981, lr_0 = 3.0193e-04
Loss = 2.4390e-01, PNorm = 46.3062, GNorm = 0.4869, lr_0 = 2.9680e-04
Loss = 2.5555e-01, PNorm = 46.3208, GNorm = 0.6516, lr_0 = 2.9176e-04
Loss = 3.0984e-01, PNorm = 46.3469, GNorm = 0.8000, lr_0 = 2.8681e-04
Validation prc-auc = 0.781742
Validation auc = 0.911507
Epoch 17
Loss = 3.4527e-01, PNorm = 46.3638, GNorm = 0.7193, lr_0 = 2.8193e-04
Loss = 3.0315e-01, PNorm = 46.3940, GNorm = 0.7395, lr_0 = 2.7715e-04
Loss = 2.8271e-01, PNorm = 46.4266, GNorm = 0.3841, lr_0 = 2.7244e-04
Loss = 2.5015e-01, PNorm = 46.4628, GNorm = 0.4005, lr_0 = 2.6781e-04
Loss = 2.3493e-01, PNorm = 46.4884, GNorm = 0.6621, lr_0 = 2.6326e-04
Validation prc-auc = 0.745389
Validation auc = 0.914870
Epoch 18
Loss = 1.8152e-01, PNorm = 46.5080, GNorm = 0.3463, lr_0 = 2.5879e-04
Loss = 2.5910e-01, PNorm = 46.5267, GNorm = 0.7590, lr_0 = 2.5439e-04
Loss = 2.3375e-01, PNorm = 46.5498, GNorm = 0.5535, lr_0 = 2.5007e-04
Loss = 2.4315e-01, PNorm = 46.5774, GNorm = 0.6138, lr_0 = 2.4582e-04
Loss = 2.7505e-01, PNorm = 46.5925, GNorm = 0.3355, lr_0 = 2.4165e-04
Validation prc-auc = 0.757019
Validation auc = 0.911913
Epoch 19
Loss = 2.5850e-01, PNorm = 46.6129, GNorm = 0.4735, lr_0 = 2.3754e-04
Loss = 2.7703e-01, PNorm = 46.6303, GNorm = 0.3168, lr_0 = 2.3351e-04
Loss = 2.5247e-01, PNorm = 46.6606, GNorm = 0.5025, lr_0 = 2.2954e-04
Loss = 2.5222e-01, PNorm = 46.6861, GNorm = 0.3164, lr_0 = 2.2564e-04
Loss = 2.2915e-01, PNorm = 46.7120, GNorm = 0.7844, lr_0 = 2.2181e-04
Validation prc-auc = 0.745392
Validation auc = 0.916435
Epoch 20
Loss = 2.2156e-01, PNorm = 46.7262, GNorm = 0.6639, lr_0 = 2.1804e-04
Loss = 2.4490e-01, PNorm = 46.7523, GNorm = 0.4905, lr_0 = 2.1434e-04
Loss = 2.7813e-01, PNorm = 46.7704, GNorm = 0.8190, lr_0 = 2.1070e-04
Loss = 2.3885e-01, PNorm = 46.7836, GNorm = 0.3101, lr_0 = 2.0712e-04
Loss = 2.3723e-01, PNorm = 46.8020, GNorm = 0.3817, lr_0 = 2.0360e-04
Validation prc-auc = 0.765926
Validation auc = 0.919043
Epoch 21
Loss = 2.7631e-01, PNorm = 46.8143, GNorm = 0.3919, lr_0 = 1.9980e-04
Loss = 2.3179e-01, PNorm = 46.8341, GNorm = 0.4087, lr_0 = 1.9641e-04
Loss = 2.4680e-01, PNorm = 46.8619, GNorm = 0.3422, lr_0 = 1.9307e-04
Loss = 2.3935e-01, PNorm = 46.8833, GNorm = 0.3877, lr_0 = 1.8979e-04
Loss = 2.7719e-01, PNorm = 46.9046, GNorm = 0.9537, lr_0 = 1.8657e-04
Validation prc-auc = 0.778601
Validation auc = 0.924957
Epoch 22
Loss = 2.3893e-01, PNorm = 46.9163, GNorm = 0.5021, lr_0 = 1.8340e-04
Loss = 2.4303e-01, PNorm = 46.9339, GNorm = 0.6340, lr_0 = 1.8028e-04
Loss = 2.7122e-01, PNorm = 46.9511, GNorm = 1.0226, lr_0 = 1.7722e-04
Loss = 2.4805e-01, PNorm = 46.9615, GNorm = 0.6360, lr_0 = 1.7421e-04
Loss = 2.2157e-01, PNorm = 46.9795, GNorm = 0.5217, lr_0 = 1.7125e-04
Validation prc-auc = 0.778678
Validation auc = 0.922000
Epoch 23
Loss = 2.4678e-01, PNorm = 47.0011, GNorm = 1.0077, lr_0 = 1.6834e-04
Loss = 2.6748e-01, PNorm = 47.0107, GNorm = 0.9290, lr_0 = 1.6548e-04
Loss = 2.3697e-01, PNorm = 47.0255, GNorm = 0.3608, lr_0 = 1.6267e-04
Loss = 2.3043e-01, PNorm = 47.0407, GNorm = 0.5180, lr_0 = 1.5991e-04
Loss = 2.4214e-01, PNorm = 47.0608, GNorm = 0.8418, lr_0 = 1.5719e-04
Validation prc-auc = 0.773901
Validation auc = 0.922522
Epoch 24
Loss = 2.4165e-01, PNorm = 47.0728, GNorm = 0.3722, lr_0 = 1.5452e-04
Loss = 2.7613e-01, PNorm = 47.0892, GNorm = 0.5536, lr_0 = 1.5190e-04
Loss = 2.4519e-01, PNorm = 47.0999, GNorm = 0.6282, lr_0 = 1.4932e-04
Loss = 2.4761e-01, PNorm = 47.1064, GNorm = 0.9098, lr_0 = 1.4678e-04
Loss = 2.2106e-01, PNorm = 47.1233, GNorm = 1.0969, lr_0 = 1.4429e-04
Validation prc-auc = 0.781124
Validation auc = 0.927275
Epoch 25
Loss = 2.6940e-01, PNorm = 47.1355, GNorm = 0.8454, lr_0 = 1.4184e-04
Loss = 2.1056e-01, PNorm = 47.1505, GNorm = 0.3731, lr_0 = 1.3943e-04
Loss = 2.5341e-01, PNorm = 47.1548, GNorm = 0.4129, lr_0 = 1.3706e-04
Loss = 2.3729e-01, PNorm = 47.1637, GNorm = 0.4302, lr_0 = 1.3473e-04
Validation prc-auc = 0.784672
Validation auc = 0.929014
Epoch 26
Loss = 2.5895e-01, PNorm = 47.1786, GNorm = 0.6048, lr_0 = 1.3221e-04
Loss = 2.4288e-01, PNorm = 47.1921, GNorm = 0.4715, lr_0 = 1.2997e-04
Loss = 2.1492e-01, PNorm = 47.2016, GNorm = 0.4469, lr_0 = 1.2776e-04
Loss = 2.5275e-01, PNorm = 47.2150, GNorm = 1.0065, lr_0 = 1.2559e-04
Loss = 2.4931e-01, PNorm = 47.2204, GNorm = 0.8690, lr_0 = 1.2346e-04
Validation prc-auc = 0.783013
Validation auc = 0.927681
Epoch 27
Loss = 2.0448e-01, PNorm = 47.2316, GNorm = 0.3720, lr_0 = 1.2136e-04
Loss = 2.1907e-01, PNorm = 47.2417, GNorm = 0.3994, lr_0 = 1.1930e-04
Loss = 2.9310e-01, PNorm = 47.2497, GNorm = 0.4817, lr_0 = 1.1727e-04
Loss = 1.9196e-01, PNorm = 47.2618, GNorm = 0.3576, lr_0 = 1.1528e-04
Loss = 2.4099e-01, PNorm = 47.2781, GNorm = 0.8991, lr_0 = 1.1332e-04
Validation prc-auc = 0.783057
Validation auc = 0.930812
Epoch 28
Loss = 2.0215e-01, PNorm = 47.2798, GNorm = 0.4450, lr_0 = 1.1140e-04
Loss = 2.3638e-01, PNorm = 47.2874, GNorm = 0.4798, lr_0 = 1.0951e-04
Loss = 2.6859e-01, PNorm = 47.2948, GNorm = 1.0763, lr_0 = 1.0765e-04
Loss = 2.2126e-01, PNorm = 47.3023, GNorm = 0.7275, lr_0 = 1.0582e-04
Loss = 2.2101e-01, PNorm = 47.3118, GNorm = 0.4306, lr_0 = 1.0402e-04
Validation prc-auc = 0.787015
Validation auc = 0.933768
Epoch 29
Loss = 2.0951e-01, PNorm = 47.3206, GNorm = 0.5982, lr_0 = 1.0225e-04
Loss = 2.3360e-01, PNorm = 47.3297, GNorm = 0.8775, lr_0 = 1.0052e-04
Loss = 2.4213e-01, PNorm = 47.3403, GNorm = 0.6859, lr_0 = 1.0000e-04
Loss = 2.4259e-01, PNorm = 47.3457, GNorm = 0.3184, lr_0 = 1.0000e-04
Loss = 2.4724e-01, PNorm = 47.3541, GNorm = 0.5607, lr_0 = 1.0000e-04
Validation prc-auc = 0.784371
Validation auc = 0.932841
Model 0 best validation prc-auc = 0.787015 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.891914
Model 0 test auc = 0.917592
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.4106e-01, PNorm = 43.2432, GNorm = 0.7430, lr_0 = 2.0312e-04
Loss = 5.4567e-01, PNorm = 43.2522, GNorm = 1.3346, lr_0 = 2.9687e-04
Loss = 4.7655e-01, PNorm = 43.2714, GNorm = 1.2345, lr_0 = 3.9062e-04
Loss = 4.1369e-01, PNorm = 43.2982, GNorm = 0.6831, lr_0 = 4.8437e-04
Validation prc-auc = 0.787948
Validation auc = 0.895043
Epoch 1
Loss = 4.5403e-01, PNorm = 43.3326, GNorm = 1.0902, lr_0 = 5.8750e-04
Loss = 3.3603e-01, PNorm = 43.3716, GNorm = 0.5598, lr_0 = 6.8125e-04
Loss = 3.6062e-01, PNorm = 43.4159, GNorm = 1.1705, lr_0 = 7.7500e-04
Loss = 3.8168e-01, PNorm = 43.4632, GNorm = 1.6005, lr_0 = 8.6875e-04
Loss = 3.5792e-01, PNorm = 43.5126, GNorm = 0.9013, lr_0 = 9.6250e-04
Validation prc-auc = 0.758285
Validation auc = 0.900435
Epoch 2
Loss = 3.8700e-01, PNorm = 43.5635, GNorm = 0.4543, lr_0 = 9.8977e-04
Loss = 3.5149e-01, PNorm = 43.6171, GNorm = 0.3785, lr_0 = 9.7296e-04
Loss = 4.0364e-01, PNorm = 43.6767, GNorm = 1.6777, lr_0 = 9.5643e-04
Loss = 3.5006e-01, PNorm = 43.7401, GNorm = 0.7665, lr_0 = 9.4019e-04
Loss = 3.3811e-01, PNorm = 43.7833, GNorm = 0.4800, lr_0 = 9.2422e-04
Validation prc-auc = 0.783067
Validation auc = 0.902232
Epoch 3
Loss = 3.3651e-01, PNorm = 43.8180, GNorm = 0.4252, lr_0 = 9.0852e-04
Loss = 2.9894e-01, PNorm = 43.8534, GNorm = 0.4193, lr_0 = 8.9309e-04
Loss = 3.6409e-01, PNorm = 43.8859, GNorm = 1.0041, lr_0 = 8.7791e-04
Loss = 2.9501e-01, PNorm = 43.9221, GNorm = 0.9676, lr_0 = 8.6300e-04
Loss = 3.0084e-01, PNorm = 43.9660, GNorm = 0.3771, lr_0 = 8.4834e-04
Validation prc-auc = 0.773460
Validation auc = 0.904145
Epoch 4
Loss = 2.7921e-01, PNorm = 44.0067, GNorm = 0.8619, lr_0 = 8.3393e-04
Loss = 2.9842e-01, PNorm = 44.0543, GNorm = 0.4380, lr_0 = 8.1977e-04
Loss = 2.9042e-01, PNorm = 44.1067, GNorm = 0.3374, lr_0 = 8.0584e-04
Loss = 3.6435e-01, PNorm = 44.1324, GNorm = 0.6170, lr_0 = 7.9215e-04
Loss = 2.9809e-01, PNorm = 44.1674, GNorm = 0.4666, lr_0 = 7.7870e-04
Validation prc-auc = 0.805438
Validation auc = 0.903159
Epoch 5
Loss = 3.0285e-01, PNorm = 44.2134, GNorm = 0.4362, lr_0 = 7.6547e-04
Loss = 2.8723e-01, PNorm = 44.2703, GNorm = 0.8179, lr_0 = 7.5247e-04
Loss = 3.2427e-01, PNorm = 44.3071, GNorm = 1.3367, lr_0 = 7.3969e-04
Loss = 3.1156e-01, PNorm = 44.3424, GNorm = 0.6441, lr_0 = 7.2712e-04
Loss = 3.3297e-01, PNorm = 44.3765, GNorm = 0.9449, lr_0 = 7.1477e-04
Validation prc-auc = 0.785456
Validation auc = 0.902696
Epoch 6
Loss = 3.0654e-01, PNorm = 44.4200, GNorm = 0.6502, lr_0 = 7.0143e-04
Loss = 3.6387e-01, PNorm = 44.4619, GNorm = 1.0051, lr_0 = 6.8951e-04
Loss = 2.9026e-01, PNorm = 44.5029, GNorm = 0.5665, lr_0 = 6.7780e-04
Loss = 3.1446e-01, PNorm = 44.5417, GNorm = 0.3373, lr_0 = 6.6629e-04
Loss = 2.8049e-01, PNorm = 44.5865, GNorm = 1.2264, lr_0 = 6.5497e-04
Validation prc-auc = 0.775922
Validation auc = 0.906116
Epoch 7
Loss = 3.2113e-01, PNorm = 44.6237, GNorm = 0.3689, lr_0 = 6.4384e-04
Loss = 2.9979e-01, PNorm = 44.6482, GNorm = 0.8271, lr_0 = 6.3291e-04
Loss = 2.9127e-01, PNorm = 44.6871, GNorm = 0.2887, lr_0 = 6.2216e-04
Loss = 3.0455e-01, PNorm = 44.7324, GNorm = 0.4116, lr_0 = 6.1159e-04
Loss = 2.5227e-01, PNorm = 44.7963, GNorm = 0.2941, lr_0 = 6.0120e-04
Validation prc-auc = 0.760422
Validation auc = 0.905420
Epoch 8
Loss = 2.8508e-01, PNorm = 44.8352, GNorm = 0.9540, lr_0 = 5.9099e-04
Loss = 2.7958e-01, PNorm = 44.8883, GNorm = 0.6071, lr_0 = 5.8095e-04
Loss = 3.5292e-01, PNorm = 44.9250, GNorm = 1.0352, lr_0 = 5.7108e-04
Loss = 3.0324e-01, PNorm = 44.9617, GNorm = 0.7674, lr_0 = 5.6138e-04
Validation prc-auc = 0.790215
Validation auc = 0.909652
Epoch 9
Loss = 3.3651e-01, PNorm = 45.0096, GNorm = 0.5355, lr_0 = 5.5184e-04
Loss = 2.5544e-01, PNorm = 45.0677, GNorm = 0.4821, lr_0 = 5.4247e-04
Loss = 3.1151e-01, PNorm = 45.1109, GNorm = 0.8361, lr_0 = 5.3325e-04
Loss = 2.9089e-01, PNorm = 45.1458, GNorm = 0.5428, lr_0 = 5.2420e-04
Loss = 3.2576e-01, PNorm = 45.1746, GNorm = 0.4988, lr_0 = 5.1529e-04
Validation prc-auc = 0.749982
Validation auc = 0.906812
Epoch 10
Loss = 2.6133e-01, PNorm = 45.2180, GNorm = 0.3874, lr_0 = 5.0654e-04
Loss = 2.9623e-01, PNorm = 45.2500, GNorm = 0.6704, lr_0 = 4.9793e-04
Loss = 2.8915e-01, PNorm = 45.2923, GNorm = 0.4452, lr_0 = 4.8948e-04
Loss = 2.5643e-01, PNorm = 45.3351, GNorm = 0.3355, lr_0 = 4.8116e-04
Loss = 2.8758e-01, PNorm = 45.3723, GNorm = 0.3999, lr_0 = 4.7299e-04
Validation prc-auc = 0.755778
Validation auc = 0.911681
Epoch 11
Loss = 3.0229e-01, PNorm = 45.4191, GNorm = 0.7254, lr_0 = 4.6416e-04
Loss = 2.6225e-01, PNorm = 45.4563, GNorm = 0.3068, lr_0 = 4.5627e-04
Loss = 2.4216e-01, PNorm = 45.5004, GNorm = 0.4217, lr_0 = 4.4852e-04
Loss = 2.9084e-01, PNorm = 45.5358, GNorm = 0.6737, lr_0 = 4.4091e-04
Loss = 2.5590e-01, PNorm = 45.5777, GNorm = 0.9896, lr_0 = 4.3342e-04
Validation prc-auc = 0.739939
Validation auc = 0.910754
Epoch 12
Loss = 2.6088e-01, PNorm = 45.6153, GNorm = 0.6712, lr_0 = 4.2605e-04
Loss = 3.1176e-01, PNorm = 45.6550, GNorm = 0.9016, lr_0 = 4.1882e-04
Loss = 2.4984e-01, PNorm = 45.7026, GNorm = 0.8257, lr_0 = 4.1170e-04
Loss = 2.9146e-01, PNorm = 45.7365, GNorm = 0.4552, lr_0 = 4.0471e-04
Loss = 2.6262e-01, PNorm = 45.7792, GNorm = 1.5348, lr_0 = 3.9783e-04
Validation prc-auc = 0.743152
Validation auc = 0.914580
Epoch 13
Loss = 2.8431e-01, PNorm = 45.8209, GNorm = 0.5670, lr_0 = 3.9108e-04
Loss = 2.5606e-01, PNorm = 45.8653, GNorm = 0.4169, lr_0 = 3.8443e-04
Loss = 2.6517e-01, PNorm = 45.8861, GNorm = 0.4028, lr_0 = 3.7790e-04
Loss = 2.6844e-01, PNorm = 45.9115, GNorm = 0.5100, lr_0 = 3.7148e-04
Loss = 2.7737e-01, PNorm = 45.9400, GNorm = 0.4890, lr_0 = 3.6517e-04
Validation prc-auc = 0.749553
Validation auc = 0.912435
Epoch 14
Loss = 2.9981e-01, PNorm = 45.9738, GNorm = 0.4308, lr_0 = 3.5897e-04
Loss = 2.7442e-01, PNorm = 45.9986, GNorm = 0.3148, lr_0 = 3.5287e-04
Loss = 2.5470e-01, PNorm = 46.0418, GNorm = 0.5470, lr_0 = 3.4688e-04
Loss = 2.7567e-01, PNorm = 46.0633, GNorm = 0.3689, lr_0 = 3.4099e-04
Loss = 2.5921e-01, PNorm = 46.1149, GNorm = 0.8114, lr_0 = 3.3520e-04
Validation prc-auc = 0.747643
Validation auc = 0.916493
Epoch 15
Loss = 2.6231e-01, PNorm = 46.1432, GNorm = 0.3318, lr_0 = 3.2950e-04
Loss = 2.8400e-01, PNorm = 46.1647, GNorm = 0.6048, lr_0 = 3.2390e-04
Loss = 2.6162e-01, PNorm = 46.2041, GNorm = 0.5856, lr_0 = 3.1840e-04
Loss = 2.5393e-01, PNorm = 46.2304, GNorm = 0.4806, lr_0 = 3.1299e-04
Loss = 2.5453e-01, PNorm = 46.2538, GNorm = 0.4369, lr_0 = 3.0768e-04
Loss = 2.5480e-01, PNorm = 46.2557, GNorm = 0.8158, lr_0 = 3.0715e-04
Validation prc-auc = 0.740371
Validation auc = 0.914812
Epoch 16
Loss = 2.3014e-01, PNorm = 46.2717, GNorm = 0.6218, lr_0 = 3.0193e-04
Loss = 2.5234e-01, PNorm = 46.2957, GNorm = 0.4761, lr_0 = 2.9680e-04
Loss = 2.6602e-01, PNorm = 46.3007, GNorm = 0.2933, lr_0 = 2.9176e-04
Loss = 3.0033e-01, PNorm = 46.3349, GNorm = 0.7375, lr_0 = 2.8681e-04
Validation prc-auc = 0.736979
Validation auc = 0.912087
Epoch 17
Loss = 2.8553e-01, PNorm = 46.3607, GNorm = 0.6559, lr_0 = 2.8193e-04
Loss = 2.3589e-01, PNorm = 46.4067, GNorm = 0.3657, lr_0 = 2.7715e-04
Loss = 2.6227e-01, PNorm = 46.4313, GNorm = 0.5617, lr_0 = 2.7244e-04
Loss = 2.6423e-01, PNorm = 46.4581, GNorm = 0.5714, lr_0 = 2.6781e-04
Loss = 2.2724e-01, PNorm = 46.4853, GNorm = 0.5951, lr_0 = 2.6326e-04
Validation prc-auc = 0.742705
Validation auc = 0.918406
Epoch 18
Loss = 1.4199e-01, PNorm = 46.5099, GNorm = 0.4297, lr_0 = 2.5879e-04
Loss = 2.2815e-01, PNorm = 46.5266, GNorm = 0.4645, lr_0 = 2.5439e-04
Loss = 3.1139e-01, PNorm = 46.5539, GNorm = 0.8593, lr_0 = 2.5007e-04
Loss = 2.4492e-01, PNorm = 46.5696, GNorm = 0.5368, lr_0 = 2.4582e-04
Loss = 2.5110e-01, PNorm = 46.5960, GNorm = 0.7099, lr_0 = 2.4165e-04
Validation prc-auc = 0.740535
Validation auc = 0.916087
Epoch 19
Loss = 2.5535e-01, PNorm = 46.6121, GNorm = 0.3442, lr_0 = 2.3754e-04
Loss = 2.8444e-01, PNorm = 46.6304, GNorm = 0.6167, lr_0 = 2.3351e-04
Loss = 2.4213e-01, PNorm = 46.6531, GNorm = 0.5158, lr_0 = 2.2954e-04
Loss = 2.3159e-01, PNorm = 46.6772, GNorm = 0.7898, lr_0 = 2.2564e-04
Loss = 2.0927e-01, PNorm = 46.7050, GNorm = 0.7975, lr_0 = 2.2181e-04
Validation prc-auc = 0.746665
Validation auc = 0.917072
Epoch 20
Loss = 2.9751e-01, PNorm = 46.7153, GNorm = 0.6963, lr_0 = 2.1804e-04
Loss = 2.2424e-01, PNorm = 46.7358, GNorm = 0.4452, lr_0 = 2.1434e-04
Loss = 2.1393e-01, PNorm = 46.7639, GNorm = 0.5081, lr_0 = 2.1070e-04
Loss = 2.6987e-01, PNorm = 46.7894, GNorm = 0.5226, lr_0 = 2.0712e-04
Loss = 2.5055e-01, PNorm = 46.8030, GNorm = 0.8058, lr_0 = 2.0360e-04
Validation prc-auc = 0.743057
Validation auc = 0.920667
Epoch 21
Loss = 2.3359e-01, PNorm = 46.8147, GNorm = 0.4074, lr_0 = 1.9980e-04
Loss = 2.8077e-01, PNorm = 46.8257, GNorm = 0.4126, lr_0 = 1.9641e-04
Loss = 2.5564e-01, PNorm = 46.8424, GNorm = 0.3999, lr_0 = 1.9307e-04
Loss = 2.5149e-01, PNorm = 46.8582, GNorm = 0.6931, lr_0 = 1.8979e-04
Loss = 2.0475e-01, PNorm = 46.8772, GNorm = 0.6610, lr_0 = 1.8657e-04
Validation prc-auc = 0.739837
Validation auc = 0.919391
Epoch 22
Loss = 2.0201e-01, PNorm = 46.8970, GNorm = 0.5534, lr_0 = 1.8340e-04
Loss = 2.5718e-01, PNorm = 46.9122, GNorm = 0.4303, lr_0 = 1.8028e-04
Loss = 2.6736e-01, PNorm = 46.9272, GNorm = 0.5031, lr_0 = 1.7722e-04
Loss = 2.3795e-01, PNorm = 46.9426, GNorm = 1.1197, lr_0 = 1.7421e-04
Loss = 2.1685e-01, PNorm = 46.9588, GNorm = 0.6588, lr_0 = 1.7125e-04
Validation prc-auc = 0.744725
Validation auc = 0.923043
Epoch 23
Loss = 2.1002e-01, PNorm = 46.9767, GNorm = 0.8469, lr_0 = 1.6834e-04
Loss = 2.4946e-01, PNorm = 46.9892, GNorm = 0.4933, lr_0 = 1.6548e-04
Loss = 1.9778e-01, PNorm = 47.0029, GNorm = 0.5456, lr_0 = 1.6267e-04
Loss = 2.4605e-01, PNorm = 47.0137, GNorm = 1.0210, lr_0 = 1.5991e-04
Loss = 2.7155e-01, PNorm = 47.0287, GNorm = 1.2873, lr_0 = 1.5719e-04
Validation prc-auc = 0.753180
Validation auc = 0.926290
Epoch 24
Loss = 2.4255e-01, PNorm = 47.0416, GNorm = 0.4832, lr_0 = 1.5452e-04
Loss = 2.4768e-01, PNorm = 47.0599, GNorm = 0.5703, lr_0 = 1.5190e-04
Loss = 2.2613e-01, PNorm = 47.0746, GNorm = 0.3541, lr_0 = 1.4932e-04
Loss = 2.5772e-01, PNorm = 47.0781, GNorm = 0.5604, lr_0 = 1.4678e-04
Loss = 2.3554e-01, PNorm = 47.0922, GNorm = 0.5746, lr_0 = 1.4429e-04
Validation prc-auc = 0.758699
Validation auc = 0.924899
Epoch 25
Loss = 2.1938e-01, PNorm = 47.0986, GNorm = 0.6956, lr_0 = 1.4184e-04
Loss = 1.9574e-01, PNorm = 47.1149, GNorm = 0.5588, lr_0 = 1.3943e-04
Loss = 2.4127e-01, PNorm = 47.1297, GNorm = 0.5366, lr_0 = 1.3706e-04
Loss = 2.5699e-01, PNorm = 47.1401, GNorm = 0.3039, lr_0 = 1.3473e-04
Validation prc-auc = 0.754770
Validation auc = 0.925826
Epoch 26
Loss = 1.8931e-01, PNorm = 47.1534, GNorm = 0.4298, lr_0 = 1.3221e-04
Loss = 2.3559e-01, PNorm = 47.1603, GNorm = 0.5129, lr_0 = 1.2997e-04
Loss = 2.5432e-01, PNorm = 47.1717, GNorm = 0.5443, lr_0 = 1.2776e-04
Loss = 2.5040e-01, PNorm = 47.1868, GNorm = 1.0893, lr_0 = 1.2559e-04
Loss = 2.2669e-01, PNorm = 47.1904, GNorm = 1.2856, lr_0 = 1.2346e-04
Validation prc-auc = 0.756930
Validation auc = 0.927855
Epoch 27
Loss = 2.4160e-01, PNorm = 47.2058, GNorm = 0.9344, lr_0 = 1.2136e-04
Loss = 2.3010e-01, PNorm = 47.2116, GNorm = 0.4478, lr_0 = 1.1930e-04
Loss = 2.3760e-01, PNorm = 47.2260, GNorm = 0.7661, lr_0 = 1.1727e-04
Loss = 2.8381e-01, PNorm = 47.2363, GNorm = 1.3516, lr_0 = 1.1528e-04
Loss = 2.2390e-01, PNorm = 47.2386, GNorm = 0.8201, lr_0 = 1.1332e-04
Validation prc-auc = 0.768902
Validation auc = 0.928783
Epoch 28
Loss = 2.6631e-01, PNorm = 47.2519, GNorm = 0.4135, lr_0 = 1.1140e-04
Loss = 2.4310e-01, PNorm = 47.2615, GNorm = 0.4996, lr_0 = 1.0951e-04
Loss = 2.4061e-01, PNorm = 47.2693, GNorm = 0.4068, lr_0 = 1.0765e-04
Loss = 2.1993e-01, PNorm = 47.2742, GNorm = 0.6621, lr_0 = 1.0582e-04
Loss = 2.4378e-01, PNorm = 47.2872, GNorm = 0.5891, lr_0 = 1.0402e-04
Validation prc-auc = 0.759596
Validation auc = 0.927913
Epoch 29
Loss = 2.0547e-01, PNorm = 47.2950, GNorm = 0.6119, lr_0 = 1.0225e-04
Loss = 2.0661e-01, PNorm = 47.3060, GNorm = 0.3786, lr_0 = 1.0052e-04
Loss = 2.8351e-01, PNorm = 47.3125, GNorm = 0.4724, lr_0 = 1.0000e-04
Loss = 2.0921e-01, PNorm = 47.3177, GNorm = 0.5313, lr_0 = 1.0000e-04
Loss = 2.2130e-01, PNorm = 47.3285, GNorm = 0.6475, lr_0 = 1.0000e-04
Validation prc-auc = 0.762779
Validation auc = 0.929188
Model 1 best validation prc-auc = 0.805438 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.889179
Model 1 test auc = 0.903153
Ensemble test prc-auc = 0.896499
Ensemble test auc = 0.913619
Fold 3
Splitting data with seed 3
Total scaffolds = 746 | train scaffolds = 582 | val scaffolds = 96 | test scaffolds = 68
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 144 | target average = 0.041667


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 53 | target average = 0.018868


Scaffold 3
Task 0: count = 52 | target average = 0.019231


Scaffold 4
Task 0: count = 45 | target average = 0.066667


Scaffold 5
Task 0: count = 45 | target average = 0.044444


Scaffold 6
Task 0: count = 44 | target average = 0.068182


Scaffold 7
Task 0: count = 42 | target average = 0.023810


Scaffold 8
Task 0: count = 38 | target average = 0.157895


Scaffold 9
Task 0: count = 36 | target average = 0.000000


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.5489e-01, PNorm = 43.2198, GNorm = 0.8167, lr_0 = 2.0312e-04
Loss = 5.6409e-01, PNorm = 43.2301, GNorm = 1.1859, lr_0 = 2.9687e-04
Loss = 4.3165e-01, PNorm = 43.2509, GNorm = 1.0485, lr_0 = 3.9062e-04
Loss = 4.1195e-01, PNorm = 43.2776, GNorm = 0.4611, lr_0 = 4.8437e-04
Validation prc-auc = 0.896959
Validation auc = 0.930788
Epoch 1
Loss = 4.4329e-01, PNorm = 43.3090, GNorm = 2.2291, lr_0 = 5.8750e-04
Loss = 3.9015e-01, PNorm = 43.3394, GNorm = 1.0015, lr_0 = 6.8125e-04
Loss = 4.0323e-01, PNorm = 43.3763, GNorm = 1.6973, lr_0 = 7.7500e-04
Loss = 3.6368e-01, PNorm = 43.4148, GNorm = 0.5925, lr_0 = 8.6875e-04
Loss = 3.4558e-01, PNorm = 43.4603, GNorm = 0.5194, lr_0 = 9.6250e-04
Validation prc-auc = 0.912099
Validation auc = 0.935555
Epoch 2
Loss = 3.4397e-01, PNorm = 43.5160, GNorm = 1.0645, lr_0 = 9.8977e-04
Loss = 3.4444e-01, PNorm = 43.5726, GNorm = 1.4511, lr_0 = 9.7296e-04
Loss = 3.4157e-01, PNorm = 43.6224, GNorm = 0.6929, lr_0 = 9.5643e-04
Loss = 3.2340e-01, PNorm = 43.6714, GNorm = 0.8581, lr_0 = 9.4019e-04
Loss = 3.6142e-01, PNorm = 43.7090, GNorm = 0.5763, lr_0 = 9.2422e-04
Validation prc-auc = 0.915378
Validation auc = 0.938546
Epoch 3
Loss = 3.8223e-01, PNorm = 43.7502, GNorm = 1.4638, lr_0 = 9.0852e-04
Loss = 3.6517e-01, PNorm = 43.8190, GNorm = 0.9173, lr_0 = 8.9309e-04
Loss = 3.4972e-01, PNorm = 43.8713, GNorm = 1.6606, lr_0 = 8.7791e-04
Loss = 3.6830e-01, PNorm = 43.9287, GNorm = 0.9212, lr_0 = 8.6300e-04
Loss = 3.3857e-01, PNorm = 43.9722, GNorm = 0.5321, lr_0 = 8.4834e-04
Validation prc-auc = 0.902532
Validation auc = 0.933258
Epoch 4
Loss = 3.6309e-01, PNorm = 44.0060, GNorm = 0.5715, lr_0 = 8.3393e-04
Loss = 3.3389e-01, PNorm = 44.0363, GNorm = 0.4705, lr_0 = 8.1977e-04
Loss = 3.1153e-01, PNorm = 44.0886, GNorm = 1.1251, lr_0 = 8.0584e-04
Loss = 3.4058e-01, PNorm = 44.1261, GNorm = 0.2832, lr_0 = 7.9215e-04
Loss = 2.8765e-01, PNorm = 44.1699, GNorm = 0.5806, lr_0 = 7.7870e-04
Validation prc-auc = 0.910080
Validation auc = 0.936162
Epoch 5
Loss = 3.4688e-01, PNorm = 44.2065, GNorm = 0.3545, lr_0 = 7.6547e-04
Loss = 2.9399e-01, PNorm = 44.2450, GNorm = 0.4296, lr_0 = 7.5247e-04
Loss = 3.2722e-01, PNorm = 44.2872, GNorm = 0.8735, lr_0 = 7.3969e-04
Loss = 3.4012e-01, PNorm = 44.3347, GNorm = 0.4131, lr_0 = 7.2712e-04
Loss = 3.1022e-01, PNorm = 44.3866, GNorm = 0.4474, lr_0 = 7.1477e-04
Validation prc-auc = 0.919325
Validation auc = 0.936942
Epoch 6
Loss = 3.3389e-01, PNorm = 44.4107, GNorm = 0.4829, lr_0 = 7.0143e-04
Loss = 2.9625e-01, PNorm = 44.4533, GNorm = 0.3649, lr_0 = 6.8951e-04
Loss = 2.7526e-01, PNorm = 44.5108, GNorm = 0.6650, lr_0 = 6.7780e-04
Loss = 3.6372e-01, PNorm = 44.5512, GNorm = 0.6764, lr_0 = 6.6629e-04
Loss = 3.1455e-01, PNorm = 44.5847, GNorm = 0.3499, lr_0 = 6.5497e-04
Validation prc-auc = 0.925940
Validation auc = 0.940712
Epoch 7
Loss = 3.1189e-01, PNorm = 44.6490, GNorm = 0.8736, lr_0 = 6.4384e-04
Loss = 3.0918e-01, PNorm = 44.6952, GNorm = 0.3856, lr_0 = 6.3291e-04
Loss = 3.2822e-01, PNorm = 44.7517, GNorm = 0.7364, lr_0 = 6.2216e-04
Loss = 3.1782e-01, PNorm = 44.7981, GNorm = 0.5051, lr_0 = 6.1159e-04
Loss = 3.1210e-01, PNorm = 44.8289, GNorm = 0.9551, lr_0 = 6.0120e-04
Validation prc-auc = 0.921331
Validation auc = 0.941233
Epoch 8
Loss = 2.9276e-01, PNorm = 44.8808, GNorm = 0.2968, lr_0 = 5.9099e-04
Loss = 3.0752e-01, PNorm = 44.9379, GNorm = 1.2506, lr_0 = 5.8095e-04
Loss = 2.9851e-01, PNorm = 44.9799, GNorm = 1.0462, lr_0 = 5.7108e-04
Loss = 3.3219e-01, PNorm = 45.0094, GNorm = 0.4887, lr_0 = 5.6138e-04
Validation prc-auc = 0.929276
Validation auc = 0.944960
Epoch 9
Loss = 2.8775e-01, PNorm = 45.0484, GNorm = 0.3942, lr_0 = 5.5184e-04
Loss = 3.3164e-01, PNorm = 45.0819, GNorm = 0.4735, lr_0 = 5.4247e-04
Loss = 2.6694e-01, PNorm = 45.1294, GNorm = 0.3884, lr_0 = 5.3325e-04
Loss = 2.8951e-01, PNorm = 45.1804, GNorm = 0.9279, lr_0 = 5.2420e-04
Loss = 2.9045e-01, PNorm = 45.2149, GNorm = 0.9008, lr_0 = 5.1529e-04
Validation prc-auc = 0.925581
Validation auc = 0.945956
Epoch 10
Loss = 2.0483e-01, PNorm = 45.2423, GNorm = 0.3578, lr_0 = 5.0654e-04
Loss = 2.8900e-01, PNorm = 45.2822, GNorm = 0.4937, lr_0 = 4.9793e-04
Loss = 2.4963e-01, PNorm = 45.3287, GNorm = 0.6034, lr_0 = 4.8948e-04
Loss = 2.9791e-01, PNorm = 45.3722, GNorm = 0.3567, lr_0 = 4.8116e-04
Loss = 3.2677e-01, PNorm = 45.4036, GNorm = 0.3611, lr_0 = 4.7299e-04
Validation prc-auc = 0.929973
Validation auc = 0.946737
Epoch 11
Loss = 3.6156e-01, PNorm = 45.4493, GNorm = 1.1408, lr_0 = 4.6416e-04
Loss = 2.7271e-01, PNorm = 45.4929, GNorm = 0.3067, lr_0 = 4.5627e-04
Loss = 2.5753e-01, PNorm = 45.5488, GNorm = 0.4327, lr_0 = 4.4852e-04
Loss = 2.9481e-01, PNorm = 45.5898, GNorm = 0.5785, lr_0 = 4.4091e-04
Loss = 2.9633e-01, PNorm = 45.6110, GNorm = 0.7591, lr_0 = 4.3342e-04
Validation prc-auc = 0.930120
Validation auc = 0.947733
Epoch 12
Loss = 3.4601e-01, PNorm = 45.6309, GNorm = 0.3892, lr_0 = 4.2605e-04
Loss = 2.6955e-01, PNorm = 45.6631, GNorm = 0.4347, lr_0 = 4.1882e-04
Loss = 2.4800e-01, PNorm = 45.6989, GNorm = 0.8127, lr_0 = 4.1170e-04
Loss = 2.9831e-01, PNorm = 45.7432, GNorm = 0.3837, lr_0 = 4.0471e-04
Loss = 3.2614e-01, PNorm = 45.7582, GNorm = 0.7840, lr_0 = 3.9783e-04
Validation prc-auc = 0.927416
Validation auc = 0.948513
Epoch 13
Loss = 2.2263e-01, PNorm = 45.7916, GNorm = 0.3579, lr_0 = 3.9108e-04
Loss = 3.0493e-01, PNorm = 45.8230, GNorm = 0.8576, lr_0 = 3.8443e-04
Loss = 2.8962e-01, PNorm = 45.8613, GNorm = 0.5452, lr_0 = 3.7790e-04
Loss = 3.1240e-01, PNorm = 45.8980, GNorm = 0.4530, lr_0 = 3.7148e-04
Loss = 2.6107e-01, PNorm = 45.9273, GNorm = 0.5404, lr_0 = 3.6517e-04
Validation prc-auc = 0.927322
Validation auc = 0.944960
Epoch 14
Loss = 2.9512e-01, PNorm = 45.9597, GNorm = 0.4023, lr_0 = 3.5897e-04
Loss = 2.6559e-01, PNorm = 45.9892, GNorm = 0.4877, lr_0 = 3.5287e-04
Loss = 2.8477e-01, PNorm = 46.0129, GNorm = 0.4470, lr_0 = 3.4688e-04
Loss = 2.6953e-01, PNorm = 46.0324, GNorm = 0.4669, lr_0 = 3.4099e-04
Loss = 2.7936e-01, PNorm = 46.0558, GNorm = 0.4718, lr_0 = 3.3520e-04
Validation prc-auc = 0.927036
Validation auc = 0.945566
Epoch 15
Loss = 2.6130e-01, PNorm = 46.0809, GNorm = 0.4512, lr_0 = 3.2950e-04
Loss = 2.6401e-01, PNorm = 46.1055, GNorm = 0.7171, lr_0 = 3.2390e-04
Loss = 2.9650e-01, PNorm = 46.1399, GNorm = 0.5780, lr_0 = 3.1840e-04
Loss = 2.5219e-01, PNorm = 46.1626, GNorm = 0.4251, lr_0 = 3.1299e-04
Loss = 2.8443e-01, PNorm = 46.2035, GNorm = 0.4791, lr_0 = 3.0768e-04
Loss = 4.0230e-01, PNorm = 46.2063, GNorm = 0.6161, lr_0 = 3.0715e-04
Validation prc-auc = 0.926178
Validation auc = 0.945436
Epoch 16
Loss = 2.4262e-01, PNorm = 46.2214, GNorm = 0.3175, lr_0 = 3.0193e-04
Loss = 3.3087e-01, PNorm = 46.2488, GNorm = 0.3847, lr_0 = 2.9680e-04
Loss = 3.2069e-01, PNorm = 46.2717, GNorm = 0.5050, lr_0 = 2.9176e-04
Loss = 2.3098e-01, PNorm = 46.3015, GNorm = 0.3314, lr_0 = 2.8681e-04
Validation prc-auc = 0.926889
Validation auc = 0.944873
Epoch 17
Loss = 3.5702e-01, PNorm = 46.3248, GNorm = 0.6763, lr_0 = 2.8193e-04
Loss = 2.2957e-01, PNorm = 46.3420, GNorm = 0.3839, lr_0 = 2.7715e-04
Loss = 3.2247e-01, PNorm = 46.3656, GNorm = 0.9224, lr_0 = 2.7244e-04
Loss = 2.2625e-01, PNorm = 46.3895, GNorm = 0.6451, lr_0 = 2.6781e-04
Loss = 2.5294e-01, PNorm = 46.4125, GNorm = 0.5799, lr_0 = 2.6326e-04
Validation prc-auc = 0.926754
Validation auc = 0.944960
Epoch 18
Loss = 3.2789e-01, PNorm = 46.4363, GNorm = 1.4631, lr_0 = 2.5879e-04
Loss = 2.7651e-01, PNorm = 46.4519, GNorm = 0.9499, lr_0 = 2.5439e-04
Loss = 2.8642e-01, PNorm = 46.4747, GNorm = 0.5320, lr_0 = 2.5007e-04
Loss = 2.4376e-01, PNorm = 46.4915, GNorm = 0.4639, lr_0 = 2.4582e-04
Loss = 2.5148e-01, PNorm = 46.5167, GNorm = 0.4532, lr_0 = 2.4165e-04
Validation prc-auc = 0.926863
Validation auc = 0.946130
Epoch 19
Loss = 2.2666e-01, PNorm = 46.5338, GNorm = 0.4156, lr_0 = 2.3754e-04
Loss = 2.8283e-01, PNorm = 46.5616, GNorm = 2.0248, lr_0 = 2.3351e-04
Loss = 2.7379e-01, PNorm = 46.5762, GNorm = 0.5925, lr_0 = 2.2954e-04
Loss = 2.2061e-01, PNorm = 46.6072, GNorm = 0.6081, lr_0 = 2.2564e-04
Loss = 2.7088e-01, PNorm = 46.6237, GNorm = 0.4097, lr_0 = 2.2181e-04
Validation prc-auc = 0.927569
Validation auc = 0.945566
Epoch 20
Loss = 2.7066e-01, PNorm = 46.6390, GNorm = 0.3620, lr_0 = 2.1804e-04
Loss = 2.4449e-01, PNorm = 46.6551, GNorm = 0.8146, lr_0 = 2.1434e-04
Loss = 2.4634e-01, PNorm = 46.6670, GNorm = 0.3888, lr_0 = 2.1070e-04
Loss = 2.4003e-01, PNorm = 46.6899, GNorm = 0.4901, lr_0 = 2.0712e-04
Loss = 2.7062e-01, PNorm = 46.7018, GNorm = 0.4790, lr_0 = 2.0360e-04
Validation prc-auc = 0.928127
Validation auc = 0.945480
Epoch 21
Loss = 2.3286e-01, PNorm = 46.7202, GNorm = 0.4628, lr_0 = 1.9980e-04
Loss = 2.4571e-01, PNorm = 46.7383, GNorm = 0.3910, lr_0 = 1.9641e-04
Loss = 3.1180e-01, PNorm = 46.7510, GNorm = 0.7965, lr_0 = 1.9307e-04
Loss = 2.8628e-01, PNorm = 46.7610, GNorm = 0.5114, lr_0 = 1.8979e-04
Loss = 1.9716e-01, PNorm = 46.7738, GNorm = 0.3204, lr_0 = 1.8657e-04
Validation prc-auc = 0.925096
Validation auc = 0.945653
Epoch 22
Loss = 3.1514e-01, PNorm = 46.7945, GNorm = 1.2005, lr_0 = 1.8340e-04
Loss = 2.4063e-01, PNorm = 46.8081, GNorm = 0.5601, lr_0 = 1.8028e-04
Loss = 2.4892e-01, PNorm = 46.8225, GNorm = 0.3183, lr_0 = 1.7722e-04
Loss = 2.3575e-01, PNorm = 46.8380, GNorm = 0.5435, lr_0 = 1.7421e-04
Loss = 2.5287e-01, PNorm = 46.8525, GNorm = 0.3486, lr_0 = 1.7125e-04
Validation prc-auc = 0.925879
Validation auc = 0.946477
Epoch 23
Loss = 2.5645e-01, PNorm = 46.8676, GNorm = 0.3895, lr_0 = 1.6834e-04
Loss = 2.5149e-01, PNorm = 46.8828, GNorm = 0.8601, lr_0 = 1.6548e-04
Loss = 2.6281e-01, PNorm = 46.8952, GNorm = 0.4141, lr_0 = 1.6267e-04
Loss = 2.6166e-01, PNorm = 46.9069, GNorm = 0.6887, lr_0 = 1.5991e-04
Loss = 2.3125e-01, PNorm = 46.9198, GNorm = 1.0924, lr_0 = 1.5719e-04
Validation prc-auc = 0.926361
Validation auc = 0.945826
Epoch 24
Loss = 2.9684e-01, PNorm = 46.9357, GNorm = 1.9039, lr_0 = 1.5452e-04
Loss = 2.2648e-01, PNorm = 46.9437, GNorm = 0.6400, lr_0 = 1.5190e-04
Loss = 2.9028e-01, PNorm = 46.9570, GNorm = 0.9242, lr_0 = 1.4932e-04
Loss = 2.0667e-01, PNorm = 46.9696, GNorm = 0.3708, lr_0 = 1.4678e-04
Loss = 2.2439e-01, PNorm = 46.9803, GNorm = 0.8844, lr_0 = 1.4429e-04
Validation prc-auc = 0.926167
Validation auc = 0.946217
Epoch 25
Loss = 2.4781e-01, PNorm = 46.9935, GNorm = 0.3783, lr_0 = 1.4184e-04
Loss = 2.5855e-01, PNorm = 46.9974, GNorm = 0.3285, lr_0 = 1.3943e-04
Loss = 2.2823e-01, PNorm = 47.0116, GNorm = 0.5852, lr_0 = 1.3706e-04
Loss = 2.1656e-01, PNorm = 47.0241, GNorm = 0.3227, lr_0 = 1.3473e-04
Validation prc-auc = 0.925595
Validation auc = 0.946173
Epoch 26
Loss = 1.3111e-01, PNorm = 47.0368, GNorm = 0.4157, lr_0 = 1.3221e-04
Loss = 2.3807e-01, PNorm = 47.0497, GNorm = 0.5315, lr_0 = 1.2997e-04
Loss = 2.5808e-01, PNorm = 47.0547, GNorm = 0.5212, lr_0 = 1.2776e-04
Loss = 2.5392e-01, PNorm = 47.0624, GNorm = 0.7758, lr_0 = 1.2559e-04
Loss = 2.8671e-01, PNorm = 47.0755, GNorm = 0.4025, lr_0 = 1.2346e-04
Validation prc-auc = 0.925750
Validation auc = 0.945610
Epoch 27
Loss = 1.9495e-01, PNorm = 47.0791, GNorm = 0.3928, lr_0 = 1.2136e-04
Loss = 2.5573e-01, PNorm = 47.0951, GNorm = 0.5780, lr_0 = 1.1930e-04
Loss = 3.0200e-01, PNorm = 47.1051, GNorm = 0.6344, lr_0 = 1.1727e-04
Loss = 1.9548e-01, PNorm = 47.1105, GNorm = 0.4166, lr_0 = 1.1528e-04
Loss = 2.7029e-01, PNorm = 47.1243, GNorm = 0.5755, lr_0 = 1.1332e-04
Validation prc-auc = 0.926772
Validation auc = 0.946867
Epoch 28
Loss = 2.1771e-01, PNorm = 47.1308, GNorm = 0.3883, lr_0 = 1.1140e-04
Loss = 2.0935e-01, PNorm = 47.1410, GNorm = 0.4568, lr_0 = 1.0951e-04
Loss = 2.4323e-01, PNorm = 47.1530, GNorm = 1.0275, lr_0 = 1.0765e-04
Loss = 2.7496e-01, PNorm = 47.1571, GNorm = 0.8184, lr_0 = 1.0582e-04
Loss = 2.7222e-01, PNorm = 47.1623, GNorm = 0.4133, lr_0 = 1.0402e-04
Validation prc-auc = 0.926956
Validation auc = 0.947257
Epoch 29
Loss = 1.9419e-01, PNorm = 47.1711, GNorm = 0.4319, lr_0 = 1.0225e-04
Loss = 2.7609e-01, PNorm = 47.1818, GNorm = 0.8202, lr_0 = 1.0052e-04
Loss = 2.3151e-01, PNorm = 47.1896, GNorm = 0.4331, lr_0 = 1.0000e-04
Loss = 2.3837e-01, PNorm = 47.1981, GNorm = 0.4092, lr_0 = 1.0000e-04
Loss = 2.4022e-01, PNorm = 47.2016, GNorm = 0.5461, lr_0 = 1.0000e-04
Validation prc-auc = 0.928761
Validation auc = 0.947343
Model 0 best validation prc-auc = 0.930120 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.859733
Model 0 test auc = 0.952226
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.4944e-01, PNorm = 43.2435, GNorm = 0.8085, lr_0 = 2.0312e-04
Loss = 5.5333e-01, PNorm = 43.2527, GNorm = 0.9690, lr_0 = 2.9687e-04
Loss = 4.7648e-01, PNorm = 43.2707, GNorm = 1.5331, lr_0 = 3.9062e-04
Loss = 4.6196e-01, PNorm = 43.2933, GNorm = 0.8893, lr_0 = 4.8437e-04
Validation prc-auc = 0.893253
Validation auc = 0.921947
Epoch 1
Loss = 3.6213e-01, PNorm = 43.3250, GNorm = 1.5673, lr_0 = 5.8750e-04
Loss = 3.8751e-01, PNorm = 43.3575, GNorm = 0.7153, lr_0 = 6.8125e-04
Loss = 3.6828e-01, PNorm = 43.3996, GNorm = 0.4847, lr_0 = 7.7500e-04
Loss = 3.7441e-01, PNorm = 43.4407, GNorm = 0.3861, lr_0 = 8.6875e-04
Loss = 3.8021e-01, PNorm = 43.4935, GNorm = 0.4870, lr_0 = 9.6250e-04
Validation prc-auc = 0.885066
Validation auc = 0.930658
Epoch 2
Loss = 3.1415e-01, PNorm = 43.5321, GNorm = 0.8075, lr_0 = 9.8977e-04
Loss = 3.9603e-01, PNorm = 43.5828, GNorm = 0.5358, lr_0 = 9.7296e-04
Loss = 3.6098e-01, PNorm = 43.6359, GNorm = 0.7141, lr_0 = 9.5643e-04
Loss = 3.3742e-01, PNorm = 43.6856, GNorm = 0.4227, lr_0 = 9.4019e-04
Loss = 3.1837e-01, PNorm = 43.7368, GNorm = 0.5123, lr_0 = 9.2422e-04
Validation prc-auc = 0.908758
Validation auc = 0.932998
Epoch 3
Loss = 3.0716e-01, PNorm = 43.7699, GNorm = 0.7709, lr_0 = 9.0852e-04
Loss = 3.3957e-01, PNorm = 43.8104, GNorm = 0.7185, lr_0 = 8.9309e-04
Loss = 3.5398e-01, PNorm = 43.8545, GNorm = 0.5377, lr_0 = 8.7791e-04
Loss = 3.2949e-01, PNorm = 43.9067, GNorm = 0.3919, lr_0 = 8.6300e-04
Loss = 3.0505e-01, PNorm = 43.9544, GNorm = 0.5628, lr_0 = 8.4834e-04
Validation prc-auc = 0.913971
Validation auc = 0.935382
Epoch 4
Loss = 3.5986e-01, PNorm = 43.9961, GNorm = 0.7287, lr_0 = 8.3393e-04
Loss = 2.8971e-01, PNorm = 44.0548, GNorm = 0.9086, lr_0 = 8.1977e-04
Loss = 3.4780e-01, PNorm = 44.1001, GNorm = 0.7998, lr_0 = 8.0584e-04
Loss = 2.9656e-01, PNorm = 44.1427, GNorm = 0.8550, lr_0 = 7.9215e-04
Loss = 3.4021e-01, PNorm = 44.1896, GNorm = 0.9774, lr_0 = 7.7870e-04
Validation prc-auc = 0.923281
Validation auc = 0.940106
Epoch 5
Loss = 3.2385e-01, PNorm = 44.2218, GNorm = 0.4173, lr_0 = 7.6547e-04
Loss = 3.1003e-01, PNorm = 44.2712, GNorm = 0.3881, lr_0 = 7.5247e-04
Loss = 3.0248e-01, PNorm = 44.3289, GNorm = 0.4389, lr_0 = 7.3969e-04
Loss = 3.2611e-01, PNorm = 44.3822, GNorm = 0.6389, lr_0 = 7.2712e-04
Loss = 3.2188e-01, PNorm = 44.4349, GNorm = 0.5044, lr_0 = 7.1477e-04
Validation prc-auc = 0.922710
Validation auc = 0.940929
Epoch 6
Loss = 2.6678e-01, PNorm = 44.4979, GNorm = 0.5416, lr_0 = 7.0143e-04
Loss = 2.9299e-01, PNorm = 44.5511, GNorm = 0.9219, lr_0 = 6.8951e-04
Loss = 3.1925e-01, PNorm = 44.6119, GNorm = 0.7341, lr_0 = 6.7780e-04
Loss = 3.3480e-01, PNorm = 44.6667, GNorm = 0.8917, lr_0 = 6.6629e-04
Loss = 3.1967e-01, PNorm = 44.7096, GNorm = 0.3545, lr_0 = 6.5497e-04
Validation prc-auc = 0.918667
Validation auc = 0.937115
Epoch 7
Loss = 2.8922e-01, PNorm = 44.7646, GNorm = 0.4468, lr_0 = 6.4384e-04
Loss = 2.7135e-01, PNorm = 44.8253, GNorm = 0.4532, lr_0 = 6.3291e-04
Loss = 4.0550e-01, PNorm = 44.8644, GNorm = 0.7896, lr_0 = 6.2216e-04
Loss = 2.9344e-01, PNorm = 44.8934, GNorm = 0.3809, lr_0 = 6.1159e-04
Loss = 2.7954e-01, PNorm = 44.9413, GNorm = 0.4449, lr_0 = 6.0120e-04
Validation prc-auc = 0.919735
Validation auc = 0.937029
Epoch 8
Loss = 3.3414e-01, PNorm = 44.9996, GNorm = 0.8703, lr_0 = 5.9099e-04
Loss = 2.9062e-01, PNorm = 45.0412, GNorm = 0.3293, lr_0 = 5.8095e-04
Loss = 2.9375e-01, PNorm = 45.0791, GNorm = 0.3584, lr_0 = 5.7108e-04
Loss = 2.7818e-01, PNorm = 45.1357, GNorm = 0.4143, lr_0 = 5.6138e-04
Validation prc-auc = 0.926132
Validation auc = 0.940192
Epoch 9
Loss = 2.7454e-01, PNorm = 45.1849, GNorm = 0.4460, lr_0 = 5.5184e-04
Loss = 2.8965e-01, PNorm = 45.2530, GNorm = 0.6295, lr_0 = 5.4247e-04
Loss = 2.6624e-01, PNorm = 45.3170, GNorm = 1.0023, lr_0 = 5.3325e-04
Loss = 2.9318e-01, PNorm = 45.3481, GNorm = 1.8999, lr_0 = 5.2420e-04
Loss = 3.2361e-01, PNorm = 45.3668, GNorm = 0.8360, lr_0 = 5.1529e-04
Validation prc-auc = 0.926709
Validation auc = 0.942316
Epoch 10
Loss = 2.0919e-01, PNorm = 45.4033, GNorm = 0.3424, lr_0 = 5.0654e-04
Loss = 2.9684e-01, PNorm = 45.4461, GNorm = 0.3199, lr_0 = 4.9793e-04
Loss = 2.9915e-01, PNorm = 45.4859, GNorm = 0.9118, lr_0 = 4.8948e-04
Loss = 2.8156e-01, PNorm = 45.5223, GNorm = 0.3514, lr_0 = 4.8116e-04
Loss = 2.9421e-01, PNorm = 45.5633, GNorm = 0.4208, lr_0 = 4.7299e-04
Validation prc-auc = 0.927693
Validation auc = 0.943530
Epoch 11
Loss = 2.6092e-01, PNorm = 45.6097, GNorm = 0.5034, lr_0 = 4.6416e-04
Loss = 3.0749e-01, PNorm = 45.6441, GNorm = 0.4307, lr_0 = 4.5627e-04
Loss = 3.1182e-01, PNorm = 45.6983, GNorm = 0.9666, lr_0 = 4.4852e-04
Loss = 2.6373e-01, PNorm = 45.7306, GNorm = 0.6903, lr_0 = 4.4091e-04
Loss = 2.3508e-01, PNorm = 45.7884, GNorm = 0.7212, lr_0 = 4.3342e-04
Validation prc-auc = 0.910573
Validation auc = 0.937332
Epoch 12
Loss = 3.0141e-01, PNorm = 45.8285, GNorm = 0.9888, lr_0 = 4.2605e-04
Loss = 2.6749e-01, PNorm = 45.8639, GNorm = 0.8011, lr_0 = 4.1882e-04
Loss = 3.1269e-01, PNorm = 45.8870, GNorm = 0.6755, lr_0 = 4.1170e-04
Loss = 2.5933e-01, PNorm = 45.9144, GNorm = 0.3756, lr_0 = 4.0471e-04
Loss = 3.0102e-01, PNorm = 45.9500, GNorm = 0.5126, lr_0 = 3.9783e-04
Validation prc-auc = 0.924538
Validation auc = 0.940279
Epoch 13
Loss = 3.1177e-01, PNorm = 45.9831, GNorm = 0.5548, lr_0 = 3.9108e-04
Loss = 2.1287e-01, PNorm = 46.0151, GNorm = 0.4437, lr_0 = 3.8443e-04
Loss = 2.8178e-01, PNorm = 46.0482, GNorm = 0.4615, lr_0 = 3.7790e-04
Loss = 2.6942e-01, PNorm = 46.0755, GNorm = 0.4257, lr_0 = 3.7148e-04
Loss = 3.2699e-01, PNorm = 46.1074, GNorm = 0.3831, lr_0 = 3.6517e-04
Validation prc-auc = 0.922301
Validation auc = 0.940149
Epoch 14
Loss = 2.8438e-01, PNorm = 46.1255, GNorm = 0.8420, lr_0 = 3.5897e-04
Loss = 2.5538e-01, PNorm = 46.1603, GNorm = 1.0450, lr_0 = 3.5287e-04
Loss = 2.6342e-01, PNorm = 46.1880, GNorm = 0.4478, lr_0 = 3.4688e-04
Loss = 2.9188e-01, PNorm = 46.2276, GNorm = 0.6208, lr_0 = 3.4099e-04
Loss = 2.6136e-01, PNorm = 46.2499, GNorm = 0.5657, lr_0 = 3.3520e-04
Validation prc-auc = 0.924320
Validation auc = 0.939846
Epoch 15
Loss = 2.3145e-01, PNorm = 46.2778, GNorm = 0.5331, lr_0 = 3.2950e-04
Loss = 2.7753e-01, PNorm = 46.2998, GNorm = 0.3544, lr_0 = 3.2390e-04
Loss = 2.6748e-01, PNorm = 46.3309, GNorm = 0.6107, lr_0 = 3.1840e-04
Loss = 2.6729e-01, PNorm = 46.3619, GNorm = 1.4147, lr_0 = 3.1299e-04
Loss = 2.7952e-01, PNorm = 46.3824, GNorm = 0.6779, lr_0 = 3.0768e-04
Loss = 4.5088e-01, PNorm = 46.3848, GNorm = 1.0124, lr_0 = 3.0715e-04
Validation prc-auc = 0.922227
Validation auc = 0.943876
Epoch 16
Loss = 2.6831e-01, PNorm = 46.4254, GNorm = 0.4568, lr_0 = 3.0193e-04
Loss = 2.7429e-01, PNorm = 46.4421, GNorm = 0.8876, lr_0 = 2.9680e-04
Loss = 2.8327e-01, PNorm = 46.4662, GNorm = 0.4894, lr_0 = 2.9176e-04
Loss = 2.3328e-01, PNorm = 46.4913, GNorm = 0.3115, lr_0 = 2.8681e-04
Validation prc-auc = 0.918104
Validation auc = 0.941709
Epoch 17
Loss = 3.2400e-01, PNorm = 46.5241, GNorm = 1.1400, lr_0 = 2.8193e-04
Loss = 2.6054e-01, PNorm = 46.5320, GNorm = 0.3431, lr_0 = 2.7715e-04
Loss = 2.4143e-01, PNorm = 46.5559, GNorm = 0.4652, lr_0 = 2.7244e-04
Loss = 2.8040e-01, PNorm = 46.5798, GNorm = 0.5048, lr_0 = 2.6781e-04
Loss = 2.4347e-01, PNorm = 46.6073, GNorm = 0.4271, lr_0 = 2.6326e-04
Validation prc-auc = 0.923034
Validation auc = 0.943963
Epoch 18
Loss = 2.5102e-01, PNorm = 46.6302, GNorm = 0.3300, lr_0 = 2.5879e-04
Loss = 2.6450e-01, PNorm = 46.6569, GNorm = 0.6896, lr_0 = 2.5439e-04
Loss = 2.6591e-01, PNorm = 46.6743, GNorm = 0.8424, lr_0 = 2.5007e-04
Loss = 2.6370e-01, PNorm = 46.6970, GNorm = 0.4839, lr_0 = 2.4582e-04
Loss = 2.1170e-01, PNorm = 46.7148, GNorm = 0.4064, lr_0 = 2.4165e-04
Validation prc-auc = 0.920824
Validation auc = 0.942749
Epoch 19
Loss = 2.2218e-01, PNorm = 46.7406, GNorm = 0.5143, lr_0 = 2.3754e-04
Loss = 2.5973e-01, PNorm = 46.7627, GNorm = 0.9165, lr_0 = 2.3351e-04
Loss = 2.6540e-01, PNorm = 46.7784, GNorm = 0.3094, lr_0 = 2.2954e-04
Loss = 2.6495e-01, PNorm = 46.8082, GNorm = 0.5479, lr_0 = 2.2564e-04
Loss = 2.5142e-01, PNorm = 46.8197, GNorm = 0.4256, lr_0 = 2.2181e-04
Validation prc-auc = 0.924700
Validation auc = 0.945306
Epoch 20
Loss = 2.7227e-01, PNorm = 46.8461, GNorm = 0.4958, lr_0 = 2.1804e-04
Loss = 2.2125e-01, PNorm = 46.8663, GNorm = 0.3376, lr_0 = 2.1434e-04
Loss = 2.9140e-01, PNorm = 46.8806, GNorm = 0.4545, lr_0 = 2.1070e-04
Loss = 2.7875e-01, PNorm = 46.8984, GNorm = 1.3232, lr_0 = 2.0712e-04
Loss = 2.3258e-01, PNorm = 46.9132, GNorm = 0.4166, lr_0 = 2.0360e-04
Validation prc-auc = 0.924761
Validation auc = 0.945220
Epoch 21
Loss = 2.9406e-01, PNorm = 46.9331, GNorm = 0.4678, lr_0 = 1.9980e-04
Loss = 2.3365e-01, PNorm = 46.9598, GNorm = 0.7519, lr_0 = 1.9641e-04
Loss = 2.3568e-01, PNorm = 46.9736, GNorm = 0.5176, lr_0 = 1.9307e-04
Loss = 2.3278e-01, PNorm = 46.9893, GNorm = 0.4290, lr_0 = 1.8979e-04
Loss = 2.7941e-01, PNorm = 47.0066, GNorm = 0.6594, lr_0 = 1.8657e-04
Validation prc-auc = 0.922616
Validation auc = 0.944873
Epoch 22
Loss = 2.7700e-01, PNorm = 47.0223, GNorm = 0.6325, lr_0 = 1.8340e-04
Loss = 2.4498e-01, PNorm = 47.0351, GNorm = 0.3459, lr_0 = 1.8028e-04
Loss = 2.3700e-01, PNorm = 47.0561, GNorm = 0.5817, lr_0 = 1.7722e-04
Loss = 2.2160e-01, PNorm = 47.0677, GNorm = 0.3532, lr_0 = 1.7421e-04
Loss = 2.3470e-01, PNorm = 47.0821, GNorm = 0.4691, lr_0 = 1.7125e-04
Validation prc-auc = 0.925313
Validation auc = 0.945696
Epoch 23
Loss = 2.1957e-01, PNorm = 47.0952, GNorm = 0.5973, lr_0 = 1.6834e-04
Loss = 2.2675e-01, PNorm = 47.1119, GNorm = 1.2018, lr_0 = 1.6548e-04
Loss = 2.3939e-01, PNorm = 47.1272, GNorm = 0.6710, lr_0 = 1.6267e-04
Loss = 2.7110e-01, PNorm = 47.1407, GNorm = 0.3294, lr_0 = 1.5991e-04
Loss = 2.2733e-01, PNorm = 47.1536, GNorm = 0.4226, lr_0 = 1.5719e-04
Validation prc-auc = 0.925283
Validation auc = 0.945523
Epoch 24
Loss = 2.1851e-01, PNorm = 47.1594, GNorm = 0.5000, lr_0 = 1.5452e-04
Loss = 2.9531e-01, PNorm = 47.1737, GNorm = 0.6522, lr_0 = 1.5190e-04
Loss = 2.0472e-01, PNorm = 47.1845, GNorm = 0.4080, lr_0 = 1.4932e-04
Loss = 2.4387e-01, PNorm = 47.2053, GNorm = 0.3133, lr_0 = 1.4678e-04
Loss = 2.4708e-01, PNorm = 47.2201, GNorm = 1.4300, lr_0 = 1.4429e-04
Validation prc-auc = 0.926998
Validation auc = 0.946477
Epoch 25
Loss = 2.0469e-01, PNorm = 47.2302, GNorm = 0.4077, lr_0 = 1.4184e-04
Loss = 2.3326e-01, PNorm = 47.2413, GNorm = 0.3393, lr_0 = 1.3943e-04
Loss = 2.1288e-01, PNorm = 47.2537, GNorm = 0.4279, lr_0 = 1.3706e-04
Loss = 2.1217e-01, PNorm = 47.2690, GNorm = 0.4692, lr_0 = 1.3473e-04
Validation prc-auc = 0.926769
Validation auc = 0.947560
Epoch 26
Loss = 1.5663e-01, PNorm = 47.2812, GNorm = 0.6320, lr_0 = 1.3221e-04
Loss = 2.1702e-01, PNorm = 47.2855, GNorm = 0.6519, lr_0 = 1.2997e-04
Loss = 2.7802e-01, PNorm = 47.2994, GNorm = 0.8691, lr_0 = 1.2776e-04
Loss = 2.4166e-01, PNorm = 47.3098, GNorm = 0.4371, lr_0 = 1.2559e-04
Loss = 2.2033e-01, PNorm = 47.3188, GNorm = 0.4969, lr_0 = 1.2346e-04
Validation prc-auc = 0.925853
Validation auc = 0.945393
Epoch 27
Loss = 1.9710e-01, PNorm = 47.3277, GNorm = 0.4683, lr_0 = 1.2136e-04
Loss = 2.0636e-01, PNorm = 47.3416, GNorm = 0.8456, lr_0 = 1.1930e-04
Loss = 2.2195e-01, PNorm = 47.3519, GNorm = 0.4585, lr_0 = 1.1727e-04
Loss = 2.2502e-01, PNorm = 47.3608, GNorm = 0.9329, lr_0 = 1.1528e-04
Loss = 3.1874e-01, PNorm = 47.3673, GNorm = 0.9543, lr_0 = 1.1332e-04
Validation prc-auc = 0.924480
Validation auc = 0.945220
Epoch 28
Loss = 2.1857e-01, PNorm = 47.3706, GNorm = 0.6115, lr_0 = 1.1140e-04
Loss = 1.8808e-01, PNorm = 47.3847, GNorm = 0.5280, lr_0 = 1.0951e-04
Loss = 2.6306e-01, PNorm = 47.3940, GNorm = 0.4238, lr_0 = 1.0765e-04
Loss = 2.3221e-01, PNorm = 47.4045, GNorm = 0.5544, lr_0 = 1.0582e-04
Loss = 2.3042e-01, PNorm = 47.4105, GNorm = 0.6627, lr_0 = 1.0402e-04
Validation prc-auc = 0.925312
Validation auc = 0.944786
Epoch 29
Loss = 1.9953e-01, PNorm = 47.4178, GNorm = 0.6512, lr_0 = 1.0225e-04
Loss = 2.3414e-01, PNorm = 47.4264, GNorm = 0.6649, lr_0 = 1.0052e-04
Loss = 2.3079e-01, PNorm = 47.4350, GNorm = 0.6856, lr_0 = 1.0000e-04
Loss = 2.4113e-01, PNorm = 47.4490, GNorm = 1.0131, lr_0 = 1.0000e-04
Loss = 2.3726e-01, PNorm = 47.4507, GNorm = 0.6566, lr_0 = 1.0000e-04
Validation prc-auc = 0.925603
Validation auc = 0.944873
Model 1 best validation prc-auc = 0.927693 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.833766
Model 1 test auc = 0.950041
Ensemble test prc-auc = 0.847597
Ensemble test auc = 0.950915
Fold 4
Splitting data with seed 4
Total scaffolds = 746 | train scaffolds = 610 | val scaffolds = 57 | test scaffolds = 79
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 144 | target average = 0.041667


Scaffold 1
Task 0: count = 57 | target average = 0.912281


Scaffold 2
Task 0: count = 53 | target average = 0.018868


Scaffold 3
Task 0: count = 52 | target average = 0.019231


Scaffold 4
Task 0: count = 45 | target average = 0.066667


Scaffold 5
Task 0: count = 45 | target average = 0.044444


Scaffold 6
Task 0: count = 44 | target average = 0.068182


Scaffold 7
Task 0: count = 42 | target average = 0.023810


Scaffold 8
Task 0: count = 38 | target average = 0.157895


Scaffold 9
Task 0: count = 36 | target average = 0.000000


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.5756e-01, PNorm = 43.2195, GNorm = 0.6881, lr_0 = 2.0312e-04
Loss = 5.2692e-01, PNorm = 43.2291, GNorm = 0.7319, lr_0 = 2.9687e-04
Loss = 4.9241e-01, PNorm = 43.2459, GNorm = 1.1872, lr_0 = 3.9062e-04
Loss = 4.0632e-01, PNorm = 43.2693, GNorm = 1.1380, lr_0 = 4.8437e-04
Validation prc-auc = 0.784180
Validation auc = 0.891085
Epoch 1
Loss = 3.3301e-01, PNorm = 43.3031, GNorm = 0.9904, lr_0 = 5.8750e-04
Loss = 4.0869e-01, PNorm = 43.3407, GNorm = 0.4208, lr_0 = 6.8125e-04
Loss = 3.6200e-01, PNorm = 43.3785, GNorm = 0.8446, lr_0 = 7.7500e-04
Loss = 3.4537e-01, PNorm = 43.4198, GNorm = 1.8693, lr_0 = 8.6875e-04
Loss = 4.0658e-01, PNorm = 43.4637, GNorm = 0.9608, lr_0 = 9.6250e-04
Validation prc-auc = 0.770248
Validation auc = 0.893721
Epoch 2
Loss = 3.6597e-01, PNorm = 43.5168, GNorm = 0.8544, lr_0 = 9.8977e-04
Loss = 3.3693e-01, PNorm = 43.5756, GNorm = 0.9307, lr_0 = 9.7296e-04
Loss = 3.7050e-01, PNorm = 43.6268, GNorm = 0.6528, lr_0 = 9.5643e-04
Loss = 3.0735e-01, PNorm = 43.6656, GNorm = 0.4867, lr_0 = 9.4019e-04
Loss = 3.3771e-01, PNorm = 43.7080, GNorm = 0.7036, lr_0 = 9.2422e-04
Validation prc-auc = 0.795538
Validation auc = 0.897700
Epoch 3
Loss = 3.9241e-01, PNorm = 43.7468, GNorm = 0.8743, lr_0 = 9.0852e-04
Loss = 3.0163e-01, PNorm = 43.7823, GNorm = 1.0493, lr_0 = 8.9309e-04
Loss = 3.2218e-01, PNorm = 43.8255, GNorm = 0.4091, lr_0 = 8.7791e-04
Loss = 3.5248e-01, PNorm = 43.8715, GNorm = 0.4112, lr_0 = 8.6300e-04
Loss = 2.9506e-01, PNorm = 43.9210, GNorm = 0.5600, lr_0 = 8.4834e-04
Validation prc-auc = 0.735368
Validation auc = 0.893307
Epoch 4
Loss = 2.7023e-01, PNorm = 43.9863, GNorm = 0.3789, lr_0 = 8.3393e-04
Loss = 2.9068e-01, PNorm = 44.0443, GNorm = 0.6088, lr_0 = 8.1977e-04
Loss = 3.5798e-01, PNorm = 44.1016, GNorm = 0.4455, lr_0 = 8.0584e-04
Loss = 3.3142e-01, PNorm = 44.1487, GNorm = 0.4583, lr_0 = 7.9215e-04
Loss = 2.9312e-01, PNorm = 44.2019, GNorm = 0.5347, lr_0 = 7.7870e-04
Validation prc-auc = 0.734962
Validation auc = 0.891395
Epoch 5
Loss = 3.2127e-01, PNorm = 44.2457, GNorm = 0.3292, lr_0 = 7.6547e-04
Loss = 2.7407e-01, PNorm = 44.2986, GNorm = 0.6607, lr_0 = 7.5247e-04
Loss = 3.3772e-01, PNorm = 44.3310, GNorm = 0.5245, lr_0 = 7.3969e-04
Loss = 2.9373e-01, PNorm = 44.3778, GNorm = 0.6345, lr_0 = 7.2712e-04
Loss = 3.0404e-01, PNorm = 44.4235, GNorm = 0.3332, lr_0 = 7.1477e-04
Validation prc-auc = 0.748763
Validation auc = 0.895581
Epoch 6
Loss = 3.0044e-01, PNorm = 44.4922, GNorm = 0.3040, lr_0 = 7.0143e-04
Loss = 2.9841e-01, PNorm = 44.5464, GNorm = 0.4292, lr_0 = 6.8951e-04
Loss = 2.8775e-01, PNorm = 44.5987, GNorm = 0.4294, lr_0 = 6.7780e-04
Loss = 2.8752e-01, PNorm = 44.6365, GNorm = 0.5162, lr_0 = 6.6629e-04
Loss = 3.1627e-01, PNorm = 44.6628, GNorm = 0.5081, lr_0 = 6.5497e-04
Validation prc-auc = 0.752596
Validation auc = 0.896718
Epoch 7
Loss = 2.8674e-01, PNorm = 44.7135, GNorm = 1.2912, lr_0 = 6.4384e-04
Loss = 2.6280e-01, PNorm = 44.7747, GNorm = 0.3841, lr_0 = 6.3291e-04
Loss = 3.0333e-01, PNorm = 44.8167, GNorm = 0.4514, lr_0 = 6.2216e-04
Loss = 3.2903e-01, PNorm = 44.8613, GNorm = 0.5074, lr_0 = 6.1159e-04
Loss = 2.7708e-01, PNorm = 44.9038, GNorm = 0.7414, lr_0 = 6.0120e-04
Validation prc-auc = 0.733390
Validation auc = 0.893049
Epoch 8
Loss = 2.9911e-01, PNorm = 44.9526, GNorm = 1.2255, lr_0 = 5.9099e-04
Loss = 2.6712e-01, PNorm = 45.0018, GNorm = 0.3440, lr_0 = 5.8095e-04
Loss = 2.8351e-01, PNorm = 45.0323, GNorm = 0.6101, lr_0 = 5.7108e-04
Loss = 2.8385e-01, PNorm = 45.0911, GNorm = 0.8506, lr_0 = 5.6138e-04
Validation prc-auc = 0.726516
Validation auc = 0.888553
Epoch 9
Loss = 2.7141e-01, PNorm = 45.1270, GNorm = 0.9565, lr_0 = 5.5184e-04
Loss = 3.0624e-01, PNorm = 45.1557, GNorm = 0.4316, lr_0 = 5.4247e-04
Loss = 3.1031e-01, PNorm = 45.2067, GNorm = 0.3766, lr_0 = 5.3325e-04
Loss = 2.2237e-01, PNorm = 45.2618, GNorm = 0.3259, lr_0 = 5.2420e-04
Loss = 2.6413e-01, PNorm = 45.2937, GNorm = 0.2810, lr_0 = 5.1529e-04
Validation prc-auc = 0.745732
Validation auc = 0.888811
Epoch 10
Loss = 3.0664e-01, PNorm = 45.3358, GNorm = 0.8333, lr_0 = 5.0654e-04
Loss = 2.3025e-01, PNorm = 45.3950, GNorm = 1.1778, lr_0 = 4.9793e-04
Loss = 2.6493e-01, PNorm = 45.4354, GNorm = 0.3756, lr_0 = 4.8948e-04
Loss = 3.1944e-01, PNorm = 45.4822, GNorm = 0.2809, lr_0 = 4.8116e-04
Loss = 2.8299e-01, PNorm = 45.5114, GNorm = 0.5250, lr_0 = 4.7299e-04
Validation prc-auc = 0.734692
Validation auc = 0.887778
Epoch 11
Loss = 2.5071e-01, PNorm = 45.5540, GNorm = 0.3668, lr_0 = 4.6416e-04
Loss = 2.6353e-01, PNorm = 45.6017, GNorm = 0.4673, lr_0 = 4.5627e-04
Loss = 2.8329e-01, PNorm = 45.6366, GNorm = 0.5199, lr_0 = 4.4852e-04
Loss = 2.4982e-01, PNorm = 45.6792, GNorm = 0.7359, lr_0 = 4.4091e-04
Loss = 2.8411e-01, PNorm = 45.7066, GNorm = 0.4956, lr_0 = 4.3342e-04
Validation prc-auc = 0.740474
Validation auc = 0.876822
Epoch 12
Loss = 2.0849e-01, PNorm = 45.7477, GNorm = 0.3712, lr_0 = 4.2605e-04
Loss = 2.5786e-01, PNorm = 45.8046, GNorm = 0.4665, lr_0 = 4.1882e-04
Loss = 2.7409e-01, PNorm = 45.8242, GNorm = 0.5088, lr_0 = 4.1170e-04
Loss = 2.8714e-01, PNorm = 45.8724, GNorm = 0.9094, lr_0 = 4.0471e-04
Loss = 2.8477e-01, PNorm = 45.9038, GNorm = 0.4056, lr_0 = 3.9783e-04
Validation prc-auc = 0.739308
Validation auc = 0.882196
Epoch 13
Loss = 2.9659e-01, PNorm = 45.9266, GNorm = 0.8214, lr_0 = 3.9108e-04
Loss = 2.2227e-01, PNorm = 45.9656, GNorm = 0.5026, lr_0 = 3.8443e-04
Loss = 2.9306e-01, PNorm = 46.0038, GNorm = 1.0021, lr_0 = 3.7790e-04
Loss = 2.8765e-01, PNorm = 46.0298, GNorm = 0.5665, lr_0 = 3.7148e-04
Loss = 2.2839e-01, PNorm = 46.0600, GNorm = 0.3766, lr_0 = 3.6517e-04
Validation prc-auc = 0.740882
Validation auc = 0.876563
Epoch 14
Loss = 2.5766e-01, PNorm = 46.0941, GNorm = 0.4222, lr_0 = 3.5897e-04
Loss = 2.6999e-01, PNorm = 46.1311, GNorm = 0.6504, lr_0 = 3.5287e-04
Loss = 2.8333e-01, PNorm = 46.1606, GNorm = 0.5275, lr_0 = 3.4688e-04
Loss = 2.0487e-01, PNorm = 46.1839, GNorm = 0.3583, lr_0 = 3.4099e-04
Loss = 2.7842e-01, PNorm = 46.2286, GNorm = 0.6866, lr_0 = 3.3520e-04
Validation prc-auc = 0.739932
Validation auc = 0.875530
Epoch 15
Loss = 2.3104e-01, PNorm = 46.2526, GNorm = 0.8280, lr_0 = 3.2950e-04
Loss = 2.5044e-01, PNorm = 46.2831, GNorm = 0.5514, lr_0 = 3.2390e-04
Loss = 2.2495e-01, PNorm = 46.3128, GNorm = 0.4651, lr_0 = 3.1840e-04
Loss = 2.5361e-01, PNorm = 46.3379, GNorm = 0.3317, lr_0 = 3.1299e-04
Loss = 3.0185e-01, PNorm = 46.3560, GNorm = 0.2971, lr_0 = 3.0768e-04
Loss = 2.4053e-01, PNorm = 46.3572, GNorm = 0.6315, lr_0 = 3.0715e-04
Validation prc-auc = 0.742304
Validation auc = 0.878062
Epoch 16
Loss = 2.8775e-01, PNorm = 46.3802, GNorm = 0.3792, lr_0 = 3.0193e-04
Loss = 2.5495e-01, PNorm = 46.4045, GNorm = 0.5119, lr_0 = 2.9680e-04
Loss = 2.2334e-01, PNorm = 46.4434, GNorm = 0.8295, lr_0 = 2.9176e-04
Loss = 2.7881e-01, PNorm = 46.4684, GNorm = 0.5031, lr_0 = 2.8681e-04
Validation prc-auc = 0.740854
Validation auc = 0.875736
Epoch 17
Loss = 1.7088e-01, PNorm = 46.4820, GNorm = 0.5333, lr_0 = 2.8193e-04
Loss = 2.0416e-01, PNorm = 46.5142, GNorm = 0.3404, lr_0 = 2.7715e-04
Loss = 3.0420e-01, PNorm = 46.5366, GNorm = 0.5898, lr_0 = 2.7244e-04
Loss = 2.6736e-01, PNorm = 46.5462, GNorm = 0.3672, lr_0 = 2.6781e-04
Loss = 2.4417e-01, PNorm = 46.5821, GNorm = 0.4845, lr_0 = 2.6326e-04
Validation prc-auc = 0.741513
Validation auc = 0.874289
Epoch 18
Loss = 2.5940e-01, PNorm = 46.6060, GNorm = 0.5041, lr_0 = 2.5879e-04
Loss = 2.4653e-01, PNorm = 46.6274, GNorm = 0.8905, lr_0 = 2.5439e-04
Loss = 2.1661e-01, PNorm = 46.6505, GNorm = 0.3844, lr_0 = 2.5007e-04
Loss = 2.6509e-01, PNorm = 46.6615, GNorm = 0.5684, lr_0 = 2.4582e-04
Loss = 2.6492e-01, PNorm = 46.6799, GNorm = 0.6426, lr_0 = 2.4165e-04
Validation prc-auc = 0.743694
Validation auc = 0.876460
Epoch 19
Loss = 1.9234e-01, PNorm = 46.7022, GNorm = 0.3978, lr_0 = 2.3754e-04
Loss = 2.2439e-01, PNorm = 46.7318, GNorm = 0.5016, lr_0 = 2.3351e-04
Loss = 2.5739e-01, PNorm = 46.7473, GNorm = 1.2339, lr_0 = 2.2954e-04
Loss = 2.2894e-01, PNorm = 46.7623, GNorm = 0.3005, lr_0 = 2.2564e-04
Loss = 2.7541e-01, PNorm = 46.7869, GNorm = 0.5721, lr_0 = 2.2181e-04
Validation prc-auc = 0.741262
Validation auc = 0.874910
Epoch 20
Loss = 2.4501e-01, PNorm = 46.8047, GNorm = 1.0554, lr_0 = 2.1804e-04
Loss = 2.3658e-01, PNorm = 46.8209, GNorm = 0.3141, lr_0 = 2.1434e-04
Loss = 2.6801e-01, PNorm = 46.8350, GNorm = 0.9753, lr_0 = 2.1070e-04
Loss = 2.3819e-01, PNorm = 46.8590, GNorm = 0.5376, lr_0 = 2.0712e-04
Loss = 2.1924e-01, PNorm = 46.8768, GNorm = 0.4722, lr_0 = 2.0360e-04
Validation prc-auc = 0.734982
Validation auc = 0.874599
Epoch 21
Loss = 2.6303e-01, PNorm = 46.9009, GNorm = 0.4103, lr_0 = 1.9980e-04
Loss = 2.6110e-01, PNorm = 46.9153, GNorm = 0.9409, lr_0 = 1.9641e-04
Loss = 2.5293e-01, PNorm = 46.9328, GNorm = 0.5341, lr_0 = 1.9307e-04
Loss = 2.1858e-01, PNorm = 46.9479, GNorm = 0.6879, lr_0 = 1.8979e-04
Loss = 2.2527e-01, PNorm = 46.9762, GNorm = 0.2990, lr_0 = 1.8657e-04
Validation prc-auc = 0.742845
Validation auc = 0.872868
Epoch 22
Loss = 2.5766e-01, PNorm = 46.9912, GNorm = 0.7710, lr_0 = 1.8340e-04
Loss = 2.6588e-01, PNorm = 47.0102, GNorm = 0.4632, lr_0 = 1.8028e-04
Loss = 2.0267e-01, PNorm = 47.0246, GNorm = 0.3296, lr_0 = 1.7722e-04
Loss = 2.0766e-01, PNorm = 47.0432, GNorm = 0.6175, lr_0 = 1.7421e-04
Loss = 2.2092e-01, PNorm = 47.0551, GNorm = 0.6381, lr_0 = 1.7125e-04
Validation prc-auc = 0.742385
Validation auc = 0.873824
Epoch 23
Loss = 1.9881e-01, PNorm = 47.0665, GNorm = 0.4400, lr_0 = 1.6834e-04
Loss = 1.9953e-01, PNorm = 47.0838, GNorm = 0.2838, lr_0 = 1.6548e-04
Loss = 2.5812e-01, PNorm = 47.0928, GNorm = 0.3543, lr_0 = 1.6267e-04
Loss = 2.1846e-01, PNorm = 47.1077, GNorm = 0.5238, lr_0 = 1.5991e-04
Loss = 2.5117e-01, PNorm = 47.1222, GNorm = 0.6791, lr_0 = 1.5719e-04
Validation prc-auc = 0.739339
Validation auc = 0.870568
Epoch 24
Loss = 2.5504e-01, PNorm = 47.1326, GNorm = 0.5476, lr_0 = 1.5452e-04
Loss = 2.4711e-01, PNorm = 47.1492, GNorm = 0.5910, lr_0 = 1.5190e-04
Loss = 2.2853e-01, PNorm = 47.1545, GNorm = 0.5938, lr_0 = 1.4932e-04
Loss = 1.9889e-01, PNorm = 47.1661, GNorm = 0.3387, lr_0 = 1.4678e-04
Loss = 2.2677e-01, PNorm = 47.1787, GNorm = 0.6718, lr_0 = 1.4429e-04
Validation prc-auc = 0.740793
Validation auc = 0.870724
Epoch 25
Loss = 2.4125e-01, PNorm = 47.1983, GNorm = 0.5797, lr_0 = 1.4184e-04
Loss = 2.3547e-01, PNorm = 47.2061, GNorm = 0.3998, lr_0 = 1.3943e-04
Loss = 2.5592e-01, PNorm = 47.2104, GNorm = 0.6789, lr_0 = 1.3706e-04
Loss = 1.9325e-01, PNorm = 47.2229, GNorm = 0.6550, lr_0 = 1.3473e-04
Validation prc-auc = 0.743699
Validation auc = 0.873204
Epoch 26
Loss = 2.5534e-01, PNorm = 47.2339, GNorm = 0.5919, lr_0 = 1.3221e-04
Loss = 2.4116e-01, PNorm = 47.2537, GNorm = 0.9053, lr_0 = 1.2997e-04
Loss = 2.4405e-01, PNorm = 47.2595, GNorm = 0.4666, lr_0 = 1.2776e-04
Loss = 2.3737e-01, PNorm = 47.2704, GNorm = 0.5443, lr_0 = 1.2559e-04
Loss = 2.1734e-01, PNorm = 47.2781, GNorm = 0.5813, lr_0 = 1.2346e-04
Validation prc-auc = 0.735058
Validation auc = 0.866124
Epoch 27
Loss = 2.4163e-01, PNorm = 47.2887, GNorm = 0.7713, lr_0 = 1.2136e-04
Loss = 2.1948e-01, PNorm = 47.3026, GNorm = 0.7895, lr_0 = 1.1930e-04
Loss = 2.1904e-01, PNorm = 47.3117, GNorm = 0.6703, lr_0 = 1.1727e-04
Loss = 2.2109e-01, PNorm = 47.3163, GNorm = 0.3112, lr_0 = 1.1528e-04
Loss = 2.2310e-01, PNorm = 47.3288, GNorm = 0.5240, lr_0 = 1.1332e-04
Validation prc-auc = 0.739884
Validation auc = 0.871447
Epoch 28
Loss = 2.4394e-01, PNorm = 47.3373, GNorm = 0.4499, lr_0 = 1.1140e-04
Loss = 2.3028e-01, PNorm = 47.3468, GNorm = 0.5224, lr_0 = 1.0951e-04
Loss = 2.0610e-01, PNorm = 47.3555, GNorm = 0.3361, lr_0 = 1.0765e-04
Loss = 2.0631e-01, PNorm = 47.3625, GNorm = 0.5119, lr_0 = 1.0582e-04
Loss = 2.3621e-01, PNorm = 47.3739, GNorm = 0.4925, lr_0 = 1.0402e-04
Validation prc-auc = 0.737078
Validation auc = 0.868708
Epoch 29
Loss = 2.5165e-01, PNorm = 47.3829, GNorm = 0.5859, lr_0 = 1.0225e-04
Loss = 2.2366e-01, PNorm = 47.3893, GNorm = 0.5176, lr_0 = 1.0052e-04
Loss = 2.0333e-01, PNorm = 47.3986, GNorm = 1.0072, lr_0 = 1.0000e-04
Loss = 2.4118e-01, PNorm = 47.4109, GNorm = 0.5133, lr_0 = 1.0000e-04
Loss = 1.9657e-01, PNorm = 47.4141, GNorm = 0.2791, lr_0 = 1.0000e-04
Validation prc-auc = 0.741915
Validation auc = 0.871499
Model 0 best validation prc-auc = 0.795538 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.848107
Model 0 test auc = 0.892949
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.2254e-01, PNorm = 43.2438, GNorm = 1.4752, lr_0 = 2.0312e-04
Loss = 5.3055e-01, PNorm = 43.2538, GNorm = 1.8086, lr_0 = 2.9687e-04
Loss = 5.1013e-01, PNorm = 43.2706, GNorm = 0.6900, lr_0 = 3.9062e-04
Loss = 4.2641e-01, PNorm = 43.2948, GNorm = 0.9653, lr_0 = 4.8437e-04
Validation prc-auc = 0.789194
Validation auc = 0.891137
Epoch 1
Loss = 3.9896e-01, PNorm = 43.3260, GNorm = 1.8205, lr_0 = 5.8750e-04
Loss = 4.1851e-01, PNorm = 43.3593, GNorm = 1.3238, lr_0 = 6.8125e-04
Loss = 3.9450e-01, PNorm = 43.4001, GNorm = 0.5014, lr_0 = 7.7500e-04
Loss = 3.9293e-01, PNorm = 43.4460, GNorm = 0.6785, lr_0 = 8.6875e-04
Loss = 3.5508e-01, PNorm = 43.4856, GNorm = 1.0554, lr_0 = 9.6250e-04
Validation prc-auc = 0.799274
Validation auc = 0.895013
Epoch 2
Loss = 2.8649e-01, PNorm = 43.5398, GNorm = 0.7464, lr_0 = 9.8977e-04
Loss = 3.4915e-01, PNorm = 43.5934, GNorm = 0.6217, lr_0 = 9.7296e-04
Loss = 3.2367e-01, PNorm = 43.6364, GNorm = 0.4280, lr_0 = 9.5643e-04
Loss = 3.3444e-01, PNorm = 43.6745, GNorm = 0.5545, lr_0 = 9.4019e-04
Loss = 3.4081e-01, PNorm = 43.7217, GNorm = 0.3009, lr_0 = 9.2422e-04
Validation prc-auc = 0.751241
Validation auc = 0.890724
Epoch 3
Loss = 2.7957e-01, PNorm = 43.7631, GNorm = 0.7754, lr_0 = 9.0852e-04
Loss = 3.4723e-01, PNorm = 43.8014, GNorm = 1.5369, lr_0 = 8.9309e-04
Loss = 3.2082e-01, PNorm = 43.8427, GNorm = 0.4763, lr_0 = 8.7791e-04
Loss = 3.1118e-01, PNorm = 43.8946, GNorm = 0.3715, lr_0 = 8.6300e-04
Loss = 3.3749e-01, PNorm = 43.9295, GNorm = 0.3620, lr_0 = 8.4834e-04
Validation prc-auc = 0.774847
Validation auc = 0.895633
Epoch 4
Loss = 3.1554e-01, PNorm = 43.9779, GNorm = 0.4516, lr_0 = 8.3393e-04
Loss = 3.0713e-01, PNorm = 44.0269, GNorm = 0.4808, lr_0 = 8.1977e-04
Loss = 2.9141e-01, PNorm = 44.0657, GNorm = 0.5036, lr_0 = 8.0584e-04
Loss = 3.1308e-01, PNorm = 44.1172, GNorm = 0.6417, lr_0 = 7.9215e-04
Loss = 2.9889e-01, PNorm = 44.1726, GNorm = 0.6789, lr_0 = 7.7870e-04
Validation prc-auc = 0.762864
Validation auc = 0.894703
Epoch 5
Loss = 3.7379e-01, PNorm = 44.2167, GNorm = 1.1933, lr_0 = 7.6547e-04
Loss = 3.0090e-01, PNorm = 44.2634, GNorm = 0.5385, lr_0 = 7.5247e-04
Loss = 3.1922e-01, PNorm = 44.3229, GNorm = 0.3296, lr_0 = 7.3969e-04
Loss = 3.0279e-01, PNorm = 44.3696, GNorm = 0.7194, lr_0 = 7.2712e-04
Loss = 2.8812e-01, PNorm = 44.4241, GNorm = 0.4759, lr_0 = 7.1477e-04
Validation prc-auc = 0.748626
Validation auc = 0.896047
Epoch 6
Loss = 3.2354e-01, PNorm = 44.4718, GNorm = 0.9393, lr_0 = 7.0143e-04
Loss = 3.0653e-01, PNorm = 44.5149, GNorm = 0.3778, lr_0 = 6.8951e-04
Loss = 2.9952e-01, PNorm = 44.5666, GNorm = 0.3820, lr_0 = 6.7780e-04
Loss = 2.5041e-01, PNorm = 44.6288, GNorm = 1.1352, lr_0 = 6.6629e-04
Loss = 2.9873e-01, PNorm = 44.6814, GNorm = 0.5848, lr_0 = 6.5497e-04
Validation prc-auc = 0.746194
Validation auc = 0.891602
Epoch 7
Loss = 3.0403e-01, PNorm = 44.7247, GNorm = 0.3213, lr_0 = 6.4384e-04
Loss = 2.6802e-01, PNorm = 44.7835, GNorm = 1.1029, lr_0 = 6.3291e-04
Loss = 2.7281e-01, PNorm = 44.8345, GNorm = 0.9132, lr_0 = 6.2216e-04
Loss = 3.3418e-01, PNorm = 44.8823, GNorm = 0.4441, lr_0 = 6.1159e-04
Loss = 2.4434e-01, PNorm = 44.9289, GNorm = 0.3500, lr_0 = 6.0120e-04
Validation prc-auc = 0.732821
Validation auc = 0.894031
Epoch 8
Loss = 2.5839e-01, PNorm = 44.9824, GNorm = 0.5514, lr_0 = 5.9099e-04
Loss = 3.1780e-01, PNorm = 45.0538, GNorm = 0.9483, lr_0 = 5.8095e-04
Loss = 2.7858e-01, PNorm = 45.1075, GNorm = 0.4488, lr_0 = 5.7108e-04
Loss = 3.0593e-01, PNorm = 45.1395, GNorm = 0.5261, lr_0 = 5.6138e-04
Validation prc-auc = 0.732627
Validation auc = 0.889173
Epoch 9
Loss = 4.7928e-01, PNorm = 45.1901, GNorm = 0.8321, lr_0 = 5.5184e-04
Loss = 2.9845e-01, PNorm = 45.2238, GNorm = 0.4169, lr_0 = 5.4247e-04
Loss = 2.6014e-01, PNorm = 45.2764, GNorm = 0.7399, lr_0 = 5.3325e-04
Loss = 2.6619e-01, PNorm = 45.3226, GNorm = 0.5474, lr_0 = 5.2420e-04
Loss = 2.7803e-01, PNorm = 45.3650, GNorm = 0.4036, lr_0 = 5.1529e-04
Validation prc-auc = 0.730951
Validation auc = 0.888346
Epoch 10
Loss = 3.1213e-01, PNorm = 45.4312, GNorm = 0.5912, lr_0 = 5.0654e-04
Loss = 2.4752e-01, PNorm = 45.4932, GNorm = 0.8837, lr_0 = 4.9793e-04
Loss = 2.4497e-01, PNorm = 45.5308, GNorm = 0.4454, lr_0 = 4.8948e-04
Loss = 3.0986e-01, PNorm = 45.5536, GNorm = 0.3058, lr_0 = 4.8116e-04
Loss = 3.0936e-01, PNorm = 45.6108, GNorm = 0.7527, lr_0 = 4.7299e-04
Validation prc-auc = 0.745564
Validation auc = 0.889483
Epoch 11
Loss = 2.1907e-01, PNorm = 45.6616, GNorm = 0.4652, lr_0 = 4.6416e-04
Loss = 2.5990e-01, PNorm = 45.7129, GNorm = 0.7765, lr_0 = 4.5627e-04
Loss = 2.6650e-01, PNorm = 45.7558, GNorm = 0.4042, lr_0 = 4.4852e-04
Loss = 2.9987e-01, PNorm = 45.7932, GNorm = 0.5118, lr_0 = 4.4091e-04
Loss = 2.6389e-01, PNorm = 45.8172, GNorm = 0.7278, lr_0 = 4.3342e-04
Validation prc-auc = 0.744215
Validation auc = 0.886331
Epoch 12
Loss = 2.6522e-01, PNorm = 45.8529, GNorm = 0.9377, lr_0 = 4.2605e-04
Loss = 2.3385e-01, PNorm = 45.8936, GNorm = 1.3024, lr_0 = 4.1882e-04
Loss = 2.8851e-01, PNorm = 45.9349, GNorm = 0.7514, lr_0 = 4.1170e-04
Loss = 2.4701e-01, PNorm = 45.9665, GNorm = 0.2758, lr_0 = 4.0471e-04
Loss = 2.5397e-01, PNorm = 46.0041, GNorm = 0.8813, lr_0 = 3.9783e-04
Validation prc-auc = 0.743800
Validation auc = 0.884419
Epoch 13
Loss = 2.4080e-01, PNorm = 46.0340, GNorm = 0.5128, lr_0 = 3.9108e-04
Loss = 2.5052e-01, PNorm = 46.0718, GNorm = 0.4717, lr_0 = 3.8443e-04
Loss = 2.6329e-01, PNorm = 46.1140, GNorm = 0.9225, lr_0 = 3.7790e-04
Loss = 3.0450e-01, PNorm = 46.1505, GNorm = 0.6119, lr_0 = 3.7148e-04
Loss = 2.2881e-01, PNorm = 46.1756, GNorm = 0.6060, lr_0 = 3.6517e-04
Validation prc-auc = 0.734994
Validation auc = 0.878269
Epoch 14
Loss = 2.7613e-01, PNorm = 46.2139, GNorm = 0.7357, lr_0 = 3.5897e-04
Loss = 2.1508e-01, PNorm = 46.2470, GNorm = 0.6174, lr_0 = 3.5287e-04
Loss = 2.6953e-01, PNorm = 46.2766, GNorm = 0.7997, lr_0 = 3.4688e-04
Loss = 2.6445e-01, PNorm = 46.2963, GNorm = 0.5361, lr_0 = 3.4099e-04
Loss = 2.3648e-01, PNorm = 46.3246, GNorm = 0.5225, lr_0 = 3.3520e-04
Validation prc-auc = 0.742775
Validation auc = 0.880904
Epoch 15
Loss = 2.3152e-01, PNorm = 46.3543, GNorm = 0.4488, lr_0 = 3.2950e-04
Loss = 2.3504e-01, PNorm = 46.3861, GNorm = 0.4740, lr_0 = 3.2390e-04
Loss = 2.6527e-01, PNorm = 46.4218, GNorm = 0.3897, lr_0 = 3.1840e-04
Loss = 2.7795e-01, PNorm = 46.4502, GNorm = 0.4750, lr_0 = 3.1299e-04
Loss = 2.4141e-01, PNorm = 46.4767, GNorm = 0.6429, lr_0 = 3.0768e-04
Loss = 1.4744e-01, PNorm = 46.4795, GNorm = 0.3699, lr_0 = 3.0715e-04
Validation prc-auc = 0.740047
Validation auc = 0.876977
Epoch 16
Loss = 2.1593e-01, PNorm = 46.5062, GNorm = 0.7521, lr_0 = 3.0193e-04
Loss = 2.4086e-01, PNorm = 46.5605, GNorm = 0.9230, lr_0 = 2.9680e-04
Loss = 2.5903e-01, PNorm = 46.5817, GNorm = 0.5368, lr_0 = 2.9176e-04
Loss = 2.8712e-01, PNorm = 46.5960, GNorm = 0.4562, lr_0 = 2.8681e-04
Validation prc-auc = 0.760714
Validation auc = 0.883953
Epoch 17
Loss = 1.1746e-01, PNorm = 46.6054, GNorm = 0.3159, lr_0 = 2.8193e-04
Loss = 2.2801e-01, PNorm = 46.6413, GNorm = 0.7012, lr_0 = 2.7715e-04
Loss = 2.5011e-01, PNorm = 46.6724, GNorm = 0.5999, lr_0 = 2.7244e-04
Loss = 2.1751e-01, PNorm = 46.7062, GNorm = 0.4224, lr_0 = 2.6781e-04
Loss = 2.6888e-01, PNorm = 46.7185, GNorm = 1.0249, lr_0 = 2.6326e-04
Validation prc-auc = 0.752101
Validation auc = 0.876667
Epoch 18
Loss = 2.7872e-01, PNorm = 46.7319, GNorm = 1.0967, lr_0 = 2.5879e-04
Loss = 2.4537e-01, PNorm = 46.7562, GNorm = 0.4767, lr_0 = 2.5439e-04
Loss = 2.2170e-01, PNorm = 46.7903, GNorm = 0.3668, lr_0 = 2.5007e-04
Loss = 2.4570e-01, PNorm = 46.8119, GNorm = 0.5582, lr_0 = 2.4582e-04
Loss = 2.1665e-01, PNorm = 46.8285, GNorm = 0.5498, lr_0 = 2.4165e-04
Validation prc-auc = 0.746333
Validation auc = 0.876253
Epoch 19
Loss = 2.2102e-01, PNorm = 46.8517, GNorm = 0.6420, lr_0 = 2.3754e-04
Loss = 2.2556e-01, PNorm = 46.8732, GNorm = 0.4095, lr_0 = 2.3351e-04
Loss = 2.2618e-01, PNorm = 46.9016, GNorm = 0.5373, lr_0 = 2.2954e-04
Loss = 2.7401e-01, PNorm = 46.9220, GNorm = 0.6148, lr_0 = 2.2564e-04
Loss = 2.4301e-01, PNorm = 46.9394, GNorm = 0.3849, lr_0 = 2.2181e-04
Validation prc-auc = 0.754796
Validation auc = 0.880801
Epoch 20
Loss = 2.6599e-01, PNorm = 46.9630, GNorm = 0.5074, lr_0 = 2.1804e-04
Loss = 2.0241e-01, PNorm = 46.9884, GNorm = 0.5366, lr_0 = 2.1434e-04
Loss = 2.3060e-01, PNorm = 47.0108, GNorm = 0.3647, lr_0 = 2.1070e-04
Loss = 2.3720e-01, PNorm = 47.0252, GNorm = 0.4679, lr_0 = 2.0712e-04
Loss = 2.4391e-01, PNorm = 47.0410, GNorm = 0.4224, lr_0 = 2.0360e-04
Validation prc-auc = 0.737011
Validation auc = 0.875685
Epoch 21
Loss = 2.1933e-01, PNorm = 47.0560, GNorm = 1.1239, lr_0 = 1.9980e-04
Loss = 2.2357e-01, PNorm = 47.0671, GNorm = 0.8551, lr_0 = 1.9641e-04
Loss = 2.5378e-01, PNorm = 47.0820, GNorm = 0.8311, lr_0 = 1.9307e-04
Loss = 2.4907e-01, PNorm = 47.0933, GNorm = 0.9166, lr_0 = 1.8979e-04
Loss = 2.1140e-01, PNorm = 47.1176, GNorm = 0.4452, lr_0 = 1.8657e-04
Validation prc-auc = 0.747545
Validation auc = 0.875220
Epoch 22
Loss = 2.1678e-01, PNorm = 47.1363, GNorm = 0.5158, lr_0 = 1.8340e-04
Loss = 2.0794e-01, PNorm = 47.1558, GNorm = 0.3810, lr_0 = 1.8028e-04
Loss = 2.2950e-01, PNorm = 47.1804, GNorm = 0.5842, lr_0 = 1.7722e-04
Loss = 2.3311e-01, PNorm = 47.1933, GNorm = 0.3346, lr_0 = 1.7421e-04
Loss = 2.5856e-01, PNorm = 47.2059, GNorm = 0.5948, lr_0 = 1.7125e-04
Validation prc-auc = 0.753443
Validation auc = 0.877132
Epoch 23
Loss = 2.4622e-01, PNorm = 47.2188, GNorm = 0.4659, lr_0 = 1.6834e-04
Loss = 2.4175e-01, PNorm = 47.2327, GNorm = 0.4490, lr_0 = 1.6548e-04
Loss = 1.9359e-01, PNorm = 47.2491, GNorm = 0.6621, lr_0 = 1.6267e-04
Loss = 2.3443e-01, PNorm = 47.2762, GNorm = 0.9719, lr_0 = 1.5991e-04
Loss = 2.3610e-01, PNorm = 47.2861, GNorm = 0.5399, lr_0 = 1.5719e-04
Validation prc-auc = 0.749993
Validation auc = 0.878889
Epoch 24
Loss = 2.6646e-01, PNorm = 47.2979, GNorm = 0.8956, lr_0 = 1.5452e-04
Loss = 2.4530e-01, PNorm = 47.3071, GNorm = 0.4117, lr_0 = 1.5190e-04
Loss = 2.0960e-01, PNorm = 47.3194, GNorm = 0.3904, lr_0 = 1.4932e-04
Loss = 1.9943e-01, PNorm = 47.3342, GNorm = 0.6543, lr_0 = 1.4678e-04
Loss = 2.0677e-01, PNorm = 47.3511, GNorm = 0.7769, lr_0 = 1.4429e-04
Validation prc-auc = 0.740514
Validation auc = 0.875736
Epoch 25
Loss = 2.4523e-01, PNorm = 47.3622, GNorm = 0.4325, lr_0 = 1.4184e-04
Loss = 2.2641e-01, PNorm = 47.3709, GNorm = 0.5075, lr_0 = 1.3943e-04
Loss = 2.1791e-01, PNorm = 47.3891, GNorm = 0.5092, lr_0 = 1.3706e-04
Loss = 2.3217e-01, PNorm = 47.3942, GNorm = 0.5022, lr_0 = 1.3473e-04
Validation prc-auc = 0.751023
Validation auc = 0.875426
Epoch 26
Loss = 2.9474e-01, PNorm = 47.4093, GNorm = 0.5658, lr_0 = 1.3221e-04
Loss = 2.4272e-01, PNorm = 47.4181, GNorm = 0.4275, lr_0 = 1.2997e-04
Loss = 1.8947e-01, PNorm = 47.4233, GNorm = 0.6059, lr_0 = 1.2776e-04
Loss = 2.3906e-01, PNorm = 47.4370, GNorm = 0.6298, lr_0 = 1.2559e-04
Loss = 2.0036e-01, PNorm = 47.4421, GNorm = 0.3230, lr_0 = 1.2346e-04
Validation prc-auc = 0.747522
Validation auc = 0.876150
Epoch 27
Loss = 2.1662e-01, PNorm = 47.4544, GNorm = 0.3933, lr_0 = 1.2136e-04
Loss = 2.2299e-01, PNorm = 47.4647, GNorm = 0.4837, lr_0 = 1.1930e-04
Loss = 1.7073e-01, PNorm = 47.4753, GNorm = 0.3281, lr_0 = 1.1727e-04
Loss = 2.6030e-01, PNorm = 47.4849, GNorm = 0.4467, lr_0 = 1.1528e-04
Loss = 2.1974e-01, PNorm = 47.4944, GNorm = 0.5480, lr_0 = 1.1332e-04
Validation prc-auc = 0.743526
Validation auc = 0.869897
Epoch 28
Loss = 2.2340e-01, PNorm = 47.5025, GNorm = 0.4140, lr_0 = 1.1140e-04
Loss = 2.1565e-01, PNorm = 47.5077, GNorm = 0.5722, lr_0 = 1.0951e-04
Loss = 2.5424e-01, PNorm = 47.5191, GNorm = 0.6956, lr_0 = 1.0765e-04
Loss = 2.2586e-01, PNorm = 47.5293, GNorm = 0.6591, lr_0 = 1.0582e-04
Loss = 1.6855e-01, PNorm = 47.5365, GNorm = 0.3013, lr_0 = 1.0402e-04
Validation prc-auc = 0.749917
Validation auc = 0.871654
Epoch 29
Loss = 2.2733e-01, PNorm = 47.5539, GNorm = 0.4744, lr_0 = 1.0225e-04
Loss = 2.1133e-01, PNorm = 47.5607, GNorm = 0.8012, lr_0 = 1.0052e-04
Loss = 2.0798e-01, PNorm = 47.5708, GNorm = 0.6017, lr_0 = 1.0000e-04
Loss = 2.2755e-01, PNorm = 47.5755, GNorm = 0.5033, lr_0 = 1.0000e-04
Loss = 2.0488e-01, PNorm = 47.5809, GNorm = 0.6058, lr_0 = 1.0000e-04
Validation prc-auc = 0.747397
Validation auc = 0.872946
Model 1 best validation prc-auc = 0.799274 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.849529
Model 1 test auc = 0.895315
Ensemble test prc-auc = 0.850826
Ensemble test auc = 0.895122
5-fold cross validation
	Seed 0 ==> test prc-auc = 0.810974
	Seed 0 ==> test auc = 0.883558
	Seed 1 ==> test prc-auc = 0.909869
	Seed 1 ==> test auc = 0.909118
	Seed 2 ==> test prc-auc = 0.896499
	Seed 2 ==> test auc = 0.913619
	Seed 3 ==> test prc-auc = 0.847597
	Seed 3 ==> test auc = 0.950915
	Seed 4 ==> test prc-auc = 0.850826
	Seed 4 ==> test auc = 0.895122
Overall test prc-auc = 0.863153 +/- 0.035808
Overall test auc = 0.910466 +/- 0.022836
Elapsed time = 0:49:20
