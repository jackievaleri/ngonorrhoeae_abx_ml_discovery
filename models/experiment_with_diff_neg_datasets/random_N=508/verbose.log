Command line
python /home/jackievaleri8/.conda/envs/chemprop/bin/chemprop_train --dropout 0.1 --hidden_size 500 --ffn_num_layers 2 --depth 3 --metric prc-auc --extra_metrics auc --save_dir models/controls_with_diff_neg_datasets/random_N=508/ --data_path data/controls_with_diff_neg_datasets/random_N=508.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --num_folds 5 --ensemble_size 2 --split_type scaffold_balanced --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --gpu 0
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/controls_with_diff_neg_datasets/random_N=508.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda', index=0),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 2,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 500,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'models/controls_with_diff_neg_datasets/random_N=508/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'scaffold_balanced',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 1,004 | train scaffolds = 774 | val scaffolds = 106 | test scaffolds = 124
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 64 | target average = 0.812500


Scaffold 1
Task 0: count = 30 | target average = 0.800000


Scaffold 2
Task 0: count = 9 | target average = 1.000000


Scaffold 3
Task 0: count = 9 | target average = 0.666667


Scaffold 4
Task 0: count = 9 | target average = 1.000000


Scaffold 5
Task 0: count = 8 | target average = 0.875000


Scaffold 6
Task 0: count = 8 | target average = 1.000000


Scaffold 7
Task 0: count = 8 | target average = 1.000000


Scaffold 8
Task 0: count = 7 | target average = 0.857143


Scaffold 9
Task 0: count = 7 | target average = 1.000000


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.5949e-01, PNorm = 43.2217, GNorm = 1.0151, lr_0 = 3.0625e-04
Loss = 5.7300e-01, PNorm = 43.2390, GNorm = 0.7957, lr_0 = 4.9375e-04
Validation prc-auc = 0.868007
Validation auc = 0.778926
Epoch 1
Loss = 5.2595e-01, PNorm = 43.2732, GNorm = 1.3384, lr_0 = 7.0000e-04
Loss = 5.1086e-01, PNorm = 43.3194, GNorm = 0.9206, lr_0 = 8.8750e-04
Validation prc-auc = 0.886994
Validation auc = 0.797568
Epoch 2
Loss = 4.5760e-01, PNorm = 43.3874, GNorm = 0.6034, lr_0 = 9.8301e-04
Loss = 4.3564e-01, PNorm = 43.4542, GNorm = 1.3636, lr_0 = 9.4990e-04
Loss = 4.5612e-01, PNorm = 43.5022, GNorm = 0.4164, lr_0 = 9.1790e-04
Validation prc-auc = 0.895881
Validation auc = 0.807092
Epoch 3
Loss = 4.6801e-01, PNorm = 43.5483, GNorm = 0.8708, lr_0 = 8.8699e-04
Loss = 4.1359e-01, PNorm = 43.5952, GNorm = 0.4668, lr_0 = 8.5711e-04
Validation prc-auc = 0.901442
Validation auc = 0.814184
Epoch 4
Loss = 3.9907e-01, PNorm = 43.6527, GNorm = 0.3990, lr_0 = 8.2540e-04
Loss = 3.9462e-01, PNorm = 43.7071, GNorm = 0.4449, lr_0 = 7.9760e-04
Loss = 4.0006e-01, PNorm = 43.7605, GNorm = 0.5335, lr_0 = 7.7073e-04
Validation prc-auc = 0.907575
Validation auc = 0.826140
Epoch 5
Loss = 4.2855e-01, PNorm = 43.8146, GNorm = 0.5809, lr_0 = 7.4477e-04
Loss = 3.9419e-01, PNorm = 43.8713, GNorm = 0.5181, lr_0 = 7.1969e-04
Validation prc-auc = 0.909282
Validation auc = 0.829990
Epoch 6
Loss = 3.9236e-01, PNorm = 43.9373, GNorm = 0.5244, lr_0 = 6.9306e-04
Loss = 3.6328e-01, PNorm = 44.0057, GNorm = 0.6109, lr_0 = 6.6972e-04
Loss = 4.2244e-01, PNorm = 44.0598, GNorm = 0.5535, lr_0 = 6.4716e-04
Loss = 4.4824e-01, PNorm = 44.0658, GNorm = 0.7286, lr_0 = 6.4495e-04
Validation prc-auc = 0.907115
Validation auc = 0.819453
Epoch 7
Loss = 3.6024e-01, PNorm = 44.1231, GNorm = 0.5230, lr_0 = 6.2322e-04
Loss = 3.8567e-01, PNorm = 44.1828, GNorm = 0.8291, lr_0 = 6.0223e-04
Validation prc-auc = 0.907420
Validation auc = 0.826950
Epoch 8
Loss = 3.7142e-01, PNorm = 44.2422, GNorm = 0.6237, lr_0 = 5.8194e-04
Loss = 3.8043e-01, PNorm = 44.3000, GNorm = 0.4722, lr_0 = 5.6234e-04
Validation prc-auc = 0.907082
Validation auc = 0.823506
Epoch 9
Loss = 4.2609e-01, PNorm = 44.3677, GNorm = 0.4281, lr_0 = 5.4154e-04
Loss = 3.8462e-01, PNorm = 44.4420, GNorm = 2.2335, lr_0 = 5.2330e-04
Loss = 3.6508e-01, PNorm = 44.4960, GNorm = 0.4480, lr_0 = 5.0567e-04
Validation prc-auc = 0.909210
Validation auc = 0.827558
Epoch 10
Loss = 3.6307e-01, PNorm = 44.5555, GNorm = 0.4622, lr_0 = 4.8864e-04
Loss = 3.6174e-01, PNorm = 44.6062, GNorm = 0.4787, lr_0 = 4.7218e-04
Validation prc-auc = 0.914717
Validation auc = 0.832624
Epoch 11
Loss = 4.1402e-01, PNorm = 44.6674, GNorm = 0.4658, lr_0 = 4.5471e-04
Loss = 3.4638e-01, PNorm = 44.7286, GNorm = 0.8323, lr_0 = 4.3940e-04
Loss = 3.4875e-01, PNorm = 44.7864, GNorm = 0.4585, lr_0 = 4.2460e-04
Validation prc-auc = 0.912460
Validation auc = 0.826342
Epoch 12
Loss = 2.9369e-01, PNorm = 44.8469, GNorm = 0.5875, lr_0 = 4.0889e-04
Loss = 3.4546e-01, PNorm = 44.9074, GNorm = 1.0189, lr_0 = 3.9512e-04
Validation prc-auc = 0.909058
Validation auc = 0.820061
Epoch 13
Loss = 3.7469e-01, PNorm = 44.9610, GNorm = 0.5339, lr_0 = 3.8181e-04
Loss = 3.2855e-01, PNorm = 45.0134, GNorm = 0.7125, lr_0 = 3.6895e-04
Loss = 3.4926e-01, PNorm = 45.0651, GNorm = 0.7705, lr_0 = 3.5652e-04
Validation prc-auc = 0.910991
Validation auc = 0.824113
Epoch 14
Loss = 3.3848e-01, PNorm = 45.1233, GNorm = 0.4105, lr_0 = 3.4333e-04
Loss = 2.9576e-01, PNorm = 45.1788, GNorm = 0.6607, lr_0 = 3.3177e-04
Validation prc-auc = 0.900003
Validation auc = 0.806890
Epoch 15
Loss = 3.0113e-01, PNorm = 45.2263, GNorm = 0.5537, lr_0 = 3.2059e-04
Loss = 3.2719e-01, PNorm = 45.2708, GNorm = 0.9559, lr_0 = 3.0979e-04
Loss = 3.1875e-01, PNorm = 45.3141, GNorm = 0.8909, lr_0 = 2.9936e-04
Loss = 3.7940e-01, PNorm = 45.3181, GNorm = 1.1870, lr_0 = 2.9833e-04
Validation prc-auc = 0.907091
Validation auc = 0.812563
Epoch 16
Loss = 2.8320e-01, PNorm = 45.3695, GNorm = 0.6565, lr_0 = 2.8828e-04
Loss = 3.3858e-01, PNorm = 45.4061, GNorm = 0.7671, lr_0 = 2.7857e-04
Validation prc-auc = 0.909329
Validation auc = 0.816413
Epoch 17
Loss = 3.3369e-01, PNorm = 45.4555, GNorm = 0.8566, lr_0 = 2.6827e-04
Loss = 2.7948e-01, PNorm = 45.4995, GNorm = 0.3614, lr_0 = 2.5923e-04
Validation prc-auc = 0.900376
Validation auc = 0.807092
Epoch 18
Loss = 4.0992e-01, PNorm = 45.5355, GNorm = 0.6579, lr_0 = 2.5050e-04
Loss = 3.0415e-01, PNorm = 45.5726, GNorm = 0.6623, lr_0 = 2.4206e-04
Loss = 2.7754e-01, PNorm = 45.6051, GNorm = 0.9202, lr_0 = 2.3391e-04
Validation prc-auc = 0.905178
Validation auc = 0.812969
Epoch 19
Loss = 2.8683e-01, PNorm = 45.6472, GNorm = 0.7367, lr_0 = 2.2526e-04
Loss = 3.0201e-01, PNorm = 45.6868, GNorm = 2.1197, lr_0 = 2.1767e-04
Validation prc-auc = 0.892044
Validation auc = 0.799189
Epoch 20
Loss = 3.7138e-01, PNorm = 45.7143, GNorm = 0.6996, lr_0 = 2.1034e-04
Loss = 2.8798e-01, PNorm = 45.7442, GNorm = 0.7384, lr_0 = 2.0325e-04
Loss = 2.7005e-01, PNorm = 45.7766, GNorm = 0.8778, lr_0 = 1.9641e-04
Validation prc-auc = 0.894207
Validation auc = 0.799595
Epoch 21
Loss = 3.1407e-01, PNorm = 45.8033, GNorm = 0.5766, lr_0 = 1.8914e-04
Loss = 2.8009e-01, PNorm = 45.8261, GNorm = 0.4865, lr_0 = 1.8277e-04
Validation prc-auc = 0.893345
Validation auc = 0.803850
Epoch 22
Loss = 2.4651e-01, PNorm = 45.8528, GNorm = 0.6416, lr_0 = 1.7601e-04
Loss = 2.7975e-01, PNorm = 45.8811, GNorm = 0.6249, lr_0 = 1.7008e-04
Loss = 2.7286e-01, PNorm = 45.9029, GNorm = 1.3953, lr_0 = 1.6435e-04
Validation prc-auc = 0.893191
Validation auc = 0.798582
Epoch 23
Loss = 2.3163e-01, PNorm = 45.9238, GNorm = 0.5189, lr_0 = 1.5882e-04
Loss = 2.7735e-01, PNorm = 45.9451, GNorm = 0.7329, lr_0 = 1.5347e-04
Validation prc-auc = 0.875901
Validation auc = 0.785816
Epoch 24
Loss = 2.4389e-01, PNorm = 45.9691, GNorm = 0.5365, lr_0 = 1.4779e-04
Loss = 2.6292e-01, PNorm = 45.9838, GNorm = 0.8788, lr_0 = 1.4281e-04
Loss = 2.8682e-01, PNorm = 46.0031, GNorm = 1.8419, lr_0 = 1.3800e-04
Validation prc-auc = 0.888083
Validation auc = 0.797771
Epoch 25
Loss = 2.8878e-01, PNorm = 46.0248, GNorm = 0.8872, lr_0 = 1.3335e-04
Loss = 2.3689e-01, PNorm = 46.0424, GNorm = 1.1551, lr_0 = 1.2886e-04
Validation prc-auc = 0.870000
Validation auc = 0.780952
Epoch 26
Loss = 2.7211e-01, PNorm = 46.0611, GNorm = 0.8696, lr_0 = 1.2409e-04
Loss = 2.3212e-01, PNorm = 46.0768, GNorm = 0.6626, lr_0 = 1.1991e-04
Validation prc-auc = 0.869806
Validation auc = 0.782168
Epoch 27
Loss = 2.6394e-01, PNorm = 46.0962, GNorm = 0.7058, lr_0 = 1.1548e-04
Loss = 2.6383e-01, PNorm = 46.1092, GNorm = 1.2300, lr_0 = 1.1159e-04
Loss = 2.5170e-01, PNorm = 46.1209, GNorm = 0.8563, lr_0 = 1.0783e-04
Validation prc-auc = 0.875420
Validation auc = 0.787639
Epoch 28
Loss = 2.6965e-01, PNorm = 46.1384, GNorm = 1.5545, lr_0 = 1.0420e-04
Loss = 2.3226e-01, PNorm = 46.1509, GNorm = 0.6634, lr_0 = 1.0069e-04
Validation prc-auc = 0.867409
Validation auc = 0.779737
Epoch 29
Loss = 2.1329e-01, PNorm = 46.1652, GNorm = 0.7982, lr_0 = 1.0000e-04
Loss = 2.3744e-01, PNorm = 46.1782, GNorm = 0.6319, lr_0 = 1.0000e-04
Loss = 2.5448e-01, PNorm = 46.1930, GNorm = 0.6478, lr_0 = 1.0000e-04
Validation prc-auc = 0.868356
Validation auc = 0.782371
Model 0 best validation prc-auc = 0.914717 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.926122
Model 0 test auc = 0.884305
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.3805e-01, PNorm = 43.2465, GNorm = 1.0744, lr_0 = 3.0625e-04
Loss = 5.4398e-01, PNorm = 43.2689, GNorm = 1.8267, lr_0 = 4.9375e-04
Validation prc-auc = 0.864653
Validation auc = 0.769807
Epoch 1
Loss = 5.1441e-01, PNorm = 43.3101, GNorm = 1.4298, lr_0 = 7.0000e-04
Loss = 5.2120e-01, PNorm = 43.3547, GNorm = 1.5910, lr_0 = 8.8750e-04
Validation prc-auc = 0.890831
Validation auc = 0.804863
Epoch 2
Loss = 4.0760e-01, PNorm = 43.4226, GNorm = 1.0876, lr_0 = 9.8301e-04
Loss = 4.4467e-01, PNorm = 43.4883, GNorm = 0.6025, lr_0 = 9.4990e-04
Loss = 4.1311e-01, PNorm = 43.5387, GNorm = 1.1663, lr_0 = 9.1790e-04
Validation prc-auc = 0.895033
Validation auc = 0.814184
Epoch 3
Loss = 4.3440e-01, PNorm = 43.5831, GNorm = 0.4408, lr_0 = 8.8699e-04
Loss = 4.6010e-01, PNorm = 43.6332, GNorm = 0.5693, lr_0 = 8.5711e-04
Validation prc-auc = 0.898752
Validation auc = 0.816819
Epoch 4
Loss = 3.6462e-01, PNorm = 43.6867, GNorm = 0.6992, lr_0 = 8.2540e-04
Loss = 4.5804e-01, PNorm = 43.7315, GNorm = 0.3997, lr_0 = 7.9760e-04
Loss = 3.7600e-01, PNorm = 43.7719, GNorm = 0.4682, lr_0 = 7.7073e-04
Validation prc-auc = 0.905593
Validation auc = 0.825532
Epoch 5
Loss = 3.7388e-01, PNorm = 43.8197, GNorm = 0.5197, lr_0 = 7.4477e-04
Loss = 4.1113e-01, PNorm = 43.8641, GNorm = 0.7275, lr_0 = 7.1969e-04
Validation prc-auc = 0.911105
Validation auc = 0.828977
Epoch 6
Loss = 4.4211e-01, PNorm = 43.9039, GNorm = 0.5499, lr_0 = 6.9306e-04
Loss = 3.9036e-01, PNorm = 43.9488, GNorm = 1.0003, lr_0 = 6.6972e-04
Loss = 3.9997e-01, PNorm = 43.9960, GNorm = 0.4610, lr_0 = 6.4716e-04
Loss = 3.2662e-01, PNorm = 44.0009, GNorm = 0.8054, lr_0 = 6.4495e-04
Validation prc-auc = 0.909751
Validation auc = 0.828369
Epoch 7
Loss = 4.1081e-01, PNorm = 44.0523, GNorm = 0.4732, lr_0 = 6.2322e-04
Loss = 3.5795e-01, PNorm = 44.1068, GNorm = 1.4507, lr_0 = 6.0223e-04
Validation prc-auc = 0.912091
Validation auc = 0.832016
Epoch 8
Loss = 4.1746e-01, PNorm = 44.1573, GNorm = 0.7733, lr_0 = 5.8194e-04
Loss = 3.6851e-01, PNorm = 44.2078, GNorm = 0.7833, lr_0 = 5.6234e-04
Validation prc-auc = 0.913434
Validation auc = 0.837082
Epoch 9
Loss = 3.3825e-01, PNorm = 44.2641, GNorm = 0.4359, lr_0 = 5.4154e-04
Loss = 4.2259e-01, PNorm = 44.3272, GNorm = 0.7519, lr_0 = 5.2330e-04
Loss = 3.4101e-01, PNorm = 44.3787, GNorm = 0.8740, lr_0 = 5.0567e-04
Validation prc-auc = 0.911869
Validation auc = 0.830193
Epoch 10
Loss = 3.7299e-01, PNorm = 44.4355, GNorm = 1.7300, lr_0 = 4.8864e-04
Loss = 3.6499e-01, PNorm = 44.4885, GNorm = 0.6232, lr_0 = 4.7218e-04
Validation prc-auc = 0.911114
Validation auc = 0.826342
Epoch 11
Loss = 2.9917e-01, PNorm = 44.5462, GNorm = 0.4284, lr_0 = 4.5471e-04
Loss = 3.4573e-01, PNorm = 44.5934, GNorm = 0.3742, lr_0 = 4.3940e-04
Loss = 3.4979e-01, PNorm = 44.6548, GNorm = 0.4483, lr_0 = 4.2460e-04
Validation prc-auc = 0.910750
Validation auc = 0.826545
Epoch 12
Loss = 3.6984e-01, PNorm = 44.6918, GNorm = 0.5621, lr_0 = 4.0889e-04
Loss = 3.1608e-01, PNorm = 44.7444, GNorm = 1.0261, lr_0 = 3.9512e-04
Validation prc-auc = 0.908085
Validation auc = 0.822898
Epoch 13
Loss = 3.8696e-01, PNorm = 44.7883, GNorm = 1.0570, lr_0 = 3.8181e-04
Loss = 3.6103e-01, PNorm = 44.8379, GNorm = 0.8664, lr_0 = 3.6895e-04
Loss = 3.4112e-01, PNorm = 44.8771, GNorm = 0.4089, lr_0 = 3.5652e-04
Validation prc-auc = 0.915893
Validation auc = 0.833637
Epoch 14
Loss = 3.3182e-01, PNorm = 44.9355, GNorm = 0.7117, lr_0 = 3.4333e-04
Loss = 3.3114e-01, PNorm = 44.9858, GNorm = 0.9815, lr_0 = 3.3177e-04
Validation prc-auc = 0.909989
Validation auc = 0.820669
Epoch 15
Loss = 3.2326e-01, PNorm = 45.0273, GNorm = 0.6292, lr_0 = 3.2059e-04
Loss = 3.3660e-01, PNorm = 45.0723, GNorm = 0.7381, lr_0 = 3.0979e-04
Loss = 3.2109e-01, PNorm = 45.1088, GNorm = 0.6005, lr_0 = 2.9936e-04
Loss = 3.4513e-01, PNorm = 45.1115, GNorm = 1.4832, lr_0 = 2.9833e-04
Validation prc-auc = 0.911890
Validation auc = 0.823708
Epoch 16
Loss = 3.0141e-01, PNorm = 45.1499, GNorm = 0.6826, lr_0 = 2.8828e-04
Loss = 3.2269e-01, PNorm = 45.1841, GNorm = 0.4358, lr_0 = 2.7857e-04
Validation prc-auc = 0.908268
Validation auc = 0.813374
Epoch 17
Loss = 3.4410e-01, PNorm = 45.2253, GNorm = 0.4730, lr_0 = 2.6827e-04
Loss = 3.0258e-01, PNorm = 45.2640, GNorm = 0.4585, lr_0 = 2.5923e-04
Validation prc-auc = 0.902378
Validation auc = 0.806282
Epoch 18
Loss = 2.5397e-01, PNorm = 45.3048, GNorm = 0.4368, lr_0 = 2.5050e-04
Loss = 3.0094e-01, PNorm = 45.3414, GNorm = 0.6506, lr_0 = 2.4206e-04
Loss = 3.1502e-01, PNorm = 45.3772, GNorm = 1.1008, lr_0 = 2.3391e-04
Validation prc-auc = 0.899412
Validation auc = 0.798582
Epoch 19
Loss = 3.5611e-01, PNorm = 45.4054, GNorm = 1.2423, lr_0 = 2.2526e-04
Loss = 3.0537e-01, PNorm = 45.4369, GNorm = 0.6623, lr_0 = 2.1767e-04
Validation prc-auc = 0.902830
Validation auc = 0.807092
Epoch 20
Loss = 3.4745e-01, PNorm = 45.4647, GNorm = 1.5898, lr_0 = 2.1034e-04
Loss = 2.8528e-01, PNorm = 45.4932, GNorm = 0.4753, lr_0 = 2.0325e-04
Loss = 3.1844e-01, PNorm = 45.5213, GNorm = 0.5330, lr_0 = 1.9641e-04
Validation prc-auc = 0.901682
Validation auc = 0.807295
Epoch 21
Loss = 2.8848e-01, PNorm = 45.5566, GNorm = 0.6282, lr_0 = 1.8914e-04
Loss = 3.2106e-01, PNorm = 45.5825, GNorm = 1.2407, lr_0 = 1.8277e-04
Validation prc-auc = 0.899285
Validation auc = 0.804255
Epoch 22
Loss = 2.7098e-01, PNorm = 45.6099, GNorm = 1.1284, lr_0 = 1.7601e-04
Loss = 3.0581e-01, PNorm = 45.6381, GNorm = 0.7507, lr_0 = 1.7008e-04
Loss = 2.7047e-01, PNorm = 45.6626, GNorm = 0.7659, lr_0 = 1.6435e-04
Validation prc-auc = 0.890683
Validation auc = 0.794326
Epoch 23
Loss = 2.6454e-01, PNorm = 45.6866, GNorm = 0.5925, lr_0 = 1.5882e-04
Loss = 2.9997e-01, PNorm = 45.7091, GNorm = 0.6807, lr_0 = 1.5347e-04
Validation prc-auc = 0.890572
Validation auc = 0.794934
Epoch 24
Loss = 2.5330e-01, PNorm = 45.7318, GNorm = 0.5984, lr_0 = 1.4779e-04
Loss = 2.7276e-01, PNorm = 45.7537, GNorm = 1.0619, lr_0 = 1.4281e-04
Loss = 2.7045e-01, PNorm = 45.7722, GNorm = 0.9558, lr_0 = 1.3800e-04
Validation prc-auc = 0.880588
Validation auc = 0.781966
Epoch 25
Loss = 2.7785e-01, PNorm = 45.7853, GNorm = 1.2177, lr_0 = 1.3335e-04
Loss = 2.8070e-01, PNorm = 45.8047, GNorm = 0.7906, lr_0 = 1.2886e-04
Validation prc-auc = 0.886655
Validation auc = 0.791692
Epoch 26
Loss = 2.3867e-01, PNorm = 45.8243, GNorm = 0.8799, lr_0 = 1.2409e-04
Loss = 2.7385e-01, PNorm = 45.8357, GNorm = 0.6158, lr_0 = 1.1991e-04
Validation prc-auc = 0.883757
Validation auc = 0.789260
Epoch 27
Loss = 2.2026e-01, PNorm = 45.8549, GNorm = 0.4980, lr_0 = 1.1548e-04
Loss = 2.7023e-01, PNorm = 45.8702, GNorm = 0.7238, lr_0 = 1.1159e-04
Loss = 2.7329e-01, PNorm = 45.8869, GNorm = 0.7337, lr_0 = 1.0783e-04
Validation prc-auc = 0.880541
Validation auc = 0.786626
Epoch 28
Loss = 2.8416e-01, PNorm = 45.9037, GNorm = 0.9718, lr_0 = 1.0420e-04
Loss = 2.1589e-01, PNorm = 45.9187, GNorm = 1.1466, lr_0 = 1.0069e-04
Validation prc-auc = 0.878019
Validation auc = 0.782371
Epoch 29
Loss = 2.1602e-01, PNorm = 45.9328, GNorm = 0.4867, lr_0 = 1.0000e-04
Loss = 2.3563e-01, PNorm = 45.9487, GNorm = 0.8057, lr_0 = 1.0000e-04
Loss = 2.8346e-01, PNorm = 45.9590, GNorm = 1.1431, lr_0 = 1.0000e-04
Validation prc-auc = 0.876042
Validation auc = 0.783181
Model 1 best validation prc-auc = 0.915893 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.927437
Model 1 test auc = 0.894136
Ensemble test prc-auc = 0.927767
Ensemble test auc = 0.891327
Fold 1
Splitting data with seed 1
Total scaffolds = 1,004 | train scaffolds = 778 | val scaffolds = 115 | test scaffolds = 111
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 64 | target average = 0.812500


Scaffold 1
Task 0: count = 30 | target average = 0.800000


Scaffold 2
Task 0: count = 9 | target average = 1.000000


Scaffold 3
Task 0: count = 9 | target average = 1.000000


Scaffold 4
Task 0: count = 9 | target average = 0.666667


Scaffold 5
Task 0: count = 8 | target average = 1.000000


Scaffold 6
Task 0: count = 8 | target average = 1.000000


Scaffold 7
Task 0: count = 8 | target average = 0.875000


Scaffold 8
Task 0: count = 7 | target average = 1.000000


Scaffold 9
Task 0: count = 7 | target average = 0.857143


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.4361e-01, PNorm = 43.2211, GNorm = 1.1413, lr_0 = 3.0625e-04
Loss = 5.9025e-01, PNorm = 43.2354, GNorm = 0.6487, lr_0 = 4.9375e-04
Validation prc-auc = 0.947969
Validation auc = 0.918899
Epoch 1
Loss = 5.1503e-01, PNorm = 43.2694, GNorm = 0.4947, lr_0 = 7.0000e-04
Loss = 4.8679e-01, PNorm = 43.3132, GNorm = 0.7359, lr_0 = 8.8750e-04
Validation prc-auc = 0.948518
Validation auc = 0.922061
Epoch 2
Loss = 4.8582e-01, PNorm = 43.3784, GNorm = 1.8407, lr_0 = 9.8301e-04
Loss = 4.9699e-01, PNorm = 43.4341, GNorm = 1.8644, lr_0 = 9.4990e-04
Loss = 4.2908e-01, PNorm = 43.4891, GNorm = 1.1112, lr_0 = 9.1790e-04
Validation prc-auc = 0.952493
Validation auc = 0.923921
Epoch 3
Loss = 4.4085e-01, PNorm = 43.5419, GNorm = 0.6811, lr_0 = 8.8699e-04
Loss = 4.1926e-01, PNorm = 43.5954, GNorm = 0.5073, lr_0 = 8.5711e-04
Validation prc-auc = 0.954045
Validation auc = 0.929315
Epoch 4
Loss = 3.9349e-01, PNorm = 43.6500, GNorm = 0.5393, lr_0 = 8.2540e-04
Loss = 4.0858e-01, PNorm = 43.7069, GNorm = 0.6060, lr_0 = 7.9760e-04
Loss = 4.3710e-01, PNorm = 43.7587, GNorm = 0.4070, lr_0 = 7.7073e-04
Validation prc-auc = 0.953116
Validation auc = 0.922061
Epoch 5
Loss = 4.2008e-01, PNorm = 43.8070, GNorm = 0.4003, lr_0 = 7.4477e-04
Loss = 4.2176e-01, PNorm = 43.8611, GNorm = 0.6786, lr_0 = 7.1969e-04
Validation prc-auc = 0.958573
Validation auc = 0.930990
Epoch 6
Loss = 3.8323e-01, PNorm = 43.9072, GNorm = 0.8551, lr_0 = 6.9306e-04
Loss = 4.2670e-01, PNorm = 43.9538, GNorm = 0.6283, lr_0 = 6.6972e-04
Loss = 4.0265e-01, PNorm = 44.0031, GNorm = 0.8673, lr_0 = 6.4716e-04
Loss = 3.9557e-01, PNorm = 44.0079, GNorm = 0.8844, lr_0 = 6.4495e-04
Validation prc-auc = 0.955699
Validation auc = 0.925967
Epoch 7
Loss = 4.1304e-01, PNorm = 44.0616, GNorm = 0.4576, lr_0 = 6.2322e-04
Loss = 4.0728e-01, PNorm = 44.1088, GNorm = 0.4760, lr_0 = 6.0223e-04
Validation prc-auc = 0.956803
Validation auc = 0.930060
Epoch 8
Loss = 3.8438e-01, PNorm = 44.1734, GNorm = 0.3980, lr_0 = 5.8194e-04
Loss = 3.8785e-01, PNorm = 44.2319, GNorm = 1.0449, lr_0 = 5.6234e-04
Validation prc-auc = 0.954851
Validation auc = 0.924479
Epoch 9
Loss = 3.2397e-01, PNorm = 44.2857, GNorm = 0.8020, lr_0 = 5.4154e-04
Loss = 3.3669e-01, PNorm = 44.3420, GNorm = 0.3812, lr_0 = 5.2330e-04
Loss = 4.3604e-01, PNorm = 44.3935, GNorm = 0.7599, lr_0 = 5.0567e-04
Validation prc-auc = 0.958117
Validation auc = 0.931548
Epoch 10
Loss = 4.0062e-01, PNorm = 44.4484, GNorm = 0.9552, lr_0 = 4.8864e-04
Loss = 3.6281e-01, PNorm = 44.5010, GNorm = 0.9675, lr_0 = 4.7218e-04
Validation prc-auc = 0.955237
Validation auc = 0.928385
Epoch 11
Loss = 3.8037e-01, PNorm = 44.5676, GNorm = 0.4854, lr_0 = 4.5471e-04
Loss = 3.9734e-01, PNorm = 44.6186, GNorm = 0.5560, lr_0 = 4.3940e-04
Loss = 3.3198e-01, PNorm = 44.6780, GNorm = 0.7046, lr_0 = 4.2460e-04
Validation prc-auc = 0.958778
Validation auc = 0.932478
Epoch 12
Loss = 3.5725e-01, PNorm = 44.7357, GNorm = 0.6989, lr_0 = 4.0889e-04
Loss = 3.7433e-01, PNorm = 44.7903, GNorm = 1.4084, lr_0 = 3.9512e-04
Validation prc-auc = 0.955219
Validation auc = 0.928757
Epoch 13
Loss = 3.6678e-01, PNorm = 44.8397, GNorm = 0.5255, lr_0 = 3.8181e-04
Loss = 3.4882e-01, PNorm = 44.8840, GNorm = 0.6452, lr_0 = 3.6895e-04
Loss = 3.5983e-01, PNorm = 44.9321, GNorm = 0.6050, lr_0 = 3.5652e-04
Validation prc-auc = 0.955137
Validation auc = 0.929315
Epoch 14
Loss = 3.3855e-01, PNorm = 44.9951, GNorm = 0.4014, lr_0 = 3.4333e-04
Loss = 3.3903e-01, PNorm = 45.0471, GNorm = 0.6309, lr_0 = 3.3177e-04
Validation prc-auc = 0.957187
Validation auc = 0.927827
Epoch 15
Loss = 3.4988e-01, PNorm = 45.0899, GNorm = 1.1657, lr_0 = 3.2059e-04
Loss = 3.2272e-01, PNorm = 45.1267, GNorm = 0.9073, lr_0 = 3.0979e-04
Loss = 3.3801e-01, PNorm = 45.1666, GNorm = 0.6311, lr_0 = 2.9936e-04
Loss = 4.5003e-01, PNorm = 45.1703, GNorm = 0.8496, lr_0 = 2.9833e-04
Validation prc-auc = 0.956109
Validation auc = 0.930990
Epoch 16
Loss = 3.6165e-01, PNorm = 45.2157, GNorm = 0.6196, lr_0 = 2.8828e-04
Loss = 3.1696e-01, PNorm = 45.2559, GNorm = 0.4947, lr_0 = 2.7857e-04
Validation prc-auc = 0.958478
Validation auc = 0.929688
Epoch 17
Loss = 3.5357e-01, PNorm = 45.2990, GNorm = 0.4397, lr_0 = 2.6827e-04
Loss = 3.1785e-01, PNorm = 45.3376, GNorm = 1.1368, lr_0 = 2.5923e-04
Validation prc-auc = 0.954431
Validation auc = 0.925781
Epoch 18
Loss = 3.7119e-01, PNorm = 45.3759, GNorm = 0.9711, lr_0 = 2.5050e-04
Loss = 3.0080e-01, PNorm = 45.4162, GNorm = 0.4945, lr_0 = 2.4206e-04
Loss = 2.6214e-01, PNorm = 45.4545, GNorm = 0.7173, lr_0 = 2.3391e-04
Validation prc-auc = 0.956305
Validation auc = 0.927083
Epoch 19
Loss = 2.9390e-01, PNorm = 45.4950, GNorm = 0.9098, lr_0 = 2.2526e-04
Loss = 3.0443e-01, PNorm = 45.5191, GNorm = 0.6226, lr_0 = 2.1767e-04
Validation prc-auc = 0.954517
Validation auc = 0.928013
Epoch 20
Loss = 2.5300e-01, PNorm = 45.5561, GNorm = 0.6339, lr_0 = 2.1034e-04
Loss = 2.8677e-01, PNorm = 45.5785, GNorm = 0.5035, lr_0 = 2.0325e-04
Loss = 3.2581e-01, PNorm = 45.6125, GNorm = 0.9982, lr_0 = 1.9641e-04
Validation prc-auc = 0.955717
Validation auc = 0.927455
Epoch 21
Loss = 2.7133e-01, PNorm = 45.6423, GNorm = 0.4224, lr_0 = 1.8914e-04
Loss = 3.1324e-01, PNorm = 45.6731, GNorm = 0.5695, lr_0 = 1.8277e-04
Validation prc-auc = 0.955719
Validation auc = 0.928571
Epoch 22
Loss = 2.9400e-01, PNorm = 45.7090, GNorm = 1.6074, lr_0 = 1.7601e-04
Loss = 2.8977e-01, PNorm = 45.7354, GNorm = 0.5508, lr_0 = 1.7008e-04
Loss = 3.0470e-01, PNorm = 45.7565, GNorm = 0.4355, lr_0 = 1.6435e-04
Validation prc-auc = 0.953134
Validation auc = 0.925223
Epoch 23
Loss = 2.9190e-01, PNorm = 45.7790, GNorm = 0.9205, lr_0 = 1.5882e-04
Loss = 2.5249e-01, PNorm = 45.8026, GNorm = 0.7670, lr_0 = 1.5347e-04
Validation prc-auc = 0.951482
Validation auc = 0.924479
Epoch 24
Loss = 2.5970e-01, PNorm = 45.8252, GNorm = 0.7438, lr_0 = 1.4779e-04
Loss = 3.0544e-01, PNorm = 45.8496, GNorm = 0.8762, lr_0 = 1.4281e-04
Loss = 3.0166e-01, PNorm = 45.8712, GNorm = 1.8683, lr_0 = 1.3800e-04
Validation prc-auc = 0.954096
Validation auc = 0.928199
Epoch 25
Loss = 3.0351e-01, PNorm = 45.8912, GNorm = 0.7666, lr_0 = 1.3335e-04
Loss = 2.6812e-01, PNorm = 45.9133, GNorm = 0.9434, lr_0 = 1.2886e-04
Validation prc-auc = 0.951434
Validation auc = 0.925595
Epoch 26
Loss = 2.8535e-01, PNorm = 45.9344, GNorm = 0.7052, lr_0 = 1.2409e-04
Loss = 2.4463e-01, PNorm = 45.9539, GNorm = 0.5717, lr_0 = 1.1991e-04
Validation prc-auc = 0.951235
Validation auc = 0.921503
Epoch 27
Loss = 2.5868e-01, PNorm = 45.9711, GNorm = 0.6360, lr_0 = 1.1548e-04
Loss = 2.5028e-01, PNorm = 45.9923, GNorm = 1.2762, lr_0 = 1.1159e-04
Loss = 2.7639e-01, PNorm = 46.0057, GNorm = 0.5246, lr_0 = 1.0783e-04
Validation prc-auc = 0.946621
Validation auc = 0.922061
Epoch 28
Loss = 2.6307e-01, PNorm = 46.0172, GNorm = 0.6654, lr_0 = 1.0420e-04
Loss = 2.7497e-01, PNorm = 46.0302, GNorm = 0.5204, lr_0 = 1.0069e-04
Validation prc-auc = 0.953207
Validation auc = 0.926897
Epoch 29
Loss = 2.4913e-01, PNorm = 46.0475, GNorm = 1.0786, lr_0 = 1.0000e-04
Loss = 2.8157e-01, PNorm = 46.0643, GNorm = 0.8188, lr_0 = 1.0000e-04
Loss = 2.4585e-01, PNorm = 46.0773, GNorm = 0.6278, lr_0 = 1.0000e-04
Validation prc-auc = 0.949292
Validation auc = 0.922433
Model 0 best validation prc-auc = 0.958778 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.922599
Model 0 test auc = 0.870183
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.5324e-01, PNorm = 43.2463, GNorm = 2.0727, lr_0 = 3.0625e-04
Loss = 5.7187e-01, PNorm = 43.2651, GNorm = 0.7451, lr_0 = 4.9375e-04
Validation prc-auc = 0.929318
Validation auc = 0.898251
Epoch 1
Loss = 5.4292e-01, PNorm = 43.3035, GNorm = 1.2535, lr_0 = 7.0000e-04
Loss = 5.0141e-01, PNorm = 43.3502, GNorm = 0.5046, lr_0 = 8.8750e-04
Validation prc-auc = 0.937363
Validation auc = 0.917597
Epoch 2
Loss = 4.5496e-01, PNorm = 43.4173, GNorm = 0.5998, lr_0 = 9.8301e-04
Loss = 4.1883e-01, PNorm = 43.4843, GNorm = 0.9487, lr_0 = 9.4990e-04
Loss = 4.6562e-01, PNorm = 43.5402, GNorm = 1.1268, lr_0 = 9.1790e-04
Validation prc-auc = 0.943253
Validation auc = 0.916481
Epoch 3
Loss = 4.7294e-01, PNorm = 43.5837, GNorm = 0.9444, lr_0 = 8.8699e-04
Loss = 4.2368e-01, PNorm = 43.6419, GNorm = 0.4191, lr_0 = 8.5711e-04
Validation prc-auc = 0.944626
Validation auc = 0.918713
Epoch 4
Loss = 4.7518e-01, PNorm = 43.6998, GNorm = 2.0619, lr_0 = 8.2540e-04
Loss = 4.2295e-01, PNorm = 43.7537, GNorm = 0.9211, lr_0 = 7.9760e-04
Loss = 4.4925e-01, PNorm = 43.7970, GNorm = 0.5664, lr_0 = 7.7073e-04
Validation prc-auc = 0.950583
Validation auc = 0.926897
Epoch 5
Loss = 4.1758e-01, PNorm = 43.8519, GNorm = 0.5529, lr_0 = 7.4477e-04
Loss = 3.9423e-01, PNorm = 43.8974, GNorm = 0.3916, lr_0 = 7.1969e-04
Validation prc-auc = 0.954496
Validation auc = 0.927083
Epoch 6
Loss = 4.5139e-01, PNorm = 43.9576, GNorm = 0.8236, lr_0 = 6.9306e-04
Loss = 3.9602e-01, PNorm = 44.0063, GNorm = 0.5896, lr_0 = 6.6972e-04
Loss = 3.9589e-01, PNorm = 44.0650, GNorm = 0.4300, lr_0 = 6.4716e-04
Loss = 2.4223e-01, PNorm = 44.0698, GNorm = 0.7178, lr_0 = 6.4495e-04
Validation prc-auc = 0.954170
Validation auc = 0.924665
Epoch 7
Loss = 3.7997e-01, PNorm = 44.1300, GNorm = 0.7796, lr_0 = 6.2322e-04
Loss = 4.1452e-01, PNorm = 44.1852, GNorm = 1.4329, lr_0 = 6.0223e-04
Validation prc-auc = 0.956241
Validation auc = 0.929501
Epoch 8
Loss = 4.2361e-01, PNorm = 44.2393, GNorm = 0.5523, lr_0 = 5.8194e-04
Loss = 3.7237e-01, PNorm = 44.3198, GNorm = 0.3910, lr_0 = 5.6234e-04
Validation prc-auc = 0.955679
Validation auc = 0.929874
Epoch 9
Loss = 2.5978e-01, PNorm = 44.3680, GNorm = 0.5451, lr_0 = 5.4154e-04
Loss = 3.6711e-01, PNorm = 44.4223, GNorm = 0.6600, lr_0 = 5.2330e-04
Loss = 3.8106e-01, PNorm = 44.4805, GNorm = 0.8020, lr_0 = 5.0567e-04
Validation prc-auc = 0.957971
Validation auc = 0.934710
Epoch 10
Loss = 3.5248e-01, PNorm = 44.5405, GNorm = 0.5456, lr_0 = 4.8864e-04
Loss = 4.2574e-01, PNorm = 44.5859, GNorm = 0.3601, lr_0 = 4.7218e-04
Validation prc-auc = 0.958095
Validation auc = 0.931734
Epoch 11
Loss = 3.3223e-01, PNorm = 44.6377, GNorm = 0.3778, lr_0 = 4.5471e-04
Loss = 3.5383e-01, PNorm = 44.6910, GNorm = 0.6649, lr_0 = 4.3940e-04
Loss = 3.5484e-01, PNorm = 44.7311, GNorm = 1.1458, lr_0 = 4.2460e-04
Validation prc-auc = 0.956682
Validation auc = 0.930804
Epoch 12
Loss = 3.7121e-01, PNorm = 44.8007, GNorm = 1.0903, lr_0 = 4.0889e-04
Loss = 3.3840e-01, PNorm = 44.8497, GNorm = 0.5265, lr_0 = 3.9512e-04
Validation prc-auc = 0.957708
Validation auc = 0.932664
Epoch 13
Loss = 3.8113e-01, PNorm = 44.8962, GNorm = 1.5619, lr_0 = 3.8181e-04
Loss = 3.4611e-01, PNorm = 44.9560, GNorm = 0.4635, lr_0 = 3.6895e-04
Loss = 3.5944e-01, PNorm = 45.0115, GNorm = 0.8072, lr_0 = 3.5652e-04
Validation prc-auc = 0.957162
Validation auc = 0.932292
Epoch 14
Loss = 3.4515e-01, PNorm = 45.0509, GNorm = 0.7554, lr_0 = 3.4333e-04
Loss = 3.3205e-01, PNorm = 45.0929, GNorm = 1.0390, lr_0 = 3.3177e-04
Validation prc-auc = 0.955063
Validation auc = 0.929315
Epoch 15
Loss = 3.6747e-01, PNorm = 45.1406, GNorm = 0.5380, lr_0 = 3.2059e-04
Loss = 3.3897e-01, PNorm = 45.1829, GNorm = 0.7583, lr_0 = 3.0979e-04
Loss = 3.2924e-01, PNorm = 45.2376, GNorm = 1.6369, lr_0 = 2.9936e-04
Loss = 1.9889e-01, PNorm = 45.2406, GNorm = 0.7061, lr_0 = 2.9833e-04
Validation prc-auc = 0.956230
Validation auc = 0.931362
Epoch 16
Loss = 3.2426e-01, PNorm = 45.2759, GNorm = 1.3037, lr_0 = 2.8828e-04
Loss = 3.3628e-01, PNorm = 45.3215, GNorm = 0.8268, lr_0 = 2.7857e-04
Validation prc-auc = 0.954590
Validation auc = 0.929129
Epoch 17
Loss = 2.9522e-01, PNorm = 45.3564, GNorm = 0.7788, lr_0 = 2.6827e-04
Loss = 3.0659e-01, PNorm = 45.3995, GNorm = 0.8812, lr_0 = 2.5923e-04
Validation prc-auc = 0.951010
Validation auc = 0.926339
Epoch 18
Loss = 2.7401e-01, PNorm = 45.4299, GNorm = 0.4948, lr_0 = 2.5050e-04
Loss = 3.4048e-01, PNorm = 45.4670, GNorm = 0.5519, lr_0 = 2.4206e-04
Loss = 2.9983e-01, PNorm = 45.5076, GNorm = 1.2663, lr_0 = 2.3391e-04
Validation prc-auc = 0.951708
Validation auc = 0.926711
Epoch 19
Loss = 3.4593e-01, PNorm = 45.5418, GNorm = 0.5923, lr_0 = 2.2526e-04
Loss = 3.0676e-01, PNorm = 45.5758, GNorm = 1.5238, lr_0 = 2.1767e-04
Validation prc-auc = 0.952173
Validation auc = 0.926339
Epoch 20
Loss = 2.9771e-01, PNorm = 45.6091, GNorm = 0.4663, lr_0 = 2.1034e-04
Loss = 2.8554e-01, PNorm = 45.6406, GNorm = 0.5727, lr_0 = 2.0325e-04
Loss = 3.3073e-01, PNorm = 45.6760, GNorm = 1.2613, lr_0 = 1.9641e-04
Validation prc-auc = 0.958657
Validation auc = 0.934896
Epoch 21
Loss = 2.9601e-01, PNorm = 45.6942, GNorm = 0.6445, lr_0 = 1.8914e-04
Loss = 3.2710e-01, PNorm = 45.7194, GNorm = 1.2860, lr_0 = 1.8277e-04
Validation prc-auc = 0.952649
Validation auc = 0.926339
Epoch 22
Loss = 3.1750e-01, PNorm = 45.7498, GNorm = 0.7063, lr_0 = 1.7601e-04
Loss = 3.0317e-01, PNorm = 45.7748, GNorm = 0.5212, lr_0 = 1.7008e-04
Loss = 2.6700e-01, PNorm = 45.8003, GNorm = 0.5961, lr_0 = 1.6435e-04
Validation prc-auc = 0.951484
Validation auc = 0.925223
Epoch 23
Loss = 3.0570e-01, PNorm = 45.8247, GNorm = 0.9345, lr_0 = 1.5882e-04
Loss = 2.7936e-01, PNorm = 45.8451, GNorm = 0.6336, lr_0 = 1.5347e-04
Validation prc-auc = 0.953650
Validation auc = 0.927269
Epoch 24
Loss = 2.1621e-01, PNorm = 45.8681, GNorm = 0.4799, lr_0 = 1.4779e-04
Loss = 2.9015e-01, PNorm = 45.8882, GNorm = 0.5072, lr_0 = 1.4281e-04
Loss = 3.2697e-01, PNorm = 45.9073, GNorm = 1.1847, lr_0 = 1.3800e-04
Validation prc-auc = 0.955442
Validation auc = 0.930990
Epoch 25
Loss = 2.9927e-01, PNorm = 45.9287, GNorm = 1.1847, lr_0 = 1.3335e-04
Loss = 2.5128e-01, PNorm = 45.9455, GNorm = 0.9485, lr_0 = 1.2886e-04
Validation prc-auc = 0.943728
Validation auc = 0.919271
Epoch 26
Loss = 2.6918e-01, PNorm = 45.9687, GNorm = 0.4868, lr_0 = 1.2409e-04
Loss = 2.7067e-01, PNorm = 45.9850, GNorm = 0.7293, lr_0 = 1.1991e-04
Validation prc-auc = 0.956556
Validation auc = 0.929501
Epoch 27
Loss = 2.0538e-01, PNorm = 46.0078, GNorm = 0.5292, lr_0 = 1.1548e-04
Loss = 2.7517e-01, PNorm = 46.0194, GNorm = 0.3755, lr_0 = 1.1159e-04
Loss = 2.8957e-01, PNorm = 46.0385, GNorm = 0.6594, lr_0 = 1.0783e-04
Validation prc-auc = 0.951464
Validation auc = 0.926525
Epoch 28
Loss = 2.5069e-01, PNorm = 46.0525, GNorm = 0.7368, lr_0 = 1.0420e-04
Loss = 2.8244e-01, PNorm = 46.0644, GNorm = 0.5887, lr_0 = 1.0069e-04
Validation prc-auc = 0.952449
Validation auc = 0.926153
Epoch 29
Loss = 1.9729e-01, PNorm = 46.0827, GNorm = 0.4686, lr_0 = 1.0000e-04
Loss = 2.7162e-01, PNorm = 46.0943, GNorm = 1.0092, lr_0 = 1.0000e-04
Loss = 2.8938e-01, PNorm = 46.1113, GNorm = 0.8012, lr_0 = 1.0000e-04
Validation prc-auc = 0.951707
Validation auc = 0.925037
Model 1 best validation prc-auc = 0.958657 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.924779
Model 1 test auc = 0.878040
Ensemble test prc-auc = 0.924948
Ensemble test auc = 0.875608
Fold 2
Splitting data with seed 2
Total scaffolds = 1,004 | train scaffolds = 783 | val scaffolds = 111 | test scaffolds = 110
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 64 | target average = 0.812500


Scaffold 1
Task 0: count = 30 | target average = 0.800000


Scaffold 2
Task 0: count = 9 | target average = 1.000000


Scaffold 3
Task 0: count = 9 | target average = 1.000000


Scaffold 4
Task 0: count = 9 | target average = 0.666667


Scaffold 5
Task 0: count = 8 | target average = 1.000000


Scaffold 6
Task 0: count = 8 | target average = 1.000000


Scaffold 7
Task 0: count = 8 | target average = 0.875000


Scaffold 8
Task 0: count = 7 | target average = 0.857143


Scaffold 9
Task 0: count = 7 | target average = 1.000000


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.3073e-01, PNorm = 43.2211, GNorm = 1.7397, lr_0 = 3.0625e-04
Loss = 5.4246e-01, PNorm = 43.2398, GNorm = 0.7170, lr_0 = 4.9375e-04
Validation prc-auc = 0.856126
Validation auc = 0.823618
Epoch 1
Loss = 4.9160e-01, PNorm = 43.2811, GNorm = 0.9958, lr_0 = 7.0000e-04
Loss = 5.1135e-01, PNorm = 43.3279, GNorm = 1.4098, lr_0 = 8.8750e-04
Validation prc-auc = 0.882499
Validation auc = 0.837863
Epoch 2
Loss = 5.3016e-01, PNorm = 43.3885, GNorm = 1.3304, lr_0 = 9.8301e-04
Loss = 4.6888e-01, PNorm = 43.4472, GNorm = 0.7401, lr_0 = 9.4990e-04
Loss = 4.3085e-01, PNorm = 43.5146, GNorm = 0.3646, lr_0 = 9.1790e-04
Validation prc-auc = 0.900577
Validation auc = 0.857732
Epoch 3
Loss = 4.3159e-01, PNorm = 43.5663, GNorm = 0.5685, lr_0 = 8.8699e-04
Loss = 4.1599e-01, PNorm = 43.6146, GNorm = 0.5392, lr_0 = 8.5711e-04
Validation prc-auc = 0.902012
Validation auc = 0.861293
Epoch 4
Loss = 3.3626e-01, PNorm = 43.6669, GNorm = 0.7539, lr_0 = 8.2540e-04
Loss = 4.3676e-01, PNorm = 43.7185, GNorm = 0.3956, lr_0 = 7.9760e-04
Loss = 4.1405e-01, PNorm = 43.7715, GNorm = 0.4805, lr_0 = 7.7073e-04
Validation prc-auc = 0.894688
Validation auc = 0.856607
Epoch 5
Loss = 4.2242e-01, PNorm = 43.8284, GNorm = 0.3596, lr_0 = 7.4477e-04
Loss = 3.7031e-01, PNorm = 43.8899, GNorm = 0.4741, lr_0 = 7.1969e-04
Validation prc-auc = 0.893278
Validation auc = 0.855108
Epoch 6
Loss = 3.7989e-01, PNorm = 43.9646, GNorm = 0.4310, lr_0 = 6.9306e-04
Loss = 4.1133e-01, PNorm = 44.0222, GNorm = 0.6548, lr_0 = 6.6972e-04
Loss = 3.7289e-01, PNorm = 44.0880, GNorm = 0.6224, lr_0 = 6.4716e-04
Loss = 4.0435e-01, PNorm = 44.0943, GNorm = 1.0318, lr_0 = 6.4495e-04
Validation prc-auc = 0.898501
Validation auc = 0.861106
Epoch 7
Loss = 3.7428e-01, PNorm = 44.1576, GNorm = 0.9267, lr_0 = 6.2322e-04
Loss = 3.8943e-01, PNorm = 44.2182, GNorm = 0.5197, lr_0 = 6.0223e-04
Validation prc-auc = 0.893883
Validation auc = 0.857545
Epoch 8
Loss = 3.5057e-01, PNorm = 44.2846, GNorm = 0.8314, lr_0 = 5.8194e-04
Loss = 3.9591e-01, PNorm = 44.3436, GNorm = 0.4882, lr_0 = 5.6234e-04
Validation prc-auc = 0.892443
Validation auc = 0.856420
Epoch 9
Loss = 4.0941e-01, PNorm = 44.4173, GNorm = 0.6988, lr_0 = 5.4154e-04
Loss = 3.5498e-01, PNorm = 44.4908, GNorm = 1.4641, lr_0 = 5.2330e-04
Loss = 3.8711e-01, PNorm = 44.5579, GNorm = 0.4951, lr_0 = 5.0567e-04
Validation prc-auc = 0.893670
Validation auc = 0.855858
Epoch 10
Loss = 3.7862e-01, PNorm = 44.6246, GNorm = 1.6640, lr_0 = 4.8864e-04
Loss = 3.5826e-01, PNorm = 44.6876, GNorm = 1.0588, lr_0 = 4.7218e-04
Validation prc-auc = 0.888752
Validation auc = 0.852109
Epoch 11
Loss = 3.2724e-01, PNorm = 44.7486, GNorm = 0.4369, lr_0 = 4.5471e-04
Loss = 3.4116e-01, PNorm = 44.8148, GNorm = 1.1440, lr_0 = 4.3940e-04
Loss = 3.4898e-01, PNorm = 44.8647, GNorm = 0.5359, lr_0 = 4.2460e-04
Validation prc-auc = 0.891006
Validation auc = 0.852671
Epoch 12
Loss = 3.4230e-01, PNorm = 44.9322, GNorm = 1.3863, lr_0 = 4.0889e-04
Loss = 3.3832e-01, PNorm = 44.9889, GNorm = 1.2498, lr_0 = 3.9512e-04
Validation prc-auc = 0.885584
Validation auc = 0.848922
Epoch 13
Loss = 3.3522e-01, PNorm = 45.0362, GNorm = 0.3909, lr_0 = 3.8181e-04
Loss = 3.4494e-01, PNorm = 45.1032, GNorm = 1.7058, lr_0 = 3.6895e-04
Loss = 3.1070e-01, PNorm = 45.1641, GNorm = 0.7094, lr_0 = 3.5652e-04
Validation prc-auc = 0.881007
Validation auc = 0.845361
Epoch 14
Loss = 3.4367e-01, PNorm = 45.1971, GNorm = 1.3855, lr_0 = 3.4333e-04
Loss = 3.4256e-01, PNorm = 45.2493, GNorm = 0.7054, lr_0 = 3.3177e-04
Validation prc-auc = 0.893091
Validation auc = 0.856795
Epoch 15
Loss = 3.7130e-01, PNorm = 45.2909, GNorm = 1.1547, lr_0 = 3.2059e-04
Loss = 3.2585e-01, PNorm = 45.3430, GNorm = 1.1320, lr_0 = 3.0979e-04
Loss = 3.1745e-01, PNorm = 45.3925, GNorm = 0.5602, lr_0 = 2.9936e-04
Loss = 4.2290e-01, PNorm = 45.3981, GNorm = 0.8885, lr_0 = 2.9833e-04
Validation prc-auc = 0.888336
Validation auc = 0.855108
Epoch 16
Loss = 3.2370e-01, PNorm = 45.4418, GNorm = 0.6080, lr_0 = 2.8828e-04
Loss = 2.9893e-01, PNorm = 45.4959, GNorm = 0.9104, lr_0 = 2.7857e-04
Validation prc-auc = 0.888220
Validation auc = 0.853046
Epoch 17
Loss = 2.8360e-01, PNorm = 45.5393, GNorm = 0.5192, lr_0 = 2.6827e-04
Loss = 3.2793e-01, PNorm = 45.5779, GNorm = 0.4401, lr_0 = 2.5923e-04
Validation prc-auc = 0.883010
Validation auc = 0.842924
Epoch 18
Loss = 4.0326e-01, PNorm = 45.6155, GNorm = 0.8016, lr_0 = 2.5050e-04
Loss = 3.0397e-01, PNorm = 45.6496, GNorm = 0.4939, lr_0 = 2.4206e-04
Loss = 2.7826e-01, PNorm = 45.6866, GNorm = 0.7223, lr_0 = 2.3391e-04
Validation prc-auc = 0.891494
Validation auc = 0.856232
Epoch 19
Loss = 2.9473e-01, PNorm = 45.7257, GNorm = 0.6097, lr_0 = 2.2526e-04
Loss = 2.8071e-01, PNorm = 45.7617, GNorm = 1.3804, lr_0 = 2.1767e-04
Validation prc-auc = 0.879018
Validation auc = 0.841799
Epoch 20
Loss = 2.8154e-01, PNorm = 45.7999, GNorm = 0.5903, lr_0 = 2.1034e-04
Loss = 2.8429e-01, PNorm = 45.8286, GNorm = 0.7340, lr_0 = 2.0325e-04
Loss = 2.9703e-01, PNorm = 45.8629, GNorm = 0.7751, lr_0 = 1.9641e-04
Validation prc-auc = 0.891491
Validation auc = 0.853233
Epoch 21
Loss = 2.8507e-01, PNorm = 45.9003, GNorm = 1.4686, lr_0 = 1.8914e-04
Loss = 3.0530e-01, PNorm = 45.9268, GNorm = 0.5670, lr_0 = 1.8277e-04
Validation prc-auc = 0.885853
Validation auc = 0.849297
Epoch 22
Loss = 2.7427e-01, PNorm = 45.9602, GNorm = 0.4774, lr_0 = 1.7601e-04
Loss = 2.4261e-01, PNorm = 45.9872, GNorm = 0.7186, lr_0 = 1.7008e-04
Loss = 3.0262e-01, PNorm = 46.0145, GNorm = 1.1484, lr_0 = 1.6435e-04
Validation prc-auc = 0.882655
Validation auc = 0.846860
Epoch 23
Loss = 2.8944e-01, PNorm = 46.0384, GNorm = 0.8833, lr_0 = 1.5882e-04
Loss = 2.8141e-01, PNorm = 46.0654, GNorm = 0.7403, lr_0 = 1.5347e-04
Validation prc-auc = 0.881940
Validation auc = 0.846860
Epoch 24
Loss = 2.4046e-01, PNorm = 46.0938, GNorm = 0.4624, lr_0 = 1.4779e-04
Loss = 2.7103e-01, PNorm = 46.1210, GNorm = 0.6798, lr_0 = 1.4281e-04
Loss = 2.9192e-01, PNorm = 46.1404, GNorm = 0.7999, lr_0 = 1.3800e-04
Validation prc-auc = 0.884911
Validation auc = 0.848922
Epoch 25
Loss = 2.5590e-01, PNorm = 46.1648, GNorm = 0.9743, lr_0 = 1.3335e-04
Loss = 2.8169e-01, PNorm = 46.1818, GNorm = 0.9643, lr_0 = 1.2886e-04
Validation prc-auc = 0.877037
Validation auc = 0.842362
Epoch 26
Loss = 2.7520e-01, PNorm = 46.2023, GNorm = 0.5589, lr_0 = 1.2409e-04
Loss = 2.5235e-01, PNorm = 46.2197, GNorm = 0.4630, lr_0 = 1.1991e-04
Validation prc-auc = 0.882199
Validation auc = 0.846111
Epoch 27
Loss = 2.2127e-01, PNorm = 46.2426, GNorm = 0.5510, lr_0 = 1.1548e-04
Loss = 2.9360e-01, PNorm = 46.2598, GNorm = 1.2187, lr_0 = 1.1159e-04
Loss = 2.3471e-01, PNorm = 46.2799, GNorm = 0.7739, lr_0 = 1.0783e-04
Validation prc-auc = 0.876817
Validation auc = 0.843112
Epoch 28
Loss = 2.6213e-01, PNorm = 46.2914, GNorm = 1.7487, lr_0 = 1.0420e-04
Loss = 2.4590e-01, PNorm = 46.3124, GNorm = 0.5142, lr_0 = 1.0069e-04
Validation prc-auc = 0.880300
Validation auc = 0.844424
Epoch 29
Loss = 2.2252e-01, PNorm = 46.3263, GNorm = 0.8229, lr_0 = 1.0000e-04
Loss = 2.5850e-01, PNorm = 46.3443, GNorm = 1.7531, lr_0 = 1.0000e-04
Loss = 2.5093e-01, PNorm = 46.3608, GNorm = 1.0421, lr_0 = 1.0000e-04
Validation prc-auc = 0.877355
Validation auc = 0.842174
Model 0 best validation prc-auc = 0.902012 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.886906
Model 0 test auc = 0.823877
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.4856e-01, PNorm = 43.2474, GNorm = 1.3879, lr_0 = 3.0625e-04
Loss = 5.4240e-01, PNorm = 43.2704, GNorm = 0.6498, lr_0 = 4.9375e-04
Validation prc-auc = 0.856711
Validation auc = 0.817432
Epoch 1
Loss = 4.4140e-01, PNorm = 43.3135, GNorm = 0.5593, lr_0 = 7.0000e-04
Loss = 5.0124e-01, PNorm = 43.3610, GNorm = 0.8296, lr_0 = 8.8750e-04
Validation prc-auc = 0.889338
Validation auc = 0.847610
Epoch 2
Loss = 3.7154e-01, PNorm = 43.4237, GNorm = 1.3998, lr_0 = 9.8301e-04
Loss = 4.4737e-01, PNorm = 43.4817, GNorm = 1.6458, lr_0 = 9.4990e-04
Loss = 4.2929e-01, PNorm = 43.5390, GNorm = 0.5013, lr_0 = 9.1790e-04
Validation prc-auc = 0.893151
Validation auc = 0.852484
Epoch 3
Loss = 4.1132e-01, PNorm = 43.5905, GNorm = 0.5038, lr_0 = 8.8699e-04
Loss = 4.1451e-01, PNorm = 43.6499, GNorm = 1.1354, lr_0 = 8.5711e-04
Validation prc-auc = 0.897107
Validation auc = 0.857545
Epoch 4
Loss = 4.1174e-01, PNorm = 43.7033, GNorm = 0.7678, lr_0 = 8.2540e-04
Loss = 4.1270e-01, PNorm = 43.7589, GNorm = 0.8451, lr_0 = 7.9760e-04
Loss = 4.4291e-01, PNorm = 43.8166, GNorm = 1.3260, lr_0 = 7.7073e-04
Validation prc-auc = 0.899225
Validation auc = 0.861856
Epoch 5
Loss = 4.0651e-01, PNorm = 43.8578, GNorm = 0.9847, lr_0 = 7.4477e-04
Loss = 3.9498e-01, PNorm = 43.9108, GNorm = 0.3850, lr_0 = 7.1969e-04
Validation prc-auc = 0.888655
Validation auc = 0.844611
Epoch 6
Loss = 4.1545e-01, PNorm = 43.9784, GNorm = 0.3937, lr_0 = 6.9306e-04
Loss = 4.2586e-01, PNorm = 44.0355, GNorm = 1.4371, lr_0 = 6.6972e-04
Loss = 3.8835e-01, PNorm = 44.0890, GNorm = 0.6871, lr_0 = 6.4716e-04
Loss = 3.9194e-01, PNorm = 44.0952, GNorm = 2.0182, lr_0 = 6.4495e-04
Validation prc-auc = 0.896285
Validation auc = 0.859419
Epoch 7
Loss = 3.9426e-01, PNorm = 44.1318, GNorm = 0.7636, lr_0 = 6.2322e-04
Loss = 4.2741e-01, PNorm = 44.1793, GNorm = 0.3758, lr_0 = 6.0223e-04
Validation prc-auc = 0.889243
Validation auc = 0.855295
Epoch 8
Loss = 3.8570e-01, PNorm = 44.2343, GNorm = 0.4325, lr_0 = 5.8194e-04
Loss = 3.8610e-01, PNorm = 44.2874, GNorm = 0.3208, lr_0 = 5.6234e-04
Validation prc-auc = 0.894126
Validation auc = 0.857357
Epoch 9
Loss = 4.1195e-01, PNorm = 44.3447, GNorm = 0.9697, lr_0 = 5.4154e-04
Loss = 3.6188e-01, PNorm = 44.4015, GNorm = 0.6262, lr_0 = 5.2330e-04
Loss = 3.6959e-01, PNorm = 44.4704, GNorm = 1.0096, lr_0 = 5.0567e-04
Validation prc-auc = 0.891693
Validation auc = 0.855295
Epoch 10
Loss = 3.9511e-01, PNorm = 44.5081, GNorm = 0.8075, lr_0 = 4.8864e-04
Loss = 3.5170e-01, PNorm = 44.5648, GNorm = 0.5661, lr_0 = 4.7218e-04
Validation prc-auc = 0.896646
Validation auc = 0.859606
Epoch 11
Loss = 3.5044e-01, PNorm = 44.6241, GNorm = 0.6375, lr_0 = 4.5471e-04
Loss = 3.5868e-01, PNorm = 44.6766, GNorm = 0.5978, lr_0 = 4.3940e-04
Loss = 3.4557e-01, PNorm = 44.7525, GNorm = 0.3946, lr_0 = 4.2460e-04
Validation prc-auc = 0.894072
Validation auc = 0.855108
Epoch 12
Loss = 3.5951e-01, PNorm = 44.8157, GNorm = 0.4516, lr_0 = 4.0889e-04
Loss = 3.7531e-01, PNorm = 44.8618, GNorm = 0.6774, lr_0 = 3.9512e-04
Validation prc-auc = 0.896280
Validation auc = 0.856607
Epoch 13
Loss = 3.4096e-01, PNorm = 44.9221, GNorm = 0.5848, lr_0 = 3.8181e-04
Loss = 3.7447e-01, PNorm = 44.9878, GNorm = 0.5211, lr_0 = 3.6895e-04
Loss = 3.2779e-01, PNorm = 45.0407, GNorm = 0.4859, lr_0 = 3.5652e-04
Validation prc-auc = 0.894645
Validation auc = 0.855483
Epoch 14
Loss = 3.0617e-01, PNorm = 45.0962, GNorm = 0.7156, lr_0 = 3.4333e-04
Loss = 3.3502e-01, PNorm = 45.1460, GNorm = 1.0127, lr_0 = 3.3177e-04
Validation prc-auc = 0.890539
Validation auc = 0.853608
Epoch 15
Loss = 3.6927e-01, PNorm = 45.1857, GNorm = 0.4832, lr_0 = 3.2059e-04
Loss = 3.2196e-01, PNorm = 45.2399, GNorm = 1.1781, lr_0 = 3.0979e-04
Loss = 3.3950e-01, PNorm = 45.2942, GNorm = 1.8935, lr_0 = 2.9936e-04
Loss = 4.0914e-01, PNorm = 45.2979, GNorm = 1.1818, lr_0 = 2.9833e-04
Validation prc-auc = 0.898325
Validation auc = 0.859419
Epoch 16
Loss = 2.9820e-01, PNorm = 45.3407, GNorm = 0.5854, lr_0 = 2.8828e-04
Loss = 3.0236e-01, PNorm = 45.3939, GNorm = 1.0293, lr_0 = 2.7857e-04
Validation prc-auc = 0.891067
Validation auc = 0.849485
Epoch 17
Loss = 3.5075e-01, PNorm = 45.4342, GNorm = 0.5293, lr_0 = 2.6827e-04
Loss = 3.0912e-01, PNorm = 45.4731, GNorm = 1.5165, lr_0 = 2.5923e-04
Validation prc-auc = 0.896603
Validation auc = 0.860169
Epoch 18
Loss = 3.2954e-01, PNorm = 45.5023, GNorm = 0.6720, lr_0 = 2.5050e-04
Loss = 3.1491e-01, PNorm = 45.5418, GNorm = 0.8685, lr_0 = 2.4206e-04
Loss = 2.9507e-01, PNorm = 45.5789, GNorm = 0.5200, lr_0 = 2.3391e-04
Validation prc-auc = 0.886271
Validation auc = 0.850797
Epoch 19
Loss = 3.1842e-01, PNorm = 45.6135, GNorm = 0.8129, lr_0 = 2.2526e-04
Loss = 3.1428e-01, PNorm = 45.6470, GNorm = 0.8705, lr_0 = 2.1767e-04
Validation prc-auc = 0.894256
Validation auc = 0.855670
Epoch 20
Loss = 2.2871e-01, PNorm = 45.6818, GNorm = 0.6718, lr_0 = 2.1034e-04
Loss = 2.9557e-01, PNorm = 45.7127, GNorm = 0.4640, lr_0 = 2.0325e-04
Loss = 2.9949e-01, PNorm = 45.7470, GNorm = 0.6323, lr_0 = 1.9641e-04
Validation prc-auc = 0.885411
Validation auc = 0.849110
Epoch 21
Loss = 3.0800e-01, PNorm = 45.7773, GNorm = 0.9014, lr_0 = 1.8914e-04
Loss = 3.2299e-01, PNorm = 45.8041, GNorm = 0.4648, lr_0 = 1.8277e-04
Validation prc-auc = 0.877470
Validation auc = 0.844799
Epoch 22
Loss = 3.3970e-01, PNorm = 45.8353, GNorm = 0.5374, lr_0 = 1.7601e-04
Loss = 2.5947e-01, PNorm = 45.8734, GNorm = 0.5085, lr_0 = 1.7008e-04
Loss = 3.1048e-01, PNorm = 45.8934, GNorm = 0.6676, lr_0 = 1.6435e-04
Validation prc-auc = 0.892050
Validation auc = 0.855483
Epoch 23
Loss = 2.8376e-01, PNorm = 45.9151, GNorm = 0.5269, lr_0 = 1.5882e-04
Loss = 3.0165e-01, PNorm = 45.9379, GNorm = 1.8056, lr_0 = 1.5347e-04
Validation prc-auc = 0.886477
Validation auc = 0.849110
Epoch 24
Loss = 2.8598e-01, PNorm = 45.9632, GNorm = 0.5844, lr_0 = 1.4779e-04
Loss = 2.7673e-01, PNorm = 45.9876, GNorm = 0.5467, lr_0 = 1.4281e-04
Loss = 2.8353e-01, PNorm = 46.0047, GNorm = 1.5041, lr_0 = 1.3800e-04
Validation prc-auc = 0.884038
Validation auc = 0.852858
Epoch 25
Loss = 2.7177e-01, PNorm = 46.0343, GNorm = 0.5608, lr_0 = 1.3335e-04
Loss = 2.8386e-01, PNorm = 46.0465, GNorm = 0.4683, lr_0 = 1.2886e-04
Validation prc-auc = 0.887176
Validation auc = 0.851172
Epoch 26
Loss = 2.7438e-01, PNorm = 46.0673, GNorm = 0.4364, lr_0 = 1.2409e-04
Loss = 2.5829e-01, PNorm = 46.0908, GNorm = 0.4895, lr_0 = 1.1991e-04
Validation prc-auc = 0.887559
Validation auc = 0.852671
Epoch 27
Loss = 2.7923e-01, PNorm = 46.1127, GNorm = 0.5744, lr_0 = 1.1548e-04
Loss = 2.5597e-01, PNorm = 46.1301, GNorm = 0.5471, lr_0 = 1.1159e-04
Loss = 2.6884e-01, PNorm = 46.1497, GNorm = 0.4455, lr_0 = 1.0783e-04
Validation prc-auc = 0.882264
Validation auc = 0.850047
Epoch 28
Loss = 2.8059e-01, PNorm = 46.1641, GNorm = 0.6899, lr_0 = 1.0420e-04
Loss = 2.6148e-01, PNorm = 46.1800, GNorm = 0.6089, lr_0 = 1.0069e-04
Validation prc-auc = 0.886594
Validation auc = 0.850422
Epoch 29
Loss = 2.1102e-01, PNorm = 46.1993, GNorm = 0.4414, lr_0 = 1.0000e-04
Loss = 2.5646e-01, PNorm = 46.2142, GNorm = 1.0413, lr_0 = 1.0000e-04
Loss = 2.8894e-01, PNorm = 46.2297, GNorm = 1.2582, lr_0 = 1.0000e-04
Validation prc-auc = 0.882596
Validation auc = 0.848735
Model 1 best validation prc-auc = 0.899225 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.883715
Model 1 test auc = 0.829208
Ensemble test prc-auc = 0.886430
Ensemble test auc = 0.824638
Fold 3
Splitting data with seed 3
Total scaffolds = 1,004 | train scaffolds = 783 | val scaffolds = 114 | test scaffolds = 107
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 64 | target average = 0.812500


Scaffold 1
Task 0: count = 30 | target average = 0.800000


Scaffold 2
Task 0: count = 9 | target average = 1.000000


Scaffold 3
Task 0: count = 9 | target average = 1.000000


Scaffold 4
Task 0: count = 9 | target average = 0.666667


Scaffold 5
Task 0: count = 8 | target average = 1.000000


Scaffold 6
Task 0: count = 8 | target average = 1.000000


Scaffold 7
Task 0: count = 8 | target average = 0.875000


Scaffold 8
Task 0: count = 7 | target average = 1.000000


Scaffold 9
Task 0: count = 7 | target average = 0.857143


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.2260e-01, PNorm = 43.2212, GNorm = 2.1364, lr_0 = 3.0625e-04
Loss = 5.5979e-01, PNorm = 43.2381, GNorm = 0.7525, lr_0 = 4.9375e-04
Validation prc-auc = 0.828798
Validation auc = 0.797188
Epoch 1
Loss = 5.3162e-01, PNorm = 43.2729, GNorm = 1.3276, lr_0 = 7.0000e-04
Loss = 4.9280e-01, PNorm = 43.3145, GNorm = 0.6488, lr_0 = 8.8750e-04
Validation prc-auc = 0.913897
Validation auc = 0.877038
Epoch 2
Loss = 4.2963e-01, PNorm = 43.3776, GNorm = 0.5134, lr_0 = 9.8301e-04
Loss = 4.3825e-01, PNorm = 43.4376, GNorm = 0.8412, lr_0 = 9.4990e-04
Loss = 4.5825e-01, PNorm = 43.4871, GNorm = 0.4231, lr_0 = 9.1790e-04
Validation prc-auc = 0.926778
Validation auc = 0.885286
Epoch 3
Loss = 3.9946e-01, PNorm = 43.5344, GNorm = 0.6260, lr_0 = 8.8699e-04
Loss = 4.5123e-01, PNorm = 43.5807, GNorm = 0.5966, lr_0 = 8.5711e-04
Validation prc-auc = 0.927933
Validation auc = 0.883599
Epoch 4
Loss = 3.6928e-01, PNorm = 43.6252, GNorm = 0.4607, lr_0 = 8.2540e-04
Loss = 4.2381e-01, PNorm = 43.6709, GNorm = 0.4830, lr_0 = 7.9760e-04
Loss = 4.0593e-01, PNorm = 43.7126, GNorm = 0.7704, lr_0 = 7.7073e-04
Validation prc-auc = 0.927927
Validation auc = 0.881912
Epoch 5
Loss = 3.8535e-01, PNorm = 43.7616, GNorm = 0.6522, lr_0 = 7.4477e-04
Loss = 4.4659e-01, PNorm = 43.8111, GNorm = 1.8212, lr_0 = 7.1969e-04
Validation prc-auc = 0.932525
Validation auc = 0.889410
Epoch 6
Loss = 4.5319e-01, PNorm = 43.8592, GNorm = 0.8005, lr_0 = 6.9306e-04
Loss = 3.7648e-01, PNorm = 43.9095, GNorm = 0.4104, lr_0 = 6.6972e-04
Loss = 4.2433e-01, PNorm = 43.9476, GNorm = 0.7569, lr_0 = 6.4716e-04
Loss = 3.5015e-01, PNorm = 43.9516, GNorm = 0.7855, lr_0 = 6.4495e-04
Validation prc-auc = 0.938111
Validation auc = 0.895408
Epoch 7
Loss = 3.7691e-01, PNorm = 44.0008, GNorm = 0.7025, lr_0 = 6.2322e-04
Loss = 4.0404e-01, PNorm = 44.0521, GNorm = 0.8547, lr_0 = 6.0223e-04
Validation prc-auc = 0.932742
Validation auc = 0.890159
Epoch 8
Loss = 3.8194e-01, PNorm = 44.1142, GNorm = 0.6789, lr_0 = 5.8194e-04
Loss = 4.0369e-01, PNorm = 44.1810, GNorm = 0.6032, lr_0 = 5.6234e-04
Validation prc-auc = 0.937979
Validation auc = 0.897470
Epoch 9
Loss = 3.0968e-01, PNorm = 44.2391, GNorm = 0.3939, lr_0 = 5.4154e-04
Loss = 4.4717e-01, PNorm = 44.2889, GNorm = 1.1314, lr_0 = 5.2330e-04
Loss = 3.3835e-01, PNorm = 44.3569, GNorm = 0.5856, lr_0 = 5.0567e-04
Validation prc-auc = 0.935116
Validation auc = 0.892971
Epoch 10
Loss = 3.4432e-01, PNorm = 44.4253, GNorm = 0.4268, lr_0 = 4.8864e-04
Loss = 3.9032e-01, PNorm = 44.4928, GNorm = 0.7172, lr_0 = 4.7218e-04
Validation prc-auc = 0.942421
Validation auc = 0.899157
Epoch 11
Loss = 3.8130e-01, PNorm = 44.5542, GNorm = 0.8480, lr_0 = 4.5471e-04
Loss = 3.3138e-01, PNorm = 44.6217, GNorm = 0.5278, lr_0 = 4.3940e-04
Loss = 3.8310e-01, PNorm = 44.6776, GNorm = 0.7377, lr_0 = 4.2460e-04
Validation prc-auc = 0.928634
Validation auc = 0.902343
Epoch 12
Loss = 3.2689e-01, PNorm = 44.7404, GNorm = 2.0019, lr_0 = 4.0889e-04
Loss = 3.4569e-01, PNorm = 44.7986, GNorm = 1.2451, lr_0 = 3.9512e-04
Validation prc-auc = 0.939729
Validation auc = 0.897470
Epoch 13
Loss = 3.5962e-01, PNorm = 44.8503, GNorm = 0.7661, lr_0 = 3.8181e-04
Loss = 3.3453e-01, PNorm = 44.9092, GNorm = 0.4059, lr_0 = 3.6895e-04
Loss = 3.4000e-01, PNorm = 44.9572, GNorm = 0.4348, lr_0 = 3.5652e-04
Validation prc-auc = 0.943381
Validation auc = 0.904592
Epoch 14
Loss = 3.5301e-01, PNorm = 45.0141, GNorm = 1.4118, lr_0 = 3.4333e-04
Loss = 3.2603e-01, PNorm = 45.0718, GNorm = 0.9083, lr_0 = 3.3177e-04
Validation prc-auc = 0.937550
Validation auc = 0.902905
Epoch 15
Loss = 3.6540e-01, PNorm = 45.1122, GNorm = 0.4985, lr_0 = 3.2059e-04
Loss = 3.3472e-01, PNorm = 45.1580, GNorm = 0.9828, lr_0 = 3.0979e-04
Loss = 3.0847e-01, PNorm = 45.2007, GNorm = 1.0316, lr_0 = 2.9936e-04
Loss = 2.1076e-01, PNorm = 45.2044, GNorm = 0.6946, lr_0 = 2.9833e-04
Validation prc-auc = 0.943052
Validation auc = 0.903468
Epoch 16
Loss = 3.1748e-01, PNorm = 45.2478, GNorm = 0.9136, lr_0 = 2.8828e-04
Loss = 3.3126e-01, PNorm = 45.2929, GNorm = 0.6933, lr_0 = 2.7857e-04
Validation prc-auc = 0.919171
Validation auc = 0.892596
Epoch 17
Loss = 3.2819e-01, PNorm = 45.3373, GNorm = 0.7575, lr_0 = 2.6827e-04
Loss = 3.3606e-01, PNorm = 45.3796, GNorm = 0.9216, lr_0 = 2.5923e-04
Validation prc-auc = 0.930639
Validation auc = 0.893533
Epoch 18
Loss = 2.7394e-01, PNorm = 45.4176, GNorm = 0.4992, lr_0 = 2.5050e-04
Loss = 2.9858e-01, PNorm = 45.4492, GNorm = 1.0416, lr_0 = 2.4206e-04
Loss = 3.2055e-01, PNorm = 45.4847, GNorm = 0.7150, lr_0 = 2.3391e-04
Validation prc-auc = 0.927225
Validation auc = 0.894470
Epoch 19
Loss = 2.9708e-01, PNorm = 45.5280, GNorm = 1.3481, lr_0 = 2.2526e-04
Loss = 3.2013e-01, PNorm = 45.5600, GNorm = 0.5733, lr_0 = 2.1767e-04
Validation prc-auc = 0.922002
Validation auc = 0.890722
Epoch 20
Loss = 2.6666e-01, PNorm = 45.5882, GNorm = 0.7838, lr_0 = 2.1034e-04
Loss = 3.1613e-01, PNorm = 45.6189, GNorm = 0.6610, lr_0 = 2.0325e-04
Loss = 3.0267e-01, PNorm = 45.6535, GNorm = 0.9582, lr_0 = 1.9641e-04
Validation prc-auc = 0.938397
Validation auc = 0.905904
Epoch 21
Loss = 3.1111e-01, PNorm = 45.6898, GNorm = 0.9384, lr_0 = 1.8914e-04
Loss = 3.1122e-01, PNorm = 45.7161, GNorm = 1.3667, lr_0 = 1.8277e-04
Validation prc-auc = 0.925329
Validation auc = 0.897470
Epoch 22
Loss = 2.4197e-01, PNorm = 45.7483, GNorm = 0.4414, lr_0 = 1.7601e-04
Loss = 2.7043e-01, PNorm = 45.7855, GNorm = 0.7127, lr_0 = 1.7008e-04
Loss = 3.2612e-01, PNorm = 45.8115, GNorm = 0.8568, lr_0 = 1.6435e-04
Validation prc-auc = 0.921623
Validation auc = 0.895595
Epoch 23
Loss = 2.7632e-01, PNorm = 45.8370, GNorm = 1.1990, lr_0 = 1.5882e-04
Loss = 2.6682e-01, PNorm = 45.8653, GNorm = 0.4800, lr_0 = 1.5347e-04
Validation prc-auc = 0.919637
Validation auc = 0.887535
Epoch 24
Loss = 2.7435e-01, PNorm = 45.8930, GNorm = 0.8411, lr_0 = 1.4779e-04
Loss = 2.7813e-01, PNorm = 45.9176, GNorm = 0.5847, lr_0 = 1.4281e-04
Loss = 2.6758e-01, PNorm = 45.9385, GNorm = 0.9399, lr_0 = 1.3800e-04
Validation prc-auc = 0.915808
Validation auc = 0.888472
Epoch 25
Loss = 2.4405e-01, PNorm = 45.9640, GNorm = 0.6861, lr_0 = 1.3335e-04
Loss = 2.8725e-01, PNorm = 45.9848, GNorm = 0.8940, lr_0 = 1.2886e-04
Validation prc-auc = 0.918432
Validation auc = 0.890722
Epoch 26
Loss = 2.7521e-01, PNorm = 46.0102, GNorm = 0.8412, lr_0 = 1.2409e-04
Loss = 2.6436e-01, PNorm = 46.0271, GNorm = 0.6292, lr_0 = 1.1991e-04
Validation prc-auc = 0.905936
Validation auc = 0.887348
Epoch 27
Loss = 3.3143e-01, PNorm = 46.0461, GNorm = 0.5395, lr_0 = 1.1548e-04
Loss = 2.3999e-01, PNorm = 46.0640, GNorm = 1.0261, lr_0 = 1.1159e-04
Loss = 2.6254e-01, PNorm = 46.0831, GNorm = 1.0996, lr_0 = 1.0783e-04
Validation prc-auc = 0.899687
Validation auc = 0.884349
Epoch 28
Loss = 2.3942e-01, PNorm = 46.1008, GNorm = 0.5830, lr_0 = 1.0420e-04
Loss = 2.7498e-01, PNorm = 46.1157, GNorm = 0.7280, lr_0 = 1.0069e-04
Validation prc-auc = 0.905741
Validation auc = 0.888097
Epoch 29
Loss = 2.4049e-01, PNorm = 46.1324, GNorm = 2.2112, lr_0 = 1.0000e-04
Loss = 2.6497e-01, PNorm = 46.1509, GNorm = 0.8891, lr_0 = 1.0000e-04
Loss = 2.7040e-01, PNorm = 46.1673, GNorm = 0.5278, lr_0 = 1.0000e-04
Validation prc-auc = 0.900343
Validation auc = 0.888472
Model 0 best validation prc-auc = 0.943381 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.906184
Model 0 test auc = 0.872015
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.4743e-01, PNorm = 43.2449, GNorm = 0.9683, lr_0 = 3.0625e-04
Loss = 5.7141e-01, PNorm = 43.2642, GNorm = 1.2326, lr_0 = 4.9375e-04
Validation prc-auc = 0.806613
Validation auc = 0.770197
Epoch 1
Loss = 5.2149e-01, PNorm = 43.2964, GNorm = 1.2897, lr_0 = 7.0000e-04
Loss = 4.8968e-01, PNorm = 43.3357, GNorm = 0.4913, lr_0 = 8.8750e-04
Validation prc-auc = 0.888491
Validation auc = 0.848360
Epoch 2
Loss = 4.5266e-01, PNorm = 43.3937, GNorm = 1.1188, lr_0 = 9.8301e-04
Loss = 4.1769e-01, PNorm = 43.4594, GNorm = 1.7597, lr_0 = 9.4990e-04
Loss = 4.5633e-01, PNorm = 43.5038, GNorm = 0.3955, lr_0 = 9.1790e-04
Validation prc-auc = 0.926239
Validation auc = 0.885286
Epoch 3
Loss = 4.1184e-01, PNorm = 43.5451, GNorm = 0.8505, lr_0 = 8.8699e-04
Loss = 4.6381e-01, PNorm = 43.5908, GNorm = 1.2492, lr_0 = 8.5711e-04
Validation prc-auc = 0.929026
Validation auc = 0.884724
Epoch 4
Loss = 4.3164e-01, PNorm = 43.6426, GNorm = 0.8600, lr_0 = 8.2540e-04
Loss = 3.7300e-01, PNorm = 43.6961, GNorm = 0.7314, lr_0 = 7.9760e-04
Loss = 4.4910e-01, PNorm = 43.7357, GNorm = 0.5277, lr_0 = 7.7073e-04
Validation prc-auc = 0.922644
Validation auc = 0.882474
Epoch 5
Loss = 3.8557e-01, PNorm = 43.7850, GNorm = 1.7120, lr_0 = 7.4477e-04
Loss = 4.4296e-01, PNorm = 43.8313, GNorm = 1.6766, lr_0 = 7.1969e-04
Validation prc-auc = 0.929548
Validation auc = 0.890909
Epoch 6
Loss = 4.4505e-01, PNorm = 43.8813, GNorm = 1.1025, lr_0 = 6.9306e-04
Loss = 3.8221e-01, PNorm = 43.9335, GNorm = 0.8843, lr_0 = 6.6972e-04
Loss = 4.0416e-01, PNorm = 43.9768, GNorm = 0.4493, lr_0 = 6.4716e-04
Loss = 4.6235e-01, PNorm = 43.9816, GNorm = 1.1196, lr_0 = 6.4495e-04
Validation prc-auc = 0.928100
Validation auc = 0.886223
Epoch 7
Loss = 3.9632e-01, PNorm = 44.0239, GNorm = 1.0190, lr_0 = 6.2322e-04
Loss = 3.7790e-01, PNorm = 44.0759, GNorm = 0.4746, lr_0 = 6.0223e-04
Validation prc-auc = 0.931389
Validation auc = 0.889035
Epoch 8
Loss = 3.4685e-01, PNorm = 44.1296, GNorm = 1.1427, lr_0 = 5.8194e-04
Loss = 3.8422e-01, PNorm = 44.1851, GNorm = 0.7417, lr_0 = 5.6234e-04
Validation prc-auc = 0.933878
Validation auc = 0.889597
Epoch 9
Loss = 3.1486e-01, PNorm = 44.2418, GNorm = 0.4111, lr_0 = 5.4154e-04
Loss = 3.9290e-01, PNorm = 44.3002, GNorm = 0.4669, lr_0 = 5.2330e-04
Loss = 3.8646e-01, PNorm = 44.3477, GNorm = 1.2517, lr_0 = 5.0567e-04
Validation prc-auc = 0.940344
Validation auc = 0.897657
Epoch 10
Loss = 3.8883e-01, PNorm = 44.3914, GNorm = 0.7041, lr_0 = 4.8864e-04
Loss = 3.7157e-01, PNorm = 44.4385, GNorm = 0.7279, lr_0 = 4.7218e-04
Validation prc-auc = 0.933608
Validation auc = 0.886785
Epoch 11
Loss = 3.4602e-01, PNorm = 44.4909, GNorm = 0.4927, lr_0 = 4.5471e-04
Loss = 3.5546e-01, PNorm = 44.5520, GNorm = 0.4547, lr_0 = 4.3940e-04
Loss = 3.6951e-01, PNorm = 44.5972, GNorm = 0.4815, lr_0 = 4.2460e-04
Validation prc-auc = 0.943675
Validation auc = 0.903280
Epoch 12
Loss = 3.8142e-01, PNorm = 44.6540, GNorm = 0.9600, lr_0 = 4.0889e-04
Loss = 3.2990e-01, PNorm = 44.7110, GNorm = 0.9773, lr_0 = 3.9512e-04
Validation prc-auc = 0.937564
Validation auc = 0.895595
Epoch 13
Loss = 3.2836e-01, PNorm = 44.7549, GNorm = 1.3502, lr_0 = 3.8181e-04
Loss = 3.4956e-01, PNorm = 44.8092, GNorm = 1.0329, lr_0 = 3.6895e-04
Loss = 3.5658e-01, PNorm = 44.8614, GNorm = 0.6876, lr_0 = 3.5652e-04
Validation prc-auc = 0.941198
Validation auc = 0.902905
Epoch 14
Loss = 3.7528e-01, PNorm = 44.9167, GNorm = 0.9246, lr_0 = 3.4333e-04
Loss = 3.2997e-01, PNorm = 44.9655, GNorm = 0.5312, lr_0 = 3.3177e-04
Validation prc-auc = 0.940795
Validation auc = 0.903280
Epoch 15
Loss = 2.9553e-01, PNorm = 45.0170, GNorm = 0.4615, lr_0 = 3.2059e-04
Loss = 3.6649e-01, PNorm = 45.0567, GNorm = 1.4600, lr_0 = 3.0979e-04
Loss = 3.3917e-01, PNorm = 45.1016, GNorm = 0.8012, lr_0 = 2.9936e-04
Loss = 4.6540e-01, PNorm = 45.1062, GNorm = 1.0525, lr_0 = 2.9833e-04
Validation prc-auc = 0.939799
Validation auc = 0.901218
Epoch 16
Loss = 3.1443e-01, PNorm = 45.1544, GNorm = 0.7060, lr_0 = 2.8828e-04
Loss = 2.9950e-01, PNorm = 45.1952, GNorm = 0.4576, lr_0 = 2.7857e-04
Validation prc-auc = 0.943516
Validation auc = 0.906467
Epoch 17
Loss = 3.2643e-01, PNorm = 45.2386, GNorm = 0.7390, lr_0 = 2.6827e-04
Loss = 3.2351e-01, PNorm = 45.2806, GNorm = 1.2097, lr_0 = 2.5923e-04
Validation prc-auc = 0.936460
Validation auc = 0.897282
Epoch 18
Loss = 3.7829e-01, PNorm = 45.3188, GNorm = 0.5851, lr_0 = 2.5050e-04
Loss = 3.3893e-01, PNorm = 45.3573, GNorm = 0.9699, lr_0 = 2.4206e-04
Loss = 3.2347e-01, PNorm = 45.3850, GNorm = 0.5818, lr_0 = 2.3391e-04
Validation prc-auc = 0.949695
Validation auc = 0.914902
Epoch 19
Loss = 3.3765e-01, PNorm = 45.4272, GNorm = 0.4866, lr_0 = 2.2526e-04
Loss = 2.7327e-01, PNorm = 45.4668, GNorm = 0.5473, lr_0 = 2.1767e-04
Validation prc-auc = 0.938370
Validation auc = 0.904030
Epoch 20
Loss = 3.8905e-01, PNorm = 45.4935, GNorm = 0.7197, lr_0 = 2.1034e-04
Loss = 2.7836e-01, PNorm = 45.5246, GNorm = 0.6219, lr_0 = 2.0325e-04
Loss = 3.4544e-01, PNorm = 45.5621, GNorm = 0.6161, lr_0 = 1.9641e-04
Validation prc-auc = 0.924912
Validation auc = 0.891659
Epoch 21
Loss = 3.0007e-01, PNorm = 45.5910, GNorm = 0.4421, lr_0 = 1.8914e-04
Loss = 2.7679e-01, PNorm = 45.6258, GNorm = 0.4891, lr_0 = 1.8277e-04
Validation prc-auc = 0.932255
Validation auc = 0.901781
Epoch 22
Loss = 2.9076e-01, PNorm = 45.6551, GNorm = 0.4862, lr_0 = 1.7601e-04
Loss = 3.2393e-01, PNorm = 45.6867, GNorm = 0.6188, lr_0 = 1.7008e-04
Loss = 2.7902e-01, PNorm = 45.7150, GNorm = 0.7137, lr_0 = 1.6435e-04
Validation prc-auc = 0.927686
Validation auc = 0.896720
Epoch 23
Loss = 2.8504e-01, PNorm = 45.7389, GNorm = 0.5677, lr_0 = 1.5882e-04
Loss = 2.9309e-01, PNorm = 45.7690, GNorm = 0.5225, lr_0 = 1.5347e-04
Validation prc-auc = 0.926292
Validation auc = 0.898407
Epoch 24
Loss = 2.8026e-01, PNorm = 45.7941, GNorm = 0.7953, lr_0 = 1.4779e-04
Loss = 3.1787e-01, PNorm = 45.8195, GNorm = 2.1729, lr_0 = 1.4281e-04
Loss = 2.8238e-01, PNorm = 45.8401, GNorm = 2.0451, lr_0 = 1.3800e-04
Validation prc-auc = 0.932519
Validation auc = 0.902343
Epoch 25
Loss = 3.0936e-01, PNorm = 45.8605, GNorm = 0.5203, lr_0 = 1.3335e-04
Loss = 2.7072e-01, PNorm = 45.8793, GNorm = 0.6864, lr_0 = 1.2886e-04
Validation prc-auc = 0.916184
Validation auc = 0.893158
Epoch 26
Loss = 3.0478e-01, PNorm = 45.9051, GNorm = 0.6054, lr_0 = 1.2409e-04
Loss = 3.1225e-01, PNorm = 45.9251, GNorm = 0.8522, lr_0 = 1.1991e-04
Validation prc-auc = 0.912867
Validation auc = 0.895220
Epoch 27
Loss = 2.5288e-01, PNorm = 45.9492, GNorm = 0.6271, lr_0 = 1.1548e-04
Loss = 2.9041e-01, PNorm = 45.9662, GNorm = 1.5480, lr_0 = 1.1159e-04
Loss = 2.8514e-01, PNorm = 45.9868, GNorm = 0.5711, lr_0 = 1.0783e-04
Validation prc-auc = 0.905910
Validation auc = 0.892409
Epoch 28
Loss = 2.8255e-01, PNorm = 45.9978, GNorm = 1.2588, lr_0 = 1.0420e-04
Loss = 2.7592e-01, PNorm = 46.0172, GNorm = 0.7119, lr_0 = 1.0069e-04
Validation prc-auc = 0.910390
Validation auc = 0.894658
Epoch 29
Loss = 2.9960e-01, PNorm = 46.0297, GNorm = 0.4395, lr_0 = 1.0000e-04
Loss = 2.5671e-01, PNorm = 46.0461, GNorm = 0.9063, lr_0 = 1.0000e-04
Loss = 2.5965e-01, PNorm = 46.0660, GNorm = 0.7026, lr_0 = 1.0000e-04
Validation prc-auc = 0.898950
Validation auc = 0.889597
Model 1 best validation prc-auc = 0.949695 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.914409
Model 1 test auc = 0.883778
Ensemble test prc-auc = 0.914221
Ensemble test auc = 0.881145
Fold 4
Splitting data with seed 4
Total scaffolds = 1,004 | train scaffolds = 804 | val scaffolds = 102 | test scaffolds = 98
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 64 | target average = 0.812500


Scaffold 1
Task 0: count = 30 | target average = 0.800000


Scaffold 2
Task 0: count = 9 | target average = 1.000000


Scaffold 3
Task 0: count = 9 | target average = 0.666667


Scaffold 4
Task 0: count = 9 | target average = 1.000000


Scaffold 5
Task 0: count = 8 | target average = 1.000000


Scaffold 6
Task 0: count = 8 | target average = 0.875000


Scaffold 7
Task 0: count = 8 | target average = 1.000000


Scaffold 8
Task 0: count = 7 | target average = 0.857143


Scaffold 9
Task 0: count = 7 | target average = 1.000000


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.2176e-01, PNorm = 43.2228, GNorm = 1.2080, lr_0 = 3.0625e-04
Loss = 5.7699e-01, PNorm = 43.2412, GNorm = 2.5609, lr_0 = 4.9375e-04
Validation prc-auc = 0.951226
Validation auc = 0.897761
Epoch 1
Loss = 4.7774e-01, PNorm = 43.2752, GNorm = 1.0053, lr_0 = 7.0000e-04
Loss = 4.8754e-01, PNorm = 43.3200, GNorm = 1.1395, lr_0 = 8.8750e-04
Validation prc-auc = 0.962542
Validation auc = 0.916188
Epoch 2
Loss = 4.0661e-01, PNorm = 43.3865, GNorm = 0.9672, lr_0 = 9.8301e-04
Loss = 4.5896e-01, PNorm = 43.4377, GNorm = 1.5324, lr_0 = 9.4990e-04
Loss = 4.8508e-01, PNorm = 43.4790, GNorm = 1.2579, lr_0 = 9.1790e-04
Validation prc-auc = 0.958734
Validation auc = 0.910244
Epoch 3
Loss = 4.3173e-01, PNorm = 43.5229, GNorm = 0.8465, lr_0 = 8.8699e-04
Loss = 4.2094e-01, PNorm = 43.5716, GNorm = 1.5203, lr_0 = 8.5711e-04
Validation prc-auc = 0.954135
Validation auc = 0.904498
Epoch 4
Loss = 3.7676e-01, PNorm = 43.6155, GNorm = 0.3593, lr_0 = 8.2540e-04
Loss = 4.2467e-01, PNorm = 43.6648, GNorm = 0.6678, lr_0 = 7.9760e-04
Loss = 4.3453e-01, PNorm = 43.7017, GNorm = 0.5493, lr_0 = 7.7073e-04
Validation prc-auc = 0.950945
Validation auc = 0.901129
Epoch 5
Loss = 3.9122e-01, PNorm = 43.7530, GNorm = 0.6606, lr_0 = 7.4477e-04
Loss = 3.8305e-01, PNorm = 43.8043, GNorm = 0.5041, lr_0 = 7.1969e-04
Validation prc-auc = 0.946122
Validation auc = 0.898157
Epoch 6
Loss = 3.6834e-01, PNorm = 43.8578, GNorm = 0.5854, lr_0 = 6.9306e-04
Loss = 4.2136e-01, PNorm = 43.9037, GNorm = 0.4176, lr_0 = 6.6972e-04
Loss = 3.9262e-01, PNorm = 43.9536, GNorm = 0.5472, lr_0 = 6.4716e-04
Loss = 5.0908e-01, PNorm = 43.9591, GNorm = 1.0161, lr_0 = 6.4495e-04
Validation prc-auc = 0.949435
Validation auc = 0.899346
Epoch 7
Loss = 4.0121e-01, PNorm = 44.0162, GNorm = 1.4138, lr_0 = 6.2322e-04
Loss = 3.9009e-01, PNorm = 44.0735, GNorm = 0.5773, lr_0 = 6.0223e-04
Validation prc-auc = 0.940353
Validation auc = 0.895185
Epoch 8
Loss = 3.3903e-01, PNorm = 44.1313, GNorm = 0.5695, lr_0 = 5.8194e-04
Loss = 4.0115e-01, PNorm = 44.1918, GNorm = 1.1345, lr_0 = 5.6234e-04
Validation prc-auc = 0.939114
Validation auc = 0.897167
Epoch 9
Loss = 3.3609e-01, PNorm = 44.2488, GNorm = 0.4793, lr_0 = 5.4154e-04
Loss = 3.8521e-01, PNorm = 44.3172, GNorm = 0.8352, lr_0 = 5.2330e-04
Loss = 3.8423e-01, PNorm = 44.3683, GNorm = 0.5859, lr_0 = 5.0567e-04
Validation prc-auc = 0.923701
Validation auc = 0.896770
Epoch 10
Loss = 3.5550e-01, PNorm = 44.4274, GNorm = 0.6718, lr_0 = 4.8864e-04
Loss = 3.4669e-01, PNorm = 44.4910, GNorm = 0.6013, lr_0 = 4.7218e-04
Validation prc-auc = 0.926454
Validation auc = 0.892808
Epoch 11
Loss = 4.0354e-01, PNorm = 44.5549, GNorm = 1.5949, lr_0 = 4.5471e-04
Loss = 3.7044e-01, PNorm = 44.6160, GNorm = 0.4096, lr_0 = 4.3940e-04
Loss = 3.5839e-01, PNorm = 44.6743, GNorm = 0.5227, lr_0 = 4.2460e-04
Validation prc-auc = 0.938032
Validation auc = 0.900931
Epoch 12
Loss = 3.2756e-01, PNorm = 44.7400, GNorm = 0.7820, lr_0 = 4.0889e-04
Loss = 3.7043e-01, PNorm = 44.7939, GNorm = 0.4871, lr_0 = 3.9512e-04
Validation prc-auc = 0.926695
Validation auc = 0.900139
Epoch 13
Loss = 3.6414e-01, PNorm = 44.8443, GNorm = 1.2762, lr_0 = 3.8181e-04
Loss = 3.4802e-01, PNorm = 44.8938, GNorm = 0.7672, lr_0 = 3.6895e-04
Loss = 3.6628e-01, PNorm = 44.9391, GNorm = 0.5144, lr_0 = 3.5652e-04
Validation prc-auc = 0.920091
Validation auc = 0.897959
Epoch 14
Loss = 2.9796e-01, PNorm = 45.0043, GNorm = 0.6338, lr_0 = 3.4333e-04
Loss = 3.5031e-01, PNorm = 45.0602, GNorm = 0.6369, lr_0 = 3.3177e-04
Validation prc-auc = 0.919903
Validation auc = 0.898752
Epoch 15
Loss = 3.3347e-01, PNorm = 45.1036, GNorm = 0.6566, lr_0 = 3.2059e-04
Loss = 3.0094e-01, PNorm = 45.1583, GNorm = 1.1107, lr_0 = 3.0979e-04
Loss = 3.5861e-01, PNorm = 45.2003, GNorm = 0.7510, lr_0 = 2.9936e-04
Loss = 2.8598e-01, PNorm = 45.2045, GNorm = 0.9458, lr_0 = 2.9833e-04
Validation prc-auc = 0.923733
Validation auc = 0.898157
Epoch 16
Loss = 3.1864e-01, PNorm = 45.2493, GNorm = 0.7744, lr_0 = 2.8828e-04
Loss = 3.4308e-01, PNorm = 45.2875, GNorm = 1.2241, lr_0 = 2.7857e-04
Validation prc-auc = 0.920235
Validation auc = 0.898752
Epoch 17
Loss = 3.2587e-01, PNorm = 45.3256, GNorm = 0.6530, lr_0 = 2.6827e-04
Loss = 3.1191e-01, PNorm = 45.3687, GNorm = 0.7521, lr_0 = 2.5923e-04
Validation prc-auc = 0.930682
Validation auc = 0.890628
Epoch 18
Loss = 4.0980e-01, PNorm = 45.4063, GNorm = 1.6858, lr_0 = 2.5050e-04
Loss = 3.2080e-01, PNorm = 45.4337, GNorm = 0.7429, lr_0 = 2.4206e-04
Loss = 2.8527e-01, PNorm = 45.4734, GNorm = 0.6542, lr_0 = 2.3391e-04
Validation prc-auc = 0.926583
Validation auc = 0.899544
Epoch 19
Loss = 3.1635e-01, PNorm = 45.5110, GNorm = 0.6880, lr_0 = 2.2526e-04
Loss = 3.2155e-01, PNorm = 45.5409, GNorm = 0.7661, lr_0 = 2.1767e-04
Validation prc-auc = 0.924307
Validation auc = 0.894789
Epoch 20
Loss = 3.2379e-01, PNorm = 45.5724, GNorm = 0.5247, lr_0 = 2.1034e-04
Loss = 2.8435e-01, PNorm = 45.6078, GNorm = 0.8095, lr_0 = 2.0325e-04
Loss = 3.0749e-01, PNorm = 45.6382, GNorm = 0.8052, lr_0 = 1.9641e-04
Validation prc-auc = 0.930366
Validation auc = 0.895582
Epoch 21
Loss = 2.8982e-01, PNorm = 45.6757, GNorm = 0.5089, lr_0 = 1.8914e-04
Loss = 2.9368e-01, PNorm = 45.7004, GNorm = 1.0025, lr_0 = 1.8277e-04
Validation prc-auc = 0.926666
Validation auc = 0.887656
Epoch 22
Loss = 2.8608e-01, PNorm = 45.7325, GNorm = 0.7345, lr_0 = 1.7601e-04
Loss = 2.6629e-01, PNorm = 45.7594, GNorm = 0.5267, lr_0 = 1.7008e-04
Loss = 3.1422e-01, PNorm = 45.7823, GNorm = 1.1755, lr_0 = 1.6435e-04
Validation prc-auc = 0.918761
Validation auc = 0.891817
Epoch 23
Loss = 2.6815e-01, PNorm = 45.8066, GNorm = 0.7076, lr_0 = 1.5882e-04
Loss = 2.9883e-01, PNorm = 45.8350, GNorm = 0.7693, lr_0 = 1.5347e-04
Validation prc-auc = 0.931944
Validation auc = 0.893600
Epoch 24
Loss = 3.0982e-01, PNorm = 45.8619, GNorm = 1.8607, lr_0 = 1.4779e-04
Loss = 2.3122e-01, PNorm = 45.8868, GNorm = 0.7324, lr_0 = 1.4281e-04
Loss = 3.1256e-01, PNorm = 45.9068, GNorm = 1.6165, lr_0 = 1.3800e-04
Validation prc-auc = 0.924785
Validation auc = 0.889637
Epoch 25
Loss = 2.7022e-01, PNorm = 45.9270, GNorm = 0.5219, lr_0 = 1.3335e-04
Loss = 2.6854e-01, PNorm = 45.9479, GNorm = 0.6139, lr_0 = 1.2886e-04
Validation prc-auc = 0.924544
Validation auc = 0.891421
Epoch 26
Loss = 2.8516e-01, PNorm = 45.9672, GNorm = 0.5230, lr_0 = 1.2409e-04
Loss = 2.6630e-01, PNorm = 45.9860, GNorm = 0.6590, lr_0 = 1.1991e-04
Validation prc-auc = 0.929061
Validation auc = 0.890430
Epoch 27
Loss = 2.3361e-01, PNorm = 46.0041, GNorm = 0.4961, lr_0 = 1.1548e-04
Loss = 2.8390e-01, PNorm = 46.0164, GNorm = 0.7513, lr_0 = 1.1159e-04
Loss = 2.7395e-01, PNorm = 46.0319, GNorm = 1.0385, lr_0 = 1.0783e-04
Validation prc-auc = 0.933047
Validation auc = 0.891421
Epoch 28
Loss = 2.7529e-01, PNorm = 46.0507, GNorm = 0.4933, lr_0 = 1.0420e-04
Loss = 2.7058e-01, PNorm = 46.0652, GNorm = 0.9823, lr_0 = 1.0069e-04
Validation prc-auc = 0.926936
Validation auc = 0.888250
Epoch 29
Loss = 2.4566e-01, PNorm = 46.0810, GNorm = 0.6332, lr_0 = 1.0000e-04
Loss = 2.9506e-01, PNorm = 46.0970, GNorm = 0.9631, lr_0 = 1.0000e-04
Loss = 2.3042e-01, PNorm = 46.1076, GNorm = 0.9637, lr_0 = 1.0000e-04
Validation prc-auc = 0.923046
Validation auc = 0.890628
Model 0 best validation prc-auc = 0.962542 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.861257
Model 0 test auc = 0.843945
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.6707e-01, PNorm = 43.2461, GNorm = 1.6577, lr_0 = 3.0625e-04
Loss = 5.8860e-01, PNorm = 43.2651, GNorm = 0.7772, lr_0 = 4.9375e-04
Validation prc-auc = 0.939564
Validation auc = 0.877353
Epoch 1
Loss = 5.3316e-01, PNorm = 43.3016, GNorm = 1.0322, lr_0 = 7.0000e-04
Loss = 4.8555e-01, PNorm = 43.3511, GNorm = 1.6307, lr_0 = 8.8750e-04
Validation prc-auc = 0.955194
Validation auc = 0.905687
Epoch 2
Loss = 3.9725e-01, PNorm = 43.4175, GNorm = 0.6995, lr_0 = 9.8301e-04
Loss = 4.5645e-01, PNorm = 43.4802, GNorm = 0.9302, lr_0 = 9.4990e-04
Loss = 4.4475e-01, PNorm = 43.5373, GNorm = 1.0756, lr_0 = 9.1790e-04
Validation prc-auc = 0.953123
Validation auc = 0.902714
Epoch 3
Loss = 4.4600e-01, PNorm = 43.5849, GNorm = 0.8835, lr_0 = 8.8699e-04
Loss = 4.1745e-01, PNorm = 43.6283, GNorm = 0.6617, lr_0 = 8.5711e-04
Validation prc-auc = 0.954725
Validation auc = 0.905885
Epoch 4
Loss = 3.9103e-01, PNorm = 43.6856, GNorm = 1.0407, lr_0 = 8.2540e-04
Loss = 4.1778e-01, PNorm = 43.7390, GNorm = 0.4942, lr_0 = 7.9760e-04
Loss = 4.4180e-01, PNorm = 43.7824, GNorm = 1.0193, lr_0 = 7.7073e-04
Validation prc-auc = 0.951432
Validation auc = 0.902120
Epoch 5
Loss = 4.3069e-01, PNorm = 43.8271, GNorm = 1.3068, lr_0 = 7.4477e-04
Loss = 3.8839e-01, PNorm = 43.8799, GNorm = 1.2368, lr_0 = 7.1969e-04
Validation prc-auc = 0.950052
Validation auc = 0.902913
Epoch 6
Loss = 4.7881e-01, PNorm = 43.9335, GNorm = 1.9594, lr_0 = 6.9306e-04
Loss = 3.9045e-01, PNorm = 43.9902, GNorm = 0.3737, lr_0 = 6.6972e-04
Loss = 4.3562e-01, PNorm = 44.0343, GNorm = 1.2389, lr_0 = 6.4716e-04
Loss = 3.0313e-01, PNorm = 44.0401, GNorm = 1.4904, lr_0 = 6.4495e-04
Validation prc-auc = 0.942835
Validation auc = 0.897563
Epoch 7
Loss = 4.0287e-01, PNorm = 44.0964, GNorm = 0.8318, lr_0 = 6.2322e-04
Loss = 3.9016e-01, PNorm = 44.1501, GNorm = 0.4925, lr_0 = 6.0223e-04
Validation prc-auc = 0.943199
Validation auc = 0.898157
Epoch 8
Loss = 3.7390e-01, PNorm = 44.2127, GNorm = 1.0342, lr_0 = 5.8194e-04
Loss = 3.7309e-01, PNorm = 44.2865, GNorm = 0.5536, lr_0 = 5.6234e-04
Validation prc-auc = 0.941881
Validation auc = 0.901724
Epoch 9
Loss = 3.7811e-01, PNorm = 44.3422, GNorm = 0.4905, lr_0 = 5.4154e-04
Loss = 3.8101e-01, PNorm = 44.3906, GNorm = 0.6868, lr_0 = 5.2330e-04
Loss = 3.9976e-01, PNorm = 44.4584, GNorm = 0.5525, lr_0 = 5.0567e-04
Validation prc-auc = 0.934779
Validation auc = 0.901526
Epoch 10
Loss = 3.2779e-01, PNorm = 44.5274, GNorm = 0.6570, lr_0 = 4.8864e-04
Loss = 4.0022e-01, PNorm = 44.5827, GNorm = 0.6524, lr_0 = 4.7218e-04
Validation prc-auc = 0.924336
Validation auc = 0.897167
Epoch 11
Loss = 3.8485e-01, PNorm = 44.6429, GNorm = 1.5329, lr_0 = 4.5471e-04
Loss = 3.8318e-01, PNorm = 44.6973, GNorm = 0.5818, lr_0 = 4.3940e-04
Loss = 3.4236e-01, PNorm = 44.7609, GNorm = 0.7433, lr_0 = 4.2460e-04
Validation prc-auc = 0.925087
Validation auc = 0.902913
Epoch 12
Loss = 3.5761e-01, PNorm = 44.8391, GNorm = 0.7114, lr_0 = 4.0889e-04
Loss = 3.0933e-01, PNorm = 44.9087, GNorm = 0.5592, lr_0 = 3.9512e-04
Validation prc-auc = 0.934956
Validation auc = 0.895582
Epoch 13
Loss = 4.5128e-01, PNorm = 44.9516, GNorm = 1.0569, lr_0 = 3.8181e-04
Loss = 3.6763e-01, PNorm = 44.9895, GNorm = 1.1036, lr_0 = 3.6895e-04
Loss = 3.3545e-01, PNorm = 45.0460, GNorm = 0.5155, lr_0 = 3.5652e-04
Validation prc-auc = 0.926453
Validation auc = 0.902318
Epoch 14
Loss = 3.3865e-01, PNorm = 45.1118, GNorm = 0.9899, lr_0 = 3.4333e-04
Loss = 3.4713e-01, PNorm = 45.1702, GNorm = 0.9535, lr_0 = 3.3177e-04
Validation prc-auc = 0.919897
Validation auc = 0.902913
Epoch 15
Loss = 3.4146e-01, PNorm = 45.1965, GNorm = 0.6224, lr_0 = 3.2059e-04
Loss = 3.3268e-01, PNorm = 45.2416, GNorm = 0.5935, lr_0 = 3.0979e-04
Loss = 3.2511e-01, PNorm = 45.2822, GNorm = 0.6362, lr_0 = 2.9936e-04
Loss = 2.8431e-01, PNorm = 45.2866, GNorm = 1.0457, lr_0 = 2.9833e-04
Validation prc-auc = 0.923820
Validation auc = 0.901129
Epoch 16
Loss = 2.9933e-01, PNorm = 45.3334, GNorm = 0.6189, lr_0 = 2.8828e-04
Loss = 3.2102e-01, PNorm = 45.3793, GNorm = 0.5680, lr_0 = 2.7857e-04
Validation prc-auc = 0.923826
Validation auc = 0.899742
Epoch 17
Loss = 2.7794e-01, PNorm = 45.4133, GNorm = 0.4512, lr_0 = 2.6827e-04
Loss = 3.0748e-01, PNorm = 45.4469, GNorm = 0.5440, lr_0 = 2.5923e-04
Validation prc-auc = 0.923373
Validation auc = 0.898355
Epoch 18
Loss = 4.3951e-01, PNorm = 45.4841, GNorm = 1.3464, lr_0 = 2.5050e-04
Loss = 3.0869e-01, PNorm = 45.5229, GNorm = 0.6876, lr_0 = 2.4206e-04
Loss = 3.1866e-01, PNorm = 45.5654, GNorm = 0.9029, lr_0 = 2.3391e-04
Validation prc-auc = 0.922251
Validation auc = 0.895978
Epoch 19
Loss = 2.9127e-01, PNorm = 45.5944, GNorm = 1.1256, lr_0 = 2.2526e-04
Loss = 3.2149e-01, PNorm = 45.6253, GNorm = 0.6313, lr_0 = 2.1767e-04
Validation prc-auc = 0.923099
Validation auc = 0.898950
Epoch 20
Loss = 3.1501e-01, PNorm = 45.6520, GNorm = 0.7052, lr_0 = 2.1034e-04
Loss = 3.1935e-01, PNorm = 45.6837, GNorm = 0.3979, lr_0 = 2.0325e-04
Loss = 2.7569e-01, PNorm = 45.7170, GNorm = 0.4895, lr_0 = 1.9641e-04
Validation prc-auc = 0.922961
Validation auc = 0.893204
Epoch 21
Loss = 2.9619e-01, PNorm = 45.7474, GNorm = 0.7524, lr_0 = 1.8914e-04
Loss = 2.6738e-01, PNorm = 45.7745, GNorm = 0.4307, lr_0 = 1.8277e-04
Validation prc-auc = 0.928167
Validation auc = 0.899148
Epoch 22
Loss = 2.8189e-01, PNorm = 45.8008, GNorm = 0.6284, lr_0 = 1.7601e-04
Loss = 2.8860e-01, PNorm = 45.8239, GNorm = 1.0231, lr_0 = 1.7008e-04
Loss = 2.9743e-01, PNorm = 45.8485, GNorm = 0.6784, lr_0 = 1.6435e-04
Validation prc-auc = 0.922902
Validation auc = 0.894591
Epoch 23
Loss = 2.6258e-01, PNorm = 45.8725, GNorm = 0.9910, lr_0 = 1.5882e-04
Loss = 2.8967e-01, PNorm = 45.8990, GNorm = 0.9771, lr_0 = 1.5347e-04
Validation prc-auc = 0.923601
Validation auc = 0.896770
Epoch 24
Loss = 3.1851e-01, PNorm = 45.9179, GNorm = 0.5056, lr_0 = 1.4779e-04
Loss = 2.8694e-01, PNorm = 45.9399, GNorm = 1.1165, lr_0 = 1.4281e-04
Loss = 2.4259e-01, PNorm = 45.9586, GNorm = 0.6821, lr_0 = 1.3800e-04
Validation prc-auc = 0.923735
Validation auc = 0.896176
Epoch 25
Loss = 2.7805e-01, PNorm = 45.9795, GNorm = 0.5982, lr_0 = 1.3335e-04
Loss = 2.8645e-01, PNorm = 45.9967, GNorm = 0.7869, lr_0 = 1.2886e-04
Validation prc-auc = 0.925798
Validation auc = 0.897167
Epoch 26
Loss = 2.4482e-01, PNorm = 46.0192, GNorm = 0.8280, lr_0 = 1.2409e-04
Loss = 2.6752e-01, PNorm = 46.0360, GNorm = 1.1224, lr_0 = 1.1991e-04
Validation prc-auc = 0.924502
Validation auc = 0.897563
Epoch 27
Loss = 3.2549e-01, PNorm = 46.0548, GNorm = 0.7496, lr_0 = 1.1548e-04
Loss = 2.4008e-01, PNorm = 46.0710, GNorm = 0.4214, lr_0 = 1.1159e-04
Loss = 2.6247e-01, PNorm = 46.0860, GNorm = 0.5601, lr_0 = 1.0783e-04
Validation prc-auc = 0.925106
Validation auc = 0.898355
Epoch 28
Loss = 3.0322e-01, PNorm = 46.1012, GNorm = 0.5525, lr_0 = 1.0420e-04
Loss = 2.5756e-01, PNorm = 46.1150, GNorm = 0.6201, lr_0 = 1.0069e-04
Validation prc-auc = 0.916885
Validation auc = 0.894591
Epoch 29
Loss = 2.3906e-01, PNorm = 46.1313, GNorm = 0.8070, lr_0 = 1.0000e-04
Loss = 2.5589e-01, PNorm = 46.1445, GNorm = 1.2005, lr_0 = 1.0000e-04
Loss = 2.7650e-01, PNorm = 46.1606, GNorm = 0.5934, lr_0 = 1.0000e-04
Validation prc-auc = 0.921763
Validation auc = 0.889439
Model 1 best validation prc-auc = 0.955194 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.867365
Model 1 test auc = 0.844291
Ensemble test prc-auc = 0.862560
Ensemble test auc = 0.843599
5-fold cross validation
	Seed 0 ==> test prc-auc = 0.927767
	Seed 0 ==> test auc = 0.891327
	Seed 1 ==> test prc-auc = 0.924948
	Seed 1 ==> test auc = 0.875608
	Seed 2 ==> test prc-auc = 0.886430
	Seed 2 ==> test auc = 0.824638
	Seed 3 ==> test prc-auc = 0.914221
	Seed 3 ==> test auc = 0.881145
	Seed 4 ==> test prc-auc = 0.862560
	Seed 4 ==> test auc = 0.843599
Overall test prc-auc = 0.903185 +/- 0.025023
Overall test auc = 0.863263 +/- 0.025053
Elapsed time = 0:11:51
