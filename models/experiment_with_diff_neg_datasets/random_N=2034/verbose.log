Command line
python /home/jackievaleri8/.conda/envs/chemprop/bin/chemprop_train --dropout 0.1 --hidden_size 500 --ffn_num_layers 2 --depth 3 --metric prc-auc --extra_metrics auc --save_dir models/controls_with_diff_neg_datasets/random_N=2034/ --data_path data/controls_with_diff_neg_datasets/random_N=2034.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --num_folds 5 --ensemble_size 2 --split_type scaffold_balanced --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --gpu 0
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/controls_with_diff_neg_datasets/random_N=2034.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda', index=0),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 2,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 500,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'models/controls_with_diff_neg_datasets/random_N=2034/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'scaffold_balanced',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 1,723 | train scaffolds = 1,377 | val scaffolds = 169 | test scaffolds = 177
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 92 | target average = 0.565217


Scaffold 1
Task 0: count = 51 | target average = 0.470588


Scaffold 2
Task 0: count = 19 | target average = 0.000000


Scaffold 3
Task 0: count = 18 | target average = 0.000000


Scaffold 4
Task 0: count = 17 | target average = 0.000000


Scaffold 5
Task 0: count = 15 | target average = 0.000000


Scaffold 6
Task 0: count = 15 | target average = 0.400000


Scaffold 7
Task 0: count = 11 | target average = 0.636364


Scaffold 8
Task 0: count = 11 | target average = 0.000000


Scaffold 9
Task 0: count = 11 | target average = 0.000000


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.7264e-01, PNorm = 43.2186, GNorm = 0.9223, lr_0 = 2.0312e-04
Loss = 6.0390e-01, PNorm = 43.2257, GNorm = 0.9043, lr_0 = 2.9687e-04
Loss = 4.7217e-01, PNorm = 43.2433, GNorm = 0.5981, lr_0 = 3.9062e-04
Loss = 5.2479e-01, PNorm = 43.2643, GNorm = 2.1054, lr_0 = 4.8437e-04
Validation prc-auc = 0.710631
Validation auc = 0.821777
Epoch 1
Loss = 4.2117e-01, PNorm = 43.2887, GNorm = 0.4472, lr_0 = 5.8750e-04
Loss = 4.3649e-01, PNorm = 43.3222, GNorm = 0.6710, lr_0 = 6.8125e-04
Loss = 4.4169e-01, PNorm = 43.3630, GNorm = 1.2506, lr_0 = 7.7500e-04
Loss = 4.3443e-01, PNorm = 43.4070, GNorm = 1.0959, lr_0 = 8.6875e-04
Loss = 4.3220e-01, PNorm = 43.4496, GNorm = 0.7568, lr_0 = 9.6250e-04
Validation prc-auc = 0.825429
Validation auc = 0.881976
Epoch 2
Loss = 4.9938e-01, PNorm = 43.4978, GNorm = 0.7612, lr_0 = 9.8977e-04
Loss = 3.8932e-01, PNorm = 43.5521, GNorm = 0.6167, lr_0 = 9.7296e-04
Loss = 3.7005e-01, PNorm = 43.6163, GNorm = 0.5546, lr_0 = 9.5643e-04
Loss = 4.4590e-01, PNorm = 43.6749, GNorm = 0.5842, lr_0 = 9.4019e-04
Loss = 4.4305e-01, PNorm = 43.7303, GNorm = 0.4039, lr_0 = 9.2422e-04
Validation prc-auc = 0.830931
Validation auc = 0.888157
Epoch 3
Loss = 4.3336e-01, PNorm = 43.7914, GNorm = 0.7335, lr_0 = 9.0852e-04
Loss = 3.7758e-01, PNorm = 43.8669, GNorm = 1.8963, lr_0 = 8.9309e-04
Loss = 3.9709e-01, PNorm = 43.9312, GNorm = 1.3027, lr_0 = 8.7791e-04
Loss = 4.3634e-01, PNorm = 43.9982, GNorm = 1.1055, lr_0 = 8.6300e-04
Loss = 3.9830e-01, PNorm = 44.0688, GNorm = 0.3824, lr_0 = 8.4834e-04
Validation prc-auc = 0.833095
Validation auc = 0.890845
Epoch 4
Loss = 3.8931e-01, PNorm = 44.1162, GNorm = 0.4105, lr_0 = 8.3393e-04
Loss = 3.7505e-01, PNorm = 44.1825, GNorm = 1.0274, lr_0 = 8.1977e-04
Loss = 3.9243e-01, PNorm = 44.2539, GNorm = 0.3826, lr_0 = 8.0584e-04
Loss = 3.5245e-01, PNorm = 44.3271, GNorm = 0.6965, lr_0 = 7.9215e-04
Loss = 4.0514e-01, PNorm = 44.3980, GNorm = 1.4772, lr_0 = 7.7870e-04
Validation prc-auc = 0.834024
Validation auc = 0.897653
Epoch 5
Loss = 4.7872e-01, PNorm = 44.4116, GNorm = 0.6368, lr_0 = 7.6547e-04
Loss = 3.6726e-01, PNorm = 44.4821, GNorm = 0.4922, lr_0 = 7.5247e-04
Loss = 3.4979e-01, PNorm = 44.5476, GNorm = 0.4108, lr_0 = 7.3969e-04
Loss = 4.1002e-01, PNorm = 44.5982, GNorm = 0.5528, lr_0 = 7.2712e-04
Loss = 4.1502e-01, PNorm = 44.6363, GNorm = 1.0213, lr_0 = 7.1477e-04
Validation prc-auc = 0.839680
Validation auc = 0.896578
Epoch 6
Loss = 3.6353e-01, PNorm = 44.6922, GNorm = 0.3925, lr_0 = 7.0143e-04
Loss = 3.6537e-01, PNorm = 44.7639, GNorm = 0.4132, lr_0 = 6.8951e-04
Loss = 3.7893e-01, PNorm = 44.8286, GNorm = 1.2341, lr_0 = 6.7780e-04
Loss = 3.8146e-01, PNorm = 44.8757, GNorm = 0.5162, lr_0 = 6.6629e-04
Loss = 4.0240e-01, PNorm = 44.9400, GNorm = 1.6698, lr_0 = 6.5497e-04
Validation prc-auc = 0.838154
Validation auc = 0.898280
Epoch 7
Loss = 3.6957e-01, PNorm = 45.0020, GNorm = 0.7013, lr_0 = 6.4384e-04
Loss = 3.7816e-01, PNorm = 45.0755, GNorm = 0.7003, lr_0 = 6.3291e-04
Loss = 3.4207e-01, PNorm = 45.1186, GNorm = 0.8461, lr_0 = 6.2216e-04
Loss = 3.6753e-01, PNorm = 45.1537, GNorm = 0.4759, lr_0 = 6.1159e-04
Loss = 3.5198e-01, PNorm = 45.2145, GNorm = 0.4756, lr_0 = 6.0120e-04
Validation prc-auc = 0.838184
Validation auc = 0.895458
Epoch 8
Loss = 3.4445e-01, PNorm = 45.2911, GNorm = 0.5043, lr_0 = 5.9099e-04
Loss = 3.3955e-01, PNorm = 45.3493, GNorm = 0.7023, lr_0 = 5.8095e-04
Loss = 3.5773e-01, PNorm = 45.3893, GNorm = 0.3811, lr_0 = 5.7108e-04
Loss = 3.4750e-01, PNorm = 45.4444, GNorm = 0.6675, lr_0 = 5.6138e-04
Validation prc-auc = 0.836320
Validation auc = 0.893263
Epoch 9
Loss = 4.5782e-01, PNorm = 45.4916, GNorm = 0.6434, lr_0 = 5.5184e-04
Loss = 3.3520e-01, PNorm = 45.5520, GNorm = 0.4841, lr_0 = 5.4247e-04
Loss = 3.6998e-01, PNorm = 45.5866, GNorm = 0.7699, lr_0 = 5.3325e-04
Loss = 3.0960e-01, PNorm = 45.6368, GNorm = 0.8597, lr_0 = 5.2420e-04
Loss = 3.6418e-01, PNorm = 45.6976, GNorm = 1.0998, lr_0 = 5.1529e-04
Validation prc-auc = 0.818919
Validation auc = 0.890979
Epoch 10
Loss = 3.9353e-01, PNorm = 45.7665, GNorm = 0.8246, lr_0 = 5.0654e-04
Loss = 3.5644e-01, PNorm = 45.8118, GNorm = 0.8620, lr_0 = 4.9793e-04
Loss = 3.0906e-01, PNorm = 45.8707, GNorm = 0.5009, lr_0 = 4.8948e-04
Loss = 3.1718e-01, PNorm = 45.9268, GNorm = 1.4608, lr_0 = 4.8116e-04
Loss = 3.2629e-01, PNorm = 45.9744, GNorm = 1.2105, lr_0 = 4.7299e-04
Validation prc-auc = 0.840845
Validation auc = 0.899489
Epoch 11
Loss = 2.9698e-01, PNorm = 46.0196, GNorm = 0.3932, lr_0 = 4.6416e-04
Loss = 3.3178e-01, PNorm = 46.0676, GNorm = 0.5065, lr_0 = 4.5627e-04
Loss = 3.1847e-01, PNorm = 46.1278, GNorm = 0.5831, lr_0 = 4.4852e-04
Loss = 3.4095e-01, PNorm = 46.1766, GNorm = 0.4692, lr_0 = 4.4091e-04
Loss = 3.4239e-01, PNorm = 46.2247, GNorm = 0.6273, lr_0 = 4.3342e-04
Validation prc-auc = 0.841718
Validation auc = 0.904237
Epoch 12
Loss = 3.2096e-01, PNorm = 46.2770, GNorm = 0.4211, lr_0 = 4.2605e-04
Loss = 3.4468e-01, PNorm = 46.3341, GNorm = 0.7842, lr_0 = 4.1882e-04
Loss = 3.1683e-01, PNorm = 46.3663, GNorm = 0.8518, lr_0 = 4.1170e-04
Loss = 3.1323e-01, PNorm = 46.4027, GNorm = 0.8991, lr_0 = 4.0471e-04
Loss = 3.2500e-01, PNorm = 46.4553, GNorm = 0.4418, lr_0 = 3.9783e-04
Validation prc-auc = 0.826946
Validation auc = 0.894025
Epoch 13
Loss = 2.9193e-01, PNorm = 46.5258, GNorm = 0.5938, lr_0 = 3.9108e-04
Loss = 3.3241e-01, PNorm = 46.5696, GNorm = 1.1194, lr_0 = 3.8443e-04
Loss = 2.8690e-01, PNorm = 46.6123, GNorm = 0.8380, lr_0 = 3.7790e-04
Loss = 3.4898e-01, PNorm = 46.6505, GNorm = 0.5086, lr_0 = 3.7148e-04
Loss = 3.0996e-01, PNorm = 46.6972, GNorm = 0.9052, lr_0 = 3.6517e-04
Validation prc-auc = 0.839727
Validation auc = 0.904551
Epoch 14
Loss = 3.0410e-01, PNorm = 46.7331, GNorm = 0.4746, lr_0 = 3.5897e-04
Loss = 2.7681e-01, PNorm = 46.7842, GNorm = 0.4165, lr_0 = 3.5287e-04
Loss = 3.0970e-01, PNorm = 46.8251, GNorm = 0.6603, lr_0 = 3.4688e-04
Loss = 2.8782e-01, PNorm = 46.8639, GNorm = 0.6175, lr_0 = 3.4099e-04
Loss = 3.3915e-01, PNorm = 46.9062, GNorm = 0.4267, lr_0 = 3.3520e-04
Validation prc-auc = 0.846414
Validation auc = 0.906969
Epoch 15
Loss = 2.8396e-01, PNorm = 46.9607, GNorm = 0.5413, lr_0 = 3.2950e-04
Loss = 2.8667e-01, PNorm = 47.0043, GNorm = 0.4659, lr_0 = 3.2390e-04
Loss = 3.0423e-01, PNorm = 47.0508, GNorm = 0.9384, lr_0 = 3.1840e-04
Loss = 3.1772e-01, PNorm = 47.0937, GNorm = 0.4081, lr_0 = 3.1299e-04
Loss = 2.7219e-01, PNorm = 47.1271, GNorm = 0.7260, lr_0 = 3.0768e-04
Loss = 2.6273e-01, PNorm = 47.1310, GNorm = 0.5114, lr_0 = 3.0715e-04
Validation prc-auc = 0.847169
Validation auc = 0.904327
Epoch 16
Loss = 2.4297e-01, PNorm = 47.1795, GNorm = 0.3989, lr_0 = 3.0193e-04
Loss = 2.7356e-01, PNorm = 47.2309, GNorm = 0.7739, lr_0 = 2.9680e-04
Loss = 2.9664e-01, PNorm = 47.2806, GNorm = 0.8019, lr_0 = 2.9176e-04
Loss = 3.1018e-01, PNorm = 47.3121, GNorm = 0.5303, lr_0 = 2.8681e-04
Validation prc-auc = 0.857038
Validation auc = 0.907193
Epoch 17
Loss = 2.0376e-01, PNorm = 47.3395, GNorm = 0.5167, lr_0 = 2.8193e-04
Loss = 2.8552e-01, PNorm = 47.3774, GNorm = 1.1400, lr_0 = 2.7715e-04
Loss = 2.7447e-01, PNorm = 47.4132, GNorm = 0.7527, lr_0 = 2.7244e-04
Loss = 3.1298e-01, PNorm = 47.4470, GNorm = 0.5405, lr_0 = 2.6781e-04
Loss = 2.6416e-01, PNorm = 47.4835, GNorm = 0.9006, lr_0 = 2.6326e-04
Validation prc-auc = 0.846537
Validation auc = 0.907910
Epoch 18
Loss = 2.9308e-01, PNorm = 47.5189, GNorm = 0.8453, lr_0 = 2.5879e-04
Loss = 2.9911e-01, PNorm = 47.5522, GNorm = 0.5509, lr_0 = 2.5439e-04
Loss = 2.7336e-01, PNorm = 47.5913, GNorm = 0.5948, lr_0 = 2.5007e-04
Loss = 2.5003e-01, PNorm = 47.6315, GNorm = 0.9162, lr_0 = 2.4582e-04
Loss = 2.5323e-01, PNorm = 47.6707, GNorm = 0.6031, lr_0 = 2.4165e-04
Validation prc-auc = 0.856434
Validation auc = 0.915121
Epoch 19
Loss = 2.6959e-01, PNorm = 47.6932, GNorm = 0.5725, lr_0 = 2.3754e-04
Loss = 2.4417e-01, PNorm = 47.7215, GNorm = 0.8542, lr_0 = 2.3351e-04
Loss = 2.8295e-01, PNorm = 47.7569, GNorm = 0.8629, lr_0 = 2.2954e-04
Loss = 2.3176e-01, PNorm = 47.7921, GNorm = 0.8641, lr_0 = 2.2564e-04
Loss = 2.9498e-01, PNorm = 47.8222, GNorm = 1.5952, lr_0 = 2.2181e-04
Validation prc-auc = 0.851759
Validation auc = 0.914987
Epoch 20
Loss = 2.5237e-01, PNorm = 47.8471, GNorm = 0.6913, lr_0 = 2.1804e-04
Loss = 2.9309e-01, PNorm = 47.8692, GNorm = 0.6042, lr_0 = 2.1434e-04
Loss = 2.6101e-01, PNorm = 47.8984, GNorm = 0.5153, lr_0 = 2.1070e-04
Loss = 2.4559e-01, PNorm = 47.9313, GNorm = 0.4909, lr_0 = 2.0712e-04
Loss = 2.4969e-01, PNorm = 47.9653, GNorm = 1.1359, lr_0 = 2.0360e-04
Validation prc-auc = 0.853505
Validation auc = 0.908761
Epoch 21
Loss = 2.1259e-01, PNorm = 47.9911, GNorm = 0.6056, lr_0 = 1.9980e-04
Loss = 2.6329e-01, PNorm = 48.0195, GNorm = 0.7439, lr_0 = 1.9641e-04
Loss = 2.6226e-01, PNorm = 48.0379, GNorm = 0.6555, lr_0 = 1.9307e-04
Loss = 2.7318e-01, PNorm = 48.0599, GNorm = 0.6748, lr_0 = 1.8979e-04
Loss = 2.5885e-01, PNorm = 48.0865, GNorm = 0.7497, lr_0 = 1.8657e-04
Validation prc-auc = 0.850989
Validation auc = 0.912300
Epoch 22
Loss = 3.0529e-01, PNorm = 48.1091, GNorm = 0.9741, lr_0 = 1.8340e-04
Loss = 2.1909e-01, PNorm = 48.1346, GNorm = 0.9123, lr_0 = 1.8028e-04
Loss = 2.1179e-01, PNorm = 48.1654, GNorm = 0.9211, lr_0 = 1.7722e-04
Loss = 2.6510e-01, PNorm = 48.1941, GNorm = 1.0651, lr_0 = 1.7421e-04
Loss = 2.6062e-01, PNorm = 48.2093, GNorm = 0.8777, lr_0 = 1.7125e-04
Validation prc-auc = 0.863692
Validation auc = 0.917764
Epoch 23
Loss = 2.2761e-01, PNorm = 48.2379, GNorm = 1.0957, lr_0 = 1.6834e-04
Loss = 2.1832e-01, PNorm = 48.2561, GNorm = 0.8632, lr_0 = 1.6548e-04
Loss = 2.6955e-01, PNorm = 48.2743, GNorm = 0.6380, lr_0 = 1.6267e-04
Loss = 2.6270e-01, PNorm = 48.2888, GNorm = 0.6090, lr_0 = 1.5991e-04
Loss = 2.5564e-01, PNorm = 48.3094, GNorm = 0.7434, lr_0 = 1.5719e-04
Validation prc-auc = 0.860207
Validation auc = 0.910508
Epoch 24
Loss = 2.3025e-01, PNorm = 48.3358, GNorm = 1.0144, lr_0 = 1.5452e-04
Loss = 2.1794e-01, PNorm = 48.3616, GNorm = 1.1517, lr_0 = 1.5190e-04
Loss = 2.7027e-01, PNorm = 48.3857, GNorm = 1.0848, lr_0 = 1.4932e-04
Loss = 2.2866e-01, PNorm = 48.4031, GNorm = 1.0840, lr_0 = 1.4678e-04
Loss = 2.8554e-01, PNorm = 48.4178, GNorm = 0.9565, lr_0 = 1.4429e-04
Validation prc-auc = 0.867617
Validation auc = 0.921079
Epoch 25
Loss = 2.0925e-01, PNorm = 48.4311, GNorm = 0.5603, lr_0 = 1.4184e-04
Loss = 2.3046e-01, PNorm = 48.4492, GNorm = 0.8682, lr_0 = 1.3943e-04
Loss = 2.6151e-01, PNorm = 48.4701, GNorm = 0.6987, lr_0 = 1.3706e-04
Loss = 2.4482e-01, PNorm = 48.4904, GNorm = 0.6388, lr_0 = 1.3473e-04
Validation prc-auc = 0.867097
Validation auc = 0.919511
Epoch 26
Loss = 2.4822e-01, PNorm = 48.5110, GNorm = 1.0668, lr_0 = 1.3221e-04
Loss = 1.9508e-01, PNorm = 48.5277, GNorm = 1.0027, lr_0 = 1.2997e-04
Loss = 2.4463e-01, PNorm = 48.5454, GNorm = 0.9177, lr_0 = 1.2776e-04
Loss = 2.4020e-01, PNorm = 48.5564, GNorm = 0.4746, lr_0 = 1.2559e-04
Loss = 2.5176e-01, PNorm = 48.5726, GNorm = 0.6086, lr_0 = 1.2346e-04
Validation prc-auc = 0.863872
Validation auc = 0.914226
Epoch 27
Loss = 2.2432e-01, PNorm = 48.5855, GNorm = 0.6627, lr_0 = 1.2136e-04
Loss = 2.1028e-01, PNorm = 48.6010, GNorm = 1.0937, lr_0 = 1.1930e-04
Loss = 2.4602e-01, PNorm = 48.6189, GNorm = 1.1037, lr_0 = 1.1727e-04
Loss = 2.2460e-01, PNorm = 48.6355, GNorm = 1.3400, lr_0 = 1.1528e-04
Loss = 2.1027e-01, PNorm = 48.6531, GNorm = 0.6443, lr_0 = 1.1332e-04
Validation prc-auc = 0.865887
Validation auc = 0.919690
Epoch 28
Loss = 2.1013e-01, PNorm = 48.6666, GNorm = 0.8067, lr_0 = 1.1140e-04
Loss = 2.3670e-01, PNorm = 48.6786, GNorm = 1.2677, lr_0 = 1.0951e-04
Loss = 2.1638e-01, PNorm = 48.6954, GNorm = 0.7814, lr_0 = 1.0765e-04
Loss = 2.2765e-01, PNorm = 48.7051, GNorm = 0.6490, lr_0 = 1.0582e-04
Loss = 2.3547e-01, PNorm = 48.7177, GNorm = 0.7695, lr_0 = 1.0402e-04
Validation prc-auc = 0.862324
Validation auc = 0.920541
Epoch 29
Loss = 1.6625e-01, PNorm = 48.7293, GNorm = 0.7706, lr_0 = 1.0225e-04
Loss = 2.2350e-01, PNorm = 48.7411, GNorm = 0.8463, lr_0 = 1.0052e-04
Loss = 2.4579e-01, PNorm = 48.7490, GNorm = 0.5325, lr_0 = 1.0000e-04
Loss = 2.3072e-01, PNorm = 48.7599, GNorm = 0.4796, lr_0 = 1.0000e-04
Loss = 2.1534e-01, PNorm = 48.7772, GNorm = 1.4158, lr_0 = 1.0000e-04
Validation prc-auc = 0.869284
Validation auc = 0.919421
Model 0 best validation prc-auc = 0.869284 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.773313
Model 0 test auc = 0.864874
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.6414e-01, PNorm = 43.2431, GNorm = 1.3866, lr_0 = 2.0312e-04
Loss = 5.6884e-01, PNorm = 43.2525, GNorm = 0.6133, lr_0 = 2.9687e-04
Loss = 5.2272e-01, PNorm = 43.2707, GNorm = 1.1543, lr_0 = 3.9062e-04
Loss = 5.2153e-01, PNorm = 43.2928, GNorm = 2.0587, lr_0 = 4.8437e-04
Validation prc-auc = 0.751168
Validation auc = 0.850309
Epoch 1
Loss = 4.2915e-01, PNorm = 43.3205, GNorm = 1.3298, lr_0 = 5.8750e-04
Loss = 4.6487e-01, PNorm = 43.3513, GNorm = 0.9062, lr_0 = 6.8125e-04
Loss = 4.7338e-01, PNorm = 43.3853, GNorm = 1.8312, lr_0 = 7.7500e-04
Loss = 4.2874e-01, PNorm = 43.4335, GNorm = 0.7980, lr_0 = 8.6875e-04
Loss = 4.1713e-01, PNorm = 43.4918, GNorm = 1.9050, lr_0 = 9.6250e-04
Validation prc-auc = 0.811733
Validation auc = 0.878303
Epoch 2
Loss = 4.5824e-01, PNorm = 43.5410, GNorm = 0.4783, lr_0 = 9.8977e-04
Loss = 4.6840e-01, PNorm = 43.5847, GNorm = 1.9103, lr_0 = 9.7296e-04
Loss = 4.4801e-01, PNorm = 43.6333, GNorm = 0.9707, lr_0 = 9.5643e-04
Loss = 3.8172e-01, PNorm = 43.6870, GNorm = 0.7233, lr_0 = 9.4019e-04
Loss = 4.3610e-01, PNorm = 43.7431, GNorm = 1.0198, lr_0 = 9.2422e-04
Validation prc-auc = 0.831705
Validation auc = 0.890173
Epoch 3
Loss = 3.3384e-01, PNorm = 43.7954, GNorm = 0.5088, lr_0 = 9.0852e-04
Loss = 4.1451e-01, PNorm = 43.8514, GNorm = 0.3811, lr_0 = 8.9309e-04
Loss = 4.1866e-01, PNorm = 43.9076, GNorm = 0.5167, lr_0 = 8.7791e-04
Loss = 4.2493e-01, PNorm = 43.9580, GNorm = 1.1367, lr_0 = 8.6300e-04
Loss = 4.4583e-01, PNorm = 44.0014, GNorm = 0.4017, lr_0 = 8.4834e-04
Validation prc-auc = 0.838308
Validation auc = 0.896533
Epoch 4
Loss = 4.5223e-01, PNorm = 44.0445, GNorm = 1.5629, lr_0 = 8.3393e-04
Loss = 4.2233e-01, PNorm = 44.0982, GNorm = 0.3625, lr_0 = 8.1977e-04
Loss = 3.3073e-01, PNorm = 44.1482, GNorm = 0.7818, lr_0 = 8.0584e-04
Loss = 4.3069e-01, PNorm = 44.2013, GNorm = 0.4248, lr_0 = 7.9215e-04
Loss = 4.1823e-01, PNorm = 44.2668, GNorm = 0.5125, lr_0 = 7.7870e-04
Validation prc-auc = 0.826253
Validation auc = 0.893174
Epoch 5
Loss = 3.5986e-01, PNorm = 44.3141, GNorm = 1.2567, lr_0 = 7.6547e-04
Loss = 3.9541e-01, PNorm = 44.3648, GNorm = 0.4928, lr_0 = 7.5247e-04
Loss = 3.9801e-01, PNorm = 44.4197, GNorm = 1.0215, lr_0 = 7.3969e-04
Loss = 4.0375e-01, PNorm = 44.4716, GNorm = 0.4573, lr_0 = 7.2712e-04
Loss = 3.7766e-01, PNorm = 44.5329, GNorm = 0.7072, lr_0 = 7.1477e-04
Validation prc-auc = 0.834407
Validation auc = 0.894204
Epoch 6
Loss = 3.5754e-01, PNorm = 44.5786, GNorm = 0.4521, lr_0 = 7.0143e-04
Loss = 3.8550e-01, PNorm = 44.6328, GNorm = 0.8071, lr_0 = 6.8951e-04
Loss = 3.7013e-01, PNorm = 44.6923, GNorm = 0.6699, lr_0 = 6.7780e-04
Loss = 3.6648e-01, PNorm = 44.7543, GNorm = 1.1575, lr_0 = 6.6629e-04
Loss = 3.8422e-01, PNorm = 44.8216, GNorm = 0.7849, lr_0 = 6.5497e-04
Validation prc-auc = 0.830317
Validation auc = 0.892816
Epoch 7
Loss = 3.8546e-01, PNorm = 44.8861, GNorm = 0.4188, lr_0 = 6.4384e-04
Loss = 3.7465e-01, PNorm = 44.9340, GNorm = 0.9737, lr_0 = 6.3291e-04
Loss = 3.3588e-01, PNorm = 44.9837, GNorm = 0.7017, lr_0 = 6.2216e-04
Loss = 3.8322e-01, PNorm = 45.0414, GNorm = 0.5011, lr_0 = 6.1159e-04
Loss = 3.7286e-01, PNorm = 45.0905, GNorm = 0.4173, lr_0 = 6.0120e-04
Validation prc-auc = 0.822889
Validation auc = 0.892457
Epoch 8
Loss = 3.5977e-01, PNorm = 45.1712, GNorm = 1.4375, lr_0 = 5.9099e-04
Loss = 3.3773e-01, PNorm = 45.2312, GNorm = 0.6272, lr_0 = 5.8095e-04
Loss = 4.2102e-01, PNorm = 45.2887, GNorm = 0.8143, lr_0 = 5.7108e-04
Loss = 3.4417e-01, PNorm = 45.3433, GNorm = 0.4546, lr_0 = 5.6138e-04
Validation prc-auc = 0.842475
Validation auc = 0.900654
Epoch 9
Loss = 1.8336e-01, PNorm = 45.3806, GNorm = 0.4286, lr_0 = 5.5184e-04
Loss = 3.3153e-01, PNorm = 45.4357, GNorm = 1.2819, lr_0 = 5.4247e-04
Loss = 3.9150e-01, PNorm = 45.4977, GNorm = 0.9521, lr_0 = 5.3325e-04
Loss = 2.9156e-01, PNorm = 45.5687, GNorm = 0.5192, lr_0 = 5.2420e-04
Loss = 3.4811e-01, PNorm = 45.6044, GNorm = 0.7222, lr_0 = 5.1529e-04
Validation prc-auc = 0.850407
Validation auc = 0.902759
Epoch 10
Loss = 4.3184e-01, PNorm = 45.6368, GNorm = 0.9177, lr_0 = 5.0654e-04
Loss = 3.4288e-01, PNorm = 45.6830, GNorm = 0.6904, lr_0 = 4.9793e-04
Loss = 3.6393e-01, PNorm = 45.7428, GNorm = 0.3864, lr_0 = 4.8948e-04
Loss = 3.5329e-01, PNorm = 45.7942, GNorm = 0.8080, lr_0 = 4.8116e-04
Loss = 3.3417e-01, PNorm = 45.8424, GNorm = 0.4332, lr_0 = 4.7299e-04
Validation prc-auc = 0.844387
Validation auc = 0.901639
Epoch 11
Loss = 3.0132e-01, PNorm = 45.8989, GNorm = 0.6038, lr_0 = 4.6416e-04
Loss = 3.3329e-01, PNorm = 45.9502, GNorm = 0.3395, lr_0 = 4.5627e-04
Loss = 3.3318e-01, PNorm = 45.9891, GNorm = 0.4241, lr_0 = 4.4852e-04
Loss = 3.3057e-01, PNorm = 46.0375, GNorm = 0.3990, lr_0 = 4.4091e-04
Loss = 3.2019e-01, PNorm = 46.0989, GNorm = 0.3814, lr_0 = 4.3342e-04
Validation prc-auc = 0.841204
Validation auc = 0.903252
Epoch 12
Loss = 3.4299e-01, PNorm = 46.1332, GNorm = 0.8524, lr_0 = 4.2605e-04
Loss = 3.4845e-01, PNorm = 46.1657, GNorm = 0.6518, lr_0 = 4.1882e-04
Loss = 3.0631e-01, PNorm = 46.2290, GNorm = 0.4558, lr_0 = 4.1170e-04
Loss = 3.3093e-01, PNorm = 46.2921, GNorm = 0.5403, lr_0 = 4.0471e-04
Loss = 2.9844e-01, PNorm = 46.3273, GNorm = 0.6806, lr_0 = 3.9783e-04
Validation prc-auc = 0.837421
Validation auc = 0.902132
Epoch 13
Loss = 3.2662e-01, PNorm = 46.3843, GNorm = 0.6154, lr_0 = 3.9108e-04
Loss = 3.2135e-01, PNorm = 46.4338, GNorm = 0.4624, lr_0 = 3.8443e-04
Loss = 2.9865e-01, PNorm = 46.4879, GNorm = 0.3895, lr_0 = 3.7790e-04
Loss = 3.4131e-01, PNorm = 46.5358, GNorm = 0.4443, lr_0 = 3.7148e-04
Loss = 3.2951e-01, PNorm = 46.5794, GNorm = 0.8213, lr_0 = 3.6517e-04
Validation prc-auc = 0.849949
Validation auc = 0.908313
Epoch 14
Loss = 3.0042e-01, PNorm = 46.6264, GNorm = 0.7440, lr_0 = 3.5897e-04
Loss = 3.5140e-01, PNorm = 46.6845, GNorm = 0.4668, lr_0 = 3.5287e-04
Loss = 2.9037e-01, PNorm = 46.7392, GNorm = 1.1516, lr_0 = 3.4688e-04
Loss = 2.7078e-01, PNorm = 46.7785, GNorm = 0.4181, lr_0 = 3.4099e-04
Loss = 3.0307e-01, PNorm = 46.8180, GNorm = 0.7081, lr_0 = 3.3520e-04
Validation prc-auc = 0.845414
Validation auc = 0.904999
Epoch 15
Loss = 2.8646e-01, PNorm = 46.8609, GNorm = 0.4591, lr_0 = 3.2950e-04
Loss = 2.9078e-01, PNorm = 46.9110, GNorm = 0.4472, lr_0 = 3.2390e-04
Loss = 3.2137e-01, PNorm = 46.9572, GNorm = 0.5645, lr_0 = 3.1840e-04
Loss = 2.9074e-01, PNorm = 47.0084, GNorm = 0.7210, lr_0 = 3.1299e-04
Loss = 3.0320e-01, PNorm = 47.0401, GNorm = 0.8388, lr_0 = 3.0768e-04
Loss = 3.9392e-01, PNorm = 47.0433, GNorm = 1.4904, lr_0 = 3.0715e-04
Validation prc-auc = 0.845148
Validation auc = 0.904148
Epoch 16
Loss = 2.9037e-01, PNorm = 47.0789, GNorm = 0.7823, lr_0 = 3.0193e-04
Loss = 3.2016e-01, PNorm = 47.1178, GNorm = 0.5735, lr_0 = 2.9680e-04
Loss = 2.8585e-01, PNorm = 47.1598, GNorm = 0.5299, lr_0 = 2.9176e-04
Loss = 2.7164e-01, PNorm = 47.2037, GNorm = 0.6576, lr_0 = 2.8681e-04
Validation prc-auc = 0.858881
Validation auc = 0.911583
Epoch 17
Loss = 4.0196e-01, PNorm = 47.2509, GNorm = 1.4356, lr_0 = 2.8193e-04
Loss = 2.4581e-01, PNorm = 47.2905, GNorm = 0.6524, lr_0 = 2.7715e-04
Loss = 3.0956e-01, PNorm = 47.3410, GNorm = 0.4458, lr_0 = 2.7244e-04
Loss = 2.6162e-01, PNorm = 47.3743, GNorm = 0.7621, lr_0 = 2.6781e-04
Loss = 2.9455e-01, PNorm = 47.4037, GNorm = 0.8078, lr_0 = 2.6326e-04
Validation prc-auc = 0.855756
Validation auc = 0.909209
Epoch 18
Loss = 2.0674e-01, PNorm = 47.4441, GNorm = 0.7063, lr_0 = 2.5879e-04
Loss = 2.6152e-01, PNorm = 47.4822, GNorm = 0.8268, lr_0 = 2.5439e-04
Loss = 3.2981e-01, PNorm = 47.5195, GNorm = 0.9735, lr_0 = 2.5007e-04
Loss = 3.1123e-01, PNorm = 47.5390, GNorm = 0.6865, lr_0 = 2.4582e-04
Loss = 2.8893e-01, PNorm = 47.5765, GNorm = 0.8057, lr_0 = 2.4165e-04
Validation prc-auc = 0.856055
Validation auc = 0.909075
Epoch 19
Loss = 2.6262e-01, PNorm = 47.6073, GNorm = 0.6032, lr_0 = 2.3754e-04
Loss = 2.5143e-01, PNorm = 47.6382, GNorm = 1.0872, lr_0 = 2.3351e-04
Loss = 2.5881e-01, PNorm = 47.6750, GNorm = 0.9526, lr_0 = 2.2954e-04
Loss = 3.0223e-01, PNorm = 47.7084, GNorm = 0.5159, lr_0 = 2.2564e-04
Loss = 2.6473e-01, PNorm = 47.7402, GNorm = 0.8660, lr_0 = 2.2181e-04
Validation prc-auc = 0.860598
Validation auc = 0.914270
Epoch 20
Loss = 2.5516e-01, PNorm = 47.7694, GNorm = 0.6302, lr_0 = 2.1804e-04
Loss = 2.3042e-01, PNorm = 47.8049, GNorm = 0.4459, lr_0 = 2.1434e-04
Loss = 2.8270e-01, PNorm = 47.8345, GNorm = 0.5197, lr_0 = 2.1070e-04
Loss = 3.1095e-01, PNorm = 47.8566, GNorm = 0.4863, lr_0 = 2.0712e-04
Loss = 2.5910e-01, PNorm = 47.8870, GNorm = 0.5342, lr_0 = 2.0360e-04
Validation prc-auc = 0.868755
Validation auc = 0.916555
Epoch 21
Loss = 2.4555e-01, PNorm = 47.9155, GNorm = 1.3837, lr_0 = 1.9980e-04
Loss = 2.4883e-01, PNorm = 47.9445, GNorm = 0.5508, lr_0 = 1.9641e-04
Loss = 2.5213e-01, PNorm = 47.9732, GNorm = 0.4756, lr_0 = 1.9307e-04
Loss = 2.5199e-01, PNorm = 48.0081, GNorm = 0.6809, lr_0 = 1.8979e-04
Loss = 2.5546e-01, PNorm = 48.0361, GNorm = 1.0482, lr_0 = 1.8657e-04
Validation prc-auc = 0.865028
Validation auc = 0.913151
Epoch 22
Loss = 2.5398e-01, PNorm = 48.0680, GNorm = 1.2247, lr_0 = 1.8340e-04
Loss = 2.6356e-01, PNorm = 48.0956, GNorm = 0.6591, lr_0 = 1.8028e-04
Loss = 2.7234e-01, PNorm = 48.1215, GNorm = 0.8556, lr_0 = 1.7722e-04
Loss = 2.3275e-01, PNorm = 48.1456, GNorm = 0.4493, lr_0 = 1.7421e-04
Loss = 2.3276e-01, PNorm = 48.1733, GNorm = 0.7405, lr_0 = 1.7125e-04
Validation prc-auc = 0.842924
Validation auc = 0.904954
Epoch 23
Loss = 2.7751e-01, PNorm = 48.1902, GNorm = 0.6761, lr_0 = 1.6834e-04
Loss = 2.1000e-01, PNorm = 48.2146, GNorm = 0.5094, lr_0 = 1.6548e-04
Loss = 2.2404e-01, PNorm = 48.2353, GNorm = 0.4436, lr_0 = 1.6267e-04
Loss = 2.5523e-01, PNorm = 48.2547, GNorm = 0.5971, lr_0 = 1.5991e-04
Loss = 2.4651e-01, PNorm = 48.2774, GNorm = 0.8380, lr_0 = 1.5719e-04
Validation prc-auc = 0.856297
Validation auc = 0.909926
Epoch 24
Loss = 2.1240e-01, PNorm = 48.2964, GNorm = 0.4863, lr_0 = 1.5452e-04
Loss = 2.4620e-01, PNorm = 48.3195, GNorm = 0.9247, lr_0 = 1.5190e-04
Loss = 2.1204e-01, PNorm = 48.3435, GNorm = 0.6024, lr_0 = 1.4932e-04
Loss = 2.7215e-01, PNorm = 48.3641, GNorm = 0.8511, lr_0 = 1.4678e-04
Loss = 2.4356e-01, PNorm = 48.3808, GNorm = 0.8376, lr_0 = 1.4429e-04
Validation prc-auc = 0.870866
Validation auc = 0.917809
Epoch 25
Loss = 2.2565e-01, PNorm = 48.4052, GNorm = 0.8944, lr_0 = 1.4184e-04
Loss = 2.0757e-01, PNorm = 48.4173, GNorm = 0.6136, lr_0 = 1.3943e-04
Loss = 2.4492e-01, PNorm = 48.4371, GNorm = 0.5009, lr_0 = 1.3706e-04
Loss = 2.4266e-01, PNorm = 48.4503, GNorm = 0.5532, lr_0 = 1.3473e-04
Validation prc-auc = 0.870962
Validation auc = 0.916107
Epoch 26
Loss = 1.8666e-01, PNorm = 48.4701, GNorm = 0.9042, lr_0 = 1.3221e-04
Loss = 2.3283e-01, PNorm = 48.4899, GNorm = 0.6755, lr_0 = 1.2997e-04
Loss = 2.4690e-01, PNorm = 48.5072, GNorm = 0.6555, lr_0 = 1.2776e-04
Loss = 2.2203e-01, PNorm = 48.5255, GNorm = 0.7519, lr_0 = 1.2559e-04
Loss = 2.4033e-01, PNorm = 48.5447, GNorm = 0.5411, lr_0 = 1.2346e-04
Validation prc-auc = 0.869211
Validation auc = 0.912882
Epoch 27
Loss = 3.0508e-01, PNorm = 48.5596, GNorm = 0.9438, lr_0 = 1.2136e-04
Loss = 2.0223e-01, PNorm = 48.5776, GNorm = 1.0664, lr_0 = 1.1930e-04
Loss = 2.2997e-01, PNorm = 48.5929, GNorm = 0.9215, lr_0 = 1.1727e-04
Loss = 2.1752e-01, PNorm = 48.6097, GNorm = 0.4956, lr_0 = 1.1528e-04
Loss = 2.4158e-01, PNorm = 48.6283, GNorm = 0.9035, lr_0 = 1.1332e-04
Validation prc-auc = 0.864629
Validation auc = 0.911986
Epoch 28
Loss = 2.1257e-01, PNorm = 48.6423, GNorm = 0.6385, lr_0 = 1.1140e-04
Loss = 1.9445e-01, PNorm = 48.6582, GNorm = 0.6768, lr_0 = 1.0951e-04
Loss = 2.4339e-01, PNorm = 48.6715, GNorm = 0.8612, lr_0 = 1.0765e-04
Loss = 2.5236e-01, PNorm = 48.6861, GNorm = 0.6131, lr_0 = 1.0582e-04
Loss = 2.0959e-01, PNorm = 48.6996, GNorm = 0.8786, lr_0 = 1.0402e-04
Validation prc-auc = 0.870776
Validation auc = 0.916196
Epoch 29
Loss = 1.7205e-01, PNorm = 48.7128, GNorm = 0.4849, lr_0 = 1.0225e-04
Loss = 2.0612e-01, PNorm = 48.7277, GNorm = 0.4218, lr_0 = 1.0052e-04
Loss = 2.2258e-01, PNorm = 48.7413, GNorm = 0.6642, lr_0 = 1.0000e-04
Loss = 1.9768e-01, PNorm = 48.7578, GNorm = 1.3022, lr_0 = 1.0000e-04
Loss = 2.5767e-01, PNorm = 48.7690, GNorm = 1.4564, lr_0 = 1.0000e-04
Validation prc-auc = 0.861538
Validation auc = 0.914494
Model 1 best validation prc-auc = 0.870962 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.764563
Model 1 test auc = 0.861770
Ensemble test prc-auc = 0.771935
Ensemble test auc = 0.865364
Fold 1
Splitting data with seed 1
Total scaffolds = 1,723 | train scaffolds = 1,370 | val scaffolds = 178 | test scaffolds = 175
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 92 | target average = 0.565217


Scaffold 1
Task 0: count = 51 | target average = 0.470588


Scaffold 2
Task 0: count = 19 | target average = 0.000000


Scaffold 3
Task 0: count = 18 | target average = 0.000000


Scaffold 4
Task 0: count = 17 | target average = 0.000000


Scaffold 5
Task 0: count = 15 | target average = 0.000000


Scaffold 6
Task 0: count = 15 | target average = 0.400000


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 11 | target average = 0.000000


Scaffold 9
Task 0: count = 11 | target average = 0.000000


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.6683e-01, PNorm = 43.2189, GNorm = 0.7107, lr_0 = 2.0312e-04
Loss = 5.9176e-01, PNorm = 43.2269, GNorm = 0.7345, lr_0 = 2.9687e-04
Loss = 5.3665e-01, PNorm = 43.2421, GNorm = 0.7054, lr_0 = 3.9062e-04
Loss = 5.0663e-01, PNorm = 43.2665, GNorm = 1.5485, lr_0 = 4.8437e-04
Validation prc-auc = 0.569891
Validation auc = 0.767904
Epoch 1
Loss = 5.0337e-01, PNorm = 43.3018, GNorm = 1.8523, lr_0 = 5.8750e-04
Loss = 4.7881e-01, PNorm = 43.3375, GNorm = 1.4899, lr_0 = 6.8125e-04
Loss = 4.2145e-01, PNorm = 43.3816, GNorm = 0.8678, lr_0 = 7.7500e-04
Loss = 4.5939e-01, PNorm = 43.4229, GNorm = 1.3426, lr_0 = 8.6875e-04
Loss = 4.1785e-01, PNorm = 43.4723, GNorm = 0.8388, lr_0 = 9.6250e-04
Validation prc-auc = 0.613318
Validation auc = 0.793061
Epoch 2
Loss = 4.6192e-01, PNorm = 43.5402, GNorm = 0.6469, lr_0 = 9.8977e-04
Loss = 4.1050e-01, PNorm = 43.6012, GNorm = 1.6606, lr_0 = 9.7296e-04
Loss = 3.9297e-01, PNorm = 43.6701, GNorm = 0.8956, lr_0 = 9.5643e-04
Loss = 4.1587e-01, PNorm = 43.7285, GNorm = 0.8656, lr_0 = 9.4019e-04
Loss = 4.3986e-01, PNorm = 43.7649, GNorm = 1.0522, lr_0 = 9.2422e-04
Validation prc-auc = 0.625490
Validation auc = 0.811169
Epoch 3
Loss = 3.6055e-01, PNorm = 43.8152, GNorm = 0.4398, lr_0 = 9.0852e-04
Loss = 4.3738e-01, PNorm = 43.8605, GNorm = 0.4227, lr_0 = 8.9309e-04
Loss = 3.2767e-01, PNorm = 43.9238, GNorm = 0.3516, lr_0 = 8.7791e-04
Loss = 4.2782e-01, PNorm = 43.9707, GNorm = 0.5928, lr_0 = 8.6300e-04
Loss = 4.0840e-01, PNorm = 44.0156, GNorm = 0.5475, lr_0 = 8.4834e-04
Validation prc-auc = 0.639646
Validation auc = 0.816951
Epoch 4
Loss = 3.7881e-01, PNorm = 44.0671, GNorm = 0.9891, lr_0 = 8.3393e-04
Loss = 3.5776e-01, PNorm = 44.1375, GNorm = 0.3637, lr_0 = 8.1977e-04
Loss = 3.8823e-01, PNorm = 44.1896, GNorm = 0.4101, lr_0 = 8.0584e-04
Loss = 4.0379e-01, PNorm = 44.2494, GNorm = 0.4111, lr_0 = 7.9215e-04
Loss = 3.4617e-01, PNorm = 44.3088, GNorm = 0.7910, lr_0 = 7.7870e-04
Validation prc-auc = 0.600713
Validation auc = 0.820045
Epoch 5
Loss = 3.9532e-01, PNorm = 44.3507, GNorm = 0.3482, lr_0 = 7.6547e-04
Loss = 3.6153e-01, PNorm = 44.4080, GNorm = 0.4012, lr_0 = 7.5247e-04
Loss = 4.0811e-01, PNorm = 44.4494, GNorm = 0.4269, lr_0 = 7.3969e-04
Loss = 3.5915e-01, PNorm = 44.5036, GNorm = 0.6545, lr_0 = 7.2712e-04
Loss = 3.4477e-01, PNorm = 44.5527, GNorm = 0.5052, lr_0 = 7.1477e-04
Validation prc-auc = 0.640713
Validation auc = 0.827044
Epoch 6
Loss = 3.2456e-01, PNorm = 44.6114, GNorm = 0.3333, lr_0 = 7.0143e-04
Loss = 3.9533e-01, PNorm = 44.6794, GNorm = 0.8572, lr_0 = 6.8951e-04
Loss = 3.2673e-01, PNorm = 44.7327, GNorm = 1.1447, lr_0 = 6.7780e-04
Loss = 3.9520e-01, PNorm = 44.7680, GNorm = 0.4629, lr_0 = 6.6629e-04
Loss = 3.7147e-01, PNorm = 44.8085, GNorm = 0.8242, lr_0 = 6.5497e-04
Validation prc-auc = 0.637660
Validation auc = 0.824711
Epoch 7
Loss = 2.8712e-01, PNorm = 44.8638, GNorm = 1.0391, lr_0 = 6.4384e-04
Loss = 3.5593e-01, PNorm = 44.9274, GNorm = 0.8619, lr_0 = 6.3291e-04
Loss = 3.8396e-01, PNorm = 44.9780, GNorm = 0.3635, lr_0 = 6.2216e-04
Loss = 3.9470e-01, PNorm = 45.0298, GNorm = 0.4146, lr_0 = 6.1159e-04
Loss = 3.4262e-01, PNorm = 45.0731, GNorm = 0.9938, lr_0 = 6.0120e-04
Validation prc-auc = 0.635095
Validation auc = 0.833485
Epoch 8
Loss = 3.4702e-01, PNorm = 45.1283, GNorm = 0.4632, lr_0 = 5.9099e-04
Loss = 3.6757e-01, PNorm = 45.1865, GNorm = 0.6664, lr_0 = 5.8095e-04
Loss = 3.3980e-01, PNorm = 45.2505, GNorm = 0.5658, lr_0 = 5.7108e-04
Loss = 3.0916e-01, PNorm = 45.3038, GNorm = 0.8986, lr_0 = 5.6138e-04
Validation prc-auc = 0.633826
Validation auc = 0.829732
Epoch 9
Loss = 2.6075e-01, PNorm = 45.3508, GNorm = 0.4161, lr_0 = 5.5184e-04
Loss = 3.2448e-01, PNorm = 45.3969, GNorm = 0.4036, lr_0 = 5.4247e-04
Loss = 3.3068e-01, PNorm = 45.4507, GNorm = 0.4346, lr_0 = 5.3325e-04
Loss = 2.9784e-01, PNorm = 45.5101, GNorm = 0.5187, lr_0 = 5.2420e-04
Loss = 3.1955e-01, PNorm = 45.5709, GNorm = 0.6480, lr_0 = 5.1529e-04
Validation prc-auc = 0.634376
Validation auc = 0.836478
Epoch 10
Loss = 4.3649e-01, PNorm = 45.6253, GNorm = 0.7772, lr_0 = 5.0654e-04
Loss = 3.2332e-01, PNorm = 45.6717, GNorm = 0.4616, lr_0 = 4.9793e-04
Loss = 3.0712e-01, PNorm = 45.7235, GNorm = 1.0832, lr_0 = 4.8948e-04
Loss = 3.4962e-01, PNorm = 45.7831, GNorm = 0.4595, lr_0 = 4.8116e-04
Loss = 2.7962e-01, PNorm = 45.8453, GNorm = 0.5072, lr_0 = 4.7299e-04
Validation prc-auc = 0.624749
Validation auc = 0.835666
Epoch 11
Loss = 3.3833e-01, PNorm = 45.9063, GNorm = 0.4126, lr_0 = 4.6416e-04
Loss = 2.9325e-01, PNorm = 45.9671, GNorm = 0.9470, lr_0 = 4.5627e-04
Loss = 3.2911e-01, PNorm = 46.0143, GNorm = 0.3570, lr_0 = 4.4852e-04
Loss = 3.2205e-01, PNorm = 46.0683, GNorm = 0.4533, lr_0 = 4.4091e-04
Loss = 3.0564e-01, PNorm = 46.1164, GNorm = 0.6535, lr_0 = 4.3342e-04
Validation prc-auc = 0.633093
Validation auc = 0.836985
Epoch 12
Loss = 2.6962e-01, PNorm = 46.1660, GNorm = 0.4148, lr_0 = 4.2605e-04
Loss = 3.0224e-01, PNorm = 46.2278, GNorm = 0.8328, lr_0 = 4.1882e-04
Loss = 3.0972e-01, PNorm = 46.2780, GNorm = 1.0157, lr_0 = 4.1170e-04
Loss = 2.9395e-01, PNorm = 46.3273, GNorm = 0.6261, lr_0 = 4.0471e-04
Loss = 2.9195e-01, PNorm = 46.3783, GNorm = 0.3490, lr_0 = 3.9783e-04
Validation prc-auc = 0.647090
Validation auc = 0.841144
Epoch 13
Loss = 3.2784e-01, PNorm = 46.4315, GNorm = 0.9965, lr_0 = 3.9108e-04
Loss = 2.6582e-01, PNorm = 46.4936, GNorm = 0.7520, lr_0 = 3.8443e-04
Loss = 3.3033e-01, PNorm = 46.5376, GNorm = 1.0178, lr_0 = 3.7790e-04
Loss = 2.9531e-01, PNorm = 46.5955, GNorm = 0.6254, lr_0 = 3.7148e-04
Loss = 2.9769e-01, PNorm = 46.6475, GNorm = 1.1860, lr_0 = 3.6517e-04
Validation prc-auc = 0.652239
Validation auc = 0.850629
Epoch 14
Loss = 2.8502e-01, PNorm = 46.6759, GNorm = 0.9092, lr_0 = 3.5897e-04
Loss = 2.4047e-01, PNorm = 46.7276, GNorm = 0.3674, lr_0 = 3.5287e-04
Loss = 2.9534e-01, PNorm = 46.7773, GNorm = 1.0632, lr_0 = 3.4688e-04
Loss = 3.6817e-01, PNorm = 46.8221, GNorm = 0.5049, lr_0 = 3.4099e-04
Loss = 2.9569e-01, PNorm = 46.8683, GNorm = 0.4513, lr_0 = 3.3520e-04
Validation prc-auc = 0.670832
Validation auc = 0.850781
Epoch 15
Loss = 3.1043e-01, PNorm = 46.9065, GNorm = 0.7403, lr_0 = 3.2950e-04
Loss = 2.7331e-01, PNorm = 46.9610, GNorm = 1.0406, lr_0 = 3.2390e-04
Loss = 2.6907e-01, PNorm = 47.0031, GNorm = 0.4706, lr_0 = 3.1840e-04
Loss = 3.1683e-01, PNorm = 47.0395, GNorm = 0.5551, lr_0 = 3.1299e-04
Loss = 2.6636e-01, PNorm = 47.0801, GNorm = 0.6406, lr_0 = 3.0768e-04
Loss = 3.1359e-01, PNorm = 47.0848, GNorm = 0.5907, lr_0 = 3.0715e-04
Validation prc-auc = 0.684361
Validation auc = 0.861940
Epoch 16
Loss = 2.6768e-01, PNorm = 47.1232, GNorm = 0.4515, lr_0 = 3.0193e-04
Loss = 2.7712e-01, PNorm = 47.1666, GNorm = 0.5104, lr_0 = 2.9680e-04
Loss = 2.8111e-01, PNorm = 47.2032, GNorm = 0.4945, lr_0 = 2.9176e-04
Loss = 3.0245e-01, PNorm = 47.2352, GNorm = 1.2168, lr_0 = 2.8681e-04
Validation prc-auc = 0.651462
Validation auc = 0.843325
Epoch 17
Loss = 3.3472e-01, PNorm = 47.2752, GNorm = 0.6288, lr_0 = 2.8193e-04
Loss = 2.2444e-01, PNorm = 47.3187, GNorm = 0.4116, lr_0 = 2.7715e-04
Loss = 2.7005e-01, PNorm = 47.3600, GNorm = 0.4319, lr_0 = 2.7244e-04
Loss = 3.0338e-01, PNorm = 47.3992, GNorm = 0.5747, lr_0 = 2.6781e-04
Loss = 2.4423e-01, PNorm = 47.4418, GNorm = 0.4485, lr_0 = 2.6326e-04
Validation prc-auc = 0.667898
Validation auc = 0.851694
Epoch 18
Loss = 2.4856e-01, PNorm = 47.4711, GNorm = 0.4966, lr_0 = 2.5879e-04
Loss = 2.4363e-01, PNorm = 47.5022, GNorm = 0.4960, lr_0 = 2.5439e-04
Loss = 2.3843e-01, PNorm = 47.5304, GNorm = 1.0711, lr_0 = 2.5007e-04
Loss = 2.9953e-01, PNorm = 47.5667, GNorm = 0.5032, lr_0 = 2.4582e-04
Loss = 2.5030e-01, PNorm = 47.6097, GNorm = 0.4840, lr_0 = 2.4165e-04
Validation prc-auc = 0.668632
Validation auc = 0.851136
Epoch 19
Loss = 2.6442e-01, PNorm = 47.6458, GNorm = 0.4936, lr_0 = 2.3754e-04
Loss = 2.5485e-01, PNorm = 47.6813, GNorm = 1.0668, lr_0 = 2.3351e-04
Loss = 2.4801e-01, PNorm = 47.7049, GNorm = 0.4048, lr_0 = 2.2954e-04
Loss = 2.6415e-01, PNorm = 47.7382, GNorm = 0.5012, lr_0 = 2.2564e-04
Loss = 2.5247e-01, PNorm = 47.7694, GNorm = 0.7352, lr_0 = 2.2181e-04
Validation prc-auc = 0.667800
Validation auc = 0.854281
Epoch 20
Loss = 2.2039e-01, PNorm = 47.7948, GNorm = 0.7057, lr_0 = 2.1804e-04
Loss = 2.2868e-01, PNorm = 47.8292, GNorm = 0.5251, lr_0 = 2.1434e-04
Loss = 2.5262e-01, PNorm = 47.8529, GNorm = 0.5087, lr_0 = 2.1070e-04
Loss = 2.7693e-01, PNorm = 47.8766, GNorm = 0.7527, lr_0 = 2.0712e-04
Loss = 2.3192e-01, PNorm = 47.9099, GNorm = 0.4256, lr_0 = 2.0360e-04
Validation prc-auc = 0.680870
Validation auc = 0.858491
Epoch 21
Loss = 3.0160e-01, PNorm = 47.9416, GNorm = 0.7382, lr_0 = 1.9980e-04
Loss = 2.4031e-01, PNorm = 47.9712, GNorm = 0.7536, lr_0 = 1.9641e-04
Loss = 2.5315e-01, PNorm = 47.9981, GNorm = 1.1792, lr_0 = 1.9307e-04
Loss = 2.1449e-01, PNorm = 48.0168, GNorm = 0.7961, lr_0 = 1.8979e-04
Loss = 2.1427e-01, PNorm = 48.0439, GNorm = 0.7306, lr_0 = 1.8657e-04
Validation prc-auc = 0.658049
Validation auc = 0.848499
Epoch 22
Loss = 2.6236e-01, PNorm = 48.0679, GNorm = 0.6241, lr_0 = 1.8340e-04
Loss = 2.4476e-01, PNorm = 48.0999, GNorm = 1.0864, lr_0 = 1.8028e-04
Loss = 2.2891e-01, PNorm = 48.1233, GNorm = 3.1238, lr_0 = 1.7722e-04
Loss = 2.6464e-01, PNorm = 48.1427, GNorm = 0.8985, lr_0 = 1.7421e-04
Loss = 2.2359e-01, PNorm = 48.1568, GNorm = 0.6349, lr_0 = 1.7125e-04
Validation prc-auc = 0.681416
Validation auc = 0.858237
Epoch 23
Loss = 2.0679e-01, PNorm = 48.1793, GNorm = 0.6503, lr_0 = 1.6834e-04
Loss = 2.2862e-01, PNorm = 48.2061, GNorm = 0.5518, lr_0 = 1.6548e-04
Loss = 2.7600e-01, PNorm = 48.2269, GNorm = 0.6635, lr_0 = 1.6267e-04
Loss = 2.3969e-01, PNorm = 48.2485, GNorm = 0.9984, lr_0 = 1.5991e-04
Loss = 1.8796e-01, PNorm = 48.2705, GNorm = 0.9962, lr_0 = 1.5719e-04
Validation prc-auc = 0.664413
Validation auc = 0.857780
Epoch 24
Loss = 2.1623e-01, PNorm = 48.2914, GNorm = 0.6718, lr_0 = 1.5452e-04
Loss = 2.5407e-01, PNorm = 48.3085, GNorm = 1.1667, lr_0 = 1.5190e-04
Loss = 2.3022e-01, PNorm = 48.3269, GNorm = 0.5270, lr_0 = 1.4932e-04
Loss = 2.1960e-01, PNorm = 48.3465, GNorm = 1.5073, lr_0 = 1.4678e-04
Loss = 2.1906e-01, PNorm = 48.3664, GNorm = 0.7975, lr_0 = 1.4429e-04
Validation prc-auc = 0.684298
Validation auc = 0.860367
Epoch 25
Loss = 2.1131e-01, PNorm = 48.3883, GNorm = 1.0108, lr_0 = 1.4184e-04
Loss = 2.3177e-01, PNorm = 48.4056, GNorm = 1.1033, lr_0 = 1.3943e-04
Loss = 2.7562e-01, PNorm = 48.4247, GNorm = 0.7769, lr_0 = 1.3706e-04
Loss = 2.0140e-01, PNorm = 48.4405, GNorm = 0.9213, lr_0 = 1.3473e-04
Validation prc-auc = 0.659590
Validation auc = 0.855498
Epoch 26
Loss = 1.5037e-01, PNorm = 48.4657, GNorm = 1.4399, lr_0 = 1.3221e-04
Loss = 1.9453e-01, PNorm = 48.4836, GNorm = 1.2614, lr_0 = 1.2997e-04
Loss = 2.1615e-01, PNorm = 48.5014, GNorm = 0.4996, lr_0 = 1.2776e-04
Loss = 1.9951e-01, PNorm = 48.5156, GNorm = 0.6918, lr_0 = 1.2559e-04
Loss = 2.3941e-01, PNorm = 48.5332, GNorm = 0.7253, lr_0 = 1.2346e-04
Validation prc-auc = 0.680188
Validation auc = 0.857070
Epoch 27
Loss = 2.3773e-01, PNorm = 48.5446, GNorm = 0.7875, lr_0 = 1.2136e-04
Loss = 2.3279e-01, PNorm = 48.5585, GNorm = 0.8036, lr_0 = 1.1930e-04
Loss = 1.7242e-01, PNorm = 48.5719, GNorm = 0.5359, lr_0 = 1.1727e-04
Loss = 2.3742e-01, PNorm = 48.5861, GNorm = 0.8519, lr_0 = 1.1528e-04
Loss = 2.2448e-01, PNorm = 48.6051, GNorm = 0.4734, lr_0 = 1.1332e-04
Validation prc-auc = 0.680711
Validation auc = 0.860418
Epoch 28
Loss = 1.5121e-01, PNorm = 48.6205, GNorm = 0.4208, lr_0 = 1.1140e-04
Loss = 2.4340e-01, PNorm = 48.6412, GNorm = 1.5378, lr_0 = 1.0951e-04
Loss = 2.3276e-01, PNorm = 48.6553, GNorm = 1.4015, lr_0 = 1.0765e-04
Loss = 2.3502e-01, PNorm = 48.6692, GNorm = 0.4960, lr_0 = 1.0582e-04
Loss = 1.8315e-01, PNorm = 48.6776, GNorm = 0.7540, lr_0 = 1.0402e-04
Validation prc-auc = 0.675301
Validation auc = 0.855549
Epoch 29
Loss = 2.5653e-01, PNorm = 48.6955, GNorm = 1.4908, lr_0 = 1.0225e-04
Loss = 2.0021e-01, PNorm = 48.7052, GNorm = 0.9385, lr_0 = 1.0052e-04
Loss = 2.1676e-01, PNorm = 48.7208, GNorm = 0.7291, lr_0 = 1.0000e-04
Loss = 1.9204e-01, PNorm = 48.7342, GNorm = 1.2319, lr_0 = 1.0000e-04
Loss = 1.9675e-01, PNorm = 48.7474, GNorm = 0.6769, lr_0 = 1.0000e-04
Validation prc-auc = 0.681395
Validation auc = 0.858744
Model 0 best validation prc-auc = 0.684361 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.811920
Model 0 test auc = 0.900086
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.6869e-01, PNorm = 43.2429, GNorm = 0.7992, lr_0 = 2.0312e-04
Loss = 5.8240e-01, PNorm = 43.2508, GNorm = 0.7985, lr_0 = 2.9687e-04
Loss = 5.6078e-01, PNorm = 43.2659, GNorm = 1.6792, lr_0 = 3.9062e-04
Loss = 5.2268e-01, PNorm = 43.2894, GNorm = 0.5843, lr_0 = 4.8437e-04
Validation prc-auc = 0.572003
Validation auc = 0.783729
Epoch 1
Loss = 5.2477e-01, PNorm = 43.3199, GNorm = 0.8220, lr_0 = 5.8750e-04
Loss = 4.5730e-01, PNorm = 43.3538, GNorm = 1.0203, lr_0 = 6.8125e-04
Loss = 4.5322e-01, PNorm = 43.3946, GNorm = 1.8230, lr_0 = 7.7500e-04
Loss = 4.2219e-01, PNorm = 43.4459, GNorm = 0.9147, lr_0 = 8.6875e-04
Loss = 4.4875e-01, PNorm = 43.4962, GNorm = 1.3142, lr_0 = 9.6250e-04
Validation prc-auc = 0.606041
Validation auc = 0.793822
Epoch 2
Loss = 3.6420e-01, PNorm = 43.5591, GNorm = 0.3849, lr_0 = 9.8977e-04
Loss = 3.9286e-01, PNorm = 43.6211, GNorm = 1.2123, lr_0 = 9.7296e-04
Loss = 4.1492e-01, PNorm = 43.6809, GNorm = 0.5290, lr_0 = 9.5643e-04
Loss = 4.5965e-01, PNorm = 43.7315, GNorm = 0.7968, lr_0 = 9.4019e-04
Loss = 3.9555e-01, PNorm = 43.7949, GNorm = 0.7115, lr_0 = 9.2422e-04
Validation prc-auc = 0.632179
Validation auc = 0.814871
Epoch 3
Loss = 3.7873e-01, PNorm = 43.8364, GNorm = 0.3566, lr_0 = 9.0852e-04
Loss = 3.9970e-01, PNorm = 43.8912, GNorm = 1.2081, lr_0 = 8.9309e-04
Loss = 4.3230e-01, PNorm = 43.9399, GNorm = 0.8054, lr_0 = 8.7791e-04
Loss = 3.8410e-01, PNorm = 43.9806, GNorm = 0.9253, lr_0 = 8.6300e-04
Loss = 3.6988e-01, PNorm = 44.0400, GNorm = 0.5332, lr_0 = 8.4834e-04
Validation prc-auc = 0.616288
Validation auc = 0.823899
Epoch 4
Loss = 3.6350e-01, PNorm = 44.1049, GNorm = 0.4686, lr_0 = 8.3393e-04
Loss = 3.6039e-01, PNorm = 44.1764, GNorm = 0.4703, lr_0 = 8.1977e-04
Loss = 4.1546e-01, PNorm = 44.2159, GNorm = 0.4700, lr_0 = 8.0584e-04
Loss = 3.8088e-01, PNorm = 44.2677, GNorm = 0.6286, lr_0 = 7.9215e-04
Loss = 3.6892e-01, PNorm = 44.3311, GNorm = 0.5398, lr_0 = 7.7870e-04
Validation prc-auc = 0.627697
Validation auc = 0.817914
Epoch 5
Loss = 3.5479e-01, PNorm = 44.3797, GNorm = 0.6008, lr_0 = 7.6547e-04
Loss = 3.5693e-01, PNorm = 44.4555, GNorm = 1.3268, lr_0 = 7.5247e-04
Loss = 3.8793e-01, PNorm = 44.5324, GNorm = 1.0904, lr_0 = 7.3969e-04
Loss = 3.8462e-01, PNorm = 44.5895, GNorm = 0.7413, lr_0 = 7.2712e-04
Loss = 3.6736e-01, PNorm = 44.6395, GNorm = 0.7918, lr_0 = 7.1477e-04
Validation prc-auc = 0.615952
Validation auc = 0.814364
Epoch 6
Loss = 3.3179e-01, PNorm = 44.6912, GNorm = 0.5000, lr_0 = 7.0143e-04
Loss = 3.8088e-01, PNorm = 44.7433, GNorm = 0.4832, lr_0 = 6.8951e-04
Loss = 3.6164e-01, PNorm = 44.8115, GNorm = 0.6630, lr_0 = 6.7780e-04
Loss = 3.5935e-01, PNorm = 44.8766, GNorm = 0.4833, lr_0 = 6.6629e-04
Loss = 3.7948e-01, PNorm = 44.9302, GNorm = 0.6915, lr_0 = 6.5497e-04
Validation prc-auc = 0.639300
Validation auc = 0.826486
Epoch 7
Loss = 3.5361e-01, PNorm = 44.9828, GNorm = 0.9040, lr_0 = 6.4384e-04
Loss = 3.3939e-01, PNorm = 45.0454, GNorm = 0.9966, lr_0 = 6.3291e-04
Loss = 3.4749e-01, PNorm = 45.1000, GNorm = 0.5842, lr_0 = 6.2216e-04
Loss = 3.2415e-01, PNorm = 45.1571, GNorm = 0.8644, lr_0 = 6.1159e-04
Loss = 3.5900e-01, PNorm = 45.2099, GNorm = 0.7116, lr_0 = 6.0120e-04
Validation prc-auc = 0.635122
Validation auc = 0.833435
Epoch 8
Loss = 3.1014e-01, PNorm = 45.2638, GNorm = 0.3994, lr_0 = 5.9099e-04
Loss = 3.8499e-01, PNorm = 45.3293, GNorm = 0.5773, lr_0 = 5.8095e-04
Loss = 3.6322e-01, PNorm = 45.3877, GNorm = 0.6766, lr_0 = 5.7108e-04
Loss = 3.0642e-01, PNorm = 45.4531, GNorm = 0.7521, lr_0 = 5.6138e-04
Validation prc-auc = 0.641165
Validation auc = 0.835058
Epoch 9
Loss = 4.4236e-01, PNorm = 45.5194, GNorm = 0.6341, lr_0 = 5.5184e-04
Loss = 3.6528e-01, PNorm = 45.5838, GNorm = 0.4110, lr_0 = 5.4247e-04
Loss = 2.8633e-01, PNorm = 45.6616, GNorm = 1.0627, lr_0 = 5.3325e-04
Loss = 3.3073e-01, PNorm = 45.7223, GNorm = 0.5405, lr_0 = 5.2420e-04
Loss = 3.5965e-01, PNorm = 45.7899, GNorm = 0.5973, lr_0 = 5.1529e-04
Validation prc-auc = 0.642958
Validation auc = 0.840536
Epoch 10
Loss = 3.1959e-01, PNorm = 45.8458, GNorm = 0.6262, lr_0 = 5.0654e-04
Loss = 3.1430e-01, PNorm = 45.9002, GNorm = 0.8472, lr_0 = 4.9793e-04
Loss = 3.4346e-01, PNorm = 45.9628, GNorm = 0.6569, lr_0 = 4.8948e-04
Loss = 2.9725e-01, PNorm = 46.0166, GNorm = 1.8440, lr_0 = 4.8116e-04
Loss = 3.7616e-01, PNorm = 46.0557, GNorm = 0.4911, lr_0 = 4.7299e-04
Validation prc-auc = 0.637255
Validation auc = 0.844137
Epoch 11
Loss = 3.0061e-01, PNorm = 46.1126, GNorm = 0.4902, lr_0 = 4.6416e-04
Loss = 2.9797e-01, PNorm = 46.1749, GNorm = 0.7373, lr_0 = 4.5627e-04
Loss = 3.4323e-01, PNorm = 46.2064, GNorm = 0.6168, lr_0 = 4.4852e-04
Loss = 3.2457e-01, PNorm = 46.2583, GNorm = 1.1064, lr_0 = 4.4091e-04
Loss = 3.1345e-01, PNorm = 46.3191, GNorm = 0.8115, lr_0 = 4.3342e-04
Validation prc-auc = 0.637087
Validation auc = 0.846064
Epoch 12
Loss = 2.9240e-01, PNorm = 46.3680, GNorm = 0.5953, lr_0 = 4.2605e-04
Loss = 2.9724e-01, PNorm = 46.4300, GNorm = 0.9445, lr_0 = 4.1882e-04
Loss = 3.0339e-01, PNorm = 46.4908, GNorm = 0.6556, lr_0 = 4.1170e-04
Loss = 3.2001e-01, PNorm = 46.5535, GNorm = 0.8770, lr_0 = 4.0471e-04
Loss = 2.8570e-01, PNorm = 46.5981, GNorm = 0.4784, lr_0 = 3.9783e-04
Validation prc-auc = 0.662144
Validation auc = 0.853875
Epoch 13
Loss = 2.9859e-01, PNorm = 46.6384, GNorm = 1.1836, lr_0 = 3.9108e-04
Loss = 3.1631e-01, PNorm = 46.6852, GNorm = 1.1742, lr_0 = 3.8443e-04
Loss = 2.8416e-01, PNorm = 46.7310, GNorm = 0.5969, lr_0 = 3.7790e-04
Loss = 2.6139e-01, PNorm = 46.7763, GNorm = 0.6461, lr_0 = 3.7148e-04
Loss = 3.0307e-01, PNorm = 46.8297, GNorm = 0.7634, lr_0 = 3.6517e-04
Validation prc-auc = 0.648655
Validation auc = 0.849868
Epoch 14
Loss = 2.8485e-01, PNorm = 46.8746, GNorm = 0.6362, lr_0 = 3.5897e-04
Loss = 2.7000e-01, PNorm = 46.9162, GNorm = 0.5377, lr_0 = 3.5287e-04
Loss = 3.0045e-01, PNorm = 46.9646, GNorm = 0.9840, lr_0 = 3.4688e-04
Loss = 3.2867e-01, PNorm = 47.0056, GNorm = 0.8648, lr_0 = 3.4099e-04
Loss = 2.4154e-01, PNorm = 47.0421, GNorm = 0.7485, lr_0 = 3.3520e-04
Validation prc-auc = 0.642434
Validation auc = 0.853419
Epoch 15
Loss = 2.7779e-01, PNorm = 47.0994, GNorm = 0.7087, lr_0 = 3.2950e-04
Loss = 2.7140e-01, PNorm = 47.1528, GNorm = 0.6946, lr_0 = 3.2390e-04
Loss = 3.1508e-01, PNorm = 47.2049, GNorm = 0.7728, lr_0 = 3.1840e-04
Loss = 2.6662e-01, PNorm = 47.2392, GNorm = 0.8927, lr_0 = 3.1299e-04
Loss = 2.9134e-01, PNorm = 47.2786, GNorm = 1.6026, lr_0 = 3.0768e-04
Loss = 3.1112e-01, PNorm = 47.2811, GNorm = 1.1797, lr_0 = 3.0715e-04
Validation prc-auc = 0.655429
Validation auc = 0.855650
Epoch 16
Loss = 2.8849e-01, PNorm = 47.3217, GNorm = 0.4815, lr_0 = 3.0193e-04
Loss = 2.8137e-01, PNorm = 47.3565, GNorm = 0.3986, lr_0 = 2.9680e-04
Loss = 2.6990e-01, PNorm = 47.3976, GNorm = 1.1481, lr_0 = 2.9176e-04
Loss = 2.5948e-01, PNorm = 47.4416, GNorm = 0.5578, lr_0 = 2.8681e-04
Validation prc-auc = 0.661239
Validation auc = 0.855397
Epoch 17
Loss = 2.6164e-01, PNorm = 47.4799, GNorm = 0.6487, lr_0 = 2.8193e-04
Loss = 2.7336e-01, PNorm = 47.5205, GNorm = 0.6203, lr_0 = 2.7715e-04
Loss = 2.5594e-01, PNorm = 47.5651, GNorm = 0.4024, lr_0 = 2.7244e-04
Loss = 2.6672e-01, PNorm = 47.5942, GNorm = 0.8317, lr_0 = 2.6781e-04
Loss = 2.6192e-01, PNorm = 47.6241, GNorm = 0.6608, lr_0 = 2.6326e-04
Validation prc-auc = 0.655955
Validation auc = 0.857527
Epoch 18
Loss = 2.1242e-01, PNorm = 47.6616, GNorm = 0.4508, lr_0 = 2.5879e-04
Loss = 2.8291e-01, PNorm = 47.7036, GNorm = 0.6342, lr_0 = 2.5439e-04
Loss = 2.5290e-01, PNorm = 47.7435, GNorm = 0.6630, lr_0 = 2.5007e-04
Loss = 2.6519e-01, PNorm = 47.7791, GNorm = 0.4999, lr_0 = 2.4582e-04
Loss = 2.5024e-01, PNorm = 47.8145, GNorm = 0.5200, lr_0 = 2.4165e-04
Validation prc-auc = 0.648764
Validation auc = 0.847535
Epoch 19
Loss = 2.3003e-01, PNorm = 47.8470, GNorm = 1.3072, lr_0 = 2.3754e-04
Loss = 2.4044e-01, PNorm = 47.8834, GNorm = 0.8273, lr_0 = 2.3351e-04
Loss = 2.5242e-01, PNorm = 47.9190, GNorm = 0.4501, lr_0 = 2.2954e-04
Loss = 2.4831e-01, PNorm = 47.9411, GNorm = 0.4650, lr_0 = 2.2564e-04
Loss = 2.4873e-01, PNorm = 47.9658, GNorm = 0.6137, lr_0 = 2.2181e-04
Validation prc-auc = 0.666701
Validation auc = 0.857324
Epoch 20
Loss = 2.5499e-01, PNorm = 47.9943, GNorm = 0.7648, lr_0 = 2.1804e-04
Loss = 2.1432e-01, PNorm = 48.0304, GNorm = 0.4696, lr_0 = 2.1434e-04
Loss = 2.6554e-01, PNorm = 48.0612, GNorm = 0.9510, lr_0 = 2.1070e-04
Loss = 2.4220e-01, PNorm = 48.0849, GNorm = 0.3860, lr_0 = 2.0712e-04
Loss = 2.4719e-01, PNorm = 48.1137, GNorm = 0.5899, lr_0 = 2.0360e-04
Validation prc-auc = 0.658592
Validation auc = 0.852556
Epoch 21
Loss = 2.2306e-01, PNorm = 48.1400, GNorm = 0.6460, lr_0 = 1.9980e-04
Loss = 2.3174e-01, PNorm = 48.1677, GNorm = 0.6197, lr_0 = 1.9641e-04
Loss = 2.4249e-01, PNorm = 48.1948, GNorm = 0.7712, lr_0 = 1.9307e-04
Loss = 2.4301e-01, PNorm = 48.2232, GNorm = 0.4861, lr_0 = 1.8979e-04
Loss = 2.4281e-01, PNorm = 48.2520, GNorm = 0.5617, lr_0 = 1.8657e-04
Validation prc-auc = 0.669944
Validation auc = 0.855194
Epoch 22
Loss = 2.1794e-01, PNorm = 48.2817, GNorm = 1.2946, lr_0 = 1.8340e-04
Loss = 2.0481e-01, PNorm = 48.3098, GNorm = 1.0468, lr_0 = 1.8028e-04
Loss = 2.5637e-01, PNorm = 48.3347, GNorm = 0.4958, lr_0 = 1.7722e-04
Loss = 2.5446e-01, PNorm = 48.3591, GNorm = 0.8668, lr_0 = 1.7421e-04
Loss = 2.1568e-01, PNorm = 48.3788, GNorm = 1.0315, lr_0 = 1.7125e-04
Validation prc-auc = 0.657912
Validation auc = 0.851542
Epoch 23
Loss = 3.0814e-01, PNorm = 48.4051, GNorm = 0.7757, lr_0 = 1.6834e-04
Loss = 2.6474e-01, PNorm = 48.4201, GNorm = 1.3400, lr_0 = 1.6548e-04
Loss = 1.9105e-01, PNorm = 48.4465, GNorm = 0.7113, lr_0 = 1.6267e-04
Loss = 2.2797e-01, PNorm = 48.4689, GNorm = 0.8611, lr_0 = 1.5991e-04
Loss = 2.2228e-01, PNorm = 48.4891, GNorm = 0.4285, lr_0 = 1.5719e-04
Validation prc-auc = 0.689343
Validation auc = 0.857476
Epoch 24
Loss = 2.1834e-01, PNorm = 48.5134, GNorm = 0.9945, lr_0 = 1.5452e-04
Loss = 2.4925e-01, PNorm = 48.5364, GNorm = 1.0557, lr_0 = 1.5190e-04
Loss = 1.8617e-01, PNorm = 48.5553, GNorm = 0.8150, lr_0 = 1.4932e-04
Loss = 2.1093e-01, PNorm = 48.5735, GNorm = 0.7998, lr_0 = 1.4678e-04
Loss = 2.3953e-01, PNorm = 48.5875, GNorm = 0.5351, lr_0 = 1.4429e-04
Validation prc-auc = 0.677960
Validation auc = 0.864628
Epoch 25
Loss = 2.0001e-01, PNorm = 48.6012, GNorm = 1.2964, lr_0 = 1.4184e-04
Loss = 2.4426e-01, PNorm = 48.6193, GNorm = 0.6417, lr_0 = 1.3943e-04
Loss = 2.1122e-01, PNorm = 48.6344, GNorm = 0.6679, lr_0 = 1.3706e-04
Loss = 2.3331e-01, PNorm = 48.6525, GNorm = 1.0475, lr_0 = 1.3473e-04
Validation prc-auc = 0.690000
Validation auc = 0.866758
Epoch 26
Loss = 2.6804e-01, PNorm = 48.6734, GNorm = 0.5374, lr_0 = 1.3221e-04
Loss = 2.1223e-01, PNorm = 48.6891, GNorm = 0.6497, lr_0 = 1.2997e-04
Loss = 1.9957e-01, PNorm = 48.7057, GNorm = 0.9740, lr_0 = 1.2776e-04
Loss = 1.9397e-01, PNorm = 48.7203, GNorm = 0.7038, lr_0 = 1.2559e-04
Loss = 2.4103e-01, PNorm = 48.7384, GNorm = 0.9032, lr_0 = 1.2346e-04
Validation prc-auc = 0.685419
Validation auc = 0.857628
Epoch 27
Loss = 1.4776e-01, PNorm = 48.7539, GNorm = 0.8456, lr_0 = 1.2136e-04
Loss = 1.9767e-01, PNorm = 48.7684, GNorm = 0.8353, lr_0 = 1.1930e-04
Loss = 2.1259e-01, PNorm = 48.7865, GNorm = 0.4210, lr_0 = 1.1727e-04
Loss = 2.1902e-01, PNorm = 48.7995, GNorm = 0.9285, lr_0 = 1.1528e-04
Loss = 2.0652e-01, PNorm = 48.8147, GNorm = 0.5629, lr_0 = 1.1332e-04
Validation prc-auc = 0.703179
Validation auc = 0.863055
Epoch 28
Loss = 1.7147e-01, PNorm = 48.8260, GNorm = 0.5393, lr_0 = 1.1140e-04
Loss = 1.9098e-01, PNorm = 48.8432, GNorm = 0.5821, lr_0 = 1.0951e-04
Loss = 2.4134e-01, PNorm = 48.8552, GNorm = 1.4041, lr_0 = 1.0765e-04
Loss = 2.0589e-01, PNorm = 48.8666, GNorm = 0.4725, lr_0 = 1.0582e-04
Loss = 2.2248e-01, PNorm = 48.8777, GNorm = 0.7785, lr_0 = 1.0402e-04
Validation prc-auc = 0.677726
Validation auc = 0.856665
Epoch 29
Loss = 2.0461e-01, PNorm = 48.8910, GNorm = 0.7389, lr_0 = 1.0225e-04
Loss = 2.1511e-01, PNorm = 48.9055, GNorm = 0.5974, lr_0 = 1.0052e-04
Loss = 2.0433e-01, PNorm = 48.9189, GNorm = 0.9757, lr_0 = 1.0000e-04
Loss = 1.5813e-01, PNorm = 48.9303, GNorm = 0.6154, lr_0 = 1.0000e-04
Loss = 2.1476e-01, PNorm = 48.9422, GNorm = 1.6828, lr_0 = 1.0000e-04
Validation prc-auc = 0.682750
Validation auc = 0.859505
Model 1 best validation prc-auc = 0.703179 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.821350
Model 1 test auc = 0.895897
Ensemble test prc-auc = 0.818271
Ensemble test auc = 0.901038
Fold 2
Splitting data with seed 2
Total scaffolds = 1,723 | train scaffolds = 1,358 | val scaffolds = 179 | test scaffolds = 186
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 92 | target average = 0.565217


Scaffold 1
Task 0: count = 51 | target average = 0.470588


Scaffold 2
Task 0: count = 19 | target average = 0.000000


Scaffold 3
Task 0: count = 18 | target average = 0.000000


Scaffold 4
Task 0: count = 17 | target average = 0.000000


Scaffold 5
Task 0: count = 15 | target average = 0.000000


Scaffold 6
Task 0: count = 15 | target average = 0.400000


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 11 | target average = 0.636364


Scaffold 9
Task 0: count = 11 | target average = 0.000000


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.3802e-01, PNorm = 43.2194, GNorm = 0.9612, lr_0 = 2.0312e-04
Loss = 5.4895e-01, PNorm = 43.2291, GNorm = 1.4593, lr_0 = 2.9687e-04
Loss = 5.1557e-01, PNorm = 43.2453, GNorm = 0.6516, lr_0 = 3.9062e-04
Loss = 5.3540e-01, PNorm = 43.2655, GNorm = 1.1172, lr_0 = 4.8437e-04
Validation prc-auc = 0.817897
Validation auc = 0.885460
Epoch 1
Loss = 4.7993e-01, PNorm = 43.2903, GNorm = 2.3783, lr_0 = 5.8750e-04
Loss = 4.6966e-01, PNorm = 43.3185, GNorm = 0.7628, lr_0 = 6.8125e-04
Loss = 4.2642e-01, PNorm = 43.3590, GNorm = 1.0521, lr_0 = 7.7500e-04
Loss = 4.3737e-01, PNorm = 43.4028, GNorm = 0.8185, lr_0 = 8.6875e-04
Loss = 4.7416e-01, PNorm = 43.4393, GNorm = 1.4698, lr_0 = 9.6250e-04
Validation prc-auc = 0.823853
Validation auc = 0.886608
Epoch 2
Loss = 3.9177e-01, PNorm = 43.4816, GNorm = 0.9747, lr_0 = 9.8977e-04
Loss = 4.3789e-01, PNorm = 43.5360, GNorm = 0.9106, lr_0 = 9.7296e-04
Loss = 4.3636e-01, PNorm = 43.5845, GNorm = 0.7221, lr_0 = 9.5643e-04
Loss = 4.2547e-01, PNorm = 43.6366, GNorm = 0.8332, lr_0 = 9.4019e-04
Loss = 4.9899e-01, PNorm = 43.6718, GNorm = 0.5520, lr_0 = 9.2422e-04
Validation prc-auc = 0.824771
Validation auc = 0.887251
Epoch 3
Loss = 4.2542e-01, PNorm = 43.7136, GNorm = 0.7215, lr_0 = 9.0852e-04
Loss = 4.0551e-01, PNorm = 43.7533, GNorm = 0.3938, lr_0 = 8.9309e-04
Loss = 4.1355e-01, PNorm = 43.7999, GNorm = 0.3275, lr_0 = 8.7791e-04
Loss = 4.2220e-01, PNorm = 43.8423, GNorm = 0.6524, lr_0 = 8.6300e-04
Loss = 3.8725e-01, PNorm = 43.8858, GNorm = 0.4491, lr_0 = 8.4834e-04
Validation prc-auc = 0.839318
Validation auc = 0.893313
Epoch 4
Loss = 4.0491e-01, PNorm = 43.9293, GNorm = 1.1748, lr_0 = 8.3393e-04
Loss = 4.0134e-01, PNorm = 43.9709, GNorm = 0.3549, lr_0 = 8.1977e-04
Loss = 4.1464e-01, PNorm = 44.0211, GNorm = 0.5303, lr_0 = 8.0584e-04
Loss = 3.7328e-01, PNorm = 44.0730, GNorm = 0.3587, lr_0 = 7.9215e-04
Loss = 3.6487e-01, PNorm = 44.1279, GNorm = 0.7121, lr_0 = 7.7870e-04
Validation prc-auc = 0.842940
Validation auc = 0.893359
Epoch 5
Loss = 3.0726e-01, PNorm = 44.1987, GNorm = 0.4993, lr_0 = 7.6547e-04
Loss = 3.6556e-01, PNorm = 44.2635, GNorm = 0.5909, lr_0 = 7.5247e-04
Loss = 3.9046e-01, PNorm = 44.3196, GNorm = 0.4177, lr_0 = 7.3969e-04
Loss = 4.1548e-01, PNorm = 44.3786, GNorm = 0.4900, lr_0 = 7.2712e-04
Loss = 3.9022e-01, PNorm = 44.4430, GNorm = 0.4449, lr_0 = 7.1477e-04
Validation prc-auc = 0.846940
Validation auc = 0.894094
Epoch 6
Loss = 3.7925e-01, PNorm = 44.4987, GNorm = 1.1108, lr_0 = 7.0143e-04
Loss = 3.5678e-01, PNorm = 44.5659, GNorm = 0.5497, lr_0 = 6.8951e-04
Loss = 3.7505e-01, PNorm = 44.6443, GNorm = 0.5731, lr_0 = 6.7780e-04
Loss = 3.6323e-01, PNorm = 44.7096, GNorm = 0.4549, lr_0 = 6.6629e-04
Loss = 3.8616e-01, PNorm = 44.7344, GNorm = 0.3601, lr_0 = 6.5497e-04
Validation prc-auc = 0.847033
Validation auc = 0.899467
Epoch 7
Loss = 3.6525e-01, PNorm = 44.7809, GNorm = 0.5333, lr_0 = 6.4384e-04
Loss = 3.6093e-01, PNorm = 44.8464, GNorm = 0.3448, lr_0 = 6.3291e-04
Loss = 3.2425e-01, PNorm = 44.9129, GNorm = 1.0644, lr_0 = 6.2216e-04
Loss = 4.0319e-01, PNorm = 44.9550, GNorm = 0.7395, lr_0 = 6.1159e-04
Loss = 3.6407e-01, PNorm = 45.0209, GNorm = 0.8045, lr_0 = 6.0120e-04
Validation prc-auc = 0.853253
Validation auc = 0.904473
Epoch 8
Loss = 3.4634e-01, PNorm = 45.1006, GNorm = 0.6043, lr_0 = 5.9099e-04
Loss = 3.4538e-01, PNorm = 45.1576, GNorm = 0.4291, lr_0 = 5.8095e-04
Loss = 3.6982e-01, PNorm = 45.2288, GNorm = 0.5621, lr_0 = 5.7108e-04
Loss = 3.7629e-01, PNorm = 45.2857, GNorm = 0.4661, lr_0 = 5.6138e-04
Validation prc-auc = 0.853958
Validation auc = 0.902958
Epoch 9
Loss = 4.3068e-01, PNorm = 45.3497, GNorm = 0.7740, lr_0 = 5.5184e-04
Loss = 3.6653e-01, PNorm = 45.4002, GNorm = 0.5245, lr_0 = 5.4247e-04
Loss = 3.4425e-01, PNorm = 45.4608, GNorm = 0.6826, lr_0 = 5.3325e-04
Loss = 3.1520e-01, PNorm = 45.5258, GNorm = 0.4030, lr_0 = 5.2420e-04
Loss = 3.2634e-01, PNorm = 45.5834, GNorm = 0.7831, lr_0 = 5.1529e-04
Validation prc-auc = 0.855539
Validation auc = 0.905530
Epoch 10
Loss = 2.7519e-01, PNorm = 45.6465, GNorm = 0.5038, lr_0 = 5.0654e-04
Loss = 3.6982e-01, PNorm = 45.6912, GNorm = 0.6128, lr_0 = 4.9793e-04
Loss = 3.0264e-01, PNorm = 45.7505, GNorm = 0.3276, lr_0 = 4.8948e-04
Loss = 3.0810e-01, PNorm = 45.8149, GNorm = 0.9319, lr_0 = 4.8116e-04
Loss = 3.6916e-01, PNorm = 45.8715, GNorm = 0.7987, lr_0 = 4.7299e-04
Validation prc-auc = 0.848744
Validation auc = 0.904335
Epoch 11
Loss = 3.5273e-01, PNorm = 45.9236, GNorm = 0.8774, lr_0 = 4.6416e-04
Loss = 3.2404e-01, PNorm = 45.9832, GNorm = 0.8719, lr_0 = 4.5627e-04
Loss = 3.1615e-01, PNorm = 46.0278, GNorm = 0.5318, lr_0 = 4.4852e-04
Loss = 2.9251e-01, PNorm = 46.0757, GNorm = 0.6828, lr_0 = 4.4091e-04
Loss = 3.5307e-01, PNorm = 46.1495, GNorm = 0.5429, lr_0 = 4.3342e-04
Validation prc-auc = 0.862158
Validation auc = 0.905713
Epoch 12
Loss = 3.4035e-01, PNorm = 46.2114, GNorm = 0.5595, lr_0 = 4.2605e-04
Loss = 2.8357e-01, PNorm = 46.2802, GNorm = 0.4953, lr_0 = 4.1882e-04
Loss = 3.4661e-01, PNorm = 46.3214, GNorm = 0.5765, lr_0 = 4.1170e-04
Loss = 3.0417e-01, PNorm = 46.3672, GNorm = 0.4677, lr_0 = 4.0471e-04
Loss = 3.3460e-01, PNorm = 46.4273, GNorm = 1.0320, lr_0 = 3.9783e-04
Validation prc-auc = 0.863399
Validation auc = 0.906448
Epoch 13
Loss = 3.3023e-01, PNorm = 46.4759, GNorm = 0.7276, lr_0 = 3.9108e-04
Loss = 3.1855e-01, PNorm = 46.5290, GNorm = 0.7987, lr_0 = 3.8443e-04
Loss = 3.2458e-01, PNorm = 46.5694, GNorm = 1.4779, lr_0 = 3.7790e-04
Loss = 3.1151e-01, PNorm = 46.6124, GNorm = 0.4897, lr_0 = 3.7148e-04
Loss = 2.9801e-01, PNorm = 46.6746, GNorm = 0.5535, lr_0 = 3.6517e-04
Validation prc-auc = 0.862241
Validation auc = 0.906632
Epoch 14
Loss = 3.4385e-01, PNorm = 46.7193, GNorm = 1.7189, lr_0 = 3.5897e-04
Loss = 3.1873e-01, PNorm = 46.7703, GNorm = 0.6294, lr_0 = 3.5287e-04
Loss = 2.7183e-01, PNorm = 46.8308, GNorm = 0.7295, lr_0 = 3.4688e-04
Loss = 3.2931e-01, PNorm = 46.8625, GNorm = 0.7615, lr_0 = 3.4099e-04
Loss = 2.6302e-01, PNorm = 46.9026, GNorm = 0.5648, lr_0 = 3.3520e-04
Validation prc-auc = 0.862953
Validation auc = 0.908331
Epoch 15
Loss = 3.2188e-01, PNorm = 46.9510, GNorm = 0.6698, lr_0 = 3.2950e-04
Loss = 3.0221e-01, PNorm = 46.9940, GNorm = 0.8640, lr_0 = 3.2390e-04
Loss = 2.8995e-01, PNorm = 47.0308, GNorm = 0.5251, lr_0 = 3.1840e-04
Loss = 2.6238e-01, PNorm = 47.0806, GNorm = 0.8582, lr_0 = 3.1299e-04
Loss = 2.7240e-01, PNorm = 47.1214, GNorm = 0.3493, lr_0 = 3.0768e-04
Loss = 5.5248e-01, PNorm = 47.1246, GNorm = 1.6643, lr_0 = 3.0715e-04
Validation prc-auc = 0.861962
Validation auc = 0.912418
Epoch 16
Loss = 2.7338e-01, PNorm = 47.1679, GNorm = 0.6225, lr_0 = 3.0193e-04
Loss = 2.8496e-01, PNorm = 47.2117, GNorm = 0.6419, lr_0 = 2.9680e-04
Loss = 2.6454e-01, PNorm = 47.2615, GNorm = 0.5254, lr_0 = 2.9176e-04
Loss = 2.8801e-01, PNorm = 47.3024, GNorm = 1.0978, lr_0 = 2.8681e-04
Validation prc-auc = 0.875415
Validation auc = 0.914256
Epoch 17
Loss = 2.5835e-01, PNorm = 47.3250, GNorm = 0.8327, lr_0 = 2.8193e-04
Loss = 2.5306e-01, PNorm = 47.3613, GNorm = 0.8889, lr_0 = 2.7715e-04
Loss = 2.7957e-01, PNorm = 47.4033, GNorm = 0.5277, lr_0 = 2.7244e-04
Loss = 2.6639e-01, PNorm = 47.4455, GNorm = 0.3595, lr_0 = 2.6781e-04
Loss = 2.7995e-01, PNorm = 47.4873, GNorm = 0.7300, lr_0 = 2.6326e-04
Validation prc-auc = 0.851500
Validation auc = 0.906815
Epoch 18
Loss = 3.2662e-01, PNorm = 47.5231, GNorm = 0.6861, lr_0 = 2.5879e-04
Loss = 3.0757e-01, PNorm = 47.5467, GNorm = 0.9100, lr_0 = 2.5439e-04
Loss = 2.3927e-01, PNorm = 47.5878, GNorm = 0.3933, lr_0 = 2.5007e-04
Loss = 2.7831e-01, PNorm = 47.6212, GNorm = 0.6199, lr_0 = 2.4582e-04
Loss = 2.1465e-01, PNorm = 47.6551, GNorm = 0.7758, lr_0 = 2.4165e-04
Validation prc-auc = 0.875393
Validation auc = 0.914990
Epoch 19
Loss = 2.7501e-01, PNorm = 47.6920, GNorm = 0.7656, lr_0 = 2.3754e-04
Loss = 2.4420e-01, PNorm = 47.7262, GNorm = 0.5488, lr_0 = 2.3351e-04
Loss = 2.6918e-01, PNorm = 47.7603, GNorm = 1.0404, lr_0 = 2.2954e-04
Loss = 2.6238e-01, PNorm = 47.7819, GNorm = 0.8826, lr_0 = 2.2564e-04
Loss = 2.4329e-01, PNorm = 47.8142, GNorm = 0.4307, lr_0 = 2.2181e-04
Validation prc-auc = 0.878429
Validation auc = 0.913337
Epoch 20
Loss = 1.9494e-01, PNorm = 47.8472, GNorm = 0.5784, lr_0 = 2.1804e-04
Loss = 2.3648e-01, PNorm = 47.8870, GNorm = 0.4743, lr_0 = 2.1434e-04
Loss = 2.5384e-01, PNorm = 47.9161, GNorm = 0.6274, lr_0 = 2.1070e-04
Loss = 2.2587e-01, PNorm = 47.9487, GNorm = 0.7396, lr_0 = 2.0712e-04
Loss = 2.5478e-01, PNorm = 47.9714, GNorm = 1.1343, lr_0 = 2.0360e-04
Validation prc-auc = 0.866168
Validation auc = 0.911041
Epoch 21
Loss = 2.6432e-01, PNorm = 48.0007, GNorm = 0.4976, lr_0 = 1.9980e-04
Loss = 2.7840e-01, PNorm = 48.0242, GNorm = 0.7227, lr_0 = 1.9641e-04
Loss = 2.2943e-01, PNorm = 48.0545, GNorm = 0.8883, lr_0 = 1.9307e-04
Loss = 2.3948e-01, PNorm = 48.0862, GNorm = 1.1849, lr_0 = 1.8979e-04
Loss = 2.1212e-01, PNorm = 48.1194, GNorm = 0.5080, lr_0 = 1.8657e-04
Validation prc-auc = 0.869874
Validation auc = 0.909250
Epoch 22
Loss = 2.5831e-01, PNorm = 48.1473, GNorm = 1.4679, lr_0 = 1.8340e-04
Loss = 2.0996e-01, PNorm = 48.1699, GNorm = 1.2628, lr_0 = 1.8028e-04
Loss = 2.6699e-01, PNorm = 48.1964, GNorm = 0.5435, lr_0 = 1.7722e-04
Loss = 2.2850e-01, PNorm = 48.2188, GNorm = 0.6263, lr_0 = 1.7421e-04
Loss = 2.5811e-01, PNorm = 48.2393, GNorm = 0.7322, lr_0 = 1.7125e-04
Validation prc-auc = 0.863050
Validation auc = 0.906310
Epoch 23
Loss = 2.4011e-01, PNorm = 48.2640, GNorm = 0.7668, lr_0 = 1.6834e-04
Loss = 1.8045e-01, PNorm = 48.2875, GNorm = 1.0600, lr_0 = 1.6548e-04
Loss = 2.3776e-01, PNorm = 48.3134, GNorm = 0.5820, lr_0 = 1.6267e-04
Loss = 2.2472e-01, PNorm = 48.3324, GNorm = 1.1014, lr_0 = 1.5991e-04
Loss = 2.7789e-01, PNorm = 48.3589, GNorm = 0.6571, lr_0 = 1.5719e-04
Validation prc-auc = 0.860024
Validation auc = 0.910398
Epoch 24
Loss = 2.6422e-01, PNorm = 48.3744, GNorm = 0.9248, lr_0 = 1.5452e-04
Loss = 2.1806e-01, PNorm = 48.3981, GNorm = 0.6031, lr_0 = 1.5190e-04
Loss = 2.2568e-01, PNorm = 48.4205, GNorm = 0.7695, lr_0 = 1.4932e-04
Loss = 2.0831e-01, PNorm = 48.4398, GNorm = 0.5031, lr_0 = 1.4678e-04
Loss = 2.4513e-01, PNorm = 48.4604, GNorm = 1.1346, lr_0 = 1.4429e-04
Validation prc-auc = 0.867144
Validation auc = 0.907596
Epoch 25
Loss = 2.5900e-01, PNorm = 48.4758, GNorm = 0.7587, lr_0 = 1.4184e-04
Loss = 2.2044e-01, PNorm = 48.4957, GNorm = 0.6071, lr_0 = 1.3943e-04
Loss = 2.0306e-01, PNorm = 48.5192, GNorm = 0.4641, lr_0 = 1.3706e-04
Loss = 2.1333e-01, PNorm = 48.5334, GNorm = 0.4159, lr_0 = 1.3473e-04
Validation prc-auc = 0.871310
Validation auc = 0.907229
Epoch 26
Loss = 2.5585e-01, PNorm = 48.5569, GNorm = 0.8187, lr_0 = 1.3221e-04
Loss = 1.9786e-01, PNorm = 48.5739, GNorm = 0.7361, lr_0 = 1.2997e-04
Loss = 2.5437e-01, PNorm = 48.5948, GNorm = 1.5455, lr_0 = 1.2776e-04
Loss = 2.0446e-01, PNorm = 48.6080, GNorm = 0.8716, lr_0 = 1.2559e-04
Loss = 2.2999e-01, PNorm = 48.6266, GNorm = 0.6823, lr_0 = 1.2346e-04
Validation prc-auc = 0.859053
Validation auc = 0.906081
Epoch 27
Loss = 1.9671e-01, PNorm = 48.6431, GNorm = 0.6936, lr_0 = 1.2136e-04
Loss = 2.2129e-01, PNorm = 48.6564, GNorm = 0.4711, lr_0 = 1.1930e-04
Loss = 2.1154e-01, PNorm = 48.6764, GNorm = 1.4207, lr_0 = 1.1727e-04
Loss = 1.6741e-01, PNorm = 48.6907, GNorm = 0.9753, lr_0 = 1.1528e-04
Loss = 2.6413e-01, PNorm = 48.6999, GNorm = 0.4682, lr_0 = 1.1332e-04
Validation prc-auc = 0.862227
Validation auc = 0.905575
Epoch 28
Loss = 1.4241e-01, PNorm = 48.7132, GNorm = 0.7549, lr_0 = 1.1140e-04
Loss = 2.2324e-01, PNorm = 48.7305, GNorm = 1.6011, lr_0 = 1.0951e-04
Loss = 1.9802e-01, PNorm = 48.7439, GNorm = 0.9789, lr_0 = 1.0765e-04
Loss = 2.4890e-01, PNorm = 48.7567, GNorm = 1.4350, lr_0 = 1.0582e-04
Loss = 2.1508e-01, PNorm = 48.7635, GNorm = 0.8831, lr_0 = 1.0402e-04
Validation prc-auc = 0.855982
Validation auc = 0.903509
Epoch 29
Loss = 2.0075e-01, PNorm = 48.7802, GNorm = 1.2346, lr_0 = 1.0225e-04
Loss = 1.8180e-01, PNorm = 48.7944, GNorm = 0.4602, lr_0 = 1.0052e-04
Loss = 2.2165e-01, PNorm = 48.8127, GNorm = 0.7693, lr_0 = 1.0000e-04
Loss = 2.2558e-01, PNorm = 48.8268, GNorm = 1.0265, lr_0 = 1.0000e-04
Loss = 2.0675e-01, PNorm = 48.8353, GNorm = 1.1202, lr_0 = 1.0000e-04
Validation prc-auc = 0.865355
Validation auc = 0.905713
Model 0 best validation prc-auc = 0.878429 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.836576
Model 0 test auc = 0.894686
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.3569e-01, PNorm = 43.2428, GNorm = 0.9753, lr_0 = 2.0312e-04
Loss = 6.0743e-01, PNorm = 43.2518, GNorm = 0.7643, lr_0 = 2.9687e-04
Loss = 5.4307e-01, PNorm = 43.2692, GNorm = 0.5986, lr_0 = 3.9062e-04
Loss = 5.2768e-01, PNorm = 43.2876, GNorm = 0.5461, lr_0 = 4.8437e-04
Validation prc-auc = 0.826746
Validation auc = 0.884633
Epoch 1
Loss = 5.0636e-01, PNorm = 43.3164, GNorm = 0.9424, lr_0 = 5.8750e-04
Loss = 4.6890e-01, PNorm = 43.3486, GNorm = 1.1481, lr_0 = 6.8125e-04
Loss = 4.6311e-01, PNorm = 43.3899, GNorm = 1.4374, lr_0 = 7.7500e-04
Loss = 4.1538e-01, PNorm = 43.4295, GNorm = 0.8779, lr_0 = 8.6875e-04
Loss = 4.3965e-01, PNorm = 43.4746, GNorm = 0.5189, lr_0 = 9.6250e-04
Validation prc-auc = 0.833518
Validation auc = 0.891981
Epoch 2
Loss = 3.8839e-01, PNorm = 43.5331, GNorm = 0.7491, lr_0 = 9.8977e-04
Loss = 3.7232e-01, PNorm = 43.5969, GNorm = 1.4731, lr_0 = 9.7296e-04
Loss = 4.5189e-01, PNorm = 43.6575, GNorm = 1.1814, lr_0 = 9.5643e-04
Loss = 3.8949e-01, PNorm = 43.6922, GNorm = 0.3722, lr_0 = 9.4019e-04
Loss = 4.3760e-01, PNorm = 43.7427, GNorm = 0.5168, lr_0 = 9.2422e-04
Validation prc-auc = 0.834072
Validation auc = 0.891476
Epoch 3
Loss = 4.2239e-01, PNorm = 43.7944, GNorm = 1.9636, lr_0 = 9.0852e-04
Loss = 3.7600e-01, PNorm = 43.8522, GNorm = 0.6153, lr_0 = 8.9309e-04
Loss = 4.1822e-01, PNorm = 43.9087, GNorm = 0.6285, lr_0 = 8.7791e-04
Loss = 4.0839e-01, PNorm = 43.9675, GNorm = 0.3866, lr_0 = 8.6300e-04
Loss = 4.1832e-01, PNorm = 44.0055, GNorm = 0.6416, lr_0 = 8.4834e-04
Validation prc-auc = 0.828028
Validation auc = 0.892670
Epoch 4
Loss = 3.6535e-01, PNorm = 44.0651, GNorm = 0.4525, lr_0 = 8.3393e-04
Loss = 3.7978e-01, PNorm = 44.1213, GNorm = 0.4285, lr_0 = 8.1977e-04
Loss = 3.9632e-01, PNorm = 44.1819, GNorm = 0.9024, lr_0 = 8.0584e-04
Loss = 3.6981e-01, PNorm = 44.2437, GNorm = 0.5356, lr_0 = 7.9215e-04
Loss = 3.9739e-01, PNorm = 44.2896, GNorm = 0.6086, lr_0 = 7.7870e-04
Validation prc-auc = 0.853398
Validation auc = 0.899559
Epoch 5
Loss = 4.0948e-01, PNorm = 44.3547, GNorm = 0.3817, lr_0 = 7.6547e-04
Loss = 3.8981e-01, PNorm = 44.4444, GNorm = 0.5877, lr_0 = 7.5247e-04
Loss = 3.8113e-01, PNorm = 44.5185, GNorm = 1.4376, lr_0 = 7.3969e-04
Loss = 3.4779e-01, PNorm = 44.5708, GNorm = 0.4581, lr_0 = 7.2712e-04
Loss = 3.7925e-01, PNorm = 44.6241, GNorm = 0.3858, lr_0 = 7.1477e-04
Validation prc-auc = 0.856035
Validation auc = 0.902039
Epoch 6
Loss = 3.4458e-01, PNorm = 44.6908, GNorm = 0.8147, lr_0 = 7.0143e-04
Loss = 3.3436e-01, PNorm = 44.7636, GNorm = 0.3624, lr_0 = 6.8951e-04
Loss = 3.9069e-01, PNorm = 44.8218, GNorm = 0.3527, lr_0 = 6.7780e-04
Loss = 3.2572e-01, PNorm = 44.8631, GNorm = 0.3731, lr_0 = 6.6629e-04
Loss = 4.2959e-01, PNorm = 44.9109, GNorm = 1.0722, lr_0 = 6.5497e-04
Validation prc-auc = 0.853386
Validation auc = 0.903050
Epoch 7
Loss = 3.8615e-01, PNorm = 44.9524, GNorm = 0.8348, lr_0 = 6.4384e-04
Loss = 3.9560e-01, PNorm = 45.0112, GNorm = 0.5495, lr_0 = 6.3291e-04
Loss = 3.3579e-01, PNorm = 45.0645, GNorm = 0.6355, lr_0 = 6.2216e-04
Loss = 3.5688e-01, PNorm = 45.1345, GNorm = 0.4536, lr_0 = 6.1159e-04
Loss = 3.5294e-01, PNorm = 45.2135, GNorm = 0.5179, lr_0 = 6.0120e-04
Validation prc-auc = 0.839853
Validation auc = 0.895564
Epoch 8
Loss = 3.5600e-01, PNorm = 45.2840, GNorm = 0.3481, lr_0 = 5.9099e-04
Loss = 3.5779e-01, PNorm = 45.3446, GNorm = 0.7405, lr_0 = 5.8095e-04
Loss = 3.4453e-01, PNorm = 45.4002, GNorm = 0.4917, lr_0 = 5.7108e-04
Loss = 3.6363e-01, PNorm = 45.4578, GNorm = 0.4536, lr_0 = 5.6138e-04
Validation prc-auc = 0.855734
Validation auc = 0.904290
Epoch 9
Loss = 4.8860e-01, PNorm = 45.5142, GNorm = 0.8806, lr_0 = 5.5184e-04
Loss = 3.7129e-01, PNorm = 45.5725, GNorm = 0.8168, lr_0 = 5.4247e-04
Loss = 3.1826e-01, PNorm = 45.6360, GNorm = 0.8241, lr_0 = 5.3325e-04
Loss = 3.3581e-01, PNorm = 45.6953, GNorm = 0.9508, lr_0 = 5.2420e-04
Loss = 3.3450e-01, PNorm = 45.7560, GNorm = 0.6243, lr_0 = 5.1529e-04
Validation prc-auc = 0.857762
Validation auc = 0.907367
Epoch 10
Loss = 3.3638e-01, PNorm = 45.8026, GNorm = 0.4683, lr_0 = 5.0654e-04
Loss = 3.4778e-01, PNorm = 45.8588, GNorm = 0.6828, lr_0 = 4.9793e-04
Loss = 2.9104e-01, PNorm = 45.9178, GNorm = 0.7615, lr_0 = 4.8948e-04
Loss = 3.1650e-01, PNorm = 45.9841, GNorm = 0.8299, lr_0 = 4.8116e-04
Loss = 3.2535e-01, PNorm = 46.0336, GNorm = 0.5555, lr_0 = 4.7299e-04
Validation prc-auc = 0.844689
Validation auc = 0.900753
Epoch 11
Loss = 2.9007e-01, PNorm = 46.0852, GNorm = 0.8668, lr_0 = 4.6416e-04
Loss = 2.8926e-01, PNorm = 46.1565, GNorm = 0.3452, lr_0 = 4.5627e-04
Loss = 3.3585e-01, PNorm = 46.2113, GNorm = 0.5281, lr_0 = 4.4852e-04
Loss = 3.3423e-01, PNorm = 46.2729, GNorm = 0.6718, lr_0 = 4.4091e-04
Loss = 3.3226e-01, PNorm = 46.3287, GNorm = 0.9209, lr_0 = 4.3342e-04
Validation prc-auc = 0.854862
Validation auc = 0.906999
Epoch 12
Loss = 2.9379e-01, PNorm = 46.3832, GNorm = 1.0842, lr_0 = 4.2605e-04
Loss = 2.9593e-01, PNorm = 46.4421, GNorm = 0.4791, lr_0 = 4.1882e-04
Loss = 3.2239e-01, PNorm = 46.5036, GNorm = 0.5264, lr_0 = 4.1170e-04
Loss = 3.2470e-01, PNorm = 46.5531, GNorm = 0.8893, lr_0 = 4.0471e-04
Loss = 3.1385e-01, PNorm = 46.5977, GNorm = 0.5888, lr_0 = 3.9783e-04
Validation prc-auc = 0.853101
Validation auc = 0.908698
Epoch 13
Loss = 2.8523e-01, PNorm = 46.6553, GNorm = 0.7565, lr_0 = 3.9108e-04
Loss = 2.9196e-01, PNorm = 46.6971, GNorm = 0.6507, lr_0 = 3.8443e-04
Loss = 2.9809e-01, PNorm = 46.7517, GNorm = 0.4498, lr_0 = 3.7790e-04
Loss = 2.7415e-01, PNorm = 46.8024, GNorm = 0.8185, lr_0 = 3.7148e-04
Loss = 3.3720e-01, PNorm = 46.8551, GNorm = 0.7355, lr_0 = 3.6517e-04
Validation prc-auc = 0.862299
Validation auc = 0.911270
Epoch 14
Loss = 3.0320e-01, PNorm = 46.9171, GNorm = 0.6857, lr_0 = 3.5897e-04
Loss = 2.6876e-01, PNorm = 46.9778, GNorm = 2.0027, lr_0 = 3.5287e-04
Loss = 3.1412e-01, PNorm = 47.0154, GNorm = 0.5351, lr_0 = 3.4688e-04
Loss = 3.0121e-01, PNorm = 47.0680, GNorm = 1.0480, lr_0 = 3.4099e-04
Loss = 2.8801e-01, PNorm = 47.1067, GNorm = 0.7801, lr_0 = 3.3520e-04
Validation prc-auc = 0.857043
Validation auc = 0.904841
Epoch 15
Loss = 2.7236e-01, PNorm = 47.1545, GNorm = 0.4862, lr_0 = 3.2950e-04
Loss = 2.7690e-01, PNorm = 47.2021, GNorm = 0.7142, lr_0 = 3.2390e-04
Loss = 2.9476e-01, PNorm = 47.2486, GNorm = 1.3012, lr_0 = 3.1840e-04
Loss = 2.9698e-01, PNorm = 47.2890, GNorm = 1.1789, lr_0 = 3.1299e-04
Loss = 2.7667e-01, PNorm = 47.3410, GNorm = 1.1596, lr_0 = 3.0768e-04
Loss = 2.2868e-01, PNorm = 47.3464, GNorm = 0.8879, lr_0 = 3.0715e-04
Validation prc-auc = 0.842324
Validation auc = 0.905070
Epoch 16
Loss = 3.0702e-01, PNorm = 47.3895, GNorm = 0.5210, lr_0 = 3.0193e-04
Loss = 2.6694e-01, PNorm = 47.4285, GNorm = 0.8486, lr_0 = 2.9680e-04
Loss = 2.6266e-01, PNorm = 47.4661, GNorm = 0.5182, lr_0 = 2.9176e-04
Loss = 2.7586e-01, PNorm = 47.5153, GNorm = 0.5544, lr_0 = 2.8681e-04
Validation prc-auc = 0.871416
Validation auc = 0.914026
Epoch 17
Loss = 2.6631e-01, PNorm = 47.5617, GNorm = 0.7932, lr_0 = 2.8193e-04
Loss = 2.7077e-01, PNorm = 47.6163, GNorm = 0.7174, lr_0 = 2.7715e-04
Loss = 2.4638e-01, PNorm = 47.6482, GNorm = 1.2628, lr_0 = 2.7244e-04
Loss = 2.2121e-01, PNorm = 47.6883, GNorm = 0.3679, lr_0 = 2.6781e-04
Loss = 2.6189e-01, PNorm = 47.7254, GNorm = 0.6490, lr_0 = 2.6326e-04
Validation prc-auc = 0.862674
Validation auc = 0.907964
Epoch 18
Loss = 2.6084e-01, PNorm = 47.7561, GNorm = 0.8635, lr_0 = 2.5879e-04
Loss = 2.5454e-01, PNorm = 47.7952, GNorm = 0.9881, lr_0 = 2.5439e-04
Loss = 2.4024e-01, PNorm = 47.8339, GNorm = 0.4906, lr_0 = 2.5007e-04
Loss = 2.6189e-01, PNorm = 47.8699, GNorm = 0.6769, lr_0 = 2.4582e-04
Loss = 2.3004e-01, PNorm = 47.9009, GNorm = 0.3811, lr_0 = 2.4165e-04
Validation prc-auc = 0.869981
Validation auc = 0.911592
Epoch 19
Loss = 2.4860e-01, PNorm = 47.9357, GNorm = 0.5477, lr_0 = 2.3754e-04
Loss = 2.2549e-01, PNorm = 47.9705, GNorm = 0.6228, lr_0 = 2.3351e-04
Loss = 2.2294e-01, PNorm = 48.0087, GNorm = 0.6928, lr_0 = 2.2954e-04
Loss = 2.7731e-01, PNorm = 48.0340, GNorm = 1.0445, lr_0 = 2.2564e-04
Loss = 2.5316e-01, PNorm = 48.0684, GNorm = 0.7774, lr_0 = 2.2181e-04
Validation prc-auc = 0.862323
Validation auc = 0.913291
Epoch 20
Loss = 2.2115e-01, PNorm = 48.1037, GNorm = 0.4760, lr_0 = 2.1804e-04
Loss = 2.3972e-01, PNorm = 48.1351, GNorm = 0.5549, lr_0 = 2.1434e-04
Loss = 2.7830e-01, PNorm = 48.1653, GNorm = 0.8283, lr_0 = 2.1070e-04
Loss = 2.3337e-01, PNorm = 48.1954, GNorm = 0.8039, lr_0 = 2.0712e-04
Loss = 2.1666e-01, PNorm = 48.2313, GNorm = 1.1263, lr_0 = 2.0360e-04
Validation prc-auc = 0.867209
Validation auc = 0.912510
Epoch 21
Loss = 2.5484e-01, PNorm = 48.2720, GNorm = 0.7434, lr_0 = 1.9980e-04
Loss = 2.7079e-01, PNorm = 48.2965, GNorm = 0.9024, lr_0 = 1.9641e-04
Loss = 2.2757e-01, PNorm = 48.3268, GNorm = 0.5306, lr_0 = 1.9307e-04
Loss = 2.1923e-01, PNorm = 48.3557, GNorm = 0.5297, lr_0 = 1.8979e-04
Loss = 1.9649e-01, PNorm = 48.3725, GNorm = 0.4214, lr_0 = 1.8657e-04
Validation prc-auc = 0.875848
Validation auc = 0.914210
Epoch 22
Loss = 2.2078e-01, PNorm = 48.3995, GNorm = 1.3229, lr_0 = 1.8340e-04
Loss = 2.0356e-01, PNorm = 48.4239, GNorm = 0.7345, lr_0 = 1.8028e-04
Loss = 2.4107e-01, PNorm = 48.4488, GNorm = 0.5192, lr_0 = 1.7722e-04
Loss = 2.3303e-01, PNorm = 48.4689, GNorm = 1.2524, lr_0 = 1.7421e-04
Loss = 2.3503e-01, PNorm = 48.4897, GNorm = 1.5586, lr_0 = 1.7125e-04
Validation prc-auc = 0.874859
Validation auc = 0.911546
Epoch 23
Loss = 2.0728e-01, PNorm = 48.5135, GNorm = 0.8959, lr_0 = 1.6834e-04
Loss = 2.4549e-01, PNorm = 48.5375, GNorm = 0.4283, lr_0 = 1.6548e-04
Loss = 2.1139e-01, PNorm = 48.5585, GNorm = 0.5669, lr_0 = 1.6267e-04
Loss = 2.3795e-01, PNorm = 48.5820, GNorm = 0.6203, lr_0 = 1.5991e-04
Loss = 2.0685e-01, PNorm = 48.6026, GNorm = 0.4873, lr_0 = 1.5719e-04
Validation prc-auc = 0.868106
Validation auc = 0.910536
Epoch 24
Loss = 2.0562e-01, PNorm = 48.6265, GNorm = 0.4969, lr_0 = 1.5452e-04
Loss = 1.9520e-01, PNorm = 48.6453, GNorm = 0.8570, lr_0 = 1.5190e-04
Loss = 2.5579e-01, PNorm = 48.6668, GNorm = 1.0234, lr_0 = 1.4932e-04
Loss = 2.4528e-01, PNorm = 48.6793, GNorm = 0.8141, lr_0 = 1.4678e-04
Loss = 1.9264e-01, PNorm = 48.6998, GNorm = 0.5750, lr_0 = 1.4429e-04
Validation prc-auc = 0.867103
Validation auc = 0.911821
Epoch 25
Loss = 2.3382e-01, PNorm = 48.7217, GNorm = 1.4708, lr_0 = 1.4184e-04
Loss = 1.9983e-01, PNorm = 48.7381, GNorm = 0.7930, lr_0 = 1.3943e-04
Loss = 2.1116e-01, PNorm = 48.7612, GNorm = 0.7251, lr_0 = 1.3706e-04
Loss = 2.0792e-01, PNorm = 48.7817, GNorm = 1.3195, lr_0 = 1.3473e-04
Validation prc-auc = 0.868298
Validation auc = 0.909709
Epoch 26
Loss = 1.7069e-01, PNorm = 48.8025, GNorm = 0.6256, lr_0 = 1.3221e-04
Loss = 1.9551e-01, PNorm = 48.8240, GNorm = 0.9364, lr_0 = 1.2997e-04
Loss = 1.9736e-01, PNorm = 48.8435, GNorm = 0.8445, lr_0 = 1.2776e-04
Loss = 1.8016e-01, PNorm = 48.8622, GNorm = 0.5541, lr_0 = 1.2559e-04
Loss = 2.6949e-01, PNorm = 48.8740, GNorm = 0.8669, lr_0 = 1.2346e-04
Validation prc-auc = 0.869008
Validation auc = 0.908193
Epoch 27
Loss = 2.2305e-01, PNorm = 48.8816, GNorm = 0.9732, lr_0 = 1.2136e-04
Loss = 2.1620e-01, PNorm = 48.8937, GNorm = 0.7485, lr_0 = 1.1930e-04
Loss = 1.8711e-01, PNorm = 48.9104, GNorm = 0.7571, lr_0 = 1.1727e-04
Loss = 2.3475e-01, PNorm = 48.9282, GNorm = 1.2707, lr_0 = 1.1528e-04
Loss = 1.7800e-01, PNorm = 48.9435, GNorm = 1.2408, lr_0 = 1.1332e-04
Validation prc-auc = 0.854008
Validation auc = 0.906632
Epoch 28
Loss = 1.8400e-01, PNorm = 48.9585, GNorm = 1.1976, lr_0 = 1.1140e-04
Loss = 1.9245e-01, PNorm = 48.9718, GNorm = 0.7364, lr_0 = 1.0951e-04
Loss = 1.5712e-01, PNorm = 48.9891, GNorm = 0.7492, lr_0 = 1.0765e-04
Loss = 2.1142e-01, PNorm = 49.0015, GNorm = 0.6672, lr_0 = 1.0582e-04
Loss = 2.3530e-01, PNorm = 49.0154, GNorm = 1.0941, lr_0 = 1.0402e-04
Validation prc-auc = 0.874257
Validation auc = 0.916276
Epoch 29
Loss = 2.1460e-01, PNorm = 49.0243, GNorm = 0.7063, lr_0 = 1.0225e-04
Loss = 1.8368e-01, PNorm = 49.0386, GNorm = 0.5893, lr_0 = 1.0052e-04
Loss = 2.0132e-01, PNorm = 49.0518, GNorm = 1.2787, lr_0 = 1.0000e-04
Loss = 1.9969e-01, PNorm = 49.0655, GNorm = 0.9384, lr_0 = 1.0000e-04
Loss = 1.9222e-01, PNorm = 49.0749, GNorm = 0.5652, lr_0 = 1.0000e-04
Validation prc-auc = 0.871021
Validation auc = 0.912143
Model 1 best validation prc-auc = 0.875848 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.836073
Model 1 test auc = 0.901765
Ensemble test prc-auc = 0.839524
Ensemble test auc = 0.898513
Fold 3
Splitting data with seed 3
Total scaffolds = 1,723 | train scaffolds = 1,386 | val scaffolds = 183 | test scaffolds = 154
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 92 | target average = 0.565217


Scaffold 1
Task 0: count = 51 | target average = 0.470588


Scaffold 2
Task 0: count = 19 | target average = 0.000000


Scaffold 3
Task 0: count = 18 | target average = 0.000000


Scaffold 4
Task 0: count = 17 | target average = 0.000000


Scaffold 5
Task 0: count = 15 | target average = 0.400000


Scaffold 6
Task 0: count = 15 | target average = 0.000000


Scaffold 7
Task 0: count = 11 | target average = 0.636364


Scaffold 8
Task 0: count = 11 | target average = 0.000000


Scaffold 9
Task 0: count = 11 | target average = 0.000000


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.4525e-01, PNorm = 43.2191, GNorm = 0.6320, lr_0 = 2.0312e-04
Loss = 5.6467e-01, PNorm = 43.2287, GNorm = 0.6016, lr_0 = 2.9687e-04
Loss = 5.4354e-01, PNorm = 43.2443, GNorm = 1.1203, lr_0 = 3.9062e-04
Loss = 5.0666e-01, PNorm = 43.2685, GNorm = 0.8751, lr_0 = 4.8437e-04
Validation prc-auc = 0.684345
Validation auc = 0.858339
Epoch 1
Loss = 5.7391e-01, PNorm = 43.2975, GNorm = 0.5428, lr_0 = 5.8750e-04
Loss = 4.5047e-01, PNorm = 43.3260, GNorm = 0.6736, lr_0 = 6.8125e-04
Loss = 4.8255e-01, PNorm = 43.3617, GNorm = 0.5247, lr_0 = 7.7500e-04
Loss = 4.5219e-01, PNorm = 43.4049, GNorm = 0.9553, lr_0 = 8.6875e-04
Loss = 4.5607e-01, PNorm = 43.4505, GNorm = 1.1815, lr_0 = 9.6250e-04
Validation prc-auc = 0.722085
Validation auc = 0.874801
Epoch 2
Loss = 4.0740e-01, PNorm = 43.5000, GNorm = 0.6571, lr_0 = 9.8977e-04
Loss = 4.0971e-01, PNorm = 43.5548, GNorm = 0.3660, lr_0 = 9.7296e-04
Loss = 3.6121e-01, PNorm = 43.6129, GNorm = 0.4294, lr_0 = 9.5643e-04
Loss = 4.5505e-01, PNorm = 43.6644, GNorm = 0.9240, lr_0 = 9.4019e-04
Loss = 4.5058e-01, PNorm = 43.7118, GNorm = 0.6234, lr_0 = 9.2422e-04
Validation prc-auc = 0.732096
Validation auc = 0.874858
Epoch 3
Loss = 3.7904e-01, PNorm = 43.7537, GNorm = 1.3629, lr_0 = 9.0852e-04
Loss = 4.1644e-01, PNorm = 43.8052, GNorm = 0.8828, lr_0 = 8.9309e-04
Loss = 4.1130e-01, PNorm = 43.8679, GNorm = 1.0586, lr_0 = 8.7791e-04
Loss = 4.4002e-01, PNorm = 43.9151, GNorm = 0.9490, lr_0 = 8.6300e-04
Loss = 4.0322e-01, PNorm = 43.9689, GNorm = 0.8152, lr_0 = 8.4834e-04
Validation prc-auc = 0.737860
Validation auc = 0.876396
Epoch 4
Loss = 3.8268e-01, PNorm = 44.0251, GNorm = 0.3682, lr_0 = 8.3393e-04
Loss = 3.9357e-01, PNorm = 44.0964, GNorm = 1.2465, lr_0 = 8.1977e-04
Loss = 4.1653e-01, PNorm = 44.1552, GNorm = 0.5035, lr_0 = 8.0584e-04
Loss = 4.2330e-01, PNorm = 44.2085, GNorm = 1.1689, lr_0 = 7.9215e-04
Loss = 4.1464e-01, PNorm = 44.2578, GNorm = 1.0513, lr_0 = 7.7870e-04
Validation prc-auc = 0.746470
Validation auc = 0.876225
Epoch 5
Loss = 4.2778e-01, PNorm = 44.3266, GNorm = 1.0476, lr_0 = 7.6547e-04
Loss = 3.8892e-01, PNorm = 44.3916, GNorm = 0.9214, lr_0 = 7.5247e-04
Loss = 3.8317e-01, PNorm = 44.4631, GNorm = 0.7190, lr_0 = 7.3969e-04
Loss = 3.6282e-01, PNorm = 44.5331, GNorm = 0.6196, lr_0 = 7.2712e-04
Loss = 3.9353e-01, PNorm = 44.5929, GNorm = 1.4359, lr_0 = 7.1477e-04
Validation prc-auc = 0.755956
Validation auc = 0.879414
Epoch 6
Loss = 3.8122e-01, PNorm = 44.6658, GNorm = 0.6638, lr_0 = 7.0143e-04
Loss = 3.6116e-01, PNorm = 44.7340, GNorm = 0.5274, lr_0 = 6.8951e-04
Loss = 3.8148e-01, PNorm = 44.7956, GNorm = 0.6231, lr_0 = 6.7780e-04
Loss = 3.8524e-01, PNorm = 44.8617, GNorm = 1.3272, lr_0 = 6.6629e-04
Loss = 3.6285e-01, PNorm = 44.9236, GNorm = 0.7356, lr_0 = 6.5497e-04
Validation prc-auc = 0.754656
Validation auc = 0.874915
Epoch 7
Loss = 3.4191e-01, PNorm = 45.0239, GNorm = 0.4611, lr_0 = 6.4384e-04
Loss = 3.8908e-01, PNorm = 45.1035, GNorm = 0.3697, lr_0 = 6.3291e-04
Loss = 3.7432e-01, PNorm = 45.1900, GNorm = 0.3713, lr_0 = 6.2216e-04
Loss = 3.4973e-01, PNorm = 45.2732, GNorm = 0.8055, lr_0 = 6.1159e-04
Loss = 3.5572e-01, PNorm = 45.3302, GNorm = 0.5795, lr_0 = 6.0120e-04
Validation prc-auc = 0.750548
Validation auc = 0.883288
Epoch 8
Loss = 3.5518e-01, PNorm = 45.3883, GNorm = 0.9956, lr_0 = 5.9099e-04
Loss = 3.7621e-01, PNorm = 45.4547, GNorm = 1.0763, lr_0 = 5.8095e-04
Loss = 3.7348e-01, PNorm = 45.5257, GNorm = 0.7352, lr_0 = 5.7108e-04
Loss = 3.0526e-01, PNorm = 45.5953, GNorm = 0.5105, lr_0 = 5.6138e-04
Validation prc-auc = 0.756333
Validation auc = 0.878161
Epoch 9
Loss = 3.5593e-01, PNorm = 45.6577, GNorm = 1.2704, lr_0 = 5.5184e-04
Loss = 3.5244e-01, PNorm = 45.7280, GNorm = 0.4010, lr_0 = 5.4247e-04
Loss = 3.2257e-01, PNorm = 45.8079, GNorm = 0.4358, lr_0 = 5.3325e-04
Loss = 3.3882e-01, PNorm = 45.8772, GNorm = 0.9590, lr_0 = 5.2420e-04
Loss = 3.4536e-01, PNorm = 45.9416, GNorm = 0.8092, lr_0 = 5.1529e-04
Validation prc-auc = 0.747216
Validation auc = 0.872750
Epoch 10
Loss = 2.6553e-01, PNorm = 46.0040, GNorm = 1.0699, lr_0 = 5.0654e-04
Loss = 3.4121e-01, PNorm = 46.0809, GNorm = 1.1535, lr_0 = 4.9793e-04
Loss = 3.3138e-01, PNorm = 46.1336, GNorm = 0.4655, lr_0 = 4.8948e-04
Loss = 3.9357e-01, PNorm = 46.2059, GNorm = 0.7896, lr_0 = 4.8116e-04
Loss = 3.3725e-01, PNorm = 46.2808, GNorm = 0.6704, lr_0 = 4.7299e-04
Validation prc-auc = 0.752714
Validation auc = 0.878503
Epoch 11
Loss = 3.2529e-01, PNorm = 46.3433, GNorm = 0.4301, lr_0 = 4.6416e-04
Loss = 2.8456e-01, PNorm = 46.4120, GNorm = 0.3368, lr_0 = 4.5627e-04
Loss = 3.1609e-01, PNorm = 46.4875, GNorm = 0.8117, lr_0 = 4.4852e-04
Loss = 3.0682e-01, PNorm = 46.5432, GNorm = 0.6525, lr_0 = 4.4091e-04
Loss = 3.5723e-01, PNorm = 46.5990, GNorm = 0.4148, lr_0 = 4.3342e-04
Validation prc-auc = 0.755049
Validation auc = 0.871554
Epoch 12
Loss = 3.1971e-01, PNorm = 46.6372, GNorm = 1.3192, lr_0 = 4.2605e-04
Loss = 3.1257e-01, PNorm = 46.6880, GNorm = 1.1381, lr_0 = 4.1882e-04
Loss = 3.1379e-01, PNorm = 46.7493, GNorm = 0.8746, lr_0 = 4.1170e-04
Loss = 2.8451e-01, PNorm = 46.8308, GNorm = 1.1186, lr_0 = 4.0471e-04
Loss = 3.3251e-01, PNorm = 46.9025, GNorm = 1.0072, lr_0 = 3.9783e-04
Validation prc-auc = 0.733289
Validation auc = 0.876965
Epoch 13
Loss = 3.1601e-01, PNorm = 46.9443, GNorm = 1.1756, lr_0 = 3.9108e-04
Loss = 3.4263e-01, PNorm = 47.0000, GNorm = 1.6558, lr_0 = 3.8443e-04
Loss = 3.2181e-01, PNorm = 47.0454, GNorm = 1.1379, lr_0 = 3.7790e-04
Loss = 3.4638e-01, PNorm = 47.0903, GNorm = 0.5573, lr_0 = 3.7148e-04
Loss = 2.6598e-01, PNorm = 47.1474, GNorm = 0.5607, lr_0 = 3.6517e-04
Validation prc-auc = 0.755855
Validation auc = 0.870643
Epoch 14
Loss = 3.0173e-01, PNorm = 47.2137, GNorm = 0.4501, lr_0 = 3.5897e-04
Loss = 3.1978e-01, PNorm = 47.2710, GNorm = 0.6179, lr_0 = 3.5287e-04
Loss = 3.2039e-01, PNorm = 47.3096, GNorm = 0.8371, lr_0 = 3.4688e-04
Loss = 2.7993e-01, PNorm = 47.3531, GNorm = 0.3893, lr_0 = 3.4099e-04
Loss = 2.8374e-01, PNorm = 47.4081, GNorm = 0.6317, lr_0 = 3.3520e-04
Validation prc-auc = 0.762023
Validation auc = 0.877877
Epoch 15
Loss = 2.5881e-01, PNorm = 47.4454, GNorm = 0.5568, lr_0 = 3.2950e-04
Loss = 3.1726e-01, PNorm = 47.4905, GNorm = 0.8263, lr_0 = 3.2390e-04
Loss = 2.6477e-01, PNorm = 47.5340, GNorm = 0.4637, lr_0 = 3.1840e-04
Loss = 2.9721e-01, PNorm = 47.5832, GNorm = 0.5615, lr_0 = 3.1299e-04
Loss = 2.8183e-01, PNorm = 47.6318, GNorm = 1.1613, lr_0 = 3.0768e-04
Loss = 1.5582e-01, PNorm = 47.6357, GNorm = 1.0052, lr_0 = 3.0715e-04
Validation prc-auc = 0.741079
Validation auc = 0.869503
Epoch 16
Loss = 2.6585e-01, PNorm = 47.6775, GNorm = 0.8763, lr_0 = 3.0193e-04
Loss = 2.9034e-01, PNorm = 47.7265, GNorm = 0.6342, lr_0 = 2.9680e-04
Loss = 2.7518e-01, PNorm = 47.7668, GNorm = 0.8373, lr_0 = 2.9176e-04
Loss = 2.8780e-01, PNorm = 47.8001, GNorm = 0.7792, lr_0 = 2.8681e-04
Validation prc-auc = 0.756924
Validation auc = 0.873946
Epoch 17
Loss = 3.2113e-01, PNorm = 47.8272, GNorm = 0.6363, lr_0 = 2.8193e-04
Loss = 2.7031e-01, PNorm = 47.8590, GNorm = 0.4461, lr_0 = 2.7715e-04
Loss = 2.4346e-01, PNorm = 47.9010, GNorm = 1.2853, lr_0 = 2.7244e-04
Loss = 2.6405e-01, PNorm = 47.9497, GNorm = 0.6732, lr_0 = 2.6781e-04
Loss = 2.8858e-01, PNorm = 47.9900, GNorm = 0.9567, lr_0 = 2.6326e-04
Validation prc-auc = 0.752531
Validation auc = 0.871953
Epoch 18
Loss = 1.8478e-01, PNorm = 48.0206, GNorm = 0.5131, lr_0 = 2.5879e-04
Loss = 2.7315e-01, PNorm = 48.0580, GNorm = 0.5272, lr_0 = 2.5439e-04
Loss = 2.4212e-01, PNorm = 48.0934, GNorm = 0.6953, lr_0 = 2.5007e-04
Loss = 2.7250e-01, PNorm = 48.1286, GNorm = 0.6449, lr_0 = 2.4582e-04
Loss = 2.6683e-01, PNorm = 48.1598, GNorm = 0.6842, lr_0 = 2.4165e-04
Validation prc-auc = 0.762164
Validation auc = 0.876339
Epoch 19
Loss = 2.8582e-01, PNorm = 48.1972, GNorm = 1.1282, lr_0 = 2.3754e-04
Loss = 2.7007e-01, PNorm = 48.2203, GNorm = 0.7657, lr_0 = 2.3351e-04
Loss = 2.6513e-01, PNorm = 48.2536, GNorm = 0.4471, lr_0 = 2.2954e-04
Loss = 2.3662e-01, PNorm = 48.2933, GNorm = 0.4974, lr_0 = 2.2564e-04
Loss = 2.5381e-01, PNorm = 48.3332, GNorm = 0.5583, lr_0 = 2.2181e-04
Validation prc-auc = 0.762482
Validation auc = 0.876680
Epoch 20
Loss = 2.1890e-01, PNorm = 48.3545, GNorm = 1.0384, lr_0 = 2.1804e-04
Loss = 2.5517e-01, PNorm = 48.3943, GNorm = 0.7890, lr_0 = 2.1434e-04
Loss = 2.3927e-01, PNorm = 48.4252, GNorm = 0.7905, lr_0 = 2.1070e-04
Loss = 2.7551e-01, PNorm = 48.4500, GNorm = 0.5517, lr_0 = 2.0712e-04
Loss = 2.5990e-01, PNorm = 48.4726, GNorm = 0.4153, lr_0 = 2.0360e-04
Validation prc-auc = 0.735161
Validation auc = 0.868193
Epoch 21
Loss = 2.3058e-01, PNorm = 48.4984, GNorm = 0.8494, lr_0 = 1.9980e-04
Loss = 2.3775e-01, PNorm = 48.5252, GNorm = 0.5050, lr_0 = 1.9641e-04
Loss = 2.4592e-01, PNorm = 48.5498, GNorm = 0.4235, lr_0 = 1.9307e-04
Loss = 2.5754e-01, PNorm = 48.5739, GNorm = 0.5552, lr_0 = 1.8979e-04
Loss = 2.1402e-01, PNorm = 48.5931, GNorm = 0.5846, lr_0 = 1.8657e-04
Validation prc-auc = 0.760946
Validation auc = 0.877820
Epoch 22
Loss = 2.0400e-01, PNorm = 48.6285, GNorm = 0.8763, lr_0 = 1.8340e-04
Loss = 2.2520e-01, PNorm = 48.6555, GNorm = 1.6144, lr_0 = 1.8028e-04
Loss = 2.6959e-01, PNorm = 48.6832, GNorm = 0.9038, lr_0 = 1.7722e-04
Loss = 2.7775e-01, PNorm = 48.6990, GNorm = 0.9209, lr_0 = 1.7421e-04
Loss = 2.3427e-01, PNorm = 48.7221, GNorm = 0.7882, lr_0 = 1.7125e-04
Validation prc-auc = 0.763189
Validation auc = 0.876680
Epoch 23
Loss = 2.1726e-01, PNorm = 48.7436, GNorm = 0.9432, lr_0 = 1.6834e-04
Loss = 2.5818e-01, PNorm = 48.7652, GNorm = 1.2052, lr_0 = 1.6548e-04
Loss = 2.3233e-01, PNorm = 48.7892, GNorm = 0.8238, lr_0 = 1.6267e-04
Loss = 2.3841e-01, PNorm = 48.8088, GNorm = 0.7978, lr_0 = 1.5991e-04
Loss = 2.4116e-01, PNorm = 48.8306, GNorm = 0.8894, lr_0 = 1.5719e-04
Validation prc-auc = 0.750366
Validation auc = 0.873946
Epoch 24
Loss = 2.5232e-01, PNorm = 48.8488, GNorm = 0.6704, lr_0 = 1.5452e-04
Loss = 2.2058e-01, PNorm = 48.8691, GNorm = 0.5515, lr_0 = 1.5190e-04
Loss = 1.7531e-01, PNorm = 48.8921, GNorm = 1.0424, lr_0 = 1.4932e-04
Loss = 2.5030e-01, PNorm = 48.9117, GNorm = 1.1901, lr_0 = 1.4678e-04
Loss = 2.3035e-01, PNorm = 48.9279, GNorm = 0.9854, lr_0 = 1.4429e-04
Validation prc-auc = 0.762339
Validation auc = 0.874573
Epoch 25
Loss = 2.0717e-01, PNorm = 48.9446, GNorm = 0.8401, lr_0 = 1.4184e-04
Loss = 2.2523e-01, PNorm = 48.9636, GNorm = 0.6762, lr_0 = 1.3943e-04
Loss = 2.2037e-01, PNorm = 48.9854, GNorm = 0.9163, lr_0 = 1.3706e-04
Loss = 2.3124e-01, PNorm = 49.0024, GNorm = 0.4962, lr_0 = 1.3473e-04
Validation prc-auc = 0.742945
Validation auc = 0.869275
Epoch 26
Loss = 2.9120e-01, PNorm = 49.0180, GNorm = 1.4575, lr_0 = 1.3221e-04
Loss = 2.0175e-01, PNorm = 49.0333, GNorm = 1.5658, lr_0 = 1.2997e-04
Loss = 2.1105e-01, PNorm = 49.0525, GNorm = 0.5736, lr_0 = 1.2776e-04
Loss = 2.2151e-01, PNorm = 49.0650, GNorm = 0.6246, lr_0 = 1.2559e-04
Loss = 2.5515e-01, PNorm = 49.0783, GNorm = 0.7639, lr_0 = 1.2346e-04
Validation prc-auc = 0.752242
Validation auc = 0.872408
Epoch 27
Loss = 2.0859e-01, PNorm = 49.0906, GNorm = 0.9411, lr_0 = 1.2136e-04
Loss = 1.8871e-01, PNorm = 49.1069, GNorm = 0.5075, lr_0 = 1.1930e-04
Loss = 1.9728e-01, PNorm = 49.1206, GNorm = 0.4701, lr_0 = 1.1727e-04
Loss = 2.4295e-01, PNorm = 49.1363, GNorm = 1.0434, lr_0 = 1.1528e-04
Loss = 2.3203e-01, PNorm = 49.1452, GNorm = 1.2550, lr_0 = 1.1332e-04
Validation prc-auc = 0.749224
Validation auc = 0.870358
Epoch 28
Loss = 2.1960e-01, PNorm = 49.1649, GNorm = 0.7942, lr_0 = 1.1140e-04
Loss = 2.0835e-01, PNorm = 49.1755, GNorm = 0.8367, lr_0 = 1.0951e-04
Loss = 2.1764e-01, PNorm = 49.1920, GNorm = 1.2688, lr_0 = 1.0765e-04
Loss = 1.8565e-01, PNorm = 49.2042, GNorm = 0.7157, lr_0 = 1.0582e-04
Loss = 2.3015e-01, PNorm = 49.2175, GNorm = 0.6588, lr_0 = 1.0402e-04
Validation prc-auc = 0.746954
Validation auc = 0.868991
Epoch 29
Loss = 2.3109e-01, PNorm = 49.2311, GNorm = 0.6070, lr_0 = 1.0225e-04
Loss = 1.7722e-01, PNorm = 49.2450, GNorm = 0.6452, lr_0 = 1.0052e-04
Loss = 2.0082e-01, PNorm = 49.2542, GNorm = 0.7703, lr_0 = 1.0000e-04
Loss = 1.9738e-01, PNorm = 49.2671, GNorm = 0.7706, lr_0 = 1.0000e-04
Loss = 2.2717e-01, PNorm = 49.2792, GNorm = 1.0448, lr_0 = 1.0000e-04
Validation prc-auc = 0.746472
Validation auc = 0.869275
Model 0 best validation prc-auc = 0.763189 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.780715
Model 0 test auc = 0.878505
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.4366e-01, PNorm = 43.2442, GNorm = 1.9928, lr_0 = 2.0312e-04
Loss = 6.0416e-01, PNorm = 43.2520, GNorm = 0.6402, lr_0 = 2.9687e-04
Loss = 5.7374e-01, PNorm = 43.2646, GNorm = 1.4656, lr_0 = 3.9062e-04
Loss = 5.4299e-01, PNorm = 43.2852, GNorm = 0.6531, lr_0 = 4.8437e-04
Validation prc-auc = 0.690603
Validation auc = 0.859250
Epoch 1
Loss = 5.2182e-01, PNorm = 43.3132, GNorm = 0.9177, lr_0 = 5.8750e-04
Loss = 4.7637e-01, PNorm = 43.3453, GNorm = 1.2341, lr_0 = 6.8125e-04
Loss = 5.0551e-01, PNorm = 43.3791, GNorm = 1.1501, lr_0 = 7.7500e-04
Loss = 4.1817e-01, PNorm = 43.4238, GNorm = 0.4708, lr_0 = 8.6875e-04
Loss = 4.5916e-01, PNorm = 43.4695, GNorm = 0.5112, lr_0 = 9.6250e-04
Validation prc-auc = 0.706199
Validation auc = 0.866370
Epoch 2
Loss = 4.1959e-01, PNorm = 43.5155, GNorm = 0.6710, lr_0 = 9.8977e-04
Loss = 4.3768e-01, PNorm = 43.5594, GNorm = 0.4212, lr_0 = 9.7296e-04
Loss = 4.0951e-01, PNorm = 43.6085, GNorm = 0.4305, lr_0 = 9.5643e-04
Loss = 4.4978e-01, PNorm = 43.6474, GNorm = 0.4213, lr_0 = 9.4019e-04
Loss = 4.4964e-01, PNorm = 43.6812, GNorm = 0.4715, lr_0 = 9.2422e-04
Validation prc-auc = 0.729731
Validation auc = 0.873832
Epoch 3
Loss = 3.5107e-01, PNorm = 43.7184, GNorm = 0.4939, lr_0 = 9.0852e-04
Loss = 4.9625e-01, PNorm = 43.7672, GNorm = 0.5350, lr_0 = 8.9309e-04
Loss = 4.2151e-01, PNorm = 43.8038, GNorm = 0.5619, lr_0 = 8.7791e-04
Loss = 4.0977e-01, PNorm = 43.8494, GNorm = 0.4647, lr_0 = 8.6300e-04
Loss = 3.6410e-01, PNorm = 43.9015, GNorm = 0.4680, lr_0 = 8.4834e-04
Validation prc-auc = 0.736984
Validation auc = 0.872579
Epoch 4
Loss = 3.5476e-01, PNorm = 43.9527, GNorm = 0.3670, lr_0 = 8.3393e-04
Loss = 3.9198e-01, PNorm = 44.0078, GNorm = 0.4187, lr_0 = 8.1977e-04
Loss = 3.9940e-01, PNorm = 44.0530, GNorm = 0.4283, lr_0 = 8.0584e-04
Loss = 4.0269e-01, PNorm = 44.1073, GNorm = 0.5136, lr_0 = 7.9215e-04
Loss = 4.2215e-01, PNorm = 44.1656, GNorm = 1.2245, lr_0 = 7.7870e-04
Validation prc-auc = 0.737296
Validation auc = 0.875484
Epoch 5
Loss = 4.1913e-01, PNorm = 44.2302, GNorm = 0.3655, lr_0 = 7.6547e-04
Loss = 3.8477e-01, PNorm = 44.2897, GNorm = 0.8526, lr_0 = 7.5247e-04
Loss = 3.9238e-01, PNorm = 44.3583, GNorm = 0.4823, lr_0 = 7.3969e-04
Loss = 3.8210e-01, PNorm = 44.4263, GNorm = 0.4747, lr_0 = 7.2712e-04
Loss = 3.6851e-01, PNorm = 44.5019, GNorm = 0.8659, lr_0 = 7.1477e-04
Validation prc-auc = 0.750002
Validation auc = 0.882775
Epoch 6
Loss = 3.9400e-01, PNorm = 44.5796, GNorm = 0.3699, lr_0 = 7.0143e-04
Loss = 3.7148e-01, PNorm = 44.6688, GNorm = 0.4985, lr_0 = 6.8951e-04
Loss = 4.0490e-01, PNorm = 44.7233, GNorm = 0.7098, lr_0 = 6.7780e-04
Loss = 4.0726e-01, PNorm = 44.7807, GNorm = 0.7177, lr_0 = 6.6629e-04
Loss = 3.7058e-01, PNorm = 44.8326, GNorm = 0.5048, lr_0 = 6.5497e-04
Validation prc-auc = 0.733970
Validation auc = 0.875199
Epoch 7
Loss = 3.8076e-01, PNorm = 44.8941, GNorm = 0.3446, lr_0 = 6.4384e-04
Loss = 3.3981e-01, PNorm = 44.9586, GNorm = 0.4640, lr_0 = 6.3291e-04
Loss = 4.0620e-01, PNorm = 45.0255, GNorm = 0.5572, lr_0 = 6.2216e-04
Loss = 3.7567e-01, PNorm = 45.0752, GNorm = 0.5824, lr_0 = 6.1159e-04
Loss = 3.5193e-01, PNorm = 45.1269, GNorm = 0.5052, lr_0 = 6.0120e-04
Validation prc-auc = 0.750881
Validation auc = 0.874915
Epoch 8
Loss = 3.8756e-01, PNorm = 45.2005, GNorm = 0.8735, lr_0 = 5.9099e-04
Loss = 3.5654e-01, PNorm = 45.2760, GNorm = 0.6358, lr_0 = 5.8095e-04
Loss = 3.3531e-01, PNorm = 45.3590, GNorm = 0.6351, lr_0 = 5.7108e-04
Loss = 3.6900e-01, PNorm = 45.4155, GNorm = 0.6186, lr_0 = 5.6138e-04
Validation prc-auc = 0.751715
Validation auc = 0.875370
Epoch 9
Loss = 3.5559e-01, PNorm = 45.4585, GNorm = 1.0743, lr_0 = 5.5184e-04
Loss = 3.3485e-01, PNorm = 45.5113, GNorm = 0.4849, lr_0 = 5.4247e-04
Loss = 3.5669e-01, PNorm = 45.5721, GNorm = 0.7678, lr_0 = 5.3325e-04
Loss = 3.5718e-01, PNorm = 45.6453, GNorm = 0.7853, lr_0 = 5.2420e-04
Loss = 3.5698e-01, PNorm = 45.7058, GNorm = 0.4724, lr_0 = 5.1529e-04
Validation prc-auc = 0.755325
Validation auc = 0.880611
Epoch 10
Loss = 4.2590e-01, PNorm = 45.7665, GNorm = 0.6647, lr_0 = 5.0654e-04
Loss = 3.4117e-01, PNorm = 45.8159, GNorm = 0.3426, lr_0 = 4.9793e-04
Loss = 3.7056e-01, PNorm = 45.8738, GNorm = 0.9966, lr_0 = 4.8948e-04
Loss = 3.3466e-01, PNorm = 45.9436, GNorm = 0.7071, lr_0 = 4.8116e-04
Loss = 3.1273e-01, PNorm = 46.0278, GNorm = 0.5168, lr_0 = 4.7299e-04
Validation prc-auc = 0.756446
Validation auc = 0.878332
Epoch 11
Loss = 2.9730e-01, PNorm = 46.0910, GNorm = 0.8244, lr_0 = 4.6416e-04
Loss = 2.8551e-01, PNorm = 46.1488, GNorm = 0.7840, lr_0 = 4.5627e-04
Loss = 3.4621e-01, PNorm = 46.2014, GNorm = 0.4484, lr_0 = 4.4852e-04
Loss = 3.6047e-01, PNorm = 46.2748, GNorm = 0.7015, lr_0 = 4.4091e-04
Loss = 3.7773e-01, PNorm = 46.3203, GNorm = 0.6865, lr_0 = 4.3342e-04
Validation prc-auc = 0.759220
Validation auc = 0.881009
Epoch 12
Loss = 3.5484e-01, PNorm = 46.3744, GNorm = 1.1919, lr_0 = 4.2605e-04
Loss = 2.7468e-01, PNorm = 46.4439, GNorm = 0.3919, lr_0 = 4.1882e-04
Loss = 2.9408e-01, PNorm = 46.5142, GNorm = 0.4938, lr_0 = 4.1170e-04
Loss = 3.0958e-01, PNorm = 46.5799, GNorm = 0.4878, lr_0 = 4.0471e-04
Loss = 3.6739e-01, PNorm = 46.6209, GNorm = 0.9001, lr_0 = 3.9783e-04
Validation prc-auc = 0.762122
Validation auc = 0.876965
Epoch 13
Loss = 3.1968e-01, PNorm = 46.6680, GNorm = 0.6293, lr_0 = 3.9108e-04
Loss = 3.0860e-01, PNorm = 46.7304, GNorm = 0.8197, lr_0 = 3.8443e-04
Loss = 3.0816e-01, PNorm = 46.7979, GNorm = 0.8117, lr_0 = 3.7790e-04
Loss = 3.1044e-01, PNorm = 46.8422, GNorm = 0.7828, lr_0 = 3.7148e-04
Loss = 3.1315e-01, PNorm = 46.8897, GNorm = 0.5349, lr_0 = 3.6517e-04
Validation prc-auc = 0.761305
Validation auc = 0.883914
Epoch 14
Loss = 2.8341e-01, PNorm = 46.9449, GNorm = 0.7387, lr_0 = 3.5897e-04
Loss = 3.0976e-01, PNorm = 46.9902, GNorm = 0.4985, lr_0 = 3.5287e-04
Loss = 2.8016e-01, PNorm = 47.0362, GNorm = 0.6211, lr_0 = 3.4688e-04
Loss = 3.2458e-01, PNorm = 47.0820, GNorm = 0.8299, lr_0 = 3.4099e-04
Loss = 3.0532e-01, PNorm = 47.1377, GNorm = 0.6896, lr_0 = 3.3520e-04
Validation prc-auc = 0.766633
Validation auc = 0.872294
Epoch 15
Loss = 2.4730e-01, PNorm = 47.2008, GNorm = 0.4124, lr_0 = 3.2950e-04
Loss = 3.3163e-01, PNorm = 47.2407, GNorm = 0.5132, lr_0 = 3.2390e-04
Loss = 2.9311e-01, PNorm = 47.2830, GNorm = 0.5760, lr_0 = 3.1840e-04
Loss = 2.7008e-01, PNorm = 47.3321, GNorm = 0.5038, lr_0 = 3.1299e-04
Loss = 3.1710e-01, PNorm = 47.3824, GNorm = 0.9225, lr_0 = 3.0768e-04
Loss = 2.0969e-01, PNorm = 47.3863, GNorm = 0.6909, lr_0 = 3.0715e-04
Validation prc-auc = 0.765877
Validation auc = 0.878104
Epoch 16
Loss = 2.8514e-01, PNorm = 47.4336, GNorm = 0.6955, lr_0 = 3.0193e-04
Loss = 2.4166e-01, PNorm = 47.4869, GNorm = 0.9362, lr_0 = 2.9680e-04
Loss = 2.6769e-01, PNorm = 47.5402, GNorm = 0.5900, lr_0 = 2.9176e-04
Loss = 2.7042e-01, PNorm = 47.5765, GNorm = 0.6017, lr_0 = 2.8681e-04
Validation prc-auc = 0.763195
Validation auc = 0.874231
Epoch 17
Loss = 2.9301e-01, PNorm = 47.6156, GNorm = 0.8697, lr_0 = 2.8193e-04
Loss = 2.0640e-01, PNorm = 47.6641, GNorm = 0.5879, lr_0 = 2.7715e-04
Loss = 3.1022e-01, PNorm = 47.7045, GNorm = 0.6675, lr_0 = 2.7244e-04
Loss = 2.8742e-01, PNorm = 47.7512, GNorm = 0.6802, lr_0 = 2.6781e-04
Loss = 2.6549e-01, PNorm = 47.7900, GNorm = 0.7350, lr_0 = 2.6326e-04
Validation prc-auc = 0.755495
Validation auc = 0.879414
Epoch 18
Loss = 2.0352e-01, PNorm = 47.8258, GNorm = 0.5658, lr_0 = 2.5879e-04
Loss = 2.6021e-01, PNorm = 47.8665, GNorm = 1.2277, lr_0 = 2.5439e-04
Loss = 2.4339e-01, PNorm = 47.8995, GNorm = 0.4888, lr_0 = 2.5007e-04
Loss = 3.1298e-01, PNorm = 47.9403, GNorm = 1.6025, lr_0 = 2.4582e-04
Loss = 2.8213e-01, PNorm = 47.9739, GNorm = 0.4437, lr_0 = 2.4165e-04
Validation prc-auc = 0.759055
Validation auc = 0.875085
Epoch 19
Loss = 2.0044e-01, PNorm = 48.0082, GNorm = 1.0932, lr_0 = 2.3754e-04
Loss = 2.9973e-01, PNorm = 48.0410, GNorm = 1.1289, lr_0 = 2.3351e-04
Loss = 3.0598e-01, PNorm = 48.0747, GNorm = 0.5800, lr_0 = 2.2954e-04
Loss = 2.7029e-01, PNorm = 48.1092, GNorm = 0.5581, lr_0 = 2.2564e-04
Loss = 2.4745e-01, PNorm = 48.1389, GNorm = 0.5560, lr_0 = 2.2181e-04
Validation prc-auc = 0.756745
Validation auc = 0.880155
Epoch 20
Loss = 2.2982e-01, PNorm = 48.1764, GNorm = 0.9784, lr_0 = 2.1804e-04
Loss = 2.5886e-01, PNorm = 48.2088, GNorm = 0.5721, lr_0 = 2.1434e-04
Loss = 2.2411e-01, PNorm = 48.2380, GNorm = 0.5241, lr_0 = 2.1070e-04
Loss = 2.7604e-01, PNorm = 48.2678, GNorm = 1.2818, lr_0 = 2.0712e-04
Loss = 2.3141e-01, PNorm = 48.2970, GNorm = 0.7295, lr_0 = 2.0360e-04
Validation prc-auc = 0.752032
Validation auc = 0.880725
Epoch 21
Loss = 2.4153e-01, PNorm = 48.3294, GNorm = 0.6328, lr_0 = 1.9980e-04
Loss = 2.6130e-01, PNorm = 48.3579, GNorm = 1.0556, lr_0 = 1.9641e-04
Loss = 2.3096e-01, PNorm = 48.3825, GNorm = 0.5968, lr_0 = 1.9307e-04
Loss = 2.0752e-01, PNorm = 48.4123, GNorm = 0.5649, lr_0 = 1.8979e-04
Loss = 2.5240e-01, PNorm = 48.4389, GNorm = 1.3335, lr_0 = 1.8657e-04
Validation prc-auc = 0.759371
Validation auc = 0.877421
Epoch 22
Loss = 2.1776e-01, PNorm = 48.4691, GNorm = 0.7496, lr_0 = 1.8340e-04
Loss = 2.3421e-01, PNorm = 48.5025, GNorm = 1.7566, lr_0 = 1.8028e-04
Loss = 2.8008e-01, PNorm = 48.5209, GNorm = 0.7083, lr_0 = 1.7722e-04
Loss = 2.4890e-01, PNorm = 48.5394, GNorm = 0.7684, lr_0 = 1.7421e-04
Loss = 2.3174e-01, PNorm = 48.5626, GNorm = 0.4765, lr_0 = 1.7125e-04
Validation prc-auc = 0.764383
Validation auc = 0.876908
Epoch 23
Loss = 2.2260e-01, PNorm = 48.5884, GNorm = 0.8561, lr_0 = 1.6834e-04
Loss = 2.5204e-01, PNorm = 48.6054, GNorm = 0.5835, lr_0 = 1.6548e-04
Loss = 2.2296e-01, PNorm = 48.6281, GNorm = 0.4506, lr_0 = 1.6267e-04
Loss = 2.4560e-01, PNorm = 48.6563, GNorm = 0.8348, lr_0 = 1.5991e-04
Loss = 2.2560e-01, PNorm = 48.6729, GNorm = 0.7752, lr_0 = 1.5719e-04
Validation prc-auc = 0.760274
Validation auc = 0.878902
Epoch 24
Loss = 2.3503e-01, PNorm = 48.6968, GNorm = 0.7144, lr_0 = 1.5452e-04
Loss = 2.4830e-01, PNorm = 48.7132, GNorm = 0.8713, lr_0 = 1.5190e-04
Loss = 2.3496e-01, PNorm = 48.7351, GNorm = 0.6641, lr_0 = 1.4932e-04
Loss = 2.3812e-01, PNorm = 48.7525, GNorm = 0.9826, lr_0 = 1.4678e-04
Loss = 1.9978e-01, PNorm = 48.7776, GNorm = 0.5353, lr_0 = 1.4429e-04
Validation prc-auc = 0.761099
Validation auc = 0.880440
Epoch 25
Loss = 1.9593e-01, PNorm = 48.7985, GNorm = 0.9763, lr_0 = 1.4184e-04
Loss = 2.2264e-01, PNorm = 48.8164, GNorm = 0.5538, lr_0 = 1.3943e-04
Loss = 2.2193e-01, PNorm = 48.8344, GNorm = 0.7406, lr_0 = 1.3706e-04
Loss = 2.3203e-01, PNorm = 48.8496, GNorm = 0.8558, lr_0 = 1.3473e-04
Validation prc-auc = 0.763478
Validation auc = 0.876111
Epoch 26
Loss = 2.3427e-01, PNorm = 48.8710, GNorm = 0.7124, lr_0 = 1.3221e-04
Loss = 2.0699e-01, PNorm = 48.8900, GNorm = 0.5961, lr_0 = 1.2997e-04
Loss = 2.0229e-01, PNorm = 48.9093, GNorm = 1.0661, lr_0 = 1.2776e-04
Loss = 2.1875e-01, PNorm = 48.9238, GNorm = 0.5427, lr_0 = 1.2559e-04
Loss = 2.5200e-01, PNorm = 48.9439, GNorm = 0.9333, lr_0 = 1.2346e-04
Validation prc-auc = 0.760208
Validation auc = 0.871782
Epoch 27
Loss = 2.4024e-01, PNorm = 48.9565, GNorm = 0.7085, lr_0 = 1.2136e-04
Loss = 1.9530e-01, PNorm = 48.9761, GNorm = 0.4933, lr_0 = 1.1930e-04
Loss = 2.0403e-01, PNorm = 48.9939, GNorm = 1.5440, lr_0 = 1.1727e-04
Loss = 2.3201e-01, PNorm = 49.0102, GNorm = 0.8081, lr_0 = 1.1528e-04
Loss = 2.0468e-01, PNorm = 49.0254, GNorm = 1.1411, lr_0 = 1.1332e-04
Validation prc-auc = 0.764027
Validation auc = 0.874744
Epoch 28
Loss = 2.0619e-01, PNorm = 49.0372, GNorm = 0.8782, lr_0 = 1.1140e-04
Loss = 2.1581e-01, PNorm = 49.0530, GNorm = 0.6658, lr_0 = 1.0951e-04
Loss = 1.9132e-01, PNorm = 49.0685, GNorm = 1.0205, lr_0 = 1.0765e-04
Loss = 2.1794e-01, PNorm = 49.0839, GNorm = 0.6189, lr_0 = 1.0582e-04
Loss = 2.1095e-01, PNorm = 49.0949, GNorm = 1.1211, lr_0 = 1.0402e-04
Validation prc-auc = 0.753232
Validation auc = 0.875484
Epoch 29
Loss = 1.9457e-01, PNorm = 49.1073, GNorm = 0.7573, lr_0 = 1.0225e-04
Loss = 2.1111e-01, PNorm = 49.1171, GNorm = 0.9370, lr_0 = 1.0052e-04
Loss = 2.0019e-01, PNorm = 49.1308, GNorm = 0.8426, lr_0 = 1.0000e-04
Loss = 2.0333e-01, PNorm = 49.1426, GNorm = 0.4429, lr_0 = 1.0000e-04
Loss = 1.7510e-01, PNorm = 49.1549, GNorm = 0.7718, lr_0 = 1.0000e-04
Validation prc-auc = 0.750743
Validation auc = 0.873604
Model 1 best validation prc-auc = 0.766633 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.834517
Model 1 test auc = 0.895177
Ensemble test prc-auc = 0.828984
Ensemble test auc = 0.893486
Fold 4
Splitting data with seed 4
Total scaffolds = 1,723 | train scaffolds = 1,399 | val scaffolds = 157 | test scaffolds = 167
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 92 | target average = 0.565217


Scaffold 1
Task 0: count = 51 | target average = 0.470588


Scaffold 2
Task 0: count = 19 | target average = 0.000000


Scaffold 3
Task 0: count = 18 | target average = 0.000000


Scaffold 4
Task 0: count = 17 | target average = 0.000000


Scaffold 5
Task 0: count = 15 | target average = 0.000000


Scaffold 6
Task 0: count = 15 | target average = 0.400000


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 11 | target average = 0.000000


Scaffold 9
Task 0: count = 11 | target average = 0.636364


Class sizes
hit 0: 66.67%, 1: 33.33%
Total size = 3,051 | train size = 2,440 | val size = 305 | test size = 306
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.6116e-01, PNorm = 43.2185, GNorm = 1.3772, lr_0 = 2.0312e-04
Loss = 5.8437e-01, PNorm = 43.2249, GNorm = 1.6071, lr_0 = 2.9687e-04
Loss = 5.4760e-01, PNorm = 43.2403, GNorm = 0.7164, lr_0 = 3.9062e-04
Loss = 5.0593e-01, PNorm = 43.2617, GNorm = 0.5790, lr_0 = 4.8437e-04
Validation prc-auc = 0.732887
Validation auc = 0.841619
Epoch 1
Loss = 4.5091e-01, PNorm = 43.2871, GNorm = 1.0267, lr_0 = 5.8750e-04
Loss = 4.3553e-01, PNorm = 43.3189, GNorm = 0.9260, lr_0 = 6.8125e-04
Loss = 4.6056e-01, PNorm = 43.3564, GNorm = 0.9672, lr_0 = 7.7500e-04
Loss = 4.3555e-01, PNorm = 43.4040, GNorm = 0.5570, lr_0 = 8.6875e-04
Loss = 4.2211e-01, PNorm = 43.4523, GNorm = 0.9861, lr_0 = 9.6250e-04
Validation prc-auc = 0.735039
Validation auc = 0.846905
Epoch 2
Loss = 3.7320e-01, PNorm = 43.5007, GNorm = 0.4136, lr_0 = 9.8977e-04
Loss = 4.3058e-01, PNorm = 43.5480, GNorm = 0.7271, lr_0 = 9.7296e-04
Loss = 3.9038e-01, PNorm = 43.6006, GNorm = 0.4434, lr_0 = 9.5643e-04
Loss = 4.3779e-01, PNorm = 43.6547, GNorm = 0.5118, lr_0 = 9.4019e-04
Loss = 4.2286e-01, PNorm = 43.7246, GNorm = 1.8104, lr_0 = 9.2422e-04
Validation prc-auc = 0.719525
Validation auc = 0.847571
Epoch 3
Loss = 3.4625e-01, PNorm = 43.7959, GNorm = 1.2864, lr_0 = 9.0852e-04
Loss = 4.3768e-01, PNorm = 43.8578, GNorm = 0.9840, lr_0 = 8.9309e-04
Loss = 3.9284e-01, PNorm = 43.9141, GNorm = 0.4003, lr_0 = 8.7791e-04
Loss = 3.7924e-01, PNorm = 43.9816, GNorm = 0.5476, lr_0 = 8.6300e-04
Loss = 4.3698e-01, PNorm = 44.0288, GNorm = 1.1534, lr_0 = 8.4834e-04
Validation prc-auc = 0.764500
Validation auc = 0.867190
Epoch 4
Loss = 3.7069e-01, PNorm = 44.0767, GNorm = 0.9608, lr_0 = 8.3393e-04
Loss = 4.1199e-01, PNorm = 44.1302, GNorm = 0.3478, lr_0 = 8.1977e-04
Loss = 3.9018e-01, PNorm = 44.1849, GNorm = 0.9635, lr_0 = 8.0584e-04
Loss = 3.9487e-01, PNorm = 44.2382, GNorm = 0.8547, lr_0 = 7.9215e-04
Loss = 3.6343e-01, PNorm = 44.2954, GNorm = 0.4951, lr_0 = 7.7870e-04
Validation prc-auc = 0.761403
Validation auc = 0.867381
Epoch 5
Loss = 3.6048e-01, PNorm = 44.3549, GNorm = 0.5306, lr_0 = 7.6547e-04
Loss = 4.2152e-01, PNorm = 44.4159, GNorm = 0.5957, lr_0 = 7.5247e-04
Loss = 3.3741e-01, PNorm = 44.4754, GNorm = 0.5662, lr_0 = 7.3969e-04
Loss = 3.8310e-01, PNorm = 44.5373, GNorm = 0.6567, lr_0 = 7.2712e-04
Loss = 3.7316e-01, PNorm = 44.5931, GNorm = 0.6201, lr_0 = 7.1477e-04
Validation prc-auc = 0.763797
Validation auc = 0.870238
Epoch 6
Loss = 3.8819e-01, PNorm = 44.6611, GNorm = 0.5191, lr_0 = 7.0143e-04
Loss = 3.8365e-01, PNorm = 44.7307, GNorm = 0.3665, lr_0 = 6.8951e-04
Loss = 3.5699e-01, PNorm = 44.8021, GNorm = 0.4080, lr_0 = 6.7780e-04
Loss = 3.3366e-01, PNorm = 44.8669, GNorm = 0.4365, lr_0 = 6.6629e-04
Loss = 3.5801e-01, PNorm = 44.9344, GNorm = 0.5965, lr_0 = 6.5497e-04
Validation prc-auc = 0.772828
Validation auc = 0.860333
Epoch 7
Loss = 3.3384e-01, PNorm = 44.9943, GNorm = 0.6215, lr_0 = 6.4384e-04
Loss = 3.9156e-01, PNorm = 45.0457, GNorm = 1.0951, lr_0 = 6.3291e-04
Loss = 3.5462e-01, PNorm = 45.1081, GNorm = 0.8621, lr_0 = 6.2216e-04
Loss = 3.6522e-01, PNorm = 45.1678, GNorm = 0.5187, lr_0 = 6.1159e-04
Loss = 3.3328e-01, PNorm = 45.2258, GNorm = 0.5959, lr_0 = 6.0120e-04
Validation prc-auc = 0.782207
Validation auc = 0.876143
Epoch 8
Loss = 3.2020e-01, PNorm = 45.3045, GNorm = 0.8686, lr_0 = 5.9099e-04
Loss = 3.7099e-01, PNorm = 45.3738, GNorm = 0.3737, lr_0 = 5.8095e-04
Loss = 3.4633e-01, PNorm = 45.4426, GNorm = 0.5256, lr_0 = 5.7108e-04
Loss = 3.4751e-01, PNorm = 45.5031, GNorm = 0.6506, lr_0 = 5.6138e-04
Validation prc-auc = 0.774252
Validation auc = 0.863381
Epoch 9
Loss = 3.8433e-01, PNorm = 45.5735, GNorm = 0.9781, lr_0 = 5.5184e-04
Loss = 3.5143e-01, PNorm = 45.6373, GNorm = 0.5421, lr_0 = 5.4247e-04
Loss = 3.1439e-01, PNorm = 45.6976, GNorm = 0.8374, lr_0 = 5.3325e-04
Loss = 3.6902e-01, PNorm = 45.7679, GNorm = 0.4684, lr_0 = 5.2420e-04
Loss = 3.1579e-01, PNorm = 45.8447, GNorm = 0.5866, lr_0 = 5.1529e-04
Validation prc-auc = 0.757916
Validation auc = 0.867190
Epoch 10
Loss = 3.6069e-01, PNorm = 45.8999, GNorm = 0.5459, lr_0 = 5.0654e-04
Loss = 3.0543e-01, PNorm = 45.9806, GNorm = 0.5003, lr_0 = 4.9793e-04
Loss = 3.1013e-01, PNorm = 46.0577, GNorm = 0.7174, lr_0 = 4.8948e-04
Loss = 3.6145e-01, PNorm = 46.1049, GNorm = 0.5503, lr_0 = 4.8116e-04
Loss = 3.1795e-01, PNorm = 46.1470, GNorm = 0.5379, lr_0 = 4.7299e-04
Validation prc-auc = 0.761902
Validation auc = 0.870190
Epoch 11
Loss = 3.1947e-01, PNorm = 46.2057, GNorm = 0.4264, lr_0 = 4.6416e-04
Loss = 2.8480e-01, PNorm = 46.2880, GNorm = 0.9078, lr_0 = 4.5627e-04
Loss = 3.0899e-01, PNorm = 46.3541, GNorm = 0.7153, lr_0 = 4.4852e-04
Loss = 3.5458e-01, PNorm = 46.3950, GNorm = 1.1129, lr_0 = 4.4091e-04
Loss = 3.4916e-01, PNorm = 46.4365, GNorm = 0.5466, lr_0 = 4.3342e-04
Validation prc-auc = 0.777284
Validation auc = 0.871667
Epoch 12
Loss = 3.1524e-01, PNorm = 46.4873, GNorm = 0.4802, lr_0 = 4.2605e-04
Loss = 2.8631e-01, PNorm = 46.5492, GNorm = 0.5711, lr_0 = 4.1882e-04
Loss = 3.0448e-01, PNorm = 46.6106, GNorm = 0.4561, lr_0 = 4.1170e-04
Loss = 3.0536e-01, PNorm = 46.6777, GNorm = 0.4537, lr_0 = 4.0471e-04
Loss = 3.2704e-01, PNorm = 46.7286, GNorm = 1.2772, lr_0 = 3.9783e-04
Validation prc-auc = 0.746130
Validation auc = 0.862000
Epoch 13
Loss = 3.3836e-01, PNorm = 46.7946, GNorm = 0.4530, lr_0 = 3.9108e-04
Loss = 3.0639e-01, PNorm = 46.8550, GNorm = 0.8449, lr_0 = 3.8443e-04
Loss = 2.8619e-01, PNorm = 46.9162, GNorm = 0.3941, lr_0 = 3.7790e-04
Loss = 2.7731e-01, PNorm = 46.9638, GNorm = 0.3269, lr_0 = 3.7148e-04
Loss = 3.0116e-01, PNorm = 47.0079, GNorm = 0.9689, lr_0 = 3.6517e-04
Validation prc-auc = 0.764583
Validation auc = 0.868286
Epoch 14
Loss = 2.5894e-01, PNorm = 47.0482, GNorm = 0.4127, lr_0 = 3.5897e-04
Loss = 3.1321e-01, PNorm = 47.0923, GNorm = 0.6164, lr_0 = 3.5287e-04
Loss = 2.7712e-01, PNorm = 47.1465, GNorm = 0.3889, lr_0 = 3.4688e-04
Loss = 2.8957e-01, PNorm = 47.2038, GNorm = 0.5954, lr_0 = 3.4099e-04
Loss = 2.4908e-01, PNorm = 47.2579, GNorm = 0.5164, lr_0 = 3.3520e-04
Validation prc-auc = 0.753472
Validation auc = 0.868381
Epoch 15
Loss = 2.8326e-01, PNorm = 47.3067, GNorm = 0.4513, lr_0 = 3.2950e-04
Loss = 2.5215e-01, PNorm = 47.3578, GNorm = 0.6605, lr_0 = 3.2390e-04
Loss = 2.8188e-01, PNorm = 47.4094, GNorm = 0.7302, lr_0 = 3.1840e-04
Loss = 3.0886e-01, PNorm = 47.4403, GNorm = 1.0203, lr_0 = 3.1299e-04
Loss = 2.7969e-01, PNorm = 47.4870, GNorm = 0.5847, lr_0 = 3.0768e-04
Loss = 3.0098e-01, PNorm = 47.4920, GNorm = 0.6031, lr_0 = 3.0715e-04
Validation prc-auc = 0.776979
Validation auc = 0.873524
Epoch 16
Loss = 2.8747e-01, PNorm = 47.5380, GNorm = 0.6449, lr_0 = 3.0193e-04
Loss = 2.4794e-01, PNorm = 47.5930, GNorm = 0.5145, lr_0 = 2.9680e-04
Loss = 2.4870e-01, PNorm = 47.6438, GNorm = 0.8621, lr_0 = 2.9176e-04
Loss = 2.4773e-01, PNorm = 47.6898, GNorm = 0.6049, lr_0 = 2.8681e-04
Validation prc-auc = 0.784029
Validation auc = 0.875524
Epoch 17
Loss = 2.5871e-01, PNorm = 47.7222, GNorm = 0.7134, lr_0 = 2.8193e-04
Loss = 2.6329e-01, PNorm = 47.7633, GNorm = 0.8203, lr_0 = 2.7715e-04
Loss = 2.4569e-01, PNorm = 47.8101, GNorm = 0.4591, lr_0 = 2.7244e-04
Loss = 2.5225e-01, PNorm = 47.8513, GNorm = 0.4384, lr_0 = 2.6781e-04
Loss = 2.6686e-01, PNorm = 47.8854, GNorm = 1.1378, lr_0 = 2.6326e-04
Validation prc-auc = 0.785700
Validation auc = 0.873619
Epoch 18
Loss = 2.7752e-01, PNorm = 47.9164, GNorm = 0.6480, lr_0 = 2.5879e-04
Loss = 2.5164e-01, PNorm = 47.9531, GNorm = 0.5637, lr_0 = 2.5439e-04
Loss = 2.1790e-01, PNorm = 47.9980, GNorm = 0.8539, lr_0 = 2.5007e-04
Loss = 2.5312e-01, PNorm = 48.0318, GNorm = 0.5150, lr_0 = 2.4582e-04
Loss = 2.6524e-01, PNorm = 48.0683, GNorm = 1.2836, lr_0 = 2.4165e-04
Validation prc-auc = 0.811699
Validation auc = 0.883810
Epoch 19
Loss = 2.2285e-01, PNorm = 48.0889, GNorm = 0.5956, lr_0 = 2.3754e-04
Loss = 2.4216e-01, PNorm = 48.1230, GNorm = 1.0120, lr_0 = 2.3351e-04
Loss = 2.5451e-01, PNorm = 48.1535, GNorm = 0.8697, lr_0 = 2.2954e-04
Loss = 2.4196e-01, PNorm = 48.1834, GNorm = 0.8358, lr_0 = 2.2564e-04
Loss = 2.6040e-01, PNorm = 48.2110, GNorm = 0.7859, lr_0 = 2.2181e-04
Validation prc-auc = 0.809819
Validation auc = 0.884714
Epoch 20
Loss = 1.8990e-01, PNorm = 48.2421, GNorm = 0.8998, lr_0 = 2.1804e-04
Loss = 2.1422e-01, PNorm = 48.2798, GNorm = 0.5148, lr_0 = 2.1434e-04
Loss = 2.5287e-01, PNorm = 48.3055, GNorm = 0.4744, lr_0 = 2.1070e-04
Loss = 2.8035e-01, PNorm = 48.3359, GNorm = 1.3629, lr_0 = 2.0712e-04
Loss = 2.5055e-01, PNorm = 48.3603, GNorm = 0.5188, lr_0 = 2.0360e-04
Validation prc-auc = 0.804237
Validation auc = 0.881476
Epoch 21
Loss = 2.3391e-01, PNorm = 48.3930, GNorm = 0.7153, lr_0 = 1.9980e-04
Loss = 2.0821e-01, PNorm = 48.4261, GNorm = 1.0491, lr_0 = 1.9641e-04
Loss = 2.4516e-01, PNorm = 48.4545, GNorm = 0.5220, lr_0 = 1.9307e-04
Loss = 2.4246e-01, PNorm = 48.4799, GNorm = 0.6206, lr_0 = 1.8979e-04
Loss = 2.2690e-01, PNorm = 48.5027, GNorm = 0.6237, lr_0 = 1.8657e-04
Validation prc-auc = 0.810513
Validation auc = 0.884095
Epoch 22
Loss = 2.4767e-01, PNorm = 48.5278, GNorm = 0.5632, lr_0 = 1.8340e-04
Loss = 2.2172e-01, PNorm = 48.5576, GNorm = 1.0966, lr_0 = 1.8028e-04
Loss = 1.9817e-01, PNorm = 48.5844, GNorm = 0.9497, lr_0 = 1.7722e-04
Loss = 2.0945e-01, PNorm = 48.6068, GNorm = 0.7671, lr_0 = 1.7421e-04
Loss = 2.3882e-01, PNorm = 48.6273, GNorm = 0.8177, lr_0 = 1.7125e-04
Validation prc-auc = 0.825327
Validation auc = 0.891476
Epoch 23
Loss = 2.3284e-01, PNorm = 48.6427, GNorm = 0.6118, lr_0 = 1.6834e-04
Loss = 2.5124e-01, PNorm = 48.6655, GNorm = 1.1706, lr_0 = 1.6548e-04
Loss = 2.4210e-01, PNorm = 48.6893, GNorm = 0.5615, lr_0 = 1.6267e-04
Loss = 2.2130e-01, PNorm = 48.7147, GNorm = 0.9942, lr_0 = 1.5991e-04
Loss = 1.8004e-01, PNorm = 48.7329, GNorm = 0.6288, lr_0 = 1.5719e-04
Validation prc-auc = 0.805969
Validation auc = 0.885143
Epoch 24
Loss = 2.2697e-01, PNorm = 48.7553, GNorm = 0.5592, lr_0 = 1.5452e-04
Loss = 2.1459e-01, PNorm = 48.7716, GNorm = 0.4262, lr_0 = 1.5190e-04
Loss = 2.1191e-01, PNorm = 48.7935, GNorm = 1.0386, lr_0 = 1.4932e-04
Loss = 2.3214e-01, PNorm = 48.8117, GNorm = 0.8150, lr_0 = 1.4678e-04
Loss = 2.0533e-01, PNorm = 48.8353, GNorm = 0.6597, lr_0 = 1.4429e-04
Validation prc-auc = 0.793653
Validation auc = 0.879429
Epoch 25
Loss = 2.1741e-01, PNorm = 48.8541, GNorm = 0.6340, lr_0 = 1.4184e-04
Loss = 2.0452e-01, PNorm = 48.8770, GNorm = 0.6428, lr_0 = 1.3943e-04
Loss = 2.2974e-01, PNorm = 48.8988, GNorm = 1.4723, lr_0 = 1.3706e-04
Loss = 1.9657e-01, PNorm = 48.9144, GNorm = 0.5351, lr_0 = 1.3473e-04
Validation prc-auc = 0.805170
Validation auc = 0.884429
Epoch 26
Loss = 1.7734e-01, PNorm = 48.9362, GNorm = 0.4569, lr_0 = 1.3221e-04
Loss = 2.3035e-01, PNorm = 48.9536, GNorm = 0.4487, lr_0 = 1.2997e-04
Loss = 1.9315e-01, PNorm = 48.9720, GNorm = 0.5425, lr_0 = 1.2776e-04
Loss = 1.9652e-01, PNorm = 48.9889, GNorm = 0.6423, lr_0 = 1.2559e-04
Loss = 1.8968e-01, PNorm = 49.0022, GNorm = 0.5136, lr_0 = 1.2346e-04
Validation prc-auc = 0.812257
Validation auc = 0.883905
Epoch 27
Loss = 1.9855e-01, PNorm = 49.0170, GNorm = 1.0020, lr_0 = 1.2136e-04
Loss = 1.9141e-01, PNorm = 49.0333, GNorm = 1.2325, lr_0 = 1.1930e-04
Loss = 2.2180e-01, PNorm = 49.0476, GNorm = 0.9430, lr_0 = 1.1727e-04
Loss = 2.0939e-01, PNorm = 49.0645, GNorm = 0.8925, lr_0 = 1.1528e-04
Loss = 1.8526e-01, PNorm = 49.0793, GNorm = 0.8752, lr_0 = 1.1332e-04
Validation prc-auc = 0.803028
Validation auc = 0.884476
Epoch 28
Loss = 2.2881e-01, PNorm = 49.0929, GNorm = 0.9212, lr_0 = 1.1140e-04
Loss = 1.9717e-01, PNorm = 49.1027, GNorm = 0.6924, lr_0 = 1.0951e-04
Loss = 1.8245e-01, PNorm = 49.1136, GNorm = 1.1666, lr_0 = 1.0765e-04
Loss = 1.7266e-01, PNorm = 49.1275, GNorm = 0.4714, lr_0 = 1.0582e-04
Loss = 2.4238e-01, PNorm = 49.1406, GNorm = 0.6914, lr_0 = 1.0402e-04
Validation prc-auc = 0.824672
Validation auc = 0.889905
Epoch 29
Loss = 2.4286e-01, PNorm = 49.1557, GNorm = 0.9030, lr_0 = 1.0225e-04
Loss = 1.7536e-01, PNorm = 49.1693, GNorm = 0.6803, lr_0 = 1.0052e-04
Loss = 2.1239e-01, PNorm = 49.1833, GNorm = 1.1346, lr_0 = 1.0000e-04
Loss = 2.0778e-01, PNorm = 49.1929, GNorm = 0.7659, lr_0 = 1.0000e-04
Loss = 1.7722e-01, PNorm = 49.2051, GNorm = 0.6529, lr_0 = 1.0000e-04
Validation prc-auc = 0.826700
Validation auc = 0.891381
Model 0 best validation prc-auc = 0.826700 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.834649
Model 0 test auc = 0.875785
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.1763e-01, PNorm = 43.2440, GNorm = 1.4070, lr_0 = 2.0312e-04
Loss = 5.9222e-01, PNorm = 43.2530, GNorm = 1.5250, lr_0 = 2.9687e-04
Loss = 5.5373e-01, PNorm = 43.2688, GNorm = 0.8435, lr_0 = 3.9062e-04
Loss = 4.8206e-01, PNorm = 43.2920, GNorm = 0.6170, lr_0 = 4.8437e-04
Validation prc-auc = 0.681362
Validation auc = 0.831714
Epoch 1
Loss = 5.2893e-01, PNorm = 43.3241, GNorm = 1.5946, lr_0 = 5.8750e-04
Loss = 4.3787e-01, PNorm = 43.3644, GNorm = 0.6634, lr_0 = 6.8125e-04
Loss = 4.7187e-01, PNorm = 43.4096, GNorm = 0.8147, lr_0 = 7.7500e-04
Loss = 4.2920e-01, PNorm = 43.4666, GNorm = 0.6634, lr_0 = 8.6875e-04
Loss = 4.0784e-01, PNorm = 43.5195, GNorm = 0.9163, lr_0 = 9.6250e-04
Validation prc-auc = 0.724184
Validation auc = 0.848571
Epoch 2
Loss = 4.2552e-01, PNorm = 43.5744, GNorm = 0.9972, lr_0 = 9.8977e-04
Loss = 3.9601e-01, PNorm = 43.6277, GNorm = 0.6307, lr_0 = 9.7296e-04
Loss = 4.3840e-01, PNorm = 43.6839, GNorm = 0.9187, lr_0 = 9.5643e-04
Loss = 4.2884e-01, PNorm = 43.7391, GNorm = 0.3585, lr_0 = 9.4019e-04
Loss = 4.3268e-01, PNorm = 43.7935, GNorm = 1.3343, lr_0 = 9.2422e-04
Validation prc-auc = 0.722017
Validation auc = 0.846619
Epoch 3
Loss = 3.7887e-01, PNorm = 43.8491, GNorm = 0.3836, lr_0 = 9.0852e-04
Loss = 3.7493e-01, PNorm = 43.9065, GNorm = 0.4209, lr_0 = 8.9309e-04
Loss = 4.0988e-01, PNorm = 43.9675, GNorm = 0.6636, lr_0 = 8.7791e-04
Loss = 4.0558e-01, PNorm = 44.0260, GNorm = 0.3774, lr_0 = 8.6300e-04
Loss = 4.0879e-01, PNorm = 44.0867, GNorm = 0.4452, lr_0 = 8.4834e-04
Validation prc-auc = 0.764192
Validation auc = 0.865905
Epoch 4
Loss = 3.9903e-01, PNorm = 44.1504, GNorm = 0.4091, lr_0 = 8.3393e-04
Loss = 3.9862e-01, PNorm = 44.2172, GNorm = 0.7521, lr_0 = 8.1977e-04
Loss = 3.8096e-01, PNorm = 44.2729, GNorm = 0.4550, lr_0 = 8.0584e-04
Loss = 3.5291e-01, PNorm = 44.3335, GNorm = 0.6879, lr_0 = 7.9215e-04
Loss = 3.9327e-01, PNorm = 44.3918, GNorm = 1.2662, lr_0 = 7.7870e-04
Validation prc-auc = 0.773842
Validation auc = 0.869000
Epoch 5
Loss = 4.3005e-01, PNorm = 44.4599, GNorm = 0.9888, lr_0 = 7.6547e-04
Loss = 3.9784e-01, PNorm = 44.5389, GNorm = 1.2287, lr_0 = 7.5247e-04
Loss = 3.3611e-01, PNorm = 44.6127, GNorm = 0.3815, lr_0 = 7.3969e-04
Loss = 4.0128e-01, PNorm = 44.6849, GNorm = 0.6388, lr_0 = 7.2712e-04
Loss = 3.6575e-01, PNorm = 44.7399, GNorm = 0.6358, lr_0 = 7.1477e-04
Validation prc-auc = 0.759843
Validation auc = 0.863571
Epoch 6
Loss = 4.0885e-01, PNorm = 44.8071, GNorm = 0.3571, lr_0 = 7.0143e-04
Loss = 3.4569e-01, PNorm = 44.8823, GNorm = 0.4704, lr_0 = 6.8951e-04
Loss = 3.5704e-01, PNorm = 44.9667, GNorm = 0.4922, lr_0 = 6.7780e-04
Loss = 3.7621e-01, PNorm = 45.0485, GNorm = 1.4322, lr_0 = 6.6629e-04
Loss = 3.6745e-01, PNorm = 45.0756, GNorm = 0.3256, lr_0 = 6.5497e-04
Validation prc-auc = 0.753194
Validation auc = 0.862667
Epoch 7
Loss = 3.4423e-01, PNorm = 45.1280, GNorm = 0.3946, lr_0 = 6.4384e-04
Loss = 3.1605e-01, PNorm = 45.1902, GNorm = 0.6923, lr_0 = 6.3291e-04
Loss = 3.9208e-01, PNorm = 45.2409, GNorm = 0.8866, lr_0 = 6.2216e-04
Loss = 3.7870e-01, PNorm = 45.3186, GNorm = 0.9973, lr_0 = 6.1159e-04
Loss = 3.5156e-01, PNorm = 45.3788, GNorm = 0.3657, lr_0 = 6.0120e-04
Validation prc-auc = 0.780690
Validation auc = 0.873810
Epoch 8
Loss = 3.6634e-01, PNorm = 45.4323, GNorm = 0.6133, lr_0 = 5.9099e-04
Loss = 3.7450e-01, PNorm = 45.5030, GNorm = 0.8092, lr_0 = 5.8095e-04
Loss = 3.2048e-01, PNorm = 45.5862, GNorm = 0.6065, lr_0 = 5.7108e-04
Loss = 3.2973e-01, PNorm = 45.6418, GNorm = 0.4123, lr_0 = 5.6138e-04
Validation prc-auc = 0.770687
Validation auc = 0.865857
Epoch 9
Loss = 3.2378e-01, PNorm = 45.7073, GNorm = 0.5730, lr_0 = 5.5184e-04
Loss = 3.2941e-01, PNorm = 45.7622, GNorm = 0.3660, lr_0 = 5.4247e-04
Loss = 3.2252e-01, PNorm = 45.8307, GNorm = 0.4111, lr_0 = 5.3325e-04
Loss = 3.2264e-01, PNorm = 45.8769, GNorm = 0.7319, lr_0 = 5.2420e-04
Loss = 3.3698e-01, PNorm = 45.9443, GNorm = 0.6667, lr_0 = 5.1529e-04
Validation prc-auc = 0.781029
Validation auc = 0.882952
Epoch 10
Loss = 3.9760e-01, PNorm = 46.0202, GNorm = 0.9415, lr_0 = 5.0654e-04
Loss = 3.3776e-01, PNorm = 46.0801, GNorm = 0.4664, lr_0 = 4.9793e-04
Loss = 3.2164e-01, PNorm = 46.1279, GNorm = 0.5902, lr_0 = 4.8948e-04
Loss = 3.3718e-01, PNorm = 46.1834, GNorm = 0.5122, lr_0 = 4.8116e-04
Loss = 2.8451e-01, PNorm = 46.2518, GNorm = 1.2082, lr_0 = 4.7299e-04
Validation prc-auc = 0.764690
Validation auc = 0.871143
Epoch 11
Loss = 3.1097e-01, PNorm = 46.3186, GNorm = 0.5536, lr_0 = 4.6416e-04
Loss = 3.4750e-01, PNorm = 46.3761, GNorm = 0.6500, lr_0 = 4.5627e-04
Loss = 2.8899e-01, PNorm = 46.4362, GNorm = 0.5289, lr_0 = 4.4852e-04
Loss = 3.0928e-01, PNorm = 46.5048, GNorm = 0.8947, lr_0 = 4.4091e-04
Loss = 3.0253e-01, PNorm = 46.5607, GNorm = 0.8874, lr_0 = 4.3342e-04
Validation prc-auc = 0.780850
Validation auc = 0.877381
Epoch 12
Loss = 2.8846e-01, PNorm = 46.6165, GNorm = 0.5475, lr_0 = 4.2605e-04
Loss = 3.4225e-01, PNorm = 46.6840, GNorm = 0.6081, lr_0 = 4.1882e-04
Loss = 3.0726e-01, PNorm = 46.7419, GNorm = 0.6609, lr_0 = 4.1170e-04
Loss = 2.8184e-01, PNorm = 46.8000, GNorm = 0.6730, lr_0 = 4.0471e-04
Loss = 2.8591e-01, PNorm = 46.8469, GNorm = 0.5349, lr_0 = 3.9783e-04
Validation prc-auc = 0.764499
Validation auc = 0.867524
Epoch 13
Loss = 2.9113e-01, PNorm = 46.8930, GNorm = 0.4714, lr_0 = 3.9108e-04
Loss = 2.6733e-01, PNorm = 46.9485, GNorm = 0.5905, lr_0 = 3.8443e-04
Loss = 2.6255e-01, PNorm = 46.9940, GNorm = 0.6779, lr_0 = 3.7790e-04
Loss = 3.1528e-01, PNorm = 47.0407, GNorm = 0.9001, lr_0 = 3.7148e-04
Loss = 3.1947e-01, PNorm = 47.0793, GNorm = 0.5638, lr_0 = 3.6517e-04
Validation prc-auc = 0.788352
Validation auc = 0.876952
Epoch 14
Loss = 3.0260e-01, PNorm = 47.1359, GNorm = 0.5977, lr_0 = 3.5897e-04
Loss = 3.1568e-01, PNorm = 47.1853, GNorm = 0.4841, lr_0 = 3.5287e-04
Loss = 2.6437e-01, PNorm = 47.2495, GNorm = 0.4745, lr_0 = 3.4688e-04
Loss = 2.5637e-01, PNorm = 47.3147, GNorm = 0.6061, lr_0 = 3.4099e-04
Loss = 3.1385e-01, PNorm = 47.3573, GNorm = 0.5747, lr_0 = 3.3520e-04
Validation prc-auc = 0.779439
Validation auc = 0.878095
Epoch 15
Loss = 2.2554e-01, PNorm = 47.4163, GNorm = 0.4349, lr_0 = 3.2950e-04
Loss = 2.9209e-01, PNorm = 47.4694, GNorm = 0.8004, lr_0 = 3.2390e-04
Loss = 3.1044e-01, PNorm = 47.5039, GNorm = 0.4492, lr_0 = 3.1840e-04
Loss = 2.7823e-01, PNorm = 47.5402, GNorm = 1.0736, lr_0 = 3.1299e-04
Loss = 2.4742e-01, PNorm = 47.5786, GNorm = 0.5791, lr_0 = 3.0768e-04
Loss = 2.1520e-01, PNorm = 47.5839, GNorm = 0.9142, lr_0 = 3.0715e-04
Validation prc-auc = 0.798979
Validation auc = 0.879381
Epoch 16
Loss = 2.1816e-01, PNorm = 47.6413, GNorm = 0.6466, lr_0 = 3.0193e-04
Loss = 2.8861e-01, PNorm = 47.6879, GNorm = 1.0665, lr_0 = 2.9680e-04
Loss = 2.9011e-01, PNorm = 47.7254, GNorm = 0.5279, lr_0 = 2.9176e-04
Loss = 2.6693e-01, PNorm = 47.7608, GNorm = 0.3661, lr_0 = 2.8681e-04
Validation prc-auc = 0.772846
Validation auc = 0.871667
Epoch 17
Loss = 2.1003e-01, PNorm = 47.8025, GNorm = 0.5415, lr_0 = 2.8193e-04
Loss = 2.4537e-01, PNorm = 47.8473, GNorm = 0.8792, lr_0 = 2.7715e-04
Loss = 2.6458e-01, PNorm = 47.8952, GNorm = 0.9361, lr_0 = 2.7244e-04
Loss = 2.7046e-01, PNorm = 47.9251, GNorm = 0.5192, lr_0 = 2.6781e-04
Loss = 2.6706e-01, PNorm = 47.9674, GNorm = 0.8391, lr_0 = 2.6326e-04
Validation prc-auc = 0.775117
Validation auc = 0.869571
Epoch 18
Loss = 3.3536e-01, PNorm = 48.0051, GNorm = 0.8620, lr_0 = 2.5879e-04
Loss = 2.5579e-01, PNorm = 48.0422, GNorm = 0.4294, lr_0 = 2.5439e-04
Loss = 1.9841e-01, PNorm = 48.0797, GNorm = 0.7178, lr_0 = 2.5007e-04
Loss = 2.3440e-01, PNorm = 48.1230, GNorm = 1.0091, lr_0 = 2.4582e-04
Loss = 2.6596e-01, PNorm = 48.1520, GNorm = 1.2715, lr_0 = 2.4165e-04
Validation prc-auc = 0.771019
Validation auc = 0.875476
Epoch 19
Loss = 2.0648e-01, PNorm = 48.1864, GNorm = 0.7368, lr_0 = 2.3754e-04
Loss = 2.3378e-01, PNorm = 48.2164, GNorm = 0.6809, lr_0 = 2.3351e-04
Loss = 2.6876e-01, PNorm = 48.2514, GNorm = 1.6715, lr_0 = 2.2954e-04
Loss = 2.4617e-01, PNorm = 48.2833, GNorm = 1.0179, lr_0 = 2.2564e-04
Loss = 2.5198e-01, PNorm = 48.3177, GNorm = 0.4198, lr_0 = 2.2181e-04
Validation prc-auc = 0.791920
Validation auc = 0.876238
Epoch 20
Loss = 1.9595e-01, PNorm = 48.3515, GNorm = 0.6168, lr_0 = 2.1804e-04
Loss = 2.4821e-01, PNorm = 48.3836, GNorm = 0.7215, lr_0 = 2.1434e-04
Loss = 2.3143e-01, PNorm = 48.4140, GNorm = 0.7459, lr_0 = 2.1070e-04
Loss = 2.1651e-01, PNorm = 48.4380, GNorm = 0.7305, lr_0 = 2.0712e-04
Loss = 2.8194e-01, PNorm = 48.4603, GNorm = 1.2312, lr_0 = 2.0360e-04
Validation prc-auc = 0.802290
Validation auc = 0.881762
Epoch 21
Loss = 2.2602e-01, PNorm = 48.4949, GNorm = 0.8762, lr_0 = 1.9980e-04
Loss = 2.3471e-01, PNorm = 48.5321, GNorm = 1.1760, lr_0 = 1.9641e-04
Loss = 2.4138e-01, PNorm = 48.5601, GNorm = 0.9948, lr_0 = 1.9307e-04
Loss = 2.1951e-01, PNorm = 48.5852, GNorm = 1.0608, lr_0 = 1.8979e-04
Loss = 2.0568e-01, PNorm = 48.6116, GNorm = 0.6645, lr_0 = 1.8657e-04
Validation prc-auc = 0.809443
Validation auc = 0.886143
Epoch 22
Loss = 2.2938e-01, PNorm = 48.6351, GNorm = 0.5834, lr_0 = 1.8340e-04
Loss = 2.2108e-01, PNorm = 48.6576, GNorm = 0.8079, lr_0 = 1.8028e-04
Loss = 2.2305e-01, PNorm = 48.6826, GNorm = 0.6098, lr_0 = 1.7722e-04
Loss = 2.1963e-01, PNorm = 48.7026, GNorm = 0.7461, lr_0 = 1.7421e-04
Loss = 2.2237e-01, PNorm = 48.7284, GNorm = 0.5357, lr_0 = 1.7125e-04
Validation prc-auc = 0.806500
Validation auc = 0.886857
Epoch 23
Loss = 1.9070e-01, PNorm = 48.7558, GNorm = 0.8108, lr_0 = 1.6834e-04
Loss = 2.1453e-01, PNorm = 48.7827, GNorm = 0.9167, lr_0 = 1.6548e-04
Loss = 1.9801e-01, PNorm = 48.8057, GNorm = 1.0267, lr_0 = 1.6267e-04
Loss = 2.4830e-01, PNorm = 48.8264, GNorm = 0.7152, lr_0 = 1.5991e-04
Loss = 2.2417e-01, PNorm = 48.8469, GNorm = 0.5631, lr_0 = 1.5719e-04
Validation prc-auc = 0.797854
Validation auc = 0.882952
Epoch 24
Loss = 2.0894e-01, PNorm = 48.8695, GNorm = 1.5012, lr_0 = 1.5452e-04
Loss = 2.1466e-01, PNorm = 48.8862, GNorm = 0.4434, lr_0 = 1.5190e-04
Loss = 2.1951e-01, PNorm = 48.9056, GNorm = 0.9816, lr_0 = 1.4932e-04
Loss = 2.1475e-01, PNorm = 48.9234, GNorm = 0.5767, lr_0 = 1.4678e-04
Loss = 2.1605e-01, PNorm = 48.9451, GNorm = 1.0542, lr_0 = 1.4429e-04
Validation prc-auc = 0.798514
Validation auc = 0.886048
Epoch 25
Loss = 1.9988e-01, PNorm = 48.9582, GNorm = 1.1624, lr_0 = 1.4184e-04
Loss = 1.8613e-01, PNorm = 48.9778, GNorm = 0.5450, lr_0 = 1.3943e-04
Loss = 2.1572e-01, PNorm = 48.9953, GNorm = 0.7297, lr_0 = 1.3706e-04
Loss = 1.9448e-01, PNorm = 49.0119, GNorm = 1.2018, lr_0 = 1.3473e-04
Validation prc-auc = 0.801591
Validation auc = 0.883143
Epoch 26
Loss = 1.6719e-01, PNorm = 49.0306, GNorm = 0.4800, lr_0 = 1.3221e-04
Loss = 2.0094e-01, PNorm = 49.0470, GNorm = 0.7051, lr_0 = 1.2997e-04
Loss = 1.9671e-01, PNorm = 49.0673, GNorm = 0.6054, lr_0 = 1.2776e-04
Loss = 2.0498e-01, PNorm = 49.0830, GNorm = 0.7643, lr_0 = 1.2559e-04
Loss = 2.1892e-01, PNorm = 49.0987, GNorm = 0.5888, lr_0 = 1.2346e-04
Validation prc-auc = 0.805729
Validation auc = 0.884095
Epoch 27
Loss = 1.2954e-01, PNorm = 49.1097, GNorm = 0.7627, lr_0 = 1.2136e-04
Loss = 1.7739e-01, PNorm = 49.1280, GNorm = 0.7407, lr_0 = 1.1930e-04
Loss = 1.9044e-01, PNorm = 49.1403, GNorm = 2.0926, lr_0 = 1.1727e-04
Loss = 2.2132e-01, PNorm = 49.1572, GNorm = 0.6659, lr_0 = 1.1528e-04
Loss = 2.4884e-01, PNorm = 49.1701, GNorm = 0.7370, lr_0 = 1.1332e-04
Validation prc-auc = 0.766974
Validation auc = 0.872095
Epoch 28
Loss = 2.0010e-01, PNorm = 49.1856, GNorm = 0.9445, lr_0 = 1.1140e-04
Loss = 1.6297e-01, PNorm = 49.1995, GNorm = 0.8663, lr_0 = 1.0951e-04
Loss = 2.0848e-01, PNorm = 49.2151, GNorm = 1.4059, lr_0 = 1.0765e-04
Loss = 1.9670e-01, PNorm = 49.2317, GNorm = 1.3490, lr_0 = 1.0582e-04
Loss = 2.3234e-01, PNorm = 49.2441, GNorm = 1.1577, lr_0 = 1.0402e-04
Validation prc-auc = 0.781125
Validation auc = 0.875905
Epoch 29
Loss = 1.6521e-01, PNorm = 49.2583, GNorm = 0.4316, lr_0 = 1.0225e-04
Loss = 2.1350e-01, PNorm = 49.2724, GNorm = 0.9073, lr_0 = 1.0052e-04
Loss = 1.6018e-01, PNorm = 49.2841, GNorm = 0.8331, lr_0 = 1.0000e-04
Loss = 2.1592e-01, PNorm = 49.2988, GNorm = 0.9849, lr_0 = 1.0000e-04
Loss = 2.1389e-01, PNorm = 49.3075, GNorm = 1.3216, lr_0 = 1.0000e-04
Validation prc-auc = 0.812920
Validation auc = 0.886476
Model 1 best validation prc-auc = 0.812920 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.820758
Model 1 test auc = 0.873997
Ensemble test prc-auc = 0.833393
Ensemble test auc = 0.879041
5-fold cross validation
	Seed 0 ==> test prc-auc = 0.771935
	Seed 0 ==> test auc = 0.865364
	Seed 1 ==> test prc-auc = 0.818271
	Seed 1 ==> test auc = 0.901038
	Seed 2 ==> test prc-auc = 0.839524
	Seed 2 ==> test auc = 0.898513
	Seed 3 ==> test prc-auc = 0.828984
	Seed 3 ==> test auc = 0.893486
	Seed 4 ==> test prc-auc = 0.833393
	Seed 4 ==> test auc = 0.879041
Overall test prc-auc = 0.818421 +/- 0.024257
Overall test auc = 0.887488 +/- 0.013431
Elapsed time = 0:34:21
