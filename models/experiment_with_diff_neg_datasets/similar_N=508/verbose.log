Command line
python /home/jackievaleri8/.conda/envs/chemprop/bin/chemprop_train --dropout 0.1 --hidden_size 500 --ffn_num_layers 2 --depth 3 --metric prc-auc --extra_metrics auc --save_dir models/controls_with_diff_neg_datasets/similar_N=508/ --data_path data/controls_with_diff_neg_datasets/similar_N=508.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --num_folds 5 --ensemble_size 2 --split_type scaffold_balanced --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --gpu 0
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/controls_with_diff_neg_datasets/similar_N=508.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda', index=0),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 2,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 500,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'models/controls_with_diff_neg_datasets/similar_N=508/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'scaffold_balanced',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 652 | train scaffolds = 503 | val scaffolds = 75 | test scaffolds = 74
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 57 | target average = 0.912281


Scaffold 1
Task 0: count = 42 | target average = 0.142857


Scaffold 2
Task 0: count = 29 | target average = 0.827586


Scaffold 3
Task 0: count = 19 | target average = 0.315789


Scaffold 4
Task 0: count = 18 | target average = 0.166667


Scaffold 5
Task 0: count = 16 | target average = 0.187500


Scaffold 6
Task 0: count = 15 | target average = 0.133333


Scaffold 7
Task 0: count = 14 | target average = 0.214286


Scaffold 8
Task 0: count = 13 | target average = 0.384615


Scaffold 9
Task 0: count = 13 | target average = 0.384615


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.2480e-01, PNorm = 43.2238, GNorm = 0.7116, lr_0 = 3.0625e-04
Loss = 5.1584e-01, PNorm = 43.2485, GNorm = 0.7970, lr_0 = 4.9375e-04
Validation prc-auc = 0.891206
Validation auc = 0.798413
Epoch 1
Loss = 5.0041e-01, PNorm = 43.2957, GNorm = 3.7088, lr_0 = 7.0000e-04
Loss = 4.6235e-01, PNorm = 43.3461, GNorm = 1.0063, lr_0 = 8.8750e-04
Validation prc-auc = 0.898437
Validation auc = 0.789866
Epoch 2
Loss = 3.8428e-01, PNorm = 43.4246, GNorm = 0.5929, lr_0 = 9.8301e-04
Loss = 4.0639e-01, PNorm = 43.4876, GNorm = 1.1468, lr_0 = 9.4990e-04
Loss = 3.9926e-01, PNorm = 43.5342, GNorm = 1.8772, lr_0 = 9.1790e-04
Validation prc-auc = 0.910942
Validation auc = 0.796459
Epoch 3
Loss = 3.8247e-01, PNorm = 43.5831, GNorm = 0.4044, lr_0 = 8.8699e-04
Loss = 3.7499e-01, PNorm = 43.6204, GNorm = 0.4250, lr_0 = 8.5711e-04
Validation prc-auc = 0.913258
Validation auc = 0.811111
Epoch 4
Loss = 3.0263e-01, PNorm = 43.6615, GNorm = 0.6319, lr_0 = 8.2540e-04
Loss = 4.0020e-01, PNorm = 43.7059, GNorm = 2.2641, lr_0 = 7.9760e-04
Loss = 3.6207e-01, PNorm = 43.7569, GNorm = 1.3260, lr_0 = 7.7073e-04
Validation prc-auc = 0.909424
Validation auc = 0.799634
Epoch 5
Loss = 3.4853e-01, PNorm = 43.8065, GNorm = 0.4618, lr_0 = 7.4477e-04
Loss = 3.6578e-01, PNorm = 43.8547, GNorm = 0.6258, lr_0 = 7.1969e-04
Validation prc-auc = 0.909454
Validation auc = 0.791331
Epoch 6
Loss = 4.4935e-01, PNorm = 43.9115, GNorm = 0.4264, lr_0 = 6.9306e-04
Loss = 3.4400e-01, PNorm = 43.9538, GNorm = 0.7362, lr_0 = 6.6972e-04
Loss = 3.0814e-01, PNorm = 44.0110, GNorm = 0.8110, lr_0 = 6.4716e-04
Loss = 4.0712e-01, PNorm = 44.0189, GNorm = 2.1857, lr_0 = 6.4495e-04
Validation prc-auc = 0.902288
Validation auc = 0.786447
Epoch 7
Loss = 3.3665e-01, PNorm = 44.0520, GNorm = 0.4583, lr_0 = 6.2322e-04
Loss = 3.4788e-01, PNorm = 44.0958, GNorm = 0.3810, lr_0 = 6.0223e-04
Validation prc-auc = 0.907023
Validation auc = 0.795482
Epoch 8
Loss = 3.3101e-01, PNorm = 44.1507, GNorm = 0.6938, lr_0 = 5.8194e-04
Loss = 3.8425e-01, PNorm = 44.2042, GNorm = 1.2746, lr_0 = 5.6234e-04
Validation prc-auc = 0.891261
Validation auc = 0.774969
Epoch 9
Loss = 3.0501e-01, PNorm = 44.2586, GNorm = 0.5139, lr_0 = 5.4154e-04
Loss = 3.7871e-01, PNorm = 44.3024, GNorm = 0.5594, lr_0 = 5.2330e-04
Loss = 3.1053e-01, PNorm = 44.3610, GNorm = 0.3830, lr_0 = 5.0567e-04
Validation prc-auc = 0.885540
Validation auc = 0.776435
Epoch 10
Loss = 2.9099e-01, PNorm = 44.4086, GNorm = 1.1346, lr_0 = 4.8864e-04
Loss = 3.0347e-01, PNorm = 44.4608, GNorm = 1.3012, lr_0 = 4.7218e-04
Validation prc-auc = 0.880578
Validation auc = 0.769353
Epoch 11
Loss = 4.0672e-01, PNorm = 44.5099, GNorm = 0.9077, lr_0 = 4.5471e-04
Loss = 3.2504e-01, PNorm = 44.5577, GNorm = 1.0788, lr_0 = 4.3940e-04
Loss = 3.0975e-01, PNorm = 44.5971, GNorm = 0.4310, lr_0 = 4.2460e-04
Validation prc-auc = 0.883556
Validation auc = 0.776435
Epoch 12
Loss = 2.9502e-01, PNorm = 44.6551, GNorm = 0.9500, lr_0 = 4.0889e-04
Loss = 3.1739e-01, PNorm = 44.7053, GNorm = 0.7446, lr_0 = 3.9512e-04
Validation prc-auc = 0.881259
Validation auc = 0.781074
Epoch 13
Loss = 2.8291e-01, PNorm = 44.7350, GNorm = 0.4682, lr_0 = 3.8181e-04
Loss = 3.3082e-01, PNorm = 44.7647, GNorm = 1.5851, lr_0 = 3.6895e-04
Loss = 3.3060e-01, PNorm = 44.8084, GNorm = 0.3772, lr_0 = 3.5652e-04
Validation prc-auc = 0.878812
Validation auc = 0.779853
Epoch 14
Loss = 3.3076e-01, PNorm = 44.8643, GNorm = 2.3067, lr_0 = 3.4333e-04
Loss = 3.6874e-01, PNorm = 44.8818, GNorm = 1.6503, lr_0 = 3.3177e-04
Validation prc-auc = 0.889987
Validation auc = 0.788645
Epoch 15
Loss = 3.3139e-01, PNorm = 44.9223, GNorm = 0.7644, lr_0 = 3.2059e-04
Loss = 3.0721e-01, PNorm = 44.9696, GNorm = 0.4378, lr_0 = 3.0979e-04
Loss = 3.1494e-01, PNorm = 44.9938, GNorm = 0.6034, lr_0 = 2.9936e-04
Loss = 3.2803e-01, PNorm = 44.9949, GNorm = 0.5438, lr_0 = 2.9833e-04
Validation prc-auc = 0.875161
Validation auc = 0.771551
Epoch 16
Loss = 2.9432e-01, PNorm = 45.0326, GNorm = 0.4597, lr_0 = 2.8828e-04
Loss = 3.1678e-01, PNorm = 45.0542, GNorm = 1.0813, lr_0 = 2.7857e-04
Validation prc-auc = 0.870974
Validation auc = 0.760806
Epoch 17
Loss = 2.6813e-01, PNorm = 45.0811, GNorm = 0.3811, lr_0 = 2.6827e-04
Loss = 3.2628e-01, PNorm = 45.1012, GNorm = 0.6338, lr_0 = 2.5923e-04
Validation prc-auc = 0.875689
Validation auc = 0.770574
Epoch 18
Loss = 2.7326e-01, PNorm = 45.1284, GNorm = 0.3559, lr_0 = 2.5050e-04
Loss = 2.9566e-01, PNorm = 45.1485, GNorm = 0.9131, lr_0 = 2.4206e-04
Loss = 3.0237e-01, PNorm = 45.1757, GNorm = 0.4958, lr_0 = 2.3391e-04
Validation prc-auc = 0.876726
Validation auc = 0.773993
Epoch 19
Loss = 2.7509e-01, PNorm = 45.1901, GNorm = 0.9852, lr_0 = 2.2526e-04
Loss = 2.8617e-01, PNorm = 45.2156, GNorm = 0.7776, lr_0 = 2.1767e-04
Validation prc-auc = 0.873127
Validation auc = 0.767399
Epoch 20
Loss = 2.6595e-01, PNorm = 45.2240, GNorm = 0.4127, lr_0 = 2.1034e-04
Loss = 2.7863e-01, PNorm = 45.2468, GNorm = 0.5255, lr_0 = 2.0325e-04
Loss = 3.3842e-01, PNorm = 45.2680, GNorm = 0.6198, lr_0 = 1.9641e-04
Validation prc-auc = 0.872370
Validation auc = 0.766667
Epoch 21
Loss = 2.7388e-01, PNorm = 45.2863, GNorm = 0.6264, lr_0 = 1.8914e-04
Loss = 2.7762e-01, PNorm = 45.3061, GNorm = 0.6026, lr_0 = 1.8277e-04
Validation prc-auc = 0.871172
Validation auc = 0.764713
Epoch 22
Loss = 3.4472e-01, PNorm = 45.3186, GNorm = 0.8191, lr_0 = 1.7601e-04
Loss = 2.7688e-01, PNorm = 45.3327, GNorm = 0.4008, lr_0 = 1.7008e-04
Loss = 2.7800e-01, PNorm = 45.3503, GNorm = 0.8827, lr_0 = 1.6435e-04
Validation prc-auc = 0.871169
Validation auc = 0.763492
Epoch 23
Loss = 3.0393e-01, PNorm = 45.3585, GNorm = 0.4260, lr_0 = 1.5882e-04
Loss = 2.6517e-01, PNorm = 45.3690, GNorm = 0.8989, lr_0 = 1.5347e-04
Validation prc-auc = 0.872465
Validation auc = 0.767399
Epoch 24
Loss = 3.0833e-01, PNorm = 45.3811, GNorm = 1.3265, lr_0 = 1.4779e-04
Loss = 2.9960e-01, PNorm = 45.3922, GNorm = 0.9087, lr_0 = 1.4281e-04
Loss = 2.7611e-01, PNorm = 45.4034, GNorm = 0.8554, lr_0 = 1.3800e-04
Validation prc-auc = 0.870701
Validation auc = 0.765690
Epoch 25
Loss = 3.2259e-01, PNorm = 45.4225, GNorm = 0.6177, lr_0 = 1.3335e-04
Loss = 2.4166e-01, PNorm = 45.4279, GNorm = 0.5015, lr_0 = 1.2886e-04
Validation prc-auc = 0.869021
Validation auc = 0.763248
Epoch 26
Loss = 3.1212e-01, PNorm = 45.4397, GNorm = 1.0886, lr_0 = 1.2409e-04
Loss = 2.7046e-01, PNorm = 45.4465, GNorm = 0.6894, lr_0 = 1.1991e-04
Validation prc-auc = 0.873759
Validation auc = 0.771551
Epoch 27
Loss = 2.9315e-01, PNorm = 45.4576, GNorm = 0.6926, lr_0 = 1.1548e-04
Loss = 2.6640e-01, PNorm = 45.4804, GNorm = 1.3033, lr_0 = 1.1159e-04
Loss = 3.0352e-01, PNorm = 45.4783, GNorm = 0.9831, lr_0 = 1.0783e-04
Validation prc-auc = 0.880823
Validation auc = 0.780586
Epoch 28
Loss = 2.8260e-01, PNorm = 45.4857, GNorm = 0.6856, lr_0 = 1.0420e-04
Loss = 2.8096e-01, PNorm = 45.4982, GNorm = 1.6194, lr_0 = 1.0069e-04
Validation prc-auc = 0.873917
Validation auc = 0.770574
Epoch 29
Loss = 3.0565e-01, PNorm = 45.5085, GNorm = 0.5664, lr_0 = 1.0000e-04
Loss = 2.2727e-01, PNorm = 45.5157, GNorm = 0.5713, lr_0 = 1.0000e-04
Loss = 2.9181e-01, PNorm = 45.5226, GNorm = 0.6410, lr_0 = 1.0000e-04
Validation prc-auc = 0.871380
Validation auc = 0.768620
Model 0 best validation prc-auc = 0.913258 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.962088
Model 0 test auc = 0.907613
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.0726e-01, PNorm = 43.2513, GNorm = 1.0995, lr_0 = 3.0625e-04
Loss = 5.2081e-01, PNorm = 43.2848, GNorm = 0.7366, lr_0 = 4.9375e-04
Validation prc-auc = 0.880581
Validation auc = 0.793529
Epoch 1
Loss = 4.3350e-01, PNorm = 43.3291, GNorm = 1.4600, lr_0 = 7.0000e-04
Loss = 4.6662e-01, PNorm = 43.3756, GNorm = 0.5615, lr_0 = 8.8750e-04
Validation prc-auc = 0.899220
Validation auc = 0.793040
Epoch 2
Loss = 4.3743e-01, PNorm = 43.4375, GNorm = 0.6153, lr_0 = 9.8301e-04
Loss = 3.9103e-01, PNorm = 43.4976, GNorm = 0.6864, lr_0 = 9.4990e-04
Loss = 3.7616e-01, PNorm = 43.5459, GNorm = 0.3714, lr_0 = 9.1790e-04
Validation prc-auc = 0.909400
Validation auc = 0.806471
Epoch 3
Loss = 3.7178e-01, PNorm = 43.5934, GNorm = 0.9775, lr_0 = 8.8699e-04
Loss = 3.7052e-01, PNorm = 43.6384, GNorm = 1.6895, lr_0 = 8.5711e-04
Validation prc-auc = 0.913637
Validation auc = 0.809158
Epoch 4
Loss = 3.5168e-01, PNorm = 43.6977, GNorm = 0.6857, lr_0 = 8.2540e-04
Loss = 3.8878e-01, PNorm = 43.7446, GNorm = 1.4455, lr_0 = 7.9760e-04
Loss = 3.4746e-01, PNorm = 43.8038, GNorm = 0.6749, lr_0 = 7.7073e-04
Validation prc-auc = 0.909066
Validation auc = 0.795482
Epoch 5
Loss = 3.5598e-01, PNorm = 43.8596, GNorm = 0.5828, lr_0 = 7.4477e-04
Loss = 3.7286e-01, PNorm = 43.9083, GNorm = 1.5475, lr_0 = 7.1969e-04
Validation prc-auc = 0.911773
Validation auc = 0.801587
Epoch 6
Loss = 4.4310e-01, PNorm = 43.9731, GNorm = 0.8393, lr_0 = 6.9306e-04
Loss = 3.4696e-01, PNorm = 44.0298, GNorm = 0.6364, lr_0 = 6.6972e-04
Loss = 3.4747e-01, PNorm = 44.0892, GNorm = 0.3659, lr_0 = 6.4716e-04
Loss = 3.9174e-01, PNorm = 44.0942, GNorm = 0.6076, lr_0 = 6.4495e-04
Validation prc-auc = 0.912997
Validation auc = 0.806227
Epoch 7
Loss = 3.2864e-01, PNorm = 44.1436, GNorm = 1.0345, lr_0 = 6.2322e-04
Loss = 3.5466e-01, PNorm = 44.1908, GNorm = 0.9113, lr_0 = 6.0223e-04
Validation prc-auc = 0.908843
Validation auc = 0.796215
Epoch 8
Loss = 3.6567e-01, PNorm = 44.2351, GNorm = 1.3719, lr_0 = 5.8194e-04
Loss = 2.9536e-01, PNorm = 44.2791, GNorm = 0.4940, lr_0 = 5.6234e-04
Validation prc-auc = 0.902327
Validation auc = 0.787424
Epoch 9
Loss = 3.7293e-01, PNorm = 44.3285, GNorm = 0.5102, lr_0 = 5.4154e-04
Loss = 3.1862e-01, PNorm = 44.3862, GNorm = 0.6491, lr_0 = 5.2330e-04
Loss = 3.3654e-01, PNorm = 44.4311, GNorm = 0.8753, lr_0 = 5.0567e-04
Validation prc-auc = 0.902921
Validation auc = 0.794017
Epoch 10
Loss = 3.5019e-01, PNorm = 44.4642, GNorm = 1.1244, lr_0 = 4.8864e-04
Loss = 3.1764e-01, PNorm = 44.5161, GNorm = 0.5842, lr_0 = 4.7218e-04
Validation prc-auc = 0.868280
Validation auc = 0.758120
Epoch 11
Loss = 3.2199e-01, PNorm = 44.5774, GNorm = 0.4896, lr_0 = 4.5471e-04
Loss = 2.5842e-01, PNorm = 44.6175, GNorm = 0.6329, lr_0 = 4.3940e-04
Loss = 3.5380e-01, PNorm = 44.6531, GNorm = 1.2271, lr_0 = 4.2460e-04
Validation prc-auc = 0.900833
Validation auc = 0.794994
Epoch 12
Loss = 3.0030e-01, PNorm = 44.6922, GNorm = 1.0433, lr_0 = 4.0889e-04
Loss = 3.0617e-01, PNorm = 44.7369, GNorm = 0.5394, lr_0 = 3.9512e-04
Validation prc-auc = 0.878166
Validation auc = 0.765934
Epoch 13
Loss = 3.2894e-01, PNorm = 44.7745, GNorm = 1.1207, lr_0 = 3.8181e-04
Loss = 3.2128e-01, PNorm = 44.8093, GNorm = 0.7702, lr_0 = 3.6895e-04
Loss = 3.1191e-01, PNorm = 44.8469, GNorm = 0.9991, lr_0 = 3.5652e-04
Validation prc-auc = 0.880942
Validation auc = 0.779853
Epoch 14
Loss = 2.9368e-01, PNorm = 44.8879, GNorm = 0.3551, lr_0 = 3.4333e-04
Loss = 3.1702e-01, PNorm = 44.9281, GNorm = 1.1877, lr_0 = 3.3177e-04
Validation prc-auc = 0.882858
Validation auc = 0.780342
Epoch 15
Loss = 2.6728e-01, PNorm = 44.9594, GNorm = 0.8490, lr_0 = 3.2059e-04
Loss = 3.4021e-01, PNorm = 44.9951, GNorm = 0.3687, lr_0 = 3.0979e-04
Loss = 2.8472e-01, PNorm = 45.0313, GNorm = 0.3803, lr_0 = 2.9936e-04
Loss = 5.2719e-01, PNorm = 45.0344, GNorm = 1.5504, lr_0 = 2.9833e-04
Validation prc-auc = 0.881265
Validation auc = 0.775702
Epoch 16
Loss = 2.9011e-01, PNorm = 45.0604, GNorm = 0.8639, lr_0 = 2.8828e-04
Loss = 3.0165e-01, PNorm = 45.1014, GNorm = 0.7147, lr_0 = 2.7857e-04
Validation prc-auc = 0.877735
Validation auc = 0.770085
Epoch 17
Loss = 2.9063e-01, PNorm = 45.1249, GNorm = 0.5924, lr_0 = 2.6827e-04
Loss = 3.5821e-01, PNorm = 45.1437, GNorm = 1.1277, lr_0 = 2.5923e-04
Validation prc-auc = 0.885006
Validation auc = 0.781807
Epoch 18
Loss = 2.2588e-01, PNorm = 45.1805, GNorm = 0.7988, lr_0 = 2.5050e-04
Loss = 2.6690e-01, PNorm = 45.2071, GNorm = 0.4365, lr_0 = 2.4206e-04
Loss = 3.2731e-01, PNorm = 45.2276, GNorm = 0.5421, lr_0 = 2.3391e-04
Validation prc-auc = 0.881135
Validation auc = 0.778144
Epoch 19
Loss = 2.8543e-01, PNorm = 45.2416, GNorm = 1.6057, lr_0 = 2.2526e-04
Loss = 3.1182e-01, PNorm = 45.2662, GNorm = 0.6541, lr_0 = 2.1767e-04
Validation prc-auc = 0.882703
Validation auc = 0.778877
Epoch 20
Loss = 2.7078e-01, PNorm = 45.2846, GNorm = 0.5577, lr_0 = 2.1034e-04
Loss = 2.9097e-01, PNorm = 45.3044, GNorm = 0.3234, lr_0 = 2.0325e-04
Loss = 2.8785e-01, PNorm = 45.3336, GNorm = 0.8390, lr_0 = 1.9641e-04
Validation prc-auc = 0.874498
Validation auc = 0.768620
Epoch 21
Loss = 2.4072e-01, PNorm = 45.3510, GNorm = 0.7590, lr_0 = 1.8914e-04
Loss = 3.3504e-01, PNorm = 45.3692, GNorm = 1.4017, lr_0 = 1.8277e-04
Validation prc-auc = 0.883253
Validation auc = 0.785226
Epoch 22
Loss = 2.7216e-01, PNorm = 45.3881, GNorm = 0.4269, lr_0 = 1.7601e-04
Loss = 3.0818e-01, PNorm = 45.4061, GNorm = 0.8833, lr_0 = 1.7008e-04
Loss = 2.7855e-01, PNorm = 45.4215, GNorm = 0.9002, lr_0 = 1.6435e-04
Validation prc-auc = 0.874544
Validation auc = 0.772527
Epoch 23
Loss = 3.1043e-01, PNorm = 45.4333, GNorm = 0.5759, lr_0 = 1.5882e-04
Loss = 2.6931e-01, PNorm = 45.4466, GNorm = 0.8719, lr_0 = 1.5347e-04
Validation prc-auc = 0.877995
Validation auc = 0.772772
Epoch 24
Loss = 3.4273e-01, PNorm = 45.4656, GNorm = 0.8499, lr_0 = 1.4779e-04
Loss = 2.5481e-01, PNorm = 45.4799, GNorm = 0.4663, lr_0 = 1.4281e-04
Loss = 2.5709e-01, PNorm = 45.4945, GNorm = 0.9235, lr_0 = 1.3800e-04
Validation prc-auc = 0.874714
Validation auc = 0.768620
Epoch 25
Loss = 2.8085e-01, PNorm = 45.5052, GNorm = 0.5710, lr_0 = 1.3335e-04
Loss = 2.9608e-01, PNorm = 45.5138, GNorm = 0.8849, lr_0 = 1.2886e-04
Validation prc-auc = 0.878578
Validation auc = 0.777900
Epoch 26
Loss = 2.4573e-01, PNorm = 45.5192, GNorm = 0.5391, lr_0 = 1.2409e-04
Loss = 2.9388e-01, PNorm = 45.5347, GNorm = 0.9915, lr_0 = 1.1991e-04
Validation prc-auc = 0.877721
Validation auc = 0.776679
Epoch 27
Loss = 3.0417e-01, PNorm = 45.5415, GNorm = 0.8786, lr_0 = 1.1548e-04
Loss = 2.5479e-01, PNorm = 45.5552, GNorm = 0.4776, lr_0 = 1.1159e-04
Loss = 2.8614e-01, PNorm = 45.5687, GNorm = 0.5378, lr_0 = 1.0783e-04
Validation prc-auc = 0.874195
Validation auc = 0.769353
Epoch 28
Loss = 2.7279e-01, PNorm = 45.5708, GNorm = 0.9205, lr_0 = 1.0420e-04
Loss = 2.7373e-01, PNorm = 45.5777, GNorm = 0.3888, lr_0 = 1.0069e-04
Validation prc-auc = 0.881616
Validation auc = 0.780586
Epoch 29
Loss = 2.7173e-01, PNorm = 45.5840, GNorm = 0.4741, lr_0 = 1.0000e-04
Loss = 2.4612e-01, PNorm = 45.5950, GNorm = 0.7790, lr_0 = 1.0000e-04
Loss = 2.8948e-01, PNorm = 45.6028, GNorm = 0.6662, lr_0 = 1.0000e-04
Validation prc-auc = 0.876307
Validation auc = 0.773016
Model 1 best validation prc-auc = 0.913637 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.958593
Model 1 test auc = 0.901646
Ensemble test prc-auc = 0.960755
Ensemble test auc = 0.905556
Fold 1
Splitting data with seed 1
Total scaffolds = 652 | train scaffolds = 526 | val scaffolds = 60 | test scaffolds = 66
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 57 | target average = 0.912281


Scaffold 1
Task 0: count = 42 | target average = 0.142857


Scaffold 2
Task 0: count = 29 | target average = 0.827586


Scaffold 3
Task 0: count = 19 | target average = 0.315789


Scaffold 4
Task 0: count = 18 | target average = 0.166667


Scaffold 5
Task 0: count = 16 | target average = 0.187500


Scaffold 6
Task 0: count = 15 | target average = 0.133333


Scaffold 7
Task 0: count = 14 | target average = 0.214286


Scaffold 8
Task 0: count = 13 | target average = 0.384615


Scaffold 9
Task 0: count = 13 | target average = 0.384615


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.2192e-01, PNorm = 43.2236, GNorm = 0.7636, lr_0 = 3.0625e-04
Loss = 5.0077e-01, PNorm = 43.2532, GNorm = 0.7065, lr_0 = 4.9375e-04
Validation prc-auc = 0.900216
Validation auc = 0.849981
Epoch 1
Loss = 4.3187e-01, PNorm = 43.3058, GNorm = 1.4532, lr_0 = 7.0000e-04
Loss = 4.0005e-01, PNorm = 43.3574, GNorm = 1.6377, lr_0 = 8.8750e-04
Validation prc-auc = 0.891943
Validation auc = 0.856678
Epoch 2
Loss = 4.6694e-01, PNorm = 43.4247, GNorm = 1.7191, lr_0 = 9.8301e-04
Loss = 3.9470e-01, PNorm = 43.4720, GNorm = 1.9802, lr_0 = 9.4990e-04
Loss = 3.9079e-01, PNorm = 43.5200, GNorm = 0.7588, lr_0 = 9.1790e-04
Validation prc-auc = 0.897870
Validation auc = 0.861142
Epoch 3
Loss = 4.7382e-01, PNorm = 43.5790, GNorm = 1.5190, lr_0 = 8.8699e-04
Loss = 3.7737e-01, PNorm = 43.6435, GNorm = 0.4521, lr_0 = 8.5711e-04
Validation prc-auc = 0.900503
Validation auc = 0.865048
Epoch 4
Loss = 3.3128e-01, PNorm = 43.6951, GNorm = 0.8588, lr_0 = 8.2540e-04
Loss = 4.0239e-01, PNorm = 43.7395, GNorm = 0.6170, lr_0 = 7.9760e-04
Loss = 3.5172e-01, PNorm = 43.7806, GNorm = 0.3193, lr_0 = 7.7073e-04
Validation prc-auc = 0.901434
Validation auc = 0.864862
Epoch 5
Loss = 3.3984e-01, PNorm = 43.8087, GNorm = 0.3475, lr_0 = 7.4477e-04
Loss = 3.4304e-01, PNorm = 43.8386, GNorm = 0.6180, lr_0 = 7.1969e-04
Validation prc-auc = 0.905295
Validation auc = 0.865048
Epoch 6
Loss = 3.4435e-01, PNorm = 43.8746, GNorm = 0.4179, lr_0 = 6.9306e-04
Loss = 3.4148e-01, PNorm = 43.9157, GNorm = 0.7066, lr_0 = 6.6972e-04
Loss = 3.4428e-01, PNorm = 43.9501, GNorm = 1.0303, lr_0 = 6.4716e-04
Loss = 3.2831e-01, PNorm = 43.9531, GNorm = 1.2490, lr_0 = 6.4495e-04
Validation prc-auc = 0.916288
Validation auc = 0.867839
Epoch 7
Loss = 3.3393e-01, PNorm = 43.9816, GNorm = 0.3468, lr_0 = 6.2322e-04
Loss = 3.6846e-01, PNorm = 44.0183, GNorm = 0.3357, lr_0 = 6.0223e-04
Validation prc-auc = 0.916159
Validation auc = 0.867467
Epoch 8
Loss = 3.7134e-01, PNorm = 44.0616, GNorm = 0.6203, lr_0 = 5.8194e-04
Loss = 2.9929e-01, PNorm = 44.1073, GNorm = 0.4523, lr_0 = 5.6234e-04
Validation prc-auc = 0.918725
Validation auc = 0.870629
Epoch 9
Loss = 3.0923e-01, PNorm = 44.1459, GNorm = 1.2534, lr_0 = 5.4154e-04
Loss = 3.0731e-01, PNorm = 44.1878, GNorm = 0.3614, lr_0 = 5.2330e-04
Loss = 3.2278e-01, PNorm = 44.2207, GNorm = 0.4602, lr_0 = 5.0567e-04
Validation prc-auc = 0.926871
Validation auc = 0.874349
Epoch 10
Loss = 3.6827e-01, PNorm = 44.2632, GNorm = 0.3600, lr_0 = 4.8864e-04
Loss = 3.0694e-01, PNorm = 44.3056, GNorm = 1.3041, lr_0 = 4.7218e-04
Validation prc-auc = 0.927490
Validation auc = 0.874721
Epoch 11
Loss = 2.5674e-01, PNorm = 44.3464, GNorm = 0.3327, lr_0 = 4.5471e-04
Loss = 3.1075e-01, PNorm = 44.3932, GNorm = 0.9058, lr_0 = 4.3940e-04
Loss = 3.3986e-01, PNorm = 44.4323, GNorm = 0.4691, lr_0 = 4.2460e-04
Validation prc-auc = 0.927766
Validation auc = 0.874349
Epoch 12
Loss = 3.1124e-01, PNorm = 44.4795, GNorm = 1.3295, lr_0 = 4.0889e-04
Loss = 3.1378e-01, PNorm = 44.5057, GNorm = 0.5389, lr_0 = 3.9512e-04
Validation prc-auc = 0.932792
Validation auc = 0.876953
Epoch 13
Loss = 3.0018e-01, PNorm = 44.5494, GNorm = 0.4087, lr_0 = 3.8181e-04
Loss = 3.1336e-01, PNorm = 44.5839, GNorm = 1.4760, lr_0 = 3.6895e-04
Loss = 3.1719e-01, PNorm = 44.6141, GNorm = 0.6905, lr_0 = 3.5652e-04
Validation prc-auc = 0.928058
Validation auc = 0.875837
Epoch 14
Loss = 3.1419e-01, PNorm = 44.6513, GNorm = 0.5598, lr_0 = 3.4333e-04
Loss = 2.8092e-01, PNorm = 44.6884, GNorm = 0.5153, lr_0 = 3.3177e-04
Validation prc-auc = 0.931257
Validation auc = 0.878069
Epoch 15
Loss = 2.7631e-01, PNorm = 44.7236, GNorm = 0.4877, lr_0 = 3.2059e-04
Loss = 2.8842e-01, PNorm = 44.7479, GNorm = 0.8114, lr_0 = 3.0979e-04
Loss = 3.2690e-01, PNorm = 44.7759, GNorm = 0.4140, lr_0 = 2.9936e-04
Loss = 4.0392e-01, PNorm = 44.7783, GNorm = 0.7318, lr_0 = 2.9833e-04
Validation prc-auc = 0.929320
Validation auc = 0.880115
Epoch 16
Loss = 3.0814e-01, PNorm = 44.8092, GNorm = 1.2085, lr_0 = 2.8828e-04
Loss = 3.1756e-01, PNorm = 44.8386, GNorm = 0.3851, lr_0 = 2.7857e-04
Validation prc-auc = 0.935166
Validation auc = 0.882719
Epoch 17
Loss = 2.8246e-01, PNorm = 44.8682, GNorm = 0.2731, lr_0 = 2.6827e-04
Loss = 3.2963e-01, PNorm = 44.8981, GNorm = 0.7129, lr_0 = 2.5923e-04
Validation prc-auc = 0.927103
Validation auc = 0.876581
Epoch 18
Loss = 3.1320e-01, PNorm = 44.9249, GNorm = 0.5707, lr_0 = 2.5050e-04
Loss = 2.8692e-01, PNorm = 44.9413, GNorm = 0.5250, lr_0 = 2.4206e-04
Loss = 3.2488e-01, PNorm = 44.9721, GNorm = 0.6718, lr_0 = 2.3391e-04
Validation prc-auc = 0.934238
Validation auc = 0.881417
Epoch 19
Loss = 3.1725e-01, PNorm = 44.9913, GNorm = 0.8530, lr_0 = 2.2526e-04
Loss = 2.7576e-01, PNorm = 45.0105, GNorm = 0.7251, lr_0 = 2.1767e-04
Validation prc-auc = 0.935553
Validation auc = 0.880859
Epoch 20
Loss = 2.7892e-01, PNorm = 45.0300, GNorm = 0.5004, lr_0 = 2.1034e-04
Loss = 2.8793e-01, PNorm = 45.0486, GNorm = 0.4481, lr_0 = 2.0325e-04
Loss = 2.9386e-01, PNorm = 45.0663, GNorm = 0.4983, lr_0 = 1.9641e-04
Validation prc-auc = 0.936357
Validation auc = 0.881231
Epoch 21
Loss = 3.0684e-01, PNorm = 45.0892, GNorm = 0.9115, lr_0 = 1.8914e-04
Loss = 2.7565e-01, PNorm = 45.1051, GNorm = 0.6997, lr_0 = 1.8277e-04
Validation prc-auc = 0.937346
Validation auc = 0.882719
Epoch 22
Loss = 2.6087e-01, PNorm = 45.1234, GNorm = 0.6307, lr_0 = 1.7601e-04
Loss = 2.8756e-01, PNorm = 45.1409, GNorm = 0.5194, lr_0 = 1.7008e-04
Loss = 3.1145e-01, PNorm = 45.1513, GNorm = 1.0205, lr_0 = 1.6435e-04
Validation prc-auc = 0.941254
Validation auc = 0.888114
Epoch 23
Loss = 2.9655e-01, PNorm = 45.1703, GNorm = 0.5526, lr_0 = 1.5882e-04
Loss = 2.9213e-01, PNorm = 45.1839, GNorm = 0.4043, lr_0 = 1.5347e-04
Validation prc-auc = 0.938152
Validation auc = 0.884022
Epoch 24
Loss = 3.1184e-01, PNorm = 45.1996, GNorm = 0.9390, lr_0 = 1.4779e-04
Loss = 3.2106e-01, PNorm = 45.2155, GNorm = 0.8900, lr_0 = 1.4281e-04
Loss = 2.3962e-01, PNorm = 45.2277, GNorm = 0.4498, lr_0 = 1.3800e-04
Validation prc-auc = 0.939277
Validation auc = 0.885882
Epoch 25
Loss = 2.5158e-01, PNorm = 45.2410, GNorm = 0.5999, lr_0 = 1.3335e-04
Loss = 3.1003e-01, PNorm = 45.2533, GNorm = 0.8397, lr_0 = 1.2886e-04
Validation prc-auc = 0.937316
Validation auc = 0.882719
Epoch 26
Loss = 2.7621e-01, PNorm = 45.2611, GNorm = 0.3998, lr_0 = 1.2409e-04
Loss = 2.9005e-01, PNorm = 45.2744, GNorm = 1.2474, lr_0 = 1.1991e-04
Validation prc-auc = 0.941331
Validation auc = 0.887928
Epoch 27
Loss = 3.2991e-01, PNorm = 45.2806, GNorm = 0.4622, lr_0 = 1.1548e-04
Loss = 3.1667e-01, PNorm = 45.2954, GNorm = 0.5067, lr_0 = 1.1159e-04
Loss = 2.4601e-01, PNorm = 45.3049, GNorm = 0.4704, lr_0 = 1.0783e-04
Validation prc-auc = 0.938501
Validation auc = 0.884766
Epoch 28
Loss = 2.9353e-01, PNorm = 45.3127, GNorm = 0.4427, lr_0 = 1.0420e-04
Loss = 2.7751e-01, PNorm = 45.3234, GNorm = 0.9424, lr_0 = 1.0069e-04
Validation prc-auc = 0.938496
Validation auc = 0.884580
Epoch 29
Loss = 2.6219e-01, PNorm = 45.3313, GNorm = 0.3866, lr_0 = 1.0000e-04
Loss = 2.7600e-01, PNorm = 45.3408, GNorm = 0.7432, lr_0 = 1.0000e-04
Loss = 2.8477e-01, PNorm = 45.3471, GNorm = 0.6327, lr_0 = 1.0000e-04
Validation prc-auc = 0.938966
Validation auc = 0.884766
Model 0 best validation prc-auc = 0.941331 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.940145
Model 0 test auc = 0.905968
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 5.9954e-01, PNorm = 43.2483, GNorm = 0.8364, lr_0 = 3.0625e-04
Loss = 5.1739e-01, PNorm = 43.2751, GNorm = 0.8513, lr_0 = 4.9375e-04
Validation prc-auc = 0.911072
Validation auc = 0.853516
Epoch 1
Loss = 4.7096e-01, PNorm = 43.3210, GNorm = 1.4450, lr_0 = 7.0000e-04
Loss = 4.2247e-01, PNorm = 43.3705, GNorm = 0.6047, lr_0 = 8.8750e-04
Validation prc-auc = 0.903684
Validation auc = 0.858538
Epoch 2
Loss = 3.4516e-01, PNorm = 43.4363, GNorm = 1.2662, lr_0 = 9.8301e-04
Loss = 3.9206e-01, PNorm = 43.4918, GNorm = 1.8499, lr_0 = 9.4990e-04
Loss = 3.9135e-01, PNorm = 43.5435, GNorm = 0.9855, lr_0 = 9.1790e-04
Validation prc-auc = 0.896870
Validation auc = 0.860584
Epoch 3
Loss = 3.8839e-01, PNorm = 43.5873, GNorm = 0.7531, lr_0 = 8.8699e-04
Loss = 3.7102e-01, PNorm = 43.6318, GNorm = 0.5465, lr_0 = 8.5711e-04
Validation prc-auc = 0.908366
Validation auc = 0.862723
Epoch 4
Loss = 3.7217e-01, PNorm = 43.6884, GNorm = 0.4858, lr_0 = 8.2540e-04
Loss = 3.8197e-01, PNorm = 43.7406, GNorm = 1.8088, lr_0 = 7.9760e-04
Loss = 3.4518e-01, PNorm = 43.7903, GNorm = 0.6595, lr_0 = 7.7073e-04
Validation prc-auc = 0.914611
Validation auc = 0.867839
Epoch 5
Loss = 3.8164e-01, PNorm = 43.8354, GNorm = 1.0167, lr_0 = 7.4477e-04
Loss = 3.5967e-01, PNorm = 43.8792, GNorm = 1.7785, lr_0 = 7.1969e-04
Validation prc-auc = 0.915641
Validation auc = 0.870071
Epoch 6
Loss = 2.9530e-01, PNorm = 43.9335, GNorm = 0.6291, lr_0 = 6.9306e-04
Loss = 3.3111e-01, PNorm = 43.9744, GNorm = 0.6576, lr_0 = 6.6972e-04
Loss = 3.5947e-01, PNorm = 44.0272, GNorm = 0.8431, lr_0 = 6.4716e-04
Loss = 5.7117e-01, PNorm = 44.0278, GNorm = 2.4858, lr_0 = 6.4495e-04
Validation prc-auc = 0.920745
Validation auc = 0.870815
Epoch 7
Loss = 3.2216e-01, PNorm = 44.0758, GNorm = 0.6706, lr_0 = 6.2322e-04
Loss = 3.5953e-01, PNorm = 44.1147, GNorm = 0.5027, lr_0 = 6.0223e-04
Validation prc-auc = 0.919405
Validation auc = 0.871745
Epoch 8
Loss = 3.2680e-01, PNorm = 44.1722, GNorm = 0.4576, lr_0 = 5.8194e-04
Loss = 3.4885e-01, PNorm = 44.2141, GNorm = 0.5723, lr_0 = 5.6234e-04
Validation prc-auc = 0.924285
Validation auc = 0.873047
Epoch 9
Loss = 2.8707e-01, PNorm = 44.2588, GNorm = 0.8526, lr_0 = 5.4154e-04
Loss = 3.5511e-01, PNorm = 44.3076, GNorm = 1.2109, lr_0 = 5.2330e-04
Loss = 3.3555e-01, PNorm = 44.3608, GNorm = 0.5819, lr_0 = 5.0567e-04
Validation prc-auc = 0.920460
Validation auc = 0.871187
Epoch 10
Loss = 3.6013e-01, PNorm = 44.3995, GNorm = 0.7127, lr_0 = 4.8864e-04
Loss = 3.2086e-01, PNorm = 44.4448, GNorm = 0.6295, lr_0 = 4.7218e-04
Validation prc-auc = 0.931028
Validation auc = 0.879929
Epoch 11
Loss = 2.8013e-01, PNorm = 44.4886, GNorm = 0.6819, lr_0 = 4.5471e-04
Loss = 3.1924e-01, PNorm = 44.5261, GNorm = 0.9106, lr_0 = 4.3940e-04
Loss = 3.3601e-01, PNorm = 44.5857, GNorm = 0.5839, lr_0 = 4.2460e-04
Validation prc-auc = 0.932244
Validation auc = 0.883278
Epoch 12
Loss = 3.2316e-01, PNorm = 44.6260, GNorm = 0.6168, lr_0 = 4.0889e-04
Loss = 3.1783e-01, PNorm = 44.6751, GNorm = 0.4057, lr_0 = 3.9512e-04
Validation prc-auc = 0.933058
Validation auc = 0.880115
Epoch 13
Loss = 2.8940e-01, PNorm = 44.7186, GNorm = 0.3434, lr_0 = 3.8181e-04
Loss = 3.0733e-01, PNorm = 44.7539, GNorm = 0.4345, lr_0 = 3.6895e-04
Loss = 3.1712e-01, PNorm = 44.7886, GNorm = 0.4061, lr_0 = 3.5652e-04
Validation prc-auc = 0.930025
Validation auc = 0.876023
Epoch 14
Loss = 2.9464e-01, PNorm = 44.8358, GNorm = 1.3786, lr_0 = 3.4333e-04
Loss = 3.0881e-01, PNorm = 44.8561, GNorm = 0.4485, lr_0 = 3.3177e-04
Validation prc-auc = 0.930966
Validation auc = 0.878627
Epoch 15
Loss = 2.6138e-01, PNorm = 44.8875, GNorm = 1.2236, lr_0 = 3.2059e-04
Loss = 3.3869e-01, PNorm = 44.9186, GNorm = 0.7403, lr_0 = 3.0979e-04
Loss = 2.7227e-01, PNorm = 44.9516, GNorm = 0.3382, lr_0 = 2.9936e-04
Loss = 5.0373e-01, PNorm = 44.9551, GNorm = 0.9155, lr_0 = 2.9833e-04
Validation prc-auc = 0.932991
Validation auc = 0.883092
Epoch 16
Loss = 3.0529e-01, PNorm = 44.9845, GNorm = 1.7489, lr_0 = 2.8828e-04
Loss = 2.9701e-01, PNorm = 44.9968, GNorm = 0.7291, lr_0 = 2.7857e-04
Validation prc-auc = 0.935576
Validation auc = 0.881975
Epoch 17
Loss = 2.9249e-01, PNorm = 45.0234, GNorm = 0.5503, lr_0 = 2.6827e-04
Loss = 2.9919e-01, PNorm = 45.0503, GNorm = 0.3961, lr_0 = 2.5923e-04
Validation prc-auc = 0.935743
Validation auc = 0.882161
Epoch 18
Loss = 4.6506e-01, PNorm = 45.0767, GNorm = 1.0915, lr_0 = 2.5050e-04
Loss = 2.6996e-01, PNorm = 45.0951, GNorm = 0.7094, lr_0 = 2.4206e-04
Loss = 2.9881e-01, PNorm = 45.1244, GNorm = 0.9377, lr_0 = 2.3391e-04
Validation prc-auc = 0.933354
Validation auc = 0.884022
Epoch 19
Loss = 3.1501e-01, PNorm = 45.1487, GNorm = 0.6826, lr_0 = 2.2526e-04
Loss = 2.7577e-01, PNorm = 45.1653, GNorm = 0.5362, lr_0 = 2.1767e-04
Validation prc-auc = 0.936693
Validation auc = 0.884022
Epoch 20
Loss = 3.3512e-01, PNorm = 45.1877, GNorm = 0.8292, lr_0 = 2.1034e-04
Loss = 2.9655e-01, PNorm = 45.2050, GNorm = 0.5313, lr_0 = 2.0325e-04
Loss = 2.9030e-01, PNorm = 45.2325, GNorm = 1.0724, lr_0 = 1.9641e-04
Validation prc-auc = 0.932477
Validation auc = 0.881975
Epoch 21
Loss = 2.6650e-01, PNorm = 45.2416, GNorm = 0.6210, lr_0 = 1.8914e-04
Loss = 2.9507e-01, PNorm = 45.2594, GNorm = 0.5371, lr_0 = 1.8277e-04
Validation prc-auc = 0.938720
Validation auc = 0.888300
Epoch 22
Loss = 3.0830e-01, PNorm = 45.2688, GNorm = 0.9876, lr_0 = 1.7601e-04
Loss = 3.0890e-01, PNorm = 45.2901, GNorm = 0.3643, lr_0 = 1.7008e-04
Loss = 2.7210e-01, PNorm = 45.3042, GNorm = 0.4294, lr_0 = 1.6435e-04
Validation prc-auc = 0.936865
Validation auc = 0.885510
Epoch 23
Loss = 3.1372e-01, PNorm = 45.3206, GNorm = 0.4301, lr_0 = 1.5882e-04
Loss = 2.6105e-01, PNorm = 45.3398, GNorm = 0.5681, lr_0 = 1.5347e-04
Validation prc-auc = 0.934465
Validation auc = 0.881045
Epoch 24
Loss = 3.0910e-01, PNorm = 45.3529, GNorm = 0.7748, lr_0 = 1.4779e-04
Loss = 2.5074e-01, PNorm = 45.3684, GNorm = 0.7250, lr_0 = 1.4281e-04
Loss = 2.8899e-01, PNorm = 45.3821, GNorm = 0.8890, lr_0 = 1.3800e-04
Validation prc-auc = 0.932795
Validation auc = 0.880301
Epoch 25
Loss = 2.5755e-01, PNorm = 45.3881, GNorm = 0.6121, lr_0 = 1.3335e-04
Loss = 3.2046e-01, PNorm = 45.4004, GNorm = 0.7480, lr_0 = 1.2886e-04
Validation prc-auc = 0.937451
Validation auc = 0.884580
Epoch 26
Loss = 2.3353e-01, PNorm = 45.4098, GNorm = 0.4635, lr_0 = 1.2409e-04
Loss = 2.8735e-01, PNorm = 45.4238, GNorm = 0.3809, lr_0 = 1.1991e-04
Validation prc-auc = 0.937750
Validation auc = 0.884952
Epoch 27
Loss = 2.7800e-01, PNorm = 45.4335, GNorm = 0.8531, lr_0 = 1.1548e-04
Loss = 2.9009e-01, PNorm = 45.4449, GNorm = 1.4354, lr_0 = 1.1159e-04
Loss = 2.7285e-01, PNorm = 45.4540, GNorm = 0.5154, lr_0 = 1.0783e-04
Validation prc-auc = 0.936267
Validation auc = 0.881603
Epoch 28
Loss = 2.9615e-01, PNorm = 45.4622, GNorm = 0.6494, lr_0 = 1.0420e-04
Loss = 2.5198e-01, PNorm = 45.4719, GNorm = 1.0990, lr_0 = 1.0069e-04
Validation prc-auc = 0.940323
Validation auc = 0.886254
Epoch 29
Loss = 1.8903e-01, PNorm = 45.4786, GNorm = 0.7241, lr_0 = 1.0000e-04
Loss = 3.0448e-01, PNorm = 45.4882, GNorm = 0.6980, lr_0 = 1.0000e-04
Loss = 2.8261e-01, PNorm = 45.4887, GNorm = 0.4161, lr_0 = 1.0000e-04
Validation prc-auc = 0.940469
Validation auc = 0.887184
Model 1 best validation prc-auc = 0.940469 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.935664
Model 1 test auc = 0.908132
Ensemble test prc-auc = 0.937363
Ensemble test auc = 0.906870
Fold 2
Splitting data with seed 2
Total scaffolds = 652 | train scaffolds = 509 | val scaffolds = 59 | test scaffolds = 84
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 57 | target average = 0.912281


Scaffold 1
Task 0: count = 42 | target average = 0.142857


Scaffold 2
Task 0: count = 29 | target average = 0.827586


Scaffold 3
Task 0: count = 19 | target average = 0.315789


Scaffold 4
Task 0: count = 18 | target average = 0.166667


Scaffold 5
Task 0: count = 16 | target average = 0.187500


Scaffold 6
Task 0: count = 15 | target average = 0.133333


Scaffold 7
Task 0: count = 14 | target average = 0.214286


Scaffold 8
Task 0: count = 13 | target average = 0.384615


Scaffold 9
Task 0: count = 13 | target average = 0.384615


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.2524e-01, PNorm = 43.2246, GNorm = 1.1313, lr_0 = 3.0625e-04
Loss = 5.3330e-01, PNorm = 43.2503, GNorm = 2.2857, lr_0 = 4.9375e-04
Validation prc-auc = 0.927109
Validation auc = 0.768741
Epoch 1
Loss = 5.1781e-01, PNorm = 43.2924, GNorm = 1.1200, lr_0 = 7.0000e-04
Loss = 4.5911e-01, PNorm = 43.3441, GNorm = 0.6621, lr_0 = 8.8750e-04
Validation prc-auc = 0.916845
Validation auc = 0.767556
Epoch 2
Loss = 3.2924e-01, PNorm = 43.4190, GNorm = 0.5062, lr_0 = 9.8301e-04
Loss = 4.3847e-01, PNorm = 43.4850, GNorm = 3.0712, lr_0 = 9.4990e-04
Loss = 4.2692e-01, PNorm = 43.5417, GNorm = 0.8428, lr_0 = 9.1790e-04
Validation prc-auc = 0.920665
Validation auc = 0.781778
Epoch 3
Loss = 4.4947e-01, PNorm = 43.5950, GNorm = 1.7631, lr_0 = 8.8699e-04
Loss = 3.9725e-01, PNorm = 43.6517, GNorm = 0.3919, lr_0 = 8.5711e-04
Validation prc-auc = 0.909896
Validation auc = 0.776741
Epoch 4
Loss = 4.1892e-01, PNorm = 43.7223, GNorm = 0.6871, lr_0 = 8.2540e-04
Loss = 3.8066e-01, PNorm = 43.7730, GNorm = 0.5281, lr_0 = 7.9760e-04
Loss = 3.7061e-01, PNorm = 43.8244, GNorm = 1.0384, lr_0 = 7.7073e-04
Validation prc-auc = 0.918569
Validation auc = 0.776444
Epoch 5
Loss = 3.5359e-01, PNorm = 43.8813, GNorm = 0.5305, lr_0 = 7.4477e-04
Loss = 3.6701e-01, PNorm = 43.9399, GNorm = 1.0794, lr_0 = 7.1969e-04
Validation prc-auc = 0.903397
Validation auc = 0.767556
Epoch 6
Loss = 3.9577e-01, PNorm = 43.9945, GNorm = 0.6322, lr_0 = 6.9306e-04
Loss = 3.4595e-01, PNorm = 44.0382, GNorm = 0.3953, lr_0 = 6.6972e-04
Loss = 3.7920e-01, PNorm = 44.1018, GNorm = 0.7515, lr_0 = 6.4716e-04
Loss = 1.8542e-01, PNorm = 44.1075, GNorm = 0.5045, lr_0 = 6.4495e-04
Validation prc-auc = 0.927395
Validation auc = 0.780889
Epoch 7
Loss = 3.6525e-01, PNorm = 44.1491, GNorm = 0.9862, lr_0 = 6.2322e-04
Loss = 3.2901e-01, PNorm = 44.1969, GNorm = 0.8790, lr_0 = 6.0223e-04
Validation prc-auc = 0.912996
Validation auc = 0.764889
Epoch 8
Loss = 3.0764e-01, PNorm = 44.2349, GNorm = 0.7010, lr_0 = 5.8194e-04
Loss = 3.4300e-01, PNorm = 44.2827, GNorm = 0.6059, lr_0 = 5.6234e-04
Validation prc-auc = 0.902126
Validation auc = 0.761037
Epoch 9
Loss = 2.7169e-01, PNorm = 44.3265, GNorm = 0.8597, lr_0 = 5.4154e-04
Loss = 3.3427e-01, PNorm = 44.3620, GNorm = 0.8877, lr_0 = 5.2330e-04
Loss = 3.6283e-01, PNorm = 44.3955, GNorm = 0.9354, lr_0 = 5.0567e-04
Validation prc-auc = 0.900814
Validation auc = 0.766074
Epoch 10
Loss = 3.4777e-01, PNorm = 44.4492, GNorm = 0.5952, lr_0 = 4.8864e-04
Loss = 3.9367e-01, PNorm = 44.4902, GNorm = 0.3600, lr_0 = 4.7218e-04
Validation prc-auc = 0.893427
Validation auc = 0.755704
Epoch 11
Loss = 3.3837e-01, PNorm = 44.5440, GNorm = 0.7227, lr_0 = 4.5471e-04
Loss = 3.5802e-01, PNorm = 44.6038, GNorm = 0.3868, lr_0 = 4.3940e-04
Loss = 3.3542e-01, PNorm = 44.6410, GNorm = 0.4123, lr_0 = 4.2460e-04
Validation prc-auc = 0.912254
Validation auc = 0.769630
Epoch 12
Loss = 3.4436e-01, PNorm = 44.6862, GNorm = 0.5793, lr_0 = 4.0889e-04
Loss = 3.0956e-01, PNorm = 44.7328, GNorm = 0.8370, lr_0 = 3.9512e-04
Validation prc-auc = 0.901884
Validation auc = 0.760444
Epoch 13
Loss = 3.3202e-01, PNorm = 44.7540, GNorm = 0.7308, lr_0 = 3.8181e-04
Loss = 3.2490e-01, PNorm = 44.7943, GNorm = 1.0766, lr_0 = 3.6895e-04
Loss = 3.1281e-01, PNorm = 44.8170, GNorm = 1.4610, lr_0 = 3.5652e-04
Validation prc-auc = 0.907797
Validation auc = 0.761630
Epoch 14
Loss = 3.4291e-01, PNorm = 44.8568, GNorm = 0.4025, lr_0 = 3.4333e-04
Loss = 3.1482e-01, PNorm = 44.8905, GNorm = 1.1431, lr_0 = 3.3177e-04
Validation prc-auc = 0.899555
Validation auc = 0.754519
Epoch 15
Loss = 3.4900e-01, PNorm = 44.9144, GNorm = 1.0675, lr_0 = 3.2059e-04
Loss = 3.4118e-01, PNorm = 44.9421, GNorm = 0.4461, lr_0 = 3.0979e-04
Loss = 3.1620e-01, PNorm = 44.9865, GNorm = 0.4839, lr_0 = 2.9936e-04
Loss = 1.2955e-01, PNorm = 44.9915, GNorm = 0.5108, lr_0 = 2.9833e-04
Validation prc-auc = 0.887240
Validation auc = 0.743852
Epoch 16
Loss = 3.2455e-01, PNorm = 45.0148, GNorm = 0.4229, lr_0 = 2.8828e-04
Loss = 3.0132e-01, PNorm = 45.0455, GNorm = 0.9197, lr_0 = 2.7857e-04
Validation prc-auc = 0.901958
Validation auc = 0.766370
Epoch 17
Loss = 3.3962e-01, PNorm = 45.0656, GNorm = 0.6218, lr_0 = 2.6827e-04
Loss = 2.9652e-01, PNorm = 45.1033, GNorm = 0.5825, lr_0 = 2.5923e-04
Validation prc-auc = 0.903103
Validation auc = 0.765185
Epoch 18
Loss = 2.6603e-01, PNorm = 45.1274, GNorm = 1.3130, lr_0 = 2.5050e-04
Loss = 3.1095e-01, PNorm = 45.1623, GNorm = 0.4667, lr_0 = 2.4206e-04
Loss = 3.4332e-01, PNorm = 45.1624, GNorm = 0.3888, lr_0 = 2.3391e-04
Validation prc-auc = 0.902500
Validation auc = 0.773185
Epoch 19
Loss = 3.3916e-01, PNorm = 45.1943, GNorm = 0.9340, lr_0 = 2.2526e-04
Loss = 3.2732e-01, PNorm = 45.2112, GNorm = 0.4451, lr_0 = 2.1767e-04
Validation prc-auc = 0.893509
Validation auc = 0.756593
Epoch 20
Loss = 2.7383e-01, PNorm = 45.2385, GNorm = 0.3853, lr_0 = 2.1034e-04
Loss = 3.0563e-01, PNorm = 45.2586, GNorm = 0.3112, lr_0 = 2.0325e-04
Loss = 3.0160e-01, PNorm = 45.2732, GNorm = 0.5020, lr_0 = 1.9641e-04
Validation prc-auc = 0.903208
Validation auc = 0.770815
Epoch 21
Loss = 3.2209e-01, PNorm = 45.3001, GNorm = 0.6183, lr_0 = 1.8914e-04
Loss = 2.9161e-01, PNorm = 45.3106, GNorm = 0.3750, lr_0 = 1.8277e-04
Validation prc-auc = 0.902760
Validation auc = 0.772000
Epoch 22
Loss = 2.5638e-01, PNorm = 45.3381, GNorm = 0.8207, lr_0 = 1.7601e-04
Loss = 3.2869e-01, PNorm = 45.3498, GNorm = 0.3659, lr_0 = 1.7008e-04
Loss = 2.9647e-01, PNorm = 45.3677, GNorm = 0.4237, lr_0 = 1.6435e-04
Validation prc-auc = 0.902516
Validation auc = 0.770815
Epoch 23
Loss = 3.1556e-01, PNorm = 45.3812, GNorm = 0.4404, lr_0 = 1.5882e-04
Loss = 2.7911e-01, PNorm = 45.3937, GNorm = 0.9075, lr_0 = 1.5347e-04
Validation prc-auc = 0.897876
Validation auc = 0.770815
Epoch 24
Loss = 2.8763e-01, PNorm = 45.4094, GNorm = 0.4797, lr_0 = 1.4779e-04
Loss = 3.1179e-01, PNorm = 45.4248, GNorm = 0.5294, lr_0 = 1.4281e-04
Loss = 3.0783e-01, PNorm = 45.4408, GNorm = 1.5542, lr_0 = 1.3800e-04
Validation prc-auc = 0.898537
Validation auc = 0.768741
Epoch 25
Loss = 3.4736e-01, PNorm = 45.4480, GNorm = 0.4626, lr_0 = 1.3335e-04
Loss = 2.6911e-01, PNorm = 45.4696, GNorm = 1.1411, lr_0 = 1.2886e-04
Validation prc-auc = 0.902134
Validation auc = 0.775259
Epoch 26
Loss = 2.5967e-01, PNorm = 45.4780, GNorm = 0.4112, lr_0 = 1.2409e-04
Loss = 2.9926e-01, PNorm = 45.4948, GNorm = 1.4924, lr_0 = 1.1991e-04
Validation prc-auc = 0.901951
Validation auc = 0.773778
Epoch 27
Loss = 2.9844e-01, PNorm = 45.5007, GNorm = 0.3226, lr_0 = 1.1548e-04
Loss = 2.9198e-01, PNorm = 45.5150, GNorm = 0.4036, lr_0 = 1.1159e-04
Loss = 3.0314e-01, PNorm = 45.5221, GNorm = 1.2891, lr_0 = 1.0783e-04
Validation prc-auc = 0.901480
Validation auc = 0.773185
Epoch 28
Loss = 2.9333e-01, PNorm = 45.5348, GNorm = 0.6763, lr_0 = 1.0420e-04
Loss = 2.5469e-01, PNorm = 45.5428, GNorm = 0.5406, lr_0 = 1.0069e-04
Validation prc-auc = 0.901339
Validation auc = 0.774667
Epoch 29
Loss = 3.1552e-01, PNorm = 45.5534, GNorm = 0.5071, lr_0 = 1.0000e-04
Loss = 2.8872e-01, PNorm = 45.5620, GNorm = 1.0023, lr_0 = 1.0000e-04
Loss = 2.8345e-01, PNorm = 45.5788, GNorm = 0.3650, lr_0 = 1.0000e-04
Validation prc-auc = 0.905017
Validation auc = 0.778222
Model 0 best validation prc-auc = 0.927395 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.931813
Model 0 test auc = 0.902326
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.0441e-01, PNorm = 43.2493, GNorm = 1.8148, lr_0 = 3.0625e-04
Loss = 5.0728e-01, PNorm = 43.2776, GNorm = 1.7818, lr_0 = 4.9375e-04
Validation prc-auc = 0.917445
Validation auc = 0.781185
Epoch 1
Loss = 4.5105e-01, PNorm = 43.3216, GNorm = 1.8329, lr_0 = 7.0000e-04
Loss = 4.4403e-01, PNorm = 43.3737, GNorm = 1.3753, lr_0 = 8.8750e-04
Validation prc-auc = 0.931895
Validation auc = 0.780296
Epoch 2
Loss = 2.9902e-01, PNorm = 43.4459, GNorm = 0.4690, lr_0 = 9.8301e-04
Loss = 3.9563e-01, PNorm = 43.5191, GNorm = 0.7770, lr_0 = 9.4990e-04
Loss = 4.2267e-01, PNorm = 43.5801, GNorm = 0.6766, lr_0 = 9.1790e-04
Validation prc-auc = 0.908631
Validation auc = 0.766963
Epoch 3
Loss = 3.9564e-01, PNorm = 43.6325, GNorm = 1.1306, lr_0 = 8.8699e-04
Loss = 3.8224e-01, PNorm = 43.6812, GNorm = 0.4719, lr_0 = 8.5711e-04
Validation prc-auc = 0.932119
Validation auc = 0.782963
Epoch 4
Loss = 2.8884e-01, PNorm = 43.7485, GNorm = 0.4332, lr_0 = 8.2540e-04
Loss = 4.0899e-01, PNorm = 43.8161, GNorm = 2.2339, lr_0 = 7.9760e-04
Loss = 3.8614e-01, PNorm = 43.8767, GNorm = 0.6152, lr_0 = 7.7073e-04
Validation prc-auc = 0.928915
Validation auc = 0.785926
Epoch 5
Loss = 3.6513e-01, PNorm = 43.9265, GNorm = 0.4465, lr_0 = 7.4477e-04
Loss = 3.6216e-01, PNorm = 43.9774, GNorm = 0.7581, lr_0 = 7.1969e-04
Validation prc-auc = 0.911910
Validation auc = 0.771407
Epoch 6
Loss = 3.5536e-01, PNorm = 44.0372, GNorm = 0.4562, lr_0 = 6.9306e-04
Loss = 3.7826e-01, PNorm = 44.0963, GNorm = 1.8949, lr_0 = 6.6972e-04
Loss = 3.3997e-01, PNorm = 44.1428, GNorm = 0.5884, lr_0 = 6.4716e-04
Loss = 4.4368e-01, PNorm = 44.1493, GNorm = 1.9910, lr_0 = 6.4495e-04
Validation prc-auc = 0.902993
Validation auc = 0.762222
Epoch 7
Loss = 3.6254e-01, PNorm = 44.1759, GNorm = 0.4151, lr_0 = 6.2322e-04
Loss = 3.4378e-01, PNorm = 44.2197, GNorm = 0.4043, lr_0 = 6.0223e-04
Validation prc-auc = 0.899817
Validation auc = 0.755704
Epoch 8
Loss = 3.3185e-01, PNorm = 44.2810, GNorm = 0.6833, lr_0 = 5.8194e-04
Loss = 3.4422e-01, PNorm = 44.3223, GNorm = 0.7243, lr_0 = 5.6234e-04
Validation prc-auc = 0.903697
Validation auc = 0.757778
Epoch 9
Loss = 3.0365e-01, PNorm = 44.3639, GNorm = 0.4270, lr_0 = 5.4154e-04
Loss = 3.4839e-01, PNorm = 44.4137, GNorm = 0.9813, lr_0 = 5.2330e-04
Loss = 3.6589e-01, PNorm = 44.4537, GNorm = 0.6762, lr_0 = 5.0567e-04
Validation prc-auc = 0.907488
Validation auc = 0.766963
Epoch 10
Loss = 2.9792e-01, PNorm = 44.5009, GNorm = 0.4185, lr_0 = 4.8864e-04
Loss = 3.9650e-01, PNorm = 44.5287, GNorm = 1.0035, lr_0 = 4.7218e-04
Validation prc-auc = 0.904590
Validation auc = 0.761333
Epoch 11
Loss = 3.5515e-01, PNorm = 44.5737, GNorm = 1.6690, lr_0 = 4.5471e-04
Loss = 3.0147e-01, PNorm = 44.6171, GNorm = 0.7515, lr_0 = 4.3940e-04
Loss = 3.2913e-01, PNorm = 44.6510, GNorm = 0.6598, lr_0 = 4.2460e-04
Validation prc-auc = 0.904011
Validation auc = 0.759259
Epoch 12
Loss = 3.5254e-01, PNorm = 44.6844, GNorm = 0.6819, lr_0 = 4.0889e-04
Loss = 3.0830e-01, PNorm = 44.7150, GNorm = 0.5451, lr_0 = 3.9512e-04
Validation prc-auc = 0.900327
Validation auc = 0.756000
Epoch 13
Loss = 3.1469e-01, PNorm = 44.7598, GNorm = 0.3899, lr_0 = 3.8181e-04
Loss = 3.2517e-01, PNorm = 44.8114, GNorm = 0.5027, lr_0 = 3.6895e-04
Loss = 3.0095e-01, PNorm = 44.8375, GNorm = 0.5953, lr_0 = 3.5652e-04
Validation prc-auc = 0.902188
Validation auc = 0.766074
Epoch 14
Loss = 3.1827e-01, PNorm = 44.8586, GNorm = 0.8905, lr_0 = 3.4333e-04
Loss = 3.3917e-01, PNorm = 44.8809, GNorm = 0.5265, lr_0 = 3.3177e-04
Validation prc-auc = 0.901611
Validation auc = 0.761926
Epoch 15
Loss = 3.1648e-01, PNorm = 44.9192, GNorm = 0.7124, lr_0 = 3.2059e-04
Loss = 3.2997e-01, PNorm = 44.9492, GNorm = 0.5122, lr_0 = 3.0979e-04
Loss = 3.0240e-01, PNorm = 44.9817, GNorm = 1.3565, lr_0 = 2.9936e-04
Loss = 2.9180e-01, PNorm = 44.9851, GNorm = 0.7515, lr_0 = 2.9833e-04
Validation prc-auc = 0.902117
Validation auc = 0.763407
Epoch 16
Loss = 2.9111e-01, PNorm = 45.0182, GNorm = 0.9758, lr_0 = 2.8828e-04
Loss = 3.6003e-01, PNorm = 45.0355, GNorm = 0.7314, lr_0 = 2.7857e-04
Validation prc-auc = 0.905724
Validation auc = 0.768444
Epoch 17
Loss = 2.8328e-01, PNorm = 45.0632, GNorm = 0.4865, lr_0 = 2.6827e-04
Loss = 3.2372e-01, PNorm = 45.0849, GNorm = 0.5866, lr_0 = 2.5923e-04
Validation prc-auc = 0.898596
Validation auc = 0.758370
Epoch 18
Loss = 2.5100e-01, PNorm = 45.1056, GNorm = 0.8595, lr_0 = 2.5050e-04
Loss = 3.3723e-01, PNorm = 45.1275, GNorm = 1.7852, lr_0 = 2.4206e-04
Loss = 3.1957e-01, PNorm = 45.1488, GNorm = 0.4878, lr_0 = 2.3391e-04
Validation prc-auc = 0.901336
Validation auc = 0.766667
Epoch 19
Loss = 3.0240e-01, PNorm = 45.1802, GNorm = 0.9954, lr_0 = 2.2526e-04
Loss = 3.1335e-01, PNorm = 45.2020, GNorm = 0.4508, lr_0 = 2.1767e-04
Validation prc-auc = 0.903784
Validation auc = 0.759852
Epoch 20
Loss = 2.8788e-01, PNorm = 45.2251, GNorm = 0.4646, lr_0 = 2.1034e-04
Loss = 3.0816e-01, PNorm = 45.2310, GNorm = 0.9133, lr_0 = 2.0325e-04
Loss = 3.0071e-01, PNorm = 45.2583, GNorm = 0.7559, lr_0 = 1.9641e-04
Validation prc-auc = 0.907039
Validation auc = 0.774667
Epoch 21
Loss = 3.1489e-01, PNorm = 45.2754, GNorm = 1.0351, lr_0 = 1.8914e-04
Loss = 2.9038e-01, PNorm = 45.2926, GNorm = 0.4883, lr_0 = 1.8277e-04
Validation prc-auc = 0.904939
Validation auc = 0.766222
Epoch 22
Loss = 2.6665e-01, PNorm = 45.3198, GNorm = 0.7738, lr_0 = 1.7601e-04
Loss = 3.1797e-01, PNorm = 45.3290, GNorm = 0.5913, lr_0 = 1.7008e-04
Loss = 2.9277e-01, PNorm = 45.3455, GNorm = 0.6661, lr_0 = 1.6435e-04
Validation prc-auc = 0.904624
Validation auc = 0.769333
Epoch 23
Loss = 2.9936e-01, PNorm = 45.3562, GNorm = 0.4963, lr_0 = 1.5882e-04
Loss = 3.0112e-01, PNorm = 45.3663, GNorm = 0.3921, lr_0 = 1.5347e-04
Validation prc-auc = 0.902700
Validation auc = 0.771704
Epoch 24
Loss = 3.4637e-01, PNorm = 45.3794, GNorm = 0.5185, lr_0 = 1.4779e-04
Loss = 2.7362e-01, PNorm = 45.3973, GNorm = 1.0821, lr_0 = 1.4281e-04
Loss = 3.0294e-01, PNorm = 45.4146, GNorm = 0.8511, lr_0 = 1.3800e-04
Validation prc-auc = 0.906622
Validation auc = 0.774370
Epoch 25
Loss = 2.7931e-01, PNorm = 45.4200, GNorm = 1.9668, lr_0 = 1.3335e-04
Loss = 3.1471e-01, PNorm = 45.4316, GNorm = 0.7330, lr_0 = 1.2886e-04
Validation prc-auc = 0.902224
Validation auc = 0.770815
Epoch 26
Loss = 2.6427e-01, PNorm = 45.4452, GNorm = 0.7811, lr_0 = 1.2409e-04
Loss = 3.2016e-01, PNorm = 45.4554, GNorm = 0.4409, lr_0 = 1.1991e-04
Validation prc-auc = 0.910066
Validation auc = 0.775259
Epoch 27
Loss = 2.6899e-01, PNorm = 45.4638, GNorm = 0.6904, lr_0 = 1.1548e-04
Loss = 3.0640e-01, PNorm = 45.4774, GNorm = 0.4895, lr_0 = 1.1159e-04
Loss = 2.9040e-01, PNorm = 45.4861, GNorm = 0.8417, lr_0 = 1.0783e-04
Validation prc-auc = 0.911190
Validation auc = 0.778222
Epoch 28
Loss = 2.8747e-01, PNorm = 45.4957, GNorm = 0.6470, lr_0 = 1.0420e-04
Loss = 2.9851e-01, PNorm = 45.5028, GNorm = 0.9382, lr_0 = 1.0069e-04
Validation prc-auc = 0.911297
Validation auc = 0.778815
Epoch 29
Loss = 3.1090e-01, PNorm = 45.5106, GNorm = 0.4662, lr_0 = 1.0000e-04
Loss = 2.7384e-01, PNorm = 45.5216, GNorm = 0.5505, lr_0 = 1.0000e-04
Loss = 3.0286e-01, PNorm = 45.5285, GNorm = 0.5213, lr_0 = 1.0000e-04
Validation prc-auc = 0.911523
Validation auc = 0.780593
Model 1 best validation prc-auc = 0.932119 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.955510
Model 1 test auc = 0.910148
Ensemble test prc-auc = 0.949992
Ensemble test auc = 0.907822
Fold 3
Splitting data with seed 3
Total scaffolds = 652 | train scaffolds = 517 | val scaffolds = 71 | test scaffolds = 64
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 57 | target average = 0.912281


Scaffold 1
Task 0: count = 42 | target average = 0.142857


Scaffold 2
Task 0: count = 29 | target average = 0.827586


Scaffold 3
Task 0: count = 19 | target average = 0.315789


Scaffold 4
Task 0: count = 18 | target average = 0.166667


Scaffold 5
Task 0: count = 16 | target average = 0.187500


Scaffold 6
Task 0: count = 15 | target average = 0.133333


Scaffold 7
Task 0: count = 14 | target average = 0.214286


Scaffold 8
Task 0: count = 13 | target average = 0.384615


Scaffold 9
Task 0: count = 13 | target average = 0.153846


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.0121e-01, PNorm = 43.2246, GNorm = 1.3759, lr_0 = 3.0625e-04
Loss = 5.2901e-01, PNorm = 43.2486, GNorm = 2.5456, lr_0 = 4.9375e-04
Validation prc-auc = 0.950383
Validation auc = 0.893002
Epoch 1
Loss = 4.5654e-01, PNorm = 43.2898, GNorm = 0.8322, lr_0 = 7.0000e-04
Loss = 4.3143e-01, PNorm = 43.3469, GNorm = 1.2104, lr_0 = 8.8750e-04
Validation prc-auc = 0.926090
Validation auc = 0.871453
Epoch 2
Loss = 4.1422e-01, PNorm = 43.4271, GNorm = 2.0956, lr_0 = 9.8301e-04
Loss = 4.0094e-01, PNorm = 43.4898, GNorm = 0.7579, lr_0 = 9.4990e-04
Loss = 4.0239e-01, PNorm = 43.5515, GNorm = 1.1566, lr_0 = 9.1790e-04
Validation prc-auc = 0.916190
Validation auc = 0.867613
Epoch 3
Loss = 3.7902e-01, PNorm = 43.6080, GNorm = 1.0612, lr_0 = 8.8699e-04
Loss = 3.9317e-01, PNorm = 43.6668, GNorm = 0.9666, lr_0 = 8.5711e-04
Validation prc-auc = 0.918273
Validation auc = 0.871666
Epoch 4
Loss = 4.1881e-01, PNorm = 43.7395, GNorm = 0.5079, lr_0 = 8.2540e-04
Loss = 3.4976e-01, PNorm = 43.8045, GNorm = 0.3545, lr_0 = 7.9760e-04
Loss = 3.8459e-01, PNorm = 43.8494, GNorm = 0.6066, lr_0 = 7.7073e-04
Validation prc-auc = 0.911630
Validation auc = 0.871880
Epoch 5
Loss = 3.5945e-01, PNorm = 43.9279, GNorm = 1.0539, lr_0 = 7.4477e-04
Loss = 3.8189e-01, PNorm = 43.9749, GNorm = 1.2948, lr_0 = 7.1969e-04
Validation prc-auc = 0.911818
Validation auc = 0.870813
Epoch 6
Loss = 3.4692e-01, PNorm = 44.0463, GNorm = 0.5687, lr_0 = 6.9306e-04
Loss = 3.3862e-01, PNorm = 44.1176, GNorm = 0.3397, lr_0 = 6.6972e-04
Loss = 3.5899e-01, PNorm = 44.1763, GNorm = 0.5769, lr_0 = 6.4716e-04
Loss = 4.2876e-01, PNorm = 44.1815, GNorm = 1.6402, lr_0 = 6.4495e-04
Validation prc-auc = 0.921609
Validation auc = 0.883614
Epoch 7
Loss = 3.6694e-01, PNorm = 44.2249, GNorm = 0.9535, lr_0 = 6.2322e-04
Loss = 3.3851e-01, PNorm = 44.2883, GNorm = 0.4814, lr_0 = 6.0223e-04
Validation prc-auc = 0.920793
Validation auc = 0.888095
Epoch 8
Loss = 3.3220e-01, PNorm = 44.3461, GNorm = 0.4262, lr_0 = 5.8194e-04
Loss = 3.7562e-01, PNorm = 44.3977, GNorm = 0.5313, lr_0 = 5.6234e-04
Validation prc-auc = 0.909008
Validation auc = 0.882334
Epoch 9
Loss = 2.9913e-01, PNorm = 44.4540, GNorm = 0.4497, lr_0 = 5.4154e-04
Loss = 3.1798e-01, PNorm = 44.5027, GNorm = 0.8450, lr_0 = 5.2330e-04
Loss = 3.6491e-01, PNorm = 44.5610, GNorm = 0.7912, lr_0 = 5.0567e-04
Validation prc-auc = 0.895415
Validation auc = 0.881054
Epoch 10
Loss = 3.2862e-01, PNorm = 44.5854, GNorm = 1.8579, lr_0 = 4.8864e-04
Loss = 3.6204e-01, PNorm = 44.6453, GNorm = 0.4932, lr_0 = 4.7218e-04
Validation prc-auc = 0.899647
Validation auc = 0.884041
Epoch 11
Loss = 3.3393e-01, PNorm = 44.6980, GNorm = 0.9928, lr_0 = 4.5471e-04
Loss = 3.1250e-01, PNorm = 44.7402, GNorm = 0.7896, lr_0 = 4.3940e-04
Loss = 3.5338e-01, PNorm = 44.7816, GNorm = 0.5269, lr_0 = 4.2460e-04
Validation prc-auc = 0.917366
Validation auc = 0.890655
Epoch 12
Loss = 3.5148e-01, PNorm = 44.8186, GNorm = 0.6100, lr_0 = 4.0889e-04
Loss = 3.2624e-01, PNorm = 44.8425, GNorm = 0.4124, lr_0 = 3.9512e-04
Validation prc-auc = 0.909517
Validation auc = 0.892362
Epoch 13
Loss = 3.6585e-01, PNorm = 44.8771, GNorm = 1.9425, lr_0 = 3.8181e-04
Loss = 3.3129e-01, PNorm = 44.9201, GNorm = 0.6248, lr_0 = 3.6895e-04
Loss = 3.3152e-01, PNorm = 44.9609, GNorm = 0.9201, lr_0 = 3.5652e-04
Validation prc-auc = 0.918676
Validation auc = 0.888521
Epoch 14
Loss = 3.2267e-01, PNorm = 45.0043, GNorm = 0.5188, lr_0 = 3.4333e-04
Loss = 3.0567e-01, PNorm = 45.0184, GNorm = 1.0874, lr_0 = 3.3177e-04
Validation prc-auc = 0.902062
Validation auc = 0.885748
Epoch 15
Loss = 3.5146e-01, PNorm = 45.0511, GNorm = 0.7604, lr_0 = 3.2059e-04
Loss = 3.3416e-01, PNorm = 45.0852, GNorm = 0.3924, lr_0 = 3.0979e-04
Loss = 2.8017e-01, PNorm = 45.1168, GNorm = 0.6500, lr_0 = 2.9936e-04
Loss = 2.7382e-01, PNorm = 45.1193, GNorm = 0.5406, lr_0 = 2.9833e-04
Validation prc-auc = 0.918353
Validation auc = 0.891295
Epoch 16
Loss = 3.2193e-01, PNorm = 45.1407, GNorm = 0.9380, lr_0 = 2.8828e-04
Loss = 3.0043e-01, PNorm = 45.1642, GNorm = 0.8532, lr_0 = 2.7857e-04
Validation prc-auc = 0.914686
Validation auc = 0.889162
Epoch 17
Loss = 2.5988e-01, PNorm = 45.1843, GNorm = 0.4607, lr_0 = 2.6827e-04
Loss = 3.3254e-01, PNorm = 45.2126, GNorm = 0.6388, lr_0 = 2.5923e-04
Validation prc-auc = 0.919213
Validation auc = 0.895989
Epoch 18
Loss = 2.8227e-01, PNorm = 45.2278, GNorm = 0.3552, lr_0 = 2.5050e-04
Loss = 3.1861e-01, PNorm = 45.2510, GNorm = 0.6938, lr_0 = 2.4206e-04
Loss = 2.8855e-01, PNorm = 45.2783, GNorm = 0.8405, lr_0 = 2.3391e-04
Validation prc-auc = 0.920886
Validation auc = 0.891508
Epoch 19
Loss = 3.4005e-01, PNorm = 45.3076, GNorm = 0.7703, lr_0 = 2.2526e-04
Loss = 3.2596e-01, PNorm = 45.3184, GNorm = 2.3663, lr_0 = 2.1767e-04
Validation prc-auc = 0.925938
Validation auc = 0.892148
Epoch 20
Loss = 3.0807e-01, PNorm = 45.3580, GNorm = 1.1097, lr_0 = 2.1034e-04
Loss = 3.0444e-01, PNorm = 45.3686, GNorm = 0.5501, lr_0 = 2.0325e-04
Loss = 3.0327e-01, PNorm = 45.4039, GNorm = 0.4310, lr_0 = 1.9641e-04
Validation prc-auc = 0.925591
Validation auc = 0.894069
Epoch 21
Loss = 3.1073e-01, PNorm = 45.4114, GNorm = 0.5894, lr_0 = 1.8914e-04
Loss = 2.9698e-01, PNorm = 45.4311, GNorm = 0.6692, lr_0 = 1.8277e-04
Validation prc-auc = 0.925593
Validation auc = 0.893642
Epoch 22
Loss = 3.2175e-01, PNorm = 45.4436, GNorm = 0.6423, lr_0 = 1.7601e-04
Loss = 3.0592e-01, PNorm = 45.4608, GNorm = 0.4728, lr_0 = 1.7008e-04
Loss = 2.9710e-01, PNorm = 45.4811, GNorm = 0.7263, lr_0 = 1.6435e-04
Validation prc-auc = 0.927842
Validation auc = 0.894282
Epoch 23
Loss = 2.9387e-01, PNorm = 45.4874, GNorm = 0.5279, lr_0 = 1.5882e-04
Loss = 3.1534e-01, PNorm = 45.5062, GNorm = 0.4254, lr_0 = 1.5347e-04
Validation prc-auc = 0.924862
Validation auc = 0.893642
Epoch 24
Loss = 2.8235e-01, PNorm = 45.5135, GNorm = 0.3809, lr_0 = 1.4779e-04
Loss = 2.9886e-01, PNorm = 45.5324, GNorm = 0.8340, lr_0 = 1.4281e-04
Loss = 3.0166e-01, PNorm = 45.5418, GNorm = 0.8616, lr_0 = 1.3800e-04
Validation prc-auc = 0.927600
Validation auc = 0.896629
Epoch 25
Loss = 3.2528e-01, PNorm = 45.5499, GNorm = 1.3998, lr_0 = 1.3335e-04
Loss = 2.8397e-01, PNorm = 45.5606, GNorm = 0.5178, lr_0 = 1.2886e-04
Validation prc-auc = 0.929043
Validation auc = 0.898336
Epoch 26
Loss = 3.1192e-01, PNorm = 45.5702, GNorm = 0.5603, lr_0 = 1.2409e-04
Loss = 3.2674e-01, PNorm = 45.5838, GNorm = 1.5447, lr_0 = 1.1991e-04
Validation prc-auc = 0.929371
Validation auc = 0.897909
Epoch 27
Loss = 3.3416e-01, PNorm = 45.5861, GNorm = 0.6587, lr_0 = 1.1548e-04
Loss = 3.3574e-01, PNorm = 45.6001, GNorm = 1.1329, lr_0 = 1.1159e-04
Loss = 2.6750e-01, PNorm = 45.6083, GNorm = 0.8669, lr_0 = 1.0783e-04
Validation prc-auc = 0.929467
Validation auc = 0.897696
Epoch 28
Loss = 2.5276e-01, PNorm = 45.6187, GNorm = 0.4534, lr_0 = 1.0420e-04
Loss = 3.0011e-01, PNorm = 45.6307, GNorm = 0.5695, lr_0 = 1.0069e-04
Validation prc-auc = 0.932022
Validation auc = 0.900256
Epoch 29
Loss = 2.9924e-01, PNorm = 45.6297, GNorm = 0.4463, lr_0 = 1.0000e-04
Loss = 2.9630e-01, PNorm = 45.6399, GNorm = 0.3982, lr_0 = 1.0000e-04
Loss = 2.8211e-01, PNorm = 45.6484, GNorm = 0.5676, lr_0 = 1.0000e-04
Validation prc-auc = 0.930966
Validation auc = 0.897696
Model 0 best validation prc-auc = 0.950383 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.945007
Model 0 test auc = 0.872206
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.5223e-01, PNorm = 43.2466, GNorm = 1.5310, lr_0 = 3.0625e-04
Loss = 5.2733e-01, PNorm = 43.2729, GNorm = 0.9426, lr_0 = 4.9375e-04
Validation prc-auc = 0.963749
Validation auc = 0.909430
Epoch 1
Loss = 5.1462e-01, PNorm = 43.3120, GNorm = 2.1908, lr_0 = 7.0000e-04
Loss = 4.3878e-01, PNorm = 43.3626, GNorm = 1.4929, lr_0 = 8.8750e-04
Validation prc-auc = 0.911955
Validation auc = 0.862492
Epoch 2
Loss = 4.8189e-01, PNorm = 43.4250, GNorm = 1.7641, lr_0 = 9.8301e-04
Loss = 4.5658e-01, PNorm = 43.4822, GNorm = 1.3048, lr_0 = 9.4990e-04
Loss = 3.6956e-01, PNorm = 43.5368, GNorm = 0.4837, lr_0 = 9.1790e-04
Validation prc-auc = 0.921312
Validation auc = 0.870386
Epoch 3
Loss = 3.8319e-01, PNorm = 43.5803, GNorm = 0.9140, lr_0 = 8.8699e-04
Loss = 3.7058e-01, PNorm = 43.6232, GNorm = 0.5085, lr_0 = 8.5711e-04
Validation prc-auc = 0.922149
Validation auc = 0.869106
Epoch 4
Loss = 3.5678e-01, PNorm = 43.6690, GNorm = 0.6904, lr_0 = 8.2540e-04
Loss = 3.7154e-01, PNorm = 43.7135, GNorm = 0.5589, lr_0 = 7.9760e-04
Loss = 3.6922e-01, PNorm = 43.7622, GNorm = 1.1333, lr_0 = 7.7073e-04
Validation prc-auc = 0.923922
Validation auc = 0.874867
Epoch 5
Loss = 3.4145e-01, PNorm = 43.8027, GNorm = 0.6168, lr_0 = 7.4477e-04
Loss = 3.6442e-01, PNorm = 43.8572, GNorm = 0.6184, lr_0 = 7.1969e-04
Validation prc-auc = 0.898830
Validation auc = 0.866119
Epoch 6
Loss = 4.0544e-01, PNorm = 43.9100, GNorm = 0.6850, lr_0 = 6.9306e-04
Loss = 3.7992e-01, PNorm = 43.9605, GNorm = 0.4755, lr_0 = 6.6972e-04
Loss = 3.3884e-01, PNorm = 44.0230, GNorm = 0.5574, lr_0 = 6.4716e-04
Loss = 2.8022e-01, PNorm = 44.0288, GNorm = 0.5365, lr_0 = 6.4495e-04
Validation prc-auc = 0.914329
Validation auc = 0.876360
Epoch 7
Loss = 3.2782e-01, PNorm = 44.0943, GNorm = 0.5547, lr_0 = 6.2322e-04
Loss = 3.8900e-01, PNorm = 44.1448, GNorm = 1.4519, lr_0 = 6.0223e-04
Validation prc-auc = 0.907036
Validation auc = 0.869959
Epoch 8
Loss = 3.3233e-01, PNorm = 44.2012, GNorm = 0.5007, lr_0 = 5.8194e-04
Loss = 3.3940e-01, PNorm = 44.2583, GNorm = 0.5584, lr_0 = 5.6234e-04
Validation prc-auc = 0.908634
Validation auc = 0.878494
Epoch 9
Loss = 2.7249e-01, PNorm = 44.3175, GNorm = 0.7176, lr_0 = 5.4154e-04
Loss = 3.3207e-01, PNorm = 44.3508, GNorm = 0.6313, lr_0 = 5.2330e-04
Loss = 3.6172e-01, PNorm = 44.3992, GNorm = 0.9312, lr_0 = 5.0567e-04
Validation prc-auc = 0.902784
Validation auc = 0.875080
Epoch 10
Loss = 3.6632e-01, PNorm = 44.4593, GNorm = 0.4983, lr_0 = 4.8864e-04
Loss = 3.3733e-01, PNorm = 44.5060, GNorm = 1.9552, lr_0 = 4.7218e-04
Validation prc-auc = 0.916296
Validation auc = 0.887241
Epoch 11
Loss = 3.2099e-01, PNorm = 44.5527, GNorm = 0.4075, lr_0 = 4.5471e-04
Loss = 3.5002e-01, PNorm = 44.5882, GNorm = 1.3857, lr_0 = 4.3940e-04
Loss = 3.3257e-01, PNorm = 44.6288, GNorm = 1.0256, lr_0 = 4.2460e-04
Validation prc-auc = 0.904418
Validation auc = 0.878494
Epoch 12
Loss = 3.0370e-01, PNorm = 44.6860, GNorm = 0.3644, lr_0 = 4.0889e-04
Loss = 3.6987e-01, PNorm = 44.7135, GNorm = 0.6863, lr_0 = 3.9512e-04
Validation prc-auc = 0.913006
Validation auc = 0.886388
Epoch 13
Loss = 2.8863e-01, PNorm = 44.7404, GNorm = 0.3992, lr_0 = 3.8181e-04
Loss = 3.4057e-01, PNorm = 44.7792, GNorm = 0.8377, lr_0 = 3.6895e-04
Loss = 3.1599e-01, PNorm = 44.8104, GNorm = 0.4257, lr_0 = 3.5652e-04
Validation prc-auc = 0.910593
Validation auc = 0.883614
Epoch 14
Loss = 3.3162e-01, PNorm = 44.8459, GNorm = 1.1074, lr_0 = 3.4333e-04
Loss = 3.4580e-01, PNorm = 44.8785, GNorm = 0.5813, lr_0 = 3.3177e-04
Validation prc-auc = 0.909782
Validation auc = 0.885961
Epoch 15
Loss = 2.8662e-01, PNorm = 44.9180, GNorm = 1.5001, lr_0 = 3.2059e-04
Loss = 3.1664e-01, PNorm = 44.9427, GNorm = 0.4789, lr_0 = 3.0979e-04
Loss = 3.6845e-01, PNorm = 44.9583, GNorm = 0.6658, lr_0 = 2.9936e-04
Loss = 1.3388e-01, PNorm = 44.9602, GNorm = 0.4230, lr_0 = 2.9833e-04
Validation prc-auc = 0.913020
Validation auc = 0.886175
Epoch 16
Loss = 3.3453e-01, PNorm = 44.9864, GNorm = 0.4227, lr_0 = 2.8828e-04
Loss = 3.1764e-01, PNorm = 45.0089, GNorm = 1.0596, lr_0 = 2.7857e-04
Validation prc-auc = 0.915628
Validation auc = 0.886388
Epoch 17
Loss = 3.3076e-01, PNorm = 45.0388, GNorm = 0.5993, lr_0 = 2.6827e-04
Loss = 3.4185e-01, PNorm = 45.0631, GNorm = 0.6931, lr_0 = 2.5923e-04
Validation prc-auc = 0.915274
Validation auc = 0.888308
Epoch 18
Loss = 2.5024e-01, PNorm = 45.0889, GNorm = 0.3294, lr_0 = 2.5050e-04
Loss = 3.2914e-01, PNorm = 45.1137, GNorm = 0.9985, lr_0 = 2.4206e-04
Loss = 3.0164e-01, PNorm = 45.1397, GNorm = 1.2516, lr_0 = 2.3391e-04
Validation prc-auc = 0.909066
Validation auc = 0.883828
Epoch 19
Loss = 3.0873e-01, PNorm = 45.1634, GNorm = 0.4683, lr_0 = 2.2526e-04
Loss = 3.3201e-01, PNorm = 45.1823, GNorm = 0.6562, lr_0 = 2.1767e-04
Validation prc-auc = 0.918294
Validation auc = 0.891722
Epoch 20
Loss = 2.7872e-01, PNorm = 45.1994, GNorm = 0.5085, lr_0 = 2.1034e-04
Loss = 3.2066e-01, PNorm = 45.2197, GNorm = 0.5434, lr_0 = 2.0325e-04
Loss = 2.9931e-01, PNorm = 45.2378, GNorm = 0.5281, lr_0 = 1.9641e-04
Validation prc-auc = 0.914472
Validation auc = 0.889375
Epoch 21
Loss = 3.3446e-01, PNorm = 45.2569, GNorm = 0.4853, lr_0 = 1.8914e-04
Loss = 3.2470e-01, PNorm = 45.2729, GNorm = 0.3987, lr_0 = 1.8277e-04
Validation prc-auc = 0.914272
Validation auc = 0.887455
Epoch 22
Loss = 3.0151e-01, PNorm = 45.2868, GNorm = 0.5092, lr_0 = 1.7601e-04
Loss = 2.9691e-01, PNorm = 45.3095, GNorm = 0.7117, lr_0 = 1.7008e-04
Loss = 3.3695e-01, PNorm = 45.3325, GNorm = 0.6555, lr_0 = 1.6435e-04
Validation prc-auc = 0.917757
Validation auc = 0.889162
Epoch 23
Loss = 3.1491e-01, PNorm = 45.3356, GNorm = 0.6515, lr_0 = 1.5882e-04
Loss = 3.1980e-01, PNorm = 45.3474, GNorm = 0.8966, lr_0 = 1.5347e-04
Validation prc-auc = 0.911705
Validation auc = 0.885321
Epoch 24
Loss = 2.9785e-01, PNorm = 45.3668, GNorm = 0.4971, lr_0 = 1.4779e-04
Loss = 2.6196e-01, PNorm = 45.3825, GNorm = 0.4360, lr_0 = 1.4281e-04
Loss = 3.4478e-01, PNorm = 45.3941, GNorm = 0.9512, lr_0 = 1.3800e-04
Validation prc-auc = 0.917877
Validation auc = 0.893002
Epoch 25
Loss = 2.9003e-01, PNorm = 45.4065, GNorm = 1.3483, lr_0 = 1.3335e-04
Loss = 3.0138e-01, PNorm = 45.4105, GNorm = 0.5270, lr_0 = 1.2886e-04
Validation prc-auc = 0.916868
Validation auc = 0.890442
Epoch 26
Loss = 3.1592e-01, PNorm = 45.4286, GNorm = 0.5357, lr_0 = 1.2409e-04
Loss = 2.9514e-01, PNorm = 45.4418, GNorm = 0.6097, lr_0 = 1.1991e-04
Validation prc-auc = 0.917300
Validation auc = 0.891082
Epoch 27
Loss = 3.3349e-01, PNorm = 45.4481, GNorm = 0.4642, lr_0 = 1.1548e-04
Loss = 2.5147e-01, PNorm = 45.4619, GNorm = 0.5203, lr_0 = 1.1159e-04
Loss = 3.2435e-01, PNorm = 45.4711, GNorm = 1.1491, lr_0 = 1.0783e-04
Validation prc-auc = 0.924542
Validation auc = 0.896416
Epoch 28
Loss = 2.9421e-01, PNorm = 45.4812, GNorm = 0.6835, lr_0 = 1.0420e-04
Loss = 3.2152e-01, PNorm = 45.4867, GNorm = 0.9586, lr_0 = 1.0069e-04
Validation prc-auc = 0.921328
Validation auc = 0.894495
Epoch 29
Loss = 3.4759e-01, PNorm = 45.5003, GNorm = 0.7009, lr_0 = 1.0000e-04
Loss = 2.7819e-01, PNorm = 45.5095, GNorm = 0.6741, lr_0 = 1.0000e-04
Loss = 2.9986e-01, PNorm = 45.5145, GNorm = 0.8011, lr_0 = 1.0000e-04
Validation prc-auc = 0.916681
Validation auc = 0.890442
Model 1 best validation prc-auc = 0.963749 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.942885
Model 1 test auc = 0.860219
Ensemble test prc-auc = 0.947250
Ensemble test auc = 0.870987
Fold 4
Splitting data with seed 4
Total scaffolds = 652 | train scaffolds = 511 | val scaffolds = 62 | test scaffolds = 79
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 57 | target average = 0.912281


Scaffold 1
Task 0: count = 42 | target average = 0.142857


Scaffold 2
Task 0: count = 29 | target average = 0.827586


Scaffold 3
Task 0: count = 19 | target average = 0.315789


Scaffold 4
Task 0: count = 18 | target average = 0.166667


Scaffold 5
Task 0: count = 16 | target average = 0.187500


Scaffold 6
Task 0: count = 15 | target average = 0.133333


Scaffold 7
Task 0: count = 14 | target average = 0.214286


Scaffold 8
Task 0: count = 13 | target average = 0.153846


Scaffold 9
Task 0: count = 13 | target average = 0.384615


Class sizes
hit 0: 33.31%, 1: 66.69%
Total size = 1,525 | train size = 1,220 | val size = 152 | test size = 153
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.1998e-01, PNorm = 43.2235, GNorm = 0.8143, lr_0 = 3.0625e-04
Loss = 5.1500e-01, PNorm = 43.2524, GNorm = 1.4717, lr_0 = 4.9375e-04
Validation prc-auc = 0.919637
Validation auc = 0.836839
Epoch 1
Loss = 4.7637e-01, PNorm = 43.3007, GNorm = 2.9812, lr_0 = 7.0000e-04
Loss = 4.3931e-01, PNorm = 43.3483, GNorm = 0.9577, lr_0 = 8.8750e-04
Validation prc-auc = 0.935937
Validation auc = 0.861879
Epoch 2
Loss = 4.5492e-01, PNorm = 43.4091, GNorm = 0.4508, lr_0 = 9.8301e-04
Loss = 3.9265e-01, PNorm = 43.4522, GNorm = 1.4317, lr_0 = 9.4990e-04
Loss = 4.2614e-01, PNorm = 43.4929, GNorm = 0.4066, lr_0 = 9.1790e-04
Validation prc-auc = 0.941392
Validation auc = 0.863281
Epoch 3
Loss = 3.3958e-01, PNorm = 43.5425, GNorm = 0.5310, lr_0 = 8.8699e-04
Loss = 3.6577e-01, PNorm = 43.5956, GNorm = 0.8502, lr_0 = 8.5711e-04
Validation prc-auc = 0.941219
Validation auc = 0.864483
Epoch 4
Loss = 3.8456e-01, PNorm = 43.6204, GNorm = 1.3867, lr_0 = 8.2540e-04
Loss = 3.7470e-01, PNorm = 43.6557, GNorm = 0.6043, lr_0 = 7.9760e-04
Loss = 3.6030e-01, PNorm = 43.6896, GNorm = 0.8509, lr_0 = 7.7073e-04
Validation prc-auc = 0.942979
Validation auc = 0.866286
Epoch 5
Loss = 3.6112e-01, PNorm = 43.7333, GNorm = 1.2308, lr_0 = 7.4477e-04
Loss = 3.8323e-01, PNorm = 43.7800, GNorm = 2.3344, lr_0 = 7.1969e-04
Validation prc-auc = 0.945318
Validation auc = 0.867488
Epoch 6
Loss = 3.4349e-01, PNorm = 43.8165, GNorm = 0.6682, lr_0 = 6.9306e-04
Loss = 3.5789e-01, PNorm = 43.8572, GNorm = 0.7274, lr_0 = 6.6972e-04
Loss = 3.6242e-01, PNorm = 43.9012, GNorm = 0.5391, lr_0 = 6.4716e-04
Loss = 2.9340e-01, PNorm = 43.9052, GNorm = 0.8624, lr_0 = 6.4495e-04
Validation prc-auc = 0.946210
Validation auc = 0.872095
Epoch 7
Loss = 3.4757e-01, PNorm = 43.9469, GNorm = 0.4274, lr_0 = 6.2322e-04
Loss = 3.2337e-01, PNorm = 43.9935, GNorm = 1.5167, lr_0 = 6.0223e-04
Validation prc-auc = 0.948466
Validation auc = 0.874499
Epoch 8
Loss = 3.8326e-01, PNorm = 44.0293, GNorm = 1.0350, lr_0 = 5.8194e-04
Loss = 3.2229e-01, PNorm = 44.0775, GNorm = 0.4875, lr_0 = 5.6234e-04
Validation prc-auc = 0.947560
Validation auc = 0.870493
Epoch 9
Loss = 4.4988e-01, PNorm = 44.1329, GNorm = 0.7065, lr_0 = 5.4154e-04
Loss = 3.5005e-01, PNorm = 44.1742, GNorm = 0.8213, lr_0 = 5.2330e-04
Loss = 3.3356e-01, PNorm = 44.2140, GNorm = 0.5161, lr_0 = 5.0567e-04
Validation prc-auc = 0.950034
Validation auc = 0.876703
Epoch 10
Loss = 3.4974e-01, PNorm = 44.2612, GNorm = 0.4917, lr_0 = 4.8864e-04
Loss = 3.2342e-01, PNorm = 44.3051, GNorm = 0.6063, lr_0 = 4.7218e-04
Validation prc-auc = 0.952158
Validation auc = 0.882111
Epoch 11
Loss = 2.9902e-01, PNorm = 44.3505, GNorm = 0.4089, lr_0 = 4.5471e-04
Loss = 2.8845e-01, PNorm = 44.3952, GNorm = 0.5822, lr_0 = 4.3940e-04
Loss = 3.4512e-01, PNorm = 44.4354, GNorm = 0.6998, lr_0 = 4.2460e-04
Validation prc-auc = 0.950819
Validation auc = 0.877103
Epoch 12
Loss = 3.1076e-01, PNorm = 44.4660, GNorm = 0.5599, lr_0 = 4.0889e-04
Loss = 3.5969e-01, PNorm = 44.5069, GNorm = 0.8114, lr_0 = 3.9512e-04
Validation prc-auc = 0.952882
Validation auc = 0.882312
Epoch 13
Loss = 3.7163e-01, PNorm = 44.5449, GNorm = 0.7073, lr_0 = 3.8181e-04
Loss = 3.3329e-01, PNorm = 44.5776, GNorm = 1.0503, lr_0 = 3.6895e-04
Loss = 3.4358e-01, PNorm = 44.6058, GNorm = 0.7793, lr_0 = 3.5652e-04
Validation prc-auc = 0.950202
Validation auc = 0.876102
Epoch 14
Loss = 3.4978e-01, PNorm = 44.6522, GNorm = 1.7955, lr_0 = 3.4333e-04
Loss = 3.2560e-01, PNorm = 44.6732, GNorm = 0.4457, lr_0 = 3.3177e-04
Validation prc-auc = 0.951031
Validation auc = 0.878105
Epoch 15
Loss = 3.0836e-01, PNorm = 44.7072, GNorm = 0.3536, lr_0 = 3.2059e-04
Loss = 3.2482e-01, PNorm = 44.7340, GNorm = 1.6621, lr_0 = 3.0979e-04
Loss = 3.2034e-01, PNorm = 44.7598, GNorm = 0.8041, lr_0 = 2.9936e-04
Loss = 4.9721e-01, PNorm = 44.7616, GNorm = 0.9563, lr_0 = 2.9833e-04
Validation prc-auc = 0.951270
Validation auc = 0.878706
Epoch 16
Loss = 3.1364e-01, PNorm = 44.7925, GNorm = 0.9679, lr_0 = 2.8828e-04
Loss = 3.1635e-01, PNorm = 44.8191, GNorm = 0.5525, lr_0 = 2.7857e-04
Validation prc-auc = 0.950989
Validation auc = 0.877704
Epoch 17
Loss = 2.9699e-01, PNorm = 44.8586, GNorm = 0.6447, lr_0 = 2.6827e-04
Loss = 3.1656e-01, PNorm = 44.8804, GNorm = 0.4076, lr_0 = 2.5923e-04
Validation prc-auc = 0.951883
Validation auc = 0.880709
Epoch 18
Loss = 3.5454e-01, PNorm = 44.9068, GNorm = 1.0402, lr_0 = 2.5050e-04
Loss = 2.9139e-01, PNorm = 44.9325, GNorm = 1.0869, lr_0 = 2.4206e-04
Loss = 3.3854e-01, PNorm = 44.9518, GNorm = 0.4019, lr_0 = 2.3391e-04
Validation prc-auc = 0.952506
Validation auc = 0.882913
Epoch 19
Loss = 2.8831e-01, PNorm = 44.9720, GNorm = 0.7615, lr_0 = 2.2526e-04
Loss = 2.8654e-01, PNorm = 44.9920, GNorm = 0.5220, lr_0 = 2.1767e-04
Validation prc-auc = 0.951099
Validation auc = 0.878105
Epoch 20
Loss = 3.0649e-01, PNorm = 45.0140, GNorm = 1.0333, lr_0 = 2.1034e-04
Loss = 2.7497e-01, PNorm = 45.0400, GNorm = 0.7587, lr_0 = 2.0325e-04
Loss = 3.2851e-01, PNorm = 45.0530, GNorm = 0.8830, lr_0 = 1.9641e-04
Validation prc-auc = 0.951595
Validation auc = 0.879708
Epoch 21
Loss = 2.8299e-01, PNorm = 45.0679, GNorm = 0.4354, lr_0 = 1.8914e-04
Loss = 2.9393e-01, PNorm = 45.0913, GNorm = 1.0949, lr_0 = 1.8277e-04
Validation prc-auc = 0.951174
Validation auc = 0.878305
Epoch 22
Loss = 3.8313e-01, PNorm = 45.1044, GNorm = 0.4578, lr_0 = 1.7601e-04
Loss = 2.8962e-01, PNorm = 45.1184, GNorm = 0.5952, lr_0 = 1.7008e-04
Loss = 2.5646e-01, PNorm = 45.1313, GNorm = 1.0732, lr_0 = 1.6435e-04
Validation prc-auc = 0.951468
Validation auc = 0.879507
Epoch 23
Loss = 3.1658e-01, PNorm = 45.1495, GNorm = 0.4245, lr_0 = 1.5882e-04
Loss = 2.8855e-01, PNorm = 45.1635, GNorm = 0.4883, lr_0 = 1.5347e-04
Validation prc-auc = 0.951736
Validation auc = 0.878906
Epoch 24
Loss = 3.5201e-01, PNorm = 45.1814, GNorm = 0.6574, lr_0 = 1.4779e-04
Loss = 2.8849e-01, PNorm = 45.1911, GNorm = 0.8012, lr_0 = 1.4281e-04
Loss = 2.6783e-01, PNorm = 45.2037, GNorm = 2.9764, lr_0 = 1.3800e-04
Validation prc-auc = 0.952492
Validation auc = 0.882312
Epoch 25
Loss = 2.6657e-01, PNorm = 45.2209, GNorm = 1.1960, lr_0 = 1.3335e-04
Loss = 2.9981e-01, PNorm = 45.2307, GNorm = 0.7093, lr_0 = 1.2886e-04
Validation prc-auc = 0.951037
Validation auc = 0.877304
Epoch 26
Loss = 3.3212e-01, PNorm = 45.2430, GNorm = 1.1559, lr_0 = 1.2409e-04
Loss = 2.6775e-01, PNorm = 45.2532, GNorm = 0.6878, lr_0 = 1.1991e-04
Validation prc-auc = 0.952069
Validation auc = 0.880308
Epoch 27
Loss = 3.6588e-01, PNorm = 45.2649, GNorm = 0.6165, lr_0 = 1.1548e-04
Loss = 2.6945e-01, PNorm = 45.2746, GNorm = 0.5268, lr_0 = 1.1159e-04
Loss = 2.8154e-01, PNorm = 45.2831, GNorm = 0.8456, lr_0 = 1.0783e-04
Validation prc-auc = 0.951849
Validation auc = 0.879107
Epoch 28
Loss = 2.8699e-01, PNorm = 45.2966, GNorm = 0.5415, lr_0 = 1.0420e-04
Loss = 2.9061e-01, PNorm = 45.3013, GNorm = 0.6792, lr_0 = 1.0069e-04
Validation prc-auc = 0.952442
Validation auc = 0.881110
Epoch 29
Loss = 2.7074e-01, PNorm = 45.3138, GNorm = 0.6619, lr_0 = 1.0000e-04
Loss = 2.6205e-01, PNorm = 45.3226, GNorm = 1.0281, lr_0 = 1.0000e-04
Loss = 3.0224e-01, PNorm = 45.3290, GNorm = 0.6161, lr_0 = 1.0000e-04
Validation prc-auc = 0.951553
Validation auc = 0.878506
Model 0 best validation prc-auc = 0.952882 on epoch 12
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test prc-auc = 0.974531
Model 0 test auc = 0.919278
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=500, bias=False)
        (W_h): Linear(in_features=500, out_features=500, bias=False)
        (W_o): Linear(in_features=633, out_features=500, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=700, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 992,001
Moving model to cuda
Epoch 0
Loss = 6.5309e-01, PNorm = 43.2463, GNorm = 1.8655, lr_0 = 3.0625e-04
Loss = 5.1259e-01, PNorm = 43.2730, GNorm = 0.8260, lr_0 = 4.9375e-04
Validation prc-auc = 0.908469
Validation auc = 0.843650
Epoch 1
Loss = 4.3019e-01, PNorm = 43.3225, GNorm = 1.0341, lr_0 = 7.0000e-04
Loss = 4.1647e-01, PNorm = 43.3719, GNorm = 0.7059, lr_0 = 8.8750e-04
Validation prc-auc = 0.938572
Validation auc = 0.865084
Epoch 2
Loss = 3.4860e-01, PNorm = 43.4526, GNorm = 0.5879, lr_0 = 9.8301e-04
Loss = 4.3972e-01, PNorm = 43.5132, GNorm = 1.2971, lr_0 = 9.4990e-04
Loss = 3.9984e-01, PNorm = 43.5714, GNorm = 0.5153, lr_0 = 9.1790e-04
Validation prc-auc = 0.943353
Validation auc = 0.868690
Epoch 3
Loss = 3.8998e-01, PNorm = 43.6153, GNorm = 0.4557, lr_0 = 8.8699e-04
Loss = 3.6107e-01, PNorm = 43.6595, GNorm = 0.8366, lr_0 = 8.5711e-04
Validation prc-auc = 0.945041
Validation auc = 0.866486
Epoch 4
Loss = 3.8301e-01, PNorm = 43.7091, GNorm = 0.5615, lr_0 = 8.2540e-04
Loss = 3.5345e-01, PNorm = 43.7463, GNorm = 0.4553, lr_0 = 7.9760e-04
Loss = 3.8812e-01, PNorm = 43.7813, GNorm = 0.9725, lr_0 = 7.7073e-04
Validation prc-auc = 0.945179
Validation auc = 0.869291
Epoch 5
Loss = 3.8467e-01, PNorm = 43.8139, GNorm = 0.4322, lr_0 = 7.4477e-04
Loss = 3.3952e-01, PNorm = 43.8586, GNorm = 0.3399, lr_0 = 7.1969e-04
Validation prc-auc = 0.947787
Validation auc = 0.871895
Epoch 6
Loss = 3.6240e-01, PNorm = 43.9077, GNorm = 1.2248, lr_0 = 6.9306e-04
Loss = 3.7295e-01, PNorm = 43.9487, GNorm = 0.5116, lr_0 = 6.6972e-04
Loss = 3.6679e-01, PNorm = 44.0027, GNorm = 0.4330, lr_0 = 6.4716e-04
Loss = 3.8201e-01, PNorm = 44.0075, GNorm = 0.7419, lr_0 = 6.4495e-04
Validation prc-auc = 0.946586
Validation auc = 0.866887
Epoch 7
Loss = 3.3039e-01, PNorm = 44.0464, GNorm = 0.4306, lr_0 = 6.2322e-04
Loss = 3.5843e-01, PNorm = 44.0929, GNorm = 0.5687, lr_0 = 6.0223e-04
Validation prc-auc = 0.949484
Validation auc = 0.875300
Epoch 8
Loss = 3.4996e-01, PNorm = 44.1285, GNorm = 0.6973, lr_0 = 5.8194e-04
Loss = 3.4419e-01, PNorm = 44.1736, GNorm = 1.0258, lr_0 = 5.6234e-04
Validation prc-auc = 0.952881
Validation auc = 0.882312
Epoch 9
Loss = 3.8476e-01, PNorm = 44.2340, GNorm = 0.9492, lr_0 = 5.4154e-04
Loss = 3.2809e-01, PNorm = 44.2704, GNorm = 1.1971, lr_0 = 5.2330e-04
Loss = 3.5507e-01, PNorm = 44.3091, GNorm = 1.3092, lr_0 = 5.0567e-04
Validation prc-auc = 0.951606
Validation auc = 0.878906
Epoch 10
Loss = 3.5446e-01, PNorm = 44.3504, GNorm = 0.9859, lr_0 = 4.8864e-04
Loss = 3.4834e-01, PNorm = 44.3894, GNorm = 0.3439, lr_0 = 4.7218e-04
Validation prc-auc = 0.952863
Validation auc = 0.882512
Epoch 11
Loss = 3.5017e-01, PNorm = 44.4383, GNorm = 0.5296, lr_0 = 4.5471e-04
Loss = 3.4822e-01, PNorm = 44.4852, GNorm = 0.6432, lr_0 = 4.3940e-04
Loss = 3.3783e-01, PNorm = 44.5178, GNorm = 0.4157, lr_0 = 4.2460e-04
Validation prc-auc = 0.952201
Validation auc = 0.881711
Epoch 12
Loss = 3.1666e-01, PNorm = 44.5630, GNorm = 0.4014, lr_0 = 4.0889e-04
Loss = 3.3065e-01, PNorm = 44.6049, GNorm = 0.5566, lr_0 = 3.9512e-04
Validation prc-auc = 0.952227
Validation auc = 0.881510
Epoch 13
Loss = 3.0526e-01, PNorm = 44.6312, GNorm = 0.5795, lr_0 = 3.8181e-04
Loss = 3.1519e-01, PNorm = 44.6655, GNorm = 0.7191, lr_0 = 3.6895e-04
Loss = 3.1594e-01, PNorm = 44.7026, GNorm = 0.4546, lr_0 = 3.5652e-04
Validation prc-auc = 0.951932
Validation auc = 0.880709
Epoch 14
Loss = 3.1897e-01, PNorm = 44.7324, GNorm = 0.3937, lr_0 = 3.4333e-04
Loss = 3.4355e-01, PNorm = 44.7549, GNorm = 0.4517, lr_0 = 3.3177e-04
Validation prc-auc = 0.951938
Validation auc = 0.880108
Epoch 15
Loss = 3.4632e-01, PNorm = 44.7934, GNorm = 0.5433, lr_0 = 3.2059e-04
Loss = 3.1200e-01, PNorm = 44.8212, GNorm = 0.4474, lr_0 = 3.0979e-04
Loss = 2.9001e-01, PNorm = 44.8578, GNorm = 1.6888, lr_0 = 2.9936e-04
Loss = 2.8026e-01, PNorm = 44.8588, GNorm = 0.8176, lr_0 = 2.9833e-04
Validation prc-auc = 0.951958
Validation auc = 0.879708
Epoch 16
Loss = 3.4479e-01, PNorm = 44.8824, GNorm = 0.5206, lr_0 = 2.8828e-04
Loss = 2.9513e-01, PNorm = 44.9069, GNorm = 0.4388, lr_0 = 2.7857e-04
Validation prc-auc = 0.952187
Validation auc = 0.880308
Epoch 17
Loss = 2.4351e-01, PNorm = 44.9411, GNorm = 0.2981, lr_0 = 2.6827e-04
Loss = 3.4083e-01, PNorm = 44.9657, GNorm = 0.5723, lr_0 = 2.5923e-04
Validation prc-auc = 0.953234
Validation auc = 0.883714
Epoch 18
Loss = 3.6315e-01, PNorm = 44.9936, GNorm = 0.4801, lr_0 = 2.5050e-04
Loss = 3.4689e-01, PNorm = 44.9993, GNorm = 0.7575, lr_0 = 2.4206e-04
Loss = 3.1714e-01, PNorm = 45.0261, GNorm = 0.4389, lr_0 = 2.3391e-04
Validation prc-auc = 0.949660
Validation auc = 0.874099
Epoch 19
Loss = 3.1545e-01, PNorm = 45.0515, GNorm = 1.0053, lr_0 = 2.2526e-04
Loss = 2.8824e-01, PNorm = 45.0717, GNorm = 0.5598, lr_0 = 2.1767e-04
Validation prc-auc = 0.953263
Validation auc = 0.882712
Epoch 20
Loss = 2.5367e-01, PNorm = 45.0957, GNorm = 0.4888, lr_0 = 2.1034e-04
Loss = 2.8779e-01, PNorm = 45.1186, GNorm = 0.6903, lr_0 = 2.0325e-04
Loss = 3.2174e-01, PNorm = 45.1286, GNorm = 0.6614, lr_0 = 1.9641e-04
Validation prc-auc = 0.952180
Validation auc = 0.880709
Epoch 21
Loss = 2.9790e-01, PNorm = 45.1492, GNorm = 0.5994, lr_0 = 1.8914e-04
Loss = 2.9769e-01, PNorm = 45.1610, GNorm = 0.4009, lr_0 = 1.8277e-04
Validation prc-auc = 0.952355
Validation auc = 0.880509
Epoch 22
Loss = 2.4781e-01, PNorm = 45.1811, GNorm = 0.8138, lr_0 = 1.7601e-04
Loss = 3.1652e-01, PNorm = 45.1917, GNorm = 1.1937, lr_0 = 1.7008e-04
Loss = 3.0380e-01, PNorm = 45.2090, GNorm = 0.5682, lr_0 = 1.6435e-04
Validation prc-auc = 0.952825
Validation auc = 0.882512
Epoch 23
Loss = 2.9742e-01, PNorm = 45.2199, GNorm = 0.4399, lr_0 = 1.5882e-04
Loss = 2.9719e-01, PNorm = 45.2396, GNorm = 0.9309, lr_0 = 1.5347e-04
Validation prc-auc = 0.951127
Validation auc = 0.878506
Epoch 24
Loss = 2.8649e-01, PNorm = 45.2494, GNorm = 0.5930, lr_0 = 1.4779e-04
Loss = 2.9977e-01, PNorm = 45.2672, GNorm = 1.4542, lr_0 = 1.4281e-04
Loss = 2.9020e-01, PNorm = 45.2745, GNorm = 1.4896, lr_0 = 1.3800e-04
Validation prc-auc = 0.950469
Validation auc = 0.876102
Epoch 25
Loss = 2.8871e-01, PNorm = 45.2904, GNorm = 0.7707, lr_0 = 1.3335e-04
Loss = 3.0642e-01, PNorm = 45.2982, GNorm = 0.7526, lr_0 = 1.2886e-04
Validation prc-auc = 0.951465
Validation auc = 0.879307
Epoch 26
Loss = 2.8963e-01, PNorm = 45.3085, GNorm = 0.7206, lr_0 = 1.2409e-04
Loss = 2.7661e-01, PNorm = 45.3224, GNorm = 0.7600, lr_0 = 1.1991e-04
Validation prc-auc = 0.950924
Validation auc = 0.877704
Epoch 27
Loss = 3.0168e-01, PNorm = 45.3310, GNorm = 0.9479, lr_0 = 1.1548e-04
Loss = 3.2440e-01, PNorm = 45.3441, GNorm = 0.6425, lr_0 = 1.1159e-04
Loss = 2.6374e-01, PNorm = 45.3501, GNorm = 0.4488, lr_0 = 1.0783e-04
Validation prc-auc = 0.950547
Validation auc = 0.876102
Epoch 28
Loss = 3.1987e-01, PNorm = 45.3586, GNorm = 0.8331, lr_0 = 1.0420e-04
Loss = 2.9280e-01, PNorm = 45.3673, GNorm = 1.5416, lr_0 = 1.0069e-04
Validation prc-auc = 0.950756
Validation auc = 0.876502
Epoch 29
Loss = 2.7580e-01, PNorm = 45.3765, GNorm = 0.4484, lr_0 = 1.0000e-04
Loss = 2.8526e-01, PNorm = 45.3877, GNorm = 0.4252, lr_0 = 1.0000e-04
Loss = 2.8097e-01, PNorm = 45.3973, GNorm = 1.1073, lr_0 = 1.0000e-04
Validation prc-auc = 0.951710
Validation auc = 0.879307
Model 1 best validation prc-auc = 0.953263 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test prc-auc = 0.972892
Model 1 test auc = 0.919516
Ensemble test prc-auc = 0.973320
Ensemble test auc = 0.918803
5-fold cross validation
	Seed 0 ==> test prc-auc = 0.960755
	Seed 0 ==> test auc = 0.905556
	Seed 1 ==> test prc-auc = 0.937363
	Seed 1 ==> test auc = 0.906870
	Seed 2 ==> test prc-auc = 0.949992
	Seed 2 ==> test auc = 0.907822
	Seed 3 ==> test prc-auc = 0.947250
	Seed 3 ==> test auc = 0.870987
	Seed 4 ==> test prc-auc = 0.973320
	Seed 4 ==> test auc = 0.918803
Overall test prc-auc = 0.953736 +/- 0.012304
Overall test auc = 0.902008 +/- 0.016214
Elapsed time = 0:20:47
