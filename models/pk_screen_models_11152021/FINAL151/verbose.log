Command line
python /home/jackievaleri8/.conda/envs/chemprop/bin/chemprop_train --init_lr 0.001 --dropout 0.3 --hidden_size 1200 --ffn_num_layers 3 --depth 4 --save_dir models/FINAL151 --data_path data/FULL_11_15_2021.csv --dataset_type classification --features_path data/FULL_11_15_2021.npz --no_features_scaling --num_folds 50 --ensemble_size 1 --split_type scaffold_balanced --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --metric prc-auc --extra_metrics auc
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/FULL_11_15_2021.csv',
 'dataset_type': 'classification',
 'depth': 4,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/FULL_11_15_2021.npz'],
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1200,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1200,
 'ignore_columns': None,
 'init_lr': 0.001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 50,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'models/FINAL151',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['hit'],
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 870 | train scaffolds = 646 | val scaffolds = 100 | test scaffolds = 124
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.2200e-01, PNorm = 72.7657, GNorm = 0.8225, lr_0 = 1.0000e-03
Loss = 4.2653e-01, PNorm = 73.1596, GNorm = 1.2370, lr_0 = 1.0000e-03
Validation prc-auc = 0.532112
Validation auc = 0.800874
Epoch 1
Loss = 3.7678e-01, PNorm = 73.3885, GNorm = 0.8824, lr_0 = 1.0000e-03
Loss = 4.6464e-01, PNorm = 73.5089, GNorm = 0.5755, lr_0 = 1.0000e-03
Loss = 4.2613e-01, PNorm = 73.5855, GNorm = 0.7073, lr_0 = 1.0000e-03
Validation prc-auc = 0.588270
Validation auc = 0.830360
Epoch 2
Loss = 4.1101e-01, PNorm = 73.6478, GNorm = 0.6214, lr_0 = 9.7965e-04
Loss = 4.2339e-01, PNorm = 73.6993, GNorm = 0.8760, lr_0 = 9.5130e-04
Loss = 4.2247e-01, PNorm = 73.7565, GNorm = 0.6919, lr_0 = 9.2376e-04
Validation prc-auc = 0.695961
Validation auc = 0.859119
Epoch 3
Loss = 4.0967e-01, PNorm = 73.8219, GNorm = 0.9099, lr_0 = 8.9440e-04
Loss = 3.8813e-01, PNorm = 73.8907, GNorm = 0.4951, lr_0 = 8.6851e-04
Loss = 4.2973e-01, PNorm = 73.9449, GNorm = 0.7733, lr_0 = 8.4337e-04
Validation prc-auc = 0.646575
Validation auc = 0.817801
Epoch 4
Loss = 4.2006e-01, PNorm = 74.0221, GNorm = 0.5449, lr_0 = 8.1656e-04
Loss = 3.7909e-01, PNorm = 74.0921, GNorm = 0.9220, lr_0 = 7.9293e-04
Loss = 3.8507e-01, PNorm = 74.1598, GNorm = 0.9515, lr_0 = 7.6998e-04
Loss = 3.3443e-01, PNorm = 74.1657, GNorm = 1.3807, lr_0 = 7.6772e-04
Validation prc-auc = 0.586374
Validation auc = 0.814161
Epoch 5
Loss = 3.9814e-01, PNorm = 74.2400, GNorm = 0.5541, lr_0 = 7.4550e-04
Loss = 4.2573e-01, PNorm = 74.2869, GNorm = 0.8175, lr_0 = 7.2393e-04
Validation prc-auc = 0.631108
Validation auc = 0.822352
Epoch 6
Loss = 4.8892e-01, PNorm = 74.3576, GNorm = 1.2578, lr_0 = 7.0091e-04
Loss = 4.3291e-01, PNorm = 74.4013, GNorm = 0.7790, lr_0 = 6.8063e-04
Loss = 3.7179e-01, PNorm = 74.4626, GNorm = 0.4369, lr_0 = 6.6093e-04
Validation prc-auc = 0.677225
Validation auc = 0.827812
Epoch 7
Loss = 3.5042e-01, PNorm = 74.5248, GNorm = 0.6192, lr_0 = 6.3992e-04
Loss = 3.8373e-01, PNorm = 74.5892, GNorm = 0.5352, lr_0 = 6.2139e-04
Loss = 3.5919e-01, PNorm = 74.6495, GNorm = 0.5400, lr_0 = 6.0341e-04
Validation prc-auc = 0.673197
Validation auc = 0.831088
Epoch 8
Loss = 2.9993e-01, PNorm = 74.7226, GNorm = 0.5611, lr_0 = 5.8595e-04
Loss = 3.9347e-01, PNorm = 74.7974, GNorm = 0.6083, lr_0 = 5.6899e-04
Loss = 4.1418e-01, PNorm = 74.8547, GNorm = 0.6326, lr_0 = 5.5252e-04
Validation prc-auc = 0.638394
Validation auc = 0.812341
Epoch 9
Loss = 3.7888e-01, PNorm = 74.9353, GNorm = 0.8830, lr_0 = 5.3495e-04
Loss = 3.4240e-01, PNorm = 74.9945, GNorm = 0.5316, lr_0 = 5.1947e-04
Loss = 3.5194e-01, PNorm = 75.0521, GNorm = 0.6587, lr_0 = 5.0444e-04
Validation prc-auc = 0.737657
Validation auc = 0.846014
Epoch 10
Loss = 3.7821e-01, PNorm = 75.1264, GNorm = 0.6724, lr_0 = 4.8840e-04
Loss = 3.0346e-01, PNorm = 75.1832, GNorm = 0.6319, lr_0 = 4.7426e-04
Validation prc-auc = 0.686025
Validation auc = 0.816527
Epoch 11
Loss = 3.2899e-01, PNorm = 75.2459, GNorm = 0.5996, lr_0 = 4.5919e-04
Loss = 3.3573e-01, PNorm = 75.3036, GNorm = 0.5851, lr_0 = 4.4590e-04
Loss = 3.5445e-01, PNorm = 75.3627, GNorm = 0.7174, lr_0 = 4.3299e-04
Validation prc-auc = 0.739069
Validation auc = 0.848562
Epoch 12
Loss = 3.5973e-01, PNorm = 75.4256, GNorm = 1.1209, lr_0 = 4.1923e-04
Loss = 3.2560e-01, PNorm = 75.4708, GNorm = 0.7553, lr_0 = 4.0709e-04
Loss = 3.3433e-01, PNorm = 75.5308, GNorm = 0.5248, lr_0 = 3.9531e-04
Validation prc-auc = 0.717787
Validation auc = 0.835821
Epoch 13
Loss = 3.5204e-01, PNorm = 75.5861, GNorm = 0.8044, lr_0 = 3.8274e-04
Loss = 3.2314e-01, PNorm = 75.6383, GNorm = 0.7213, lr_0 = 3.7167e-04
Loss = 3.0632e-01, PNorm = 75.6974, GNorm = 1.3180, lr_0 = 3.6091e-04
Validation prc-auc = 0.701264
Validation auc = 0.829814
Epoch 14
Loss = 3.0438e-01, PNorm = 75.7509, GNorm = 0.6945, lr_0 = 3.4944e-04
Loss = 3.0630e-01, PNorm = 75.8079, GNorm = 0.9669, lr_0 = 3.3932e-04
Loss = 3.0990e-01, PNorm = 75.8549, GNorm = 1.1093, lr_0 = 3.2950e-04
Validation prc-auc = 0.735675
Validation auc = 0.834183
Epoch 15
Loss = 2.9933e-01, PNorm = 75.9119, GNorm = 0.6917, lr_0 = 3.1996e-04
Loss = 2.4375e-01, PNorm = 75.9668, GNorm = 1.0673, lr_0 = 3.1070e-04
Loss = 3.4540e-01, PNorm = 76.0120, GNorm = 1.0913, lr_0 = 3.0171e-04
Loss = 3.1017e-01, PNorm = 76.0175, GNorm = 2.2999, lr_0 = 3.0083e-04
Validation prc-auc = 0.734981
Validation auc = 0.835457
Epoch 16
Loss = 2.8812e-01, PNorm = 76.0673, GNorm = 0.8853, lr_0 = 2.9212e-04
Loss = 2.9128e-01, PNorm = 76.1145, GNorm = 0.8395, lr_0 = 2.8367e-04
Validation prc-auc = 0.722104
Validation auc = 0.828176
Epoch 17
Loss = 2.5921e-01, PNorm = 76.1611, GNorm = 0.9855, lr_0 = 2.7465e-04
Loss = 2.9359e-01, PNorm = 76.2035, GNorm = 1.0557, lr_0 = 2.6670e-04
Loss = 2.9961e-01, PNorm = 76.2401, GNorm = 1.5474, lr_0 = 2.5898e-04
Validation prc-auc = 0.719747
Validation auc = 0.844740
Epoch 18
Loss = 2.4310e-01, PNorm = 76.2876, GNorm = 0.7419, lr_0 = 2.5075e-04
Loss = 2.9112e-01, PNorm = 76.3270, GNorm = 1.3761, lr_0 = 2.4349e-04
Loss = 2.7449e-01, PNorm = 76.3680, GNorm = 1.1830, lr_0 = 2.3644e-04
Validation prc-auc = 0.723849
Validation auc = 0.829996
Epoch 19
Loss = 2.5117e-01, PNorm = 76.4053, GNorm = 1.3439, lr_0 = 2.2893e-04
Loss = 2.5424e-01, PNorm = 76.4350, GNorm = 1.0923, lr_0 = 2.2230e-04
Loss = 2.9750e-01, PNorm = 76.4723, GNorm = 0.9923, lr_0 = 2.1587e-04
Validation prc-auc = 0.742107
Validation auc = 0.843466
Epoch 20
Loss = 2.4326e-01, PNorm = 76.5088, GNorm = 0.9823, lr_0 = 2.0900e-04
Loss = 2.5389e-01, PNorm = 76.5400, GNorm = 0.6677, lr_0 = 2.0295e-04
Loss = 2.6544e-01, PNorm = 76.5731, GNorm = 0.9087, lr_0 = 1.9708e-04
Loss = 3.9450e-01, PNorm = 76.5765, GNorm = 3.3591, lr_0 = 1.9650e-04
Validation prc-auc = 0.743285
Validation auc = 0.843284
Epoch 21
Loss = 2.4582e-01, PNorm = 76.6063, GNorm = 1.0719, lr_0 = 1.9081e-04
Loss = 2.2983e-01, PNorm = 76.6365, GNorm = 1.0370, lr_0 = 1.8529e-04
Validation prc-auc = 0.716156
Validation auc = 0.834729
Epoch 22
Loss = 2.1619e-01, PNorm = 76.6614, GNorm = 0.8715, lr_0 = 1.7993e-04
Loss = 2.2928e-01, PNorm = 76.7038, GNorm = 0.8058, lr_0 = 1.7472e-04
Loss = 2.8662e-01, PNorm = 76.7244, GNorm = 0.9385, lr_0 = 1.6966e-04
Validation prc-auc = 0.743373
Validation auc = 0.835639
Epoch 23
Loss = 2.7148e-01, PNorm = 76.7574, GNorm = 1.3049, lr_0 = 1.6427e-04
Loss = 2.2917e-01, PNorm = 76.7798, GNorm = 1.1540, lr_0 = 1.5952e-04
Loss = 2.4103e-01, PNorm = 76.7983, GNorm = 1.0211, lr_0 = 1.5490e-04
Validation prc-auc = 0.724576
Validation auc = 0.834911
Epoch 24
Loss = 2.8700e-01, PNorm = 76.8245, GNorm = 1.4386, lr_0 = 1.4998e-04
Loss = 2.3180e-01, PNorm = 76.8412, GNorm = 1.2176, lr_0 = 1.4563e-04
Loss = 2.3322e-01, PNorm = 76.8590, GNorm = 0.7231, lr_0 = 1.4142e-04
Validation prc-auc = 0.736612
Validation auc = 0.842556
Epoch 25
Loss = 2.0418e-01, PNorm = 76.8806, GNorm = 1.1894, lr_0 = 1.3692e-04
Loss = 1.9245e-01, PNorm = 76.9007, GNorm = 0.8028, lr_0 = 1.3296e-04
Loss = 2.1642e-01, PNorm = 76.9166, GNorm = 1.2839, lr_0 = 1.2911e-04
Validation prc-auc = 0.746678
Validation auc = 0.841645
Epoch 26
Loss = 2.0974e-01, PNorm = 76.9342, GNorm = 0.9660, lr_0 = 1.2501e-04
Loss = 2.2897e-01, PNorm = 76.9499, GNorm = 1.2410, lr_0 = 1.2139e-04
Validation prc-auc = 0.753961
Validation auc = 0.852748
Epoch 27
Loss = 2.5466e-01, PNorm = 76.9666, GNorm = 1.3326, lr_0 = 1.1753e-04
Loss = 1.8165e-01, PNorm = 76.9850, GNorm = 0.8968, lr_0 = 1.1413e-04
Loss = 2.2403e-01, PNorm = 76.9940, GNorm = 1.3319, lr_0 = 1.1083e-04
Validation prc-auc = 0.763865
Validation auc = 0.856571
Epoch 28
Loss = 2.4126e-01, PNorm = 77.0122, GNorm = 1.0258, lr_0 = 1.0730e-04
Loss = 2.2807e-01, PNorm = 77.0221, GNorm = 0.9858, lr_0 = 1.0420e-04
Loss = 1.6616e-01, PNorm = 77.0365, GNorm = 1.3624, lr_0 = 1.0118e-04
Validation prc-auc = 0.756244
Validation auc = 0.850564
Epoch 29
Loss = 1.9697e-01, PNorm = 77.0488, GNorm = 1.3254, lr_0 = 1.0000e-04
Loss = 1.9896e-01, PNorm = 77.0617, GNorm = 0.8300, lr_0 = 1.0000e-04
Loss = 1.8573e-01, PNorm = 77.0738, GNorm = 1.4167, lr_0 = 1.0000e-04
Validation prc-auc = 0.749221
Validation auc = 0.850564
Model 0 best validation prc-auc = 0.763865 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.642396
Model 0 test auc = 0.821267
Ensemble test prc-auc = 0.642396
Ensemble test auc = 0.821267
Fold 1
Splitting data with seed 1
Total scaffolds = 870 | train scaffolds = 625 | val scaffolds = 111 | test scaffolds = 134
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.4823e-01, PNorm = 72.7759, GNorm = 0.5334, lr_0 = 1.0000e-03
Loss = 5.0590e-01, PNorm = 73.1738, GNorm = 0.4658, lr_0 = 1.0000e-03
Validation prc-auc = 0.305616
Validation auc = 0.595000
Epoch 1
Loss = 5.0361e-01, PNorm = 73.4224, GNorm = 0.5286, lr_0 = 1.0000e-03
Loss = 3.8527e-01, PNorm = 73.5444, GNorm = 0.4894, lr_0 = 1.0000e-03
Loss = 4.0040e-01, PNorm = 73.6271, GNorm = 0.8704, lr_0 = 1.0000e-03
Validation prc-auc = 0.327176
Validation auc = 0.571481
Epoch 2
Loss = 4.5753e-01, PNorm = 73.6923, GNorm = 0.4956, lr_0 = 9.7965e-04
Loss = 3.6262e-01, PNorm = 73.7647, GNorm = 0.5151, lr_0 = 9.5130e-04
Loss = 4.2480e-01, PNorm = 73.8255, GNorm = 0.4820, lr_0 = 9.2376e-04
Validation prc-auc = 0.377608
Validation auc = 0.626852
Epoch 3
Loss = 3.6403e-01, PNorm = 73.8895, GNorm = 0.6163, lr_0 = 8.9440e-04
Loss = 3.5892e-01, PNorm = 73.9480, GNorm = 0.5731, lr_0 = 8.6851e-04
Loss = 4.0401e-01, PNorm = 74.0016, GNorm = 0.8168, lr_0 = 8.4337e-04
Validation prc-auc = 0.417635
Validation auc = 0.649444
Epoch 4
Loss = 4.4457e-01, PNorm = 74.0604, GNorm = 0.5450, lr_0 = 8.1656e-04
Loss = 4.0211e-01, PNorm = 74.1247, GNorm = 0.7595, lr_0 = 7.9293e-04
Loss = 3.6248e-01, PNorm = 74.1770, GNorm = 0.7992, lr_0 = 7.6998e-04
Loss = 1.3004e-01, PNorm = 74.1835, GNorm = 1.2395, lr_0 = 7.6772e-04
Validation prc-auc = 0.429133
Validation auc = 0.658704
Epoch 5
Loss = 4.0404e-01, PNorm = 74.2263, GNorm = 0.5641, lr_0 = 7.4550e-04
Loss = 3.8948e-01, PNorm = 74.2846, GNorm = 0.4902, lr_0 = 7.2393e-04
Validation prc-auc = 0.461074
Validation auc = 0.678704
Epoch 6
Loss = 4.2193e-01, PNorm = 74.3282, GNorm = 0.6876, lr_0 = 7.0091e-04
Loss = 3.6871e-01, PNorm = 74.3749, GNorm = 0.6321, lr_0 = 6.8063e-04
Loss = 3.1528e-01, PNorm = 74.4258, GNorm = 0.4421, lr_0 = 6.6093e-04
Validation prc-auc = 0.457972
Validation auc = 0.680741
Epoch 7
Loss = 3.5539e-01, PNorm = 74.4798, GNorm = 0.7689, lr_0 = 6.3992e-04
Loss = 3.6249e-01, PNorm = 74.5439, GNorm = 0.6627, lr_0 = 6.2139e-04
Loss = 3.4721e-01, PNorm = 74.6015, GNorm = 0.5285, lr_0 = 6.0341e-04
Validation prc-auc = 0.502292
Validation auc = 0.701667
Epoch 8
Loss = 3.8214e-01, PNorm = 74.6576, GNorm = 0.9057, lr_0 = 5.8595e-04
Loss = 3.9459e-01, PNorm = 74.7174, GNorm = 0.4832, lr_0 = 5.6899e-04
Loss = 3.2398e-01, PNorm = 74.7862, GNorm = 0.7622, lr_0 = 5.5252e-04
Validation prc-auc = 0.491562
Validation auc = 0.690370
Epoch 9
Loss = 3.5496e-01, PNorm = 74.8435, GNorm = 0.6093, lr_0 = 5.3495e-04
Loss = 3.4135e-01, PNorm = 74.8980, GNorm = 0.7130, lr_0 = 5.1947e-04
Loss = 2.9991e-01, PNorm = 74.9458, GNorm = 0.6737, lr_0 = 5.0444e-04
Validation prc-auc = 0.488655
Validation auc = 0.687963
Epoch 10
Loss = 3.1301e-01, PNorm = 75.0096, GNorm = 0.6511, lr_0 = 4.8840e-04
Loss = 3.6606e-01, PNorm = 75.0666, GNorm = 0.6033, lr_0 = 4.7426e-04
Validation prc-auc = 0.538741
Validation auc = 0.696852
Epoch 11
Loss = 3.4892e-01, PNorm = 75.1346, GNorm = 0.6679, lr_0 = 4.5919e-04
Loss = 3.0681e-01, PNorm = 75.1909, GNorm = 0.7468, lr_0 = 4.4590e-04
Loss = 3.5342e-01, PNorm = 75.2477, GNorm = 0.6443, lr_0 = 4.3299e-04
Validation prc-auc = 0.545285
Validation auc = 0.696852
Epoch 12
Loss = 2.5032e-01, PNorm = 75.3162, GNorm = 0.5475, lr_0 = 4.1923e-04
Loss = 3.1854e-01, PNorm = 75.3712, GNorm = 0.7273, lr_0 = 4.0709e-04
Loss = 2.9554e-01, PNorm = 75.4379, GNorm = 0.5322, lr_0 = 3.9531e-04
Validation prc-auc = 0.547934
Validation auc = 0.713889
Epoch 13
Loss = 2.7377e-01, PNorm = 75.4942, GNorm = 0.6492, lr_0 = 3.8274e-04
Loss = 3.0758e-01, PNorm = 75.5580, GNorm = 0.8386, lr_0 = 3.7167e-04
Loss = 3.1066e-01, PNorm = 75.6179, GNorm = 1.0031, lr_0 = 3.6091e-04
Validation prc-auc = 0.547649
Validation auc = 0.720926
Epoch 14
Loss = 3.3347e-01, PNorm = 75.6757, GNorm = 0.6525, lr_0 = 3.4944e-04
Loss = 3.0538e-01, PNorm = 75.7305, GNorm = 0.8921, lr_0 = 3.3932e-04
Loss = 2.9003e-01, PNorm = 75.7788, GNorm = 0.8978, lr_0 = 3.2950e-04
Validation prc-auc = 0.511200
Validation auc = 0.707407
Epoch 15
Loss = 2.4586e-01, PNorm = 75.8224, GNorm = 0.6511, lr_0 = 3.1996e-04
Loss = 2.8719e-01, PNorm = 75.8687, GNorm = 0.9716, lr_0 = 3.1070e-04
Loss = 2.9675e-01, PNorm = 75.9147, GNorm = 0.7142, lr_0 = 3.0171e-04
Loss = 4.5559e-01, PNorm = 75.9196, GNorm = 2.6841, lr_0 = 3.0083e-04
Validation prc-auc = 0.552578
Validation auc = 0.720741
Epoch 16
Loss = 2.3814e-01, PNorm = 75.9661, GNorm = 0.7565, lr_0 = 2.9212e-04
Loss = 2.7241e-01, PNorm = 76.0121, GNorm = 1.2137, lr_0 = 2.8367e-04
Validation prc-auc = 0.588517
Validation auc = 0.745741
Epoch 17
Loss = 2.8583e-01, PNorm = 76.0507, GNorm = 0.6911, lr_0 = 2.7465e-04
Loss = 2.6715e-01, PNorm = 76.0914, GNorm = 0.7053, lr_0 = 2.6670e-04
Loss = 2.6187e-01, PNorm = 76.1353, GNorm = 0.7555, lr_0 = 2.5898e-04
Validation prc-auc = 0.568932
Validation auc = 0.731481
Epoch 18
Loss = 2.9422e-01, PNorm = 76.1785, GNorm = 0.9690, lr_0 = 2.5075e-04
Loss = 2.4275e-01, PNorm = 76.2200, GNorm = 1.2665, lr_0 = 2.4349e-04
Loss = 2.3600e-01, PNorm = 76.2562, GNorm = 0.9875, lr_0 = 2.3644e-04
Validation prc-auc = 0.587135
Validation auc = 0.721667
Epoch 19
Loss = 2.5126e-01, PNorm = 76.2866, GNorm = 0.5469, lr_0 = 2.2893e-04
Loss = 2.4741e-01, PNorm = 76.3172, GNorm = 0.6952, lr_0 = 2.2230e-04
Loss = 2.6724e-01, PNorm = 76.3445, GNorm = 0.6422, lr_0 = 2.1587e-04
Validation prc-auc = 0.594766
Validation auc = 0.727963
Epoch 20
Loss = 2.1969e-01, PNorm = 76.3757, GNorm = 0.7644, lr_0 = 2.0900e-04
Loss = 2.7455e-01, PNorm = 76.4061, GNorm = 0.9037, lr_0 = 2.0295e-04
Loss = 2.2050e-01, PNorm = 76.4363, GNorm = 0.9785, lr_0 = 1.9708e-04
Loss = 1.4044e-01, PNorm = 76.4391, GNorm = 1.3513, lr_0 = 1.9650e-04
Validation prc-auc = 0.598867
Validation auc = 0.730000
Epoch 21
Loss = 2.1825e-01, PNorm = 76.4669, GNorm = 0.9360, lr_0 = 1.9081e-04
Loss = 2.0679e-01, PNorm = 76.4972, GNorm = 1.3455, lr_0 = 1.8529e-04
Validation prc-auc = 0.598200
Validation auc = 0.730000
Epoch 22
Loss = 2.4571e-01, PNorm = 76.5204, GNorm = 0.8406, lr_0 = 1.7993e-04
Loss = 2.1223e-01, PNorm = 76.5459, GNorm = 0.8892, lr_0 = 1.7472e-04
Loss = 2.1861e-01, PNorm = 76.5728, GNorm = 0.8865, lr_0 = 1.6966e-04
Validation prc-auc = 0.623929
Validation auc = 0.739815
Epoch 23
Loss = 2.4200e-01, PNorm = 76.6012, GNorm = 1.1516, lr_0 = 1.6427e-04
Loss = 2.1520e-01, PNorm = 76.6258, GNorm = 1.4245, lr_0 = 1.5952e-04
Loss = 2.0289e-01, PNorm = 76.6479, GNorm = 0.8133, lr_0 = 1.5490e-04
Validation prc-auc = 0.598600
Validation auc = 0.733519
Epoch 24
Loss = 2.0192e-01, PNorm = 76.6707, GNorm = 1.2389, lr_0 = 1.4998e-04
Loss = 2.1941e-01, PNorm = 76.6933, GNorm = 0.9114, lr_0 = 1.4563e-04
Loss = 2.2509e-01, PNorm = 76.7128, GNorm = 1.2630, lr_0 = 1.4142e-04
Validation prc-auc = 0.599020
Validation auc = 0.731481
Epoch 25
Loss = 2.2768e-01, PNorm = 76.7309, GNorm = 1.2115, lr_0 = 1.3692e-04
Loss = 2.4375e-01, PNorm = 76.7458, GNorm = 1.0363, lr_0 = 1.3296e-04
Loss = 1.9197e-01, PNorm = 76.7659, GNorm = 0.9410, lr_0 = 1.2911e-04
Validation prc-auc = 0.589411
Validation auc = 0.735556
Epoch 26
Loss = 2.1510e-01, PNorm = 76.7867, GNorm = 1.3365, lr_0 = 1.2501e-04
Loss = 1.8402e-01, PNorm = 76.8028, GNorm = 1.1193, lr_0 = 1.2139e-04
Validation prc-auc = 0.592444
Validation auc = 0.727778
Epoch 27
Loss = 3.0258e-01, PNorm = 76.8188, GNorm = 1.2749, lr_0 = 1.1753e-04
Loss = 2.0549e-01, PNorm = 76.8335, GNorm = 1.5915, lr_0 = 1.1413e-04
Loss = 1.6923e-01, PNorm = 76.8472, GNorm = 1.1522, lr_0 = 1.1083e-04
Validation prc-auc = 0.599425
Validation auc = 0.727037
Epoch 28
Loss = 2.2001e-01, PNorm = 76.8586, GNorm = 0.9356, lr_0 = 1.0730e-04
Loss = 1.9542e-01, PNorm = 76.8708, GNorm = 0.8217, lr_0 = 1.0420e-04
Loss = 1.8388e-01, PNorm = 76.8835, GNorm = 0.9046, lr_0 = 1.0118e-04
Validation prc-auc = 0.586728
Validation auc = 0.730741
Epoch 29
Loss = 2.0353e-01, PNorm = 76.8970, GNorm = 0.9060, lr_0 = 1.0000e-04
Loss = 1.6360e-01, PNorm = 76.9105, GNorm = 1.1265, lr_0 = 1.0000e-04
Loss = 1.8775e-01, PNorm = 76.9211, GNorm = 0.7935, lr_0 = 1.0000e-04
Validation prc-auc = 0.602323
Validation auc = 0.736852
Model 0 best validation prc-auc = 0.623929 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.495492
Model 0 test auc = 0.724950
Ensemble test prc-auc = 0.495492
Ensemble test auc = 0.724950
Fold 2
Splitting data with seed 2
Total scaffolds = 870 | train scaffolds = 646 | val scaffolds = 88 | test scaffolds = 136
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.3521e-01, PNorm = 72.7602, GNorm = 0.5042, lr_0 = 1.0000e-03
Loss = 4.2861e-01, PNorm = 73.1590, GNorm = 0.5242, lr_0 = 1.0000e-03
Validation prc-auc = 0.467616
Validation auc = 0.749335
Epoch 1
Loss = 4.0236e-01, PNorm = 73.3991, GNorm = 0.6781, lr_0 = 1.0000e-03
Loss = 4.0375e-01, PNorm = 73.5321, GNorm = 0.9626, lr_0 = 1.0000e-03
Loss = 4.2219e-01, PNorm = 73.6179, GNorm = 0.7068, lr_0 = 1.0000e-03
Validation prc-auc = 0.410079
Validation auc = 0.739362
Epoch 2
Loss = 4.2497e-01, PNorm = 73.6901, GNorm = 0.5573, lr_0 = 9.7965e-04
Loss = 4.0555e-01, PNorm = 73.7605, GNorm = 0.6693, lr_0 = 9.5130e-04
Loss = 4.2349e-01, PNorm = 73.8161, GNorm = 1.1037, lr_0 = 9.2376e-04
Validation prc-auc = 0.422830
Validation auc = 0.745844
Epoch 3
Loss = 3.5976e-01, PNorm = 73.8830, GNorm = 0.7327, lr_0 = 8.9440e-04
Loss = 4.5230e-01, PNorm = 73.9416, GNorm = 0.8594, lr_0 = 8.6851e-04
Loss = 3.8173e-01, PNorm = 74.0129, GNorm = 0.4764, lr_0 = 8.4337e-04
Validation prc-auc = 0.444084
Validation auc = 0.761802
Epoch 4
Loss = 3.8512e-01, PNorm = 74.0953, GNorm = 1.2520, lr_0 = 8.1656e-04
Loss = 4.0600e-01, PNorm = 74.1715, GNorm = 1.0916, lr_0 = 7.9293e-04
Loss = 3.7709e-01, PNorm = 74.2411, GNorm = 0.6543, lr_0 = 7.6998e-04
Loss = 1.2062e+00, PNorm = 74.2450, GNorm = 4.4210, lr_0 = 7.6772e-04
Validation prc-auc = 0.436412
Validation auc = 0.744348
Epoch 5
Loss = 4.4387e-01, PNorm = 74.3363, GNorm = 0.5961, lr_0 = 7.4550e-04
Loss = 3.7524e-01, PNorm = 74.4025, GNorm = 0.5196, lr_0 = 7.2393e-04
Validation prc-auc = 0.482601
Validation auc = 0.771609
Epoch 6
Loss = 3.5423e-01, PNorm = 74.4738, GNorm = 0.5934, lr_0 = 7.0091e-04
Loss = 3.5453e-01, PNorm = 74.5283, GNorm = 0.6614, lr_0 = 6.8063e-04
Loss = 3.8946e-01, PNorm = 74.5882, GNorm = 1.1954, lr_0 = 6.6093e-04
Validation prc-auc = 0.464385
Validation auc = 0.756981
Epoch 7
Loss = 3.6267e-01, PNorm = 74.6556, GNorm = 1.2183, lr_0 = 6.3992e-04
Loss = 3.8519e-01, PNorm = 74.7287, GNorm = 1.8987, lr_0 = 6.2139e-04
Loss = 3.2989e-01, PNorm = 74.7798, GNorm = 0.6686, lr_0 = 6.0341e-04
Validation prc-auc = 0.443474
Validation auc = 0.753823
Epoch 8
Loss = 3.0034e-01, PNorm = 74.8528, GNorm = 0.5833, lr_0 = 5.8595e-04
Loss = 3.5132e-01, PNorm = 74.9101, GNorm = 0.7710, lr_0 = 5.6899e-04
Loss = 3.8383e-01, PNorm = 74.9798, GNorm = 0.7760, lr_0 = 5.5252e-04
Validation prc-auc = 0.500157
Validation auc = 0.762965
Epoch 9
Loss = 2.9965e-01, PNorm = 75.0514, GNorm = 0.5174, lr_0 = 5.3495e-04
Loss = 3.4087e-01, PNorm = 75.1165, GNorm = 0.6740, lr_0 = 5.1947e-04
Loss = 3.4921e-01, PNorm = 75.1884, GNorm = 0.7043, lr_0 = 5.0444e-04
Validation prc-auc = 0.550745
Validation auc = 0.792886
Epoch 10
Loss = 2.9883e-01, PNorm = 75.2677, GNorm = 0.7012, lr_0 = 4.8840e-04
Loss = 3.8281e-01, PNorm = 75.3167, GNorm = 0.8466, lr_0 = 4.7426e-04
Validation prc-auc = 0.478449
Validation auc = 0.748172
Epoch 11
Loss = 3.4675e-01, PNorm = 75.3827, GNorm = 0.6993, lr_0 = 4.5919e-04
Loss = 3.0117e-01, PNorm = 75.4370, GNorm = 0.8153, lr_0 = 4.4590e-04
Loss = 3.1966e-01, PNorm = 75.4938, GNorm = 0.7803, lr_0 = 4.3299e-04
Validation prc-auc = 0.541744
Validation auc = 0.782414
Epoch 12
Loss = 3.3585e-01, PNorm = 75.5578, GNorm = 1.2596, lr_0 = 4.1923e-04
Loss = 3.0835e-01, PNorm = 75.6059, GNorm = 0.7271, lr_0 = 4.0709e-04
Loss = 3.2673e-01, PNorm = 75.6610, GNorm = 1.2495, lr_0 = 3.9531e-04
Validation prc-auc = 0.547105
Validation auc = 0.784574
Epoch 13
Loss = 2.9188e-01, PNorm = 75.7221, GNorm = 0.7781, lr_0 = 3.8274e-04
Loss = 2.9655e-01, PNorm = 75.7718, GNorm = 0.7149, lr_0 = 3.7167e-04
Loss = 3.0471e-01, PNorm = 75.8215, GNorm = 0.7749, lr_0 = 3.6091e-04
Validation prc-auc = 0.599518
Validation auc = 0.801197
Epoch 14
Loss = 2.7076e-01, PNorm = 75.8695, GNorm = 0.8973, lr_0 = 3.4944e-04
Loss = 2.8963e-01, PNorm = 75.9199, GNorm = 1.1241, lr_0 = 3.3932e-04
Loss = 3.1929e-01, PNorm = 75.9524, GNorm = 0.8492, lr_0 = 3.2950e-04
Validation prc-auc = 0.525194
Validation auc = 0.767620
Epoch 15
Loss = 2.9053e-01, PNorm = 75.9953, GNorm = 1.2986, lr_0 = 3.1996e-04
Loss = 2.7687e-01, PNorm = 76.0423, GNorm = 0.7157, lr_0 = 3.1070e-04
Loss = 2.8928e-01, PNorm = 76.0838, GNorm = 0.7996, lr_0 = 3.0171e-04
Loss = 3.1121e-01, PNorm = 76.0879, GNorm = 1.8721, lr_0 = 3.0083e-04
Validation prc-auc = 0.570953
Validation auc = 0.796376
Epoch 16
Loss = 2.7373e-01, PNorm = 76.1281, GNorm = 0.8611, lr_0 = 2.9212e-04
Loss = 2.4971e-01, PNorm = 76.1683, GNorm = 1.0254, lr_0 = 2.8367e-04
Validation prc-auc = 0.589990
Validation auc = 0.786735
Epoch 17
Loss = 1.9866e-01, PNorm = 76.2057, GNorm = 1.0159, lr_0 = 2.7465e-04
Loss = 2.8980e-01, PNorm = 76.2501, GNorm = 1.2173, lr_0 = 2.6670e-04
Loss = 2.6842e-01, PNorm = 76.2905, GNorm = 0.4767, lr_0 = 2.5898e-04
Validation prc-auc = 0.606671
Validation auc = 0.796875
Epoch 18
Loss = 2.6111e-01, PNorm = 76.3275, GNorm = 0.6776, lr_0 = 2.5075e-04
Loss = 2.5995e-01, PNorm = 76.3620, GNorm = 0.7478, lr_0 = 2.4349e-04
Loss = 2.5822e-01, PNorm = 76.3960, GNorm = 0.8222, lr_0 = 2.3644e-04
Validation prc-auc = 0.641990
Validation auc = 0.796376
Epoch 19
Loss = 3.1980e-01, PNorm = 76.4305, GNorm = 1.2105, lr_0 = 2.2893e-04
Loss = 2.1026e-01, PNorm = 76.4640, GNorm = 0.9266, lr_0 = 2.2230e-04
Loss = 2.6667e-01, PNorm = 76.4853, GNorm = 0.9722, lr_0 = 2.1587e-04
Validation prc-auc = 0.610987
Validation auc = 0.786902
Epoch 20
Loss = 2.3492e-01, PNorm = 76.5287, GNorm = 0.7824, lr_0 = 2.0900e-04
Loss = 2.8796e-01, PNorm = 76.5564, GNorm = 1.0371, lr_0 = 2.0295e-04
Loss = 2.2917e-01, PNorm = 76.5831, GNorm = 0.9314, lr_0 = 1.9708e-04
Loss = 2.0816e-01, PNorm = 76.5858, GNorm = 1.9755, lr_0 = 1.9650e-04
Validation prc-auc = 0.669442
Validation auc = 0.801695
Epoch 21
Loss = 2.3643e-01, PNorm = 76.6115, GNorm = 0.8775, lr_0 = 1.9081e-04
Loss = 2.5537e-01, PNorm = 76.6345, GNorm = 0.5508, lr_0 = 1.8529e-04
Validation prc-auc = 0.656207
Validation auc = 0.802693
Epoch 22
Loss = 2.2161e-01, PNorm = 76.6631, GNorm = 0.7664, lr_0 = 1.7993e-04
Loss = 2.2478e-01, PNorm = 76.6841, GNorm = 1.1686, lr_0 = 1.7472e-04
Loss = 2.4606e-01, PNorm = 76.7068, GNorm = 1.2659, lr_0 = 1.6966e-04
Validation prc-auc = 0.655972
Validation auc = 0.802028
Epoch 23
Loss = 2.4261e-01, PNorm = 76.7304, GNorm = 1.3153, lr_0 = 1.6427e-04
Loss = 2.1439e-01, PNorm = 76.7514, GNorm = 0.9295, lr_0 = 1.5952e-04
Loss = 2.2508e-01, PNorm = 76.7726, GNorm = 0.8476, lr_0 = 1.5490e-04
Validation prc-auc = 0.664376
Validation auc = 0.806350
Epoch 24
Loss = 2.1100e-01, PNorm = 76.7965, GNorm = 1.1286, lr_0 = 1.4998e-04
Loss = 2.2598e-01, PNorm = 76.8097, GNorm = 0.9114, lr_0 = 1.4563e-04
Loss = 2.2758e-01, PNorm = 76.8273, GNorm = 1.1618, lr_0 = 1.4142e-04
Validation prc-auc = 0.659555
Validation auc = 0.803025
Epoch 25
Loss = 2.2536e-01, PNorm = 76.8483, GNorm = 1.2316, lr_0 = 1.3692e-04
Loss = 1.7774e-01, PNorm = 76.8704, GNorm = 0.8506, lr_0 = 1.3296e-04
Loss = 2.5170e-01, PNorm = 76.8867, GNorm = 1.1731, lr_0 = 1.2911e-04
Validation prc-auc = 0.682543
Validation auc = 0.806516
Epoch 26
Loss = 2.2370e-01, PNorm = 76.9033, GNorm = 0.8901, lr_0 = 1.2501e-04
Loss = 1.7323e-01, PNorm = 76.9185, GNorm = 0.9670, lr_0 = 1.2139e-04
Validation prc-auc = 0.660660
Validation auc = 0.802028
Epoch 27
Loss = 1.8492e-01, PNorm = 76.9329, GNorm = 1.3131, lr_0 = 1.1753e-04
Loss = 2.2358e-01, PNorm = 76.9487, GNorm = 1.1450, lr_0 = 1.1413e-04
Loss = 2.0752e-01, PNorm = 76.9587, GNorm = 0.6985, lr_0 = 1.1083e-04
Validation prc-auc = 0.662861
Validation auc = 0.803856
Epoch 28
Loss = 2.0767e-01, PNorm = 76.9730, GNorm = 1.0723, lr_0 = 1.0730e-04
Loss = 2.0506e-01, PNorm = 76.9872, GNorm = 1.2399, lr_0 = 1.0420e-04
Loss = 1.9482e-01, PNorm = 76.9991, GNorm = 1.0833, lr_0 = 1.0118e-04
Validation prc-auc = 0.674550
Validation auc = 0.807015
Epoch 29
Loss = 1.8566e-01, PNorm = 77.0106, GNorm = 1.4121, lr_0 = 1.0000e-04
Loss = 1.7103e-01, PNorm = 77.0230, GNorm = 0.9898, lr_0 = 1.0000e-04
Loss = 2.0567e-01, PNorm = 77.0345, GNorm = 1.1449, lr_0 = 1.0000e-04
Validation prc-auc = 0.656120
Validation auc = 0.805352
Model 0 best validation prc-auc = 0.682543 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.606983
Model 0 test auc = 0.789009
Ensemble test prc-auc = 0.606983
Ensemble test auc = 0.789009
Fold 3
Splitting data with seed 3
Total scaffolds = 870 | train scaffolds = 627 | val scaffolds = 116 | test scaffolds = 127
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 8.2463e-01, PNorm = 72.7629, GNorm = 0.6283, lr_0 = 1.0000e-03
Loss = 4.4027e-01, PNorm = 73.1666, GNorm = 0.5628, lr_0 = 1.0000e-03
Validation prc-auc = 0.418750
Validation auc = 0.814146
Epoch 1
Loss = 5.7678e-01, PNorm = 73.4031, GNorm = 1.8325, lr_0 = 1.0000e-03
Loss = 4.3110e-01, PNorm = 73.5285, GNorm = 0.4870, lr_0 = 1.0000e-03
Loss = 4.3979e-01, PNorm = 73.6059, GNorm = 0.6496, lr_0 = 1.0000e-03
Validation prc-auc = 0.420882
Validation auc = 0.837636
Epoch 2
Loss = 3.9173e-01, PNorm = 73.6763, GNorm = 0.6036, lr_0 = 9.7965e-04
Loss = 4.1596e-01, PNorm = 73.7293, GNorm = 0.4996, lr_0 = 9.5130e-04
Loss = 4.2031e-01, PNorm = 73.7833, GNorm = 0.5787, lr_0 = 9.2376e-04
Validation prc-auc = 0.447203
Validation auc = 0.840475
Epoch 3
Loss = 4.2936e-01, PNorm = 73.8436, GNorm = 0.4717, lr_0 = 8.9440e-04
Loss = 3.9728e-01, PNorm = 73.9057, GNorm = 0.4943, lr_0 = 8.6851e-04
Loss = 4.0021e-01, PNorm = 73.9696, GNorm = 1.0799, lr_0 = 8.4337e-04
Validation prc-auc = 0.416213
Validation auc = 0.830924
Epoch 4
Loss = 4.1008e-01, PNorm = 74.0410, GNorm = 0.8165, lr_0 = 8.1656e-04
Loss = 3.9362e-01, PNorm = 74.1036, GNorm = 0.7385, lr_0 = 7.9293e-04
Loss = 3.9186e-01, PNorm = 74.1571, GNorm = 0.8024, lr_0 = 7.6998e-04
Loss = 5.4511e-01, PNorm = 74.1621, GNorm = 1.8418, lr_0 = 7.6772e-04
Validation prc-auc = 0.464897
Validation auc = 0.847186
Epoch 5
Loss = 4.1708e-01, PNorm = 74.2164, GNorm = 0.5927, lr_0 = 7.4550e-04
Loss = 3.5903e-01, PNorm = 74.2795, GNorm = 1.0391, lr_0 = 7.2393e-04
Validation prc-auc = 0.451792
Validation auc = 0.854930
Epoch 6
Loss = 3.6277e-01, PNorm = 74.3372, GNorm = 0.8181, lr_0 = 7.0091e-04
Loss = 3.8183e-01, PNorm = 74.3973, GNorm = 0.8254, lr_0 = 6.8063e-04
Loss = 3.6733e-01, PNorm = 74.4491, GNorm = 0.8800, lr_0 = 6.6093e-04
Validation prc-auc = 0.453848
Validation auc = 0.851575
Epoch 7
Loss = 3.3872e-01, PNorm = 74.5100, GNorm = 0.8602, lr_0 = 6.3992e-04
Loss = 3.6295e-01, PNorm = 74.5709, GNorm = 0.7474, lr_0 = 6.2139e-04
Loss = 3.8516e-01, PNorm = 74.6190, GNorm = 0.7386, lr_0 = 6.0341e-04
Validation prc-auc = 0.455969
Validation auc = 0.854930
Epoch 8
Loss = 4.3836e-01, PNorm = 74.6775, GNorm = 1.6471, lr_0 = 5.8595e-04
Loss = 3.5333e-01, PNorm = 74.7224, GNorm = 0.6438, lr_0 = 5.6899e-04
Loss = 3.5069e-01, PNorm = 74.7743, GNorm = 0.5870, lr_0 = 5.5252e-04
Validation prc-auc = 0.470184
Validation auc = 0.854672
Epoch 9
Loss = 3.5738e-01, PNorm = 74.8372, GNorm = 0.7118, lr_0 = 5.3495e-04
Loss = 3.4928e-01, PNorm = 74.8900, GNorm = 0.6901, lr_0 = 5.1947e-04
Loss = 3.6918e-01, PNorm = 74.9414, GNorm = 1.2223, lr_0 = 5.0444e-04
Validation prc-auc = 0.449216
Validation auc = 0.844089
Epoch 10
Loss = 3.2650e-01, PNorm = 74.9915, GNorm = 0.7200, lr_0 = 4.8840e-04
Loss = 3.5050e-01, PNorm = 75.0548, GNorm = 0.9518, lr_0 = 4.7426e-04
Validation prc-auc = 0.492957
Validation auc = 0.871451
Epoch 11
Loss = 2.1786e-01, PNorm = 75.1138, GNorm = 0.5561, lr_0 = 4.5919e-04
Loss = 3.2454e-01, PNorm = 75.1758, GNorm = 0.6955, lr_0 = 4.4590e-04
Loss = 3.3473e-01, PNorm = 75.2338, GNorm = 0.9809, lr_0 = 4.3299e-04
Validation prc-auc = 0.489939
Validation auc = 0.865514
Epoch 12
Loss = 3.4732e-01, PNorm = 75.2997, GNorm = 1.3230, lr_0 = 4.1923e-04
Loss = 3.4376e-01, PNorm = 75.3543, GNorm = 0.7185, lr_0 = 4.0709e-04
Loss = 3.0207e-01, PNorm = 75.4047, GNorm = 0.8220, lr_0 = 3.9531e-04
Validation prc-auc = 0.513157
Validation auc = 0.876097
Epoch 13
Loss = 2.9071e-01, PNorm = 75.4550, GNorm = 0.7305, lr_0 = 3.8274e-04
Loss = 2.8395e-01, PNorm = 75.4944, GNorm = 0.7247, lr_0 = 3.7167e-04
Loss = 3.3120e-01, PNorm = 75.5401, GNorm = 0.8900, lr_0 = 3.6091e-04
Validation prc-auc = 0.535069
Validation auc = 0.879711
Epoch 14
Loss = 3.1453e-01, PNorm = 75.5902, GNorm = 0.9898, lr_0 = 3.4944e-04
Loss = 2.9191e-01, PNorm = 75.6410, GNorm = 1.2254, lr_0 = 3.3932e-04
Loss = 3.0146e-01, PNorm = 75.6811, GNorm = 0.8135, lr_0 = 3.2950e-04
Validation prc-auc = 0.517229
Validation auc = 0.870676
Epoch 15
Loss = 3.1538e-01, PNorm = 75.7309, GNorm = 0.6478, lr_0 = 3.1996e-04
Loss = 3.2118e-01, PNorm = 75.7817, GNorm = 0.7120, lr_0 = 3.1070e-04
Loss = 2.8922e-01, PNorm = 75.8313, GNorm = 1.1173, lr_0 = 3.0171e-04
Loss = 4.1957e-01, PNorm = 75.8351, GNorm = 2.5811, lr_0 = 3.0083e-04
Validation prc-auc = 0.489129
Validation auc = 0.870934
Epoch 16
Loss = 2.6943e-01, PNorm = 75.8791, GNorm = 0.9020, lr_0 = 2.9212e-04
Loss = 3.1805e-01, PNorm = 75.9041, GNorm = 0.8815, lr_0 = 2.8367e-04
Validation prc-auc = 0.490325
Validation auc = 0.871193
Epoch 17
Loss = 3.3061e-01, PNorm = 75.9462, GNorm = 1.0151, lr_0 = 2.7465e-04
Loss = 3.1265e-01, PNorm = 75.9779, GNorm = 0.9629, lr_0 = 2.6670e-04
Loss = 2.9158e-01, PNorm = 76.0224, GNorm = 1.6145, lr_0 = 2.5898e-04
Validation prc-auc = 0.516430
Validation auc = 0.875581
Epoch 18
Loss = 2.2415e-01, PNorm = 76.0576, GNorm = 0.8032, lr_0 = 2.5075e-04
Loss = 3.0360e-01, PNorm = 76.0821, GNorm = 0.8134, lr_0 = 2.4349e-04
Loss = 2.7277e-01, PNorm = 76.1199, GNorm = 0.8833, lr_0 = 2.3644e-04
Validation prc-auc = 0.533598
Validation auc = 0.879453
Epoch 19
Loss = 2.7288e-01, PNorm = 76.1530, GNorm = 0.8725, lr_0 = 2.2893e-04
Loss = 2.6145e-01, PNorm = 76.1848, GNorm = 1.3915, lr_0 = 2.2230e-04
Loss = 2.5204e-01, PNorm = 76.2132, GNorm = 1.1214, lr_0 = 2.1587e-04
Validation prc-auc = 0.613594
Validation auc = 0.884099
Epoch 20
Loss = 2.5179e-01, PNorm = 76.2481, GNorm = 1.8701, lr_0 = 2.0900e-04
Loss = 2.5208e-01, PNorm = 76.2768, GNorm = 0.8447, lr_0 = 2.0295e-04
Loss = 2.6501e-01, PNorm = 76.3008, GNorm = 1.3022, lr_0 = 1.9708e-04
Loss = 4.1457e-01, PNorm = 76.3027, GNorm = 4.2706, lr_0 = 1.9650e-04
Validation prc-auc = 0.563887
Validation auc = 0.882034
Epoch 21
Loss = 2.3392e-01, PNorm = 76.3256, GNorm = 0.9171, lr_0 = 1.9081e-04
Loss = 2.4367e-01, PNorm = 76.3519, GNorm = 1.0500, lr_0 = 1.8529e-04
Validation prc-auc = 0.564947
Validation auc = 0.886164
Epoch 22
Loss = 2.3816e-01, PNorm = 76.3753, GNorm = 0.9973, lr_0 = 1.7993e-04
Loss = 2.5816e-01, PNorm = 76.4042, GNorm = 1.3639, lr_0 = 1.7472e-04
Loss = 2.3983e-01, PNorm = 76.4251, GNorm = 0.9521, lr_0 = 1.6966e-04
Validation prc-auc = 0.608453
Validation auc = 0.886939
Epoch 23
Loss = 2.7258e-01, PNorm = 76.4455, GNorm = 1.9996, lr_0 = 1.6427e-04
Loss = 2.2662e-01, PNorm = 76.4689, GNorm = 1.3289, lr_0 = 1.5952e-04
Loss = 2.4126e-01, PNorm = 76.4887, GNorm = 1.5037, lr_0 = 1.5490e-04
Validation prc-auc = 0.583879
Validation auc = 0.885648
Epoch 24
Loss = 2.4105e-01, PNorm = 76.5153, GNorm = 1.4731, lr_0 = 1.4998e-04
Loss = 2.2848e-01, PNorm = 76.5322, GNorm = 1.1110, lr_0 = 1.4563e-04
Loss = 2.2594e-01, PNorm = 76.5519, GNorm = 0.9865, lr_0 = 1.4142e-04
Validation prc-auc = 0.674716
Validation auc = 0.901652
Epoch 25
Loss = 1.9815e-01, PNorm = 76.5701, GNorm = 1.0111, lr_0 = 1.3692e-04
Loss = 2.1016e-01, PNorm = 76.5880, GNorm = 1.1793, lr_0 = 1.3296e-04
Loss = 2.5576e-01, PNorm = 76.6077, GNorm = 1.3985, lr_0 = 1.2911e-04
Validation prc-auc = 0.691011
Validation auc = 0.901910
Epoch 26
Loss = 2.0115e-01, PNorm = 76.6235, GNorm = 1.2630, lr_0 = 1.2501e-04
Loss = 1.9582e-01, PNorm = 76.6397, GNorm = 1.6708, lr_0 = 1.2139e-04
Validation prc-auc = 0.684394
Validation auc = 0.903201
Epoch 27
Loss = 1.8128e-01, PNorm = 76.6543, GNorm = 1.0580, lr_0 = 1.1753e-04
Loss = 2.0477e-01, PNorm = 76.6652, GNorm = 1.2846, lr_0 = 1.1413e-04
Loss = 2.3802e-01, PNorm = 76.6840, GNorm = 0.9139, lr_0 = 1.1083e-04
Validation prc-auc = 0.660510
Validation auc = 0.896748
Epoch 28
Loss = 1.8673e-01, PNorm = 76.6989, GNorm = 0.9970, lr_0 = 1.0730e-04
Loss = 2.0628e-01, PNorm = 76.7090, GNorm = 0.6943, lr_0 = 1.0420e-04
Loss = 2.1885e-01, PNorm = 76.7231, GNorm = 2.2434, lr_0 = 1.0118e-04
Validation prc-auc = 0.703784
Validation auc = 0.906557
Epoch 29
Loss = 1.7188e-01, PNorm = 76.7371, GNorm = 1.2387, lr_0 = 1.0000e-04
Loss = 1.9917e-01, PNorm = 76.7453, GNorm = 1.3311, lr_0 = 1.0000e-04
Loss = 1.8439e-01, PNorm = 76.7621, GNorm = 1.0164, lr_0 = 1.0000e-04
Validation prc-auc = 0.695842
Validation auc = 0.903201
Model 0 best validation prc-auc = 0.703784 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.617508
Model 0 test auc = 0.761699
Ensemble test prc-auc = 0.617508
Ensemble test auc = 0.761699
Fold 4
Splitting data with seed 4
Total scaffolds = 870 | train scaffolds = 670 | val scaffolds = 90 | test scaffolds = 110
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.5911e-01, PNorm = 72.7540, GNorm = 0.8466, lr_0 = 1.0000e-03
Loss = 4.7870e-01, PNorm = 73.1492, GNorm = 0.5554, lr_0 = 1.0000e-03
Validation prc-auc = 0.392173
Validation auc = 0.705933
Epoch 1
Loss = 5.2236e-01, PNorm = 73.3829, GNorm = 0.8518, lr_0 = 1.0000e-03
Loss = 4.4347e-01, PNorm = 73.5007, GNorm = 0.7815, lr_0 = 1.0000e-03
Loss = 4.3187e-01, PNorm = 73.5775, GNorm = 0.9374, lr_0 = 1.0000e-03
Validation prc-auc = 0.434944
Validation auc = 0.712335
Epoch 2
Loss = 4.0139e-01, PNorm = 73.6545, GNorm = 0.9781, lr_0 = 9.7965e-04
Loss = 4.5761e-01, PNorm = 73.7139, GNorm = 0.5000, lr_0 = 9.5130e-04
Loss = 4.4618e-01, PNorm = 73.7609, GNorm = 0.6193, lr_0 = 9.2376e-04
Validation prc-auc = 0.405820
Validation auc = 0.696543
Epoch 3
Loss = 4.6621e-01, PNorm = 73.8132, GNorm = 0.4756, lr_0 = 8.9440e-04
Loss = 4.1539e-01, PNorm = 73.8633, GNorm = 0.6181, lr_0 = 8.6851e-04
Loss = 3.8942e-01, PNorm = 73.9187, GNorm = 0.5309, lr_0 = 8.4337e-04
Validation prc-auc = 0.484443
Validation auc = 0.712335
Epoch 4
Loss = 3.8588e-01, PNorm = 73.9758, GNorm = 0.7673, lr_0 = 8.1656e-04
Loss = 4.1308e-01, PNorm = 74.0302, GNorm = 0.5246, lr_0 = 7.9293e-04
Loss = 4.4568e-01, PNorm = 74.0920, GNorm = 0.7179, lr_0 = 7.6998e-04
Loss = 4.6538e-01, PNorm = 74.0975, GNorm = 1.6070, lr_0 = 7.6772e-04
Validation prc-auc = 0.461333
Validation auc = 0.710201
Epoch 5
Loss = 3.7498e-01, PNorm = 74.1758, GNorm = 0.5499, lr_0 = 7.4550e-04
Loss = 4.2981e-01, PNorm = 74.2381, GNorm = 0.6176, lr_0 = 7.2393e-04
Validation prc-auc = 0.502466
Validation auc = 0.704012
Epoch 6
Loss = 2.8697e-01, PNorm = 74.3069, GNorm = 0.7334, lr_0 = 7.0091e-04
Loss = 3.7746e-01, PNorm = 74.3713, GNorm = 0.6409, lr_0 = 6.8063e-04
Loss = 3.6993e-01, PNorm = 74.4364, GNorm = 0.8970, lr_0 = 6.6093e-04
Validation prc-auc = 0.525856
Validation auc = 0.719804
Epoch 7
Loss = 3.9541e-01, PNorm = 74.5126, GNorm = 0.8100, lr_0 = 6.3992e-04
Loss = 4.1523e-01, PNorm = 74.5801, GNorm = 0.6363, lr_0 = 6.2139e-04
Loss = 3.6176e-01, PNorm = 74.6410, GNorm = 0.5185, lr_0 = 6.0341e-04
Validation prc-auc = 0.535025
Validation auc = 0.727486
Epoch 8
Loss = 3.3233e-01, PNorm = 74.7069, GNorm = 0.5859, lr_0 = 5.8595e-04
Loss = 4.0496e-01, PNorm = 74.7796, GNorm = 0.9947, lr_0 = 5.6899e-04
Loss = 3.5890e-01, PNorm = 74.8553, GNorm = 0.5361, lr_0 = 5.5252e-04
Validation prc-auc = 0.536513
Validation auc = 0.713828
Epoch 9
Loss = 3.5949e-01, PNorm = 74.9196, GNorm = 0.7740, lr_0 = 5.3495e-04
Loss = 3.3652e-01, PNorm = 74.9841, GNorm = 0.9230, lr_0 = 5.1947e-04
Loss = 3.7343e-01, PNorm = 75.0497, GNorm = 0.6514, lr_0 = 5.0444e-04
Validation prc-auc = 0.501180
Validation auc = 0.743918
Epoch 10
Loss = 3.8614e-01, PNorm = 75.1072, GNorm = 0.7798, lr_0 = 4.8840e-04
Loss = 3.4385e-01, PNorm = 75.1763, GNorm = 0.8918, lr_0 = 4.7426e-04
Validation prc-auc = 0.553275
Validation auc = 0.718950
Epoch 11
Loss = 3.4810e-01, PNorm = 75.2441, GNorm = 0.5884, lr_0 = 4.5919e-04
Loss = 3.5351e-01, PNorm = 75.3084, GNorm = 0.8776, lr_0 = 4.4590e-04
Loss = 3.3892e-01, PNorm = 75.3696, GNorm = 1.0752, lr_0 = 4.3299e-04
Validation prc-auc = 0.542548
Validation auc = 0.727273
Epoch 12
Loss = 3.6835e-01, PNorm = 75.4371, GNorm = 1.0021, lr_0 = 4.1923e-04
Loss = 3.7462e-01, PNorm = 75.4896, GNorm = 1.5192, lr_0 = 4.0709e-04
Loss = 3.1363e-01, PNorm = 75.5426, GNorm = 0.7720, lr_0 = 3.9531e-04
Validation prc-auc = 0.567416
Validation auc = 0.733248
Epoch 13
Loss = 3.2124e-01, PNorm = 75.5897, GNorm = 0.8215, lr_0 = 3.8274e-04
Loss = 3.0492e-01, PNorm = 75.6437, GNorm = 0.7105, lr_0 = 3.7167e-04
Loss = 3.5259e-01, PNorm = 75.6825, GNorm = 0.7589, lr_0 = 3.6091e-04
Validation prc-auc = 0.562637
Validation auc = 0.736876
Epoch 14
Loss = 2.8352e-01, PNorm = 75.7448, GNorm = 0.8032, lr_0 = 3.4944e-04
Loss = 3.0629e-01, PNorm = 75.7950, GNorm = 0.7351, lr_0 = 3.3932e-04
Loss = 3.2291e-01, PNorm = 75.8507, GNorm = 0.6959, lr_0 = 3.2950e-04
Validation prc-auc = 0.548205
Validation auc = 0.730687
Epoch 15
Loss = 3.0131e-01, PNorm = 75.8978, GNorm = 0.9158, lr_0 = 3.1996e-04
Loss = 2.9111e-01, PNorm = 75.9500, GNorm = 0.8252, lr_0 = 3.1070e-04
Loss = 3.1684e-01, PNorm = 75.9913, GNorm = 0.6657, lr_0 = 3.0171e-04
Loss = 3.2793e-01, PNorm = 75.9952, GNorm = 1.9442, lr_0 = 3.0083e-04
Validation prc-auc = 0.576004
Validation auc = 0.738583
Epoch 16
Loss = 2.8853e-01, PNorm = 76.0468, GNorm = 0.6402, lr_0 = 2.9212e-04
Loss = 2.9041e-01, PNorm = 76.0879, GNorm = 0.9032, lr_0 = 2.8367e-04
Validation prc-auc = 0.578951
Validation auc = 0.760990
Epoch 17
Loss = 3.3750e-01, PNorm = 76.1322, GNorm = 0.8295, lr_0 = 2.7465e-04
Loss = 2.5817e-01, PNorm = 76.1716, GNorm = 0.7880, lr_0 = 2.6670e-04
Loss = 2.8202e-01, PNorm = 76.2067, GNorm = 1.2401, lr_0 = 2.5898e-04
Validation prc-auc = 0.564293
Validation auc = 0.754161
Epoch 18
Loss = 3.0150e-01, PNorm = 76.2462, GNorm = 1.0871, lr_0 = 2.5075e-04
Loss = 2.8982e-01, PNorm = 76.2845, GNorm = 1.0894, lr_0 = 2.4349e-04
Loss = 2.9298e-01, PNorm = 76.3224, GNorm = 0.8492, lr_0 = 2.3644e-04
Validation prc-auc = 0.571358
Validation auc = 0.747119
Epoch 19
Loss = 2.2927e-01, PNorm = 76.3591, GNorm = 1.3774, lr_0 = 2.2893e-04
Loss = 2.6771e-01, PNorm = 76.3918, GNorm = 0.7280, lr_0 = 2.2230e-04
Loss = 2.6382e-01, PNorm = 76.4188, GNorm = 1.0635, lr_0 = 2.1587e-04
Validation prc-auc = 0.591997
Validation auc = 0.759710
Epoch 20
Loss = 2.6348e-01, PNorm = 76.4524, GNorm = 1.2169, lr_0 = 2.0900e-04
Loss = 2.4480e-01, PNorm = 76.4844, GNorm = 0.7309, lr_0 = 2.0295e-04
Loss = 2.5619e-01, PNorm = 76.5099, GNorm = 0.6666, lr_0 = 1.9708e-04
Loss = 6.0679e-02, PNorm = 76.5126, GNorm = 0.9778, lr_0 = 1.9650e-04
Validation prc-auc = 0.613032
Validation auc = 0.790866
Epoch 21
Loss = 2.5794e-01, PNorm = 76.5452, GNorm = 0.9600, lr_0 = 1.9081e-04
Loss = 2.5330e-01, PNorm = 76.5721, GNorm = 0.9877, lr_0 = 1.8529e-04
Validation prc-auc = 0.591447
Validation auc = 0.758643
Epoch 22
Loss = 2.6337e-01, PNorm = 76.5993, GNorm = 0.9563, lr_0 = 1.7993e-04
Loss = 2.8689e-01, PNorm = 76.6239, GNorm = 0.7922, lr_0 = 1.7472e-04
Loss = 2.5340e-01, PNorm = 76.6467, GNorm = 1.5800, lr_0 = 1.6966e-04
Validation prc-auc = 0.613342
Validation auc = 0.770166
Epoch 23
Loss = 2.1906e-01, PNorm = 76.6729, GNorm = 0.8875, lr_0 = 1.6427e-04
Loss = 2.1545e-01, PNorm = 76.6979, GNorm = 1.0389, lr_0 = 1.5952e-04
Loss = 2.3771e-01, PNorm = 76.7179, GNorm = 1.1394, lr_0 = 1.5490e-04
Validation prc-auc = 0.611246
Validation auc = 0.779770
Epoch 24
Loss = 2.5261e-01, PNorm = 76.7369, GNorm = 1.0873, lr_0 = 1.4998e-04
Loss = 2.4745e-01, PNorm = 76.7586, GNorm = 0.8599, lr_0 = 1.4563e-04
Loss = 1.9750e-01, PNorm = 76.7786, GNorm = 0.9896, lr_0 = 1.4142e-04
Validation prc-auc = 0.600541
Validation auc = 0.774648
Epoch 25
Loss = 1.9861e-01, PNorm = 76.7991, GNorm = 1.1580, lr_0 = 1.3692e-04
Loss = 2.2599e-01, PNorm = 76.8109, GNorm = 0.7574, lr_0 = 1.3296e-04
Loss = 2.3639e-01, PNorm = 76.8266, GNorm = 1.0864, lr_0 = 1.2911e-04
Validation prc-auc = 0.606713
Validation auc = 0.781263
Epoch 26
Loss = 2.2161e-01, PNorm = 76.8462, GNorm = 0.8707, lr_0 = 1.2501e-04
Loss = 2.4403e-01, PNorm = 76.8604, GNorm = 2.3188, lr_0 = 1.2139e-04
Validation prc-auc = 0.604646
Validation auc = 0.782544
Epoch 27
Loss = 1.0407e-01, PNorm = 76.8810, GNorm = 0.7996, lr_0 = 1.1753e-04
Loss = 1.9761e-01, PNorm = 76.8962, GNorm = 1.1505, lr_0 = 1.1413e-04
Loss = 2.0034e-01, PNorm = 76.9094, GNorm = 1.0045, lr_0 = 1.1083e-04
Validation prc-auc = 0.606116
Validation auc = 0.768032
Epoch 28
Loss = 2.1410e-01, PNorm = 76.9235, GNorm = 1.2880, lr_0 = 1.0730e-04
Loss = 2.1180e-01, PNorm = 76.9380, GNorm = 1.6203, lr_0 = 1.0420e-04
Loss = 2.0125e-01, PNorm = 76.9511, GNorm = 0.7758, lr_0 = 1.0118e-04
Validation prc-auc = 0.583623
Validation auc = 0.768032
Epoch 29
Loss = 2.1301e-01, PNorm = 76.9629, GNorm = 1.2530, lr_0 = 1.0000e-04
Loss = 2.0047e-01, PNorm = 76.9768, GNorm = 0.8102, lr_0 = 1.0000e-04
Loss = 2.2561e-01, PNorm = 76.9868, GNorm = 0.9679, lr_0 = 1.0000e-04
Validation prc-auc = 0.593538
Validation auc = 0.779983
Model 0 best validation prc-auc = 0.613342 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.571876
Model 0 test auc = 0.834321
Ensemble test prc-auc = 0.571876
Ensemble test auc = 0.834321
Fold 5
Splitting data with seed 5
Total scaffolds = 870 | train scaffolds = 666 | val scaffolds = 118 | test scaffolds = 86
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.9615e-01, PNorm = 72.7754, GNorm = 0.9850, lr_0 = 1.0000e-03
Loss = 4.3567e-01, PNorm = 73.1851, GNorm = 0.8024, lr_0 = 1.0000e-03
Validation prc-auc = 0.441963
Validation auc = 0.748923
Epoch 1
Loss = 4.2129e-01, PNorm = 73.4278, GNorm = 0.7537, lr_0 = 1.0000e-03
Loss = 4.3008e-01, PNorm = 73.5541, GNorm = 0.6609, lr_0 = 1.0000e-03
Loss = 4.3285e-01, PNorm = 73.6457, GNorm = 1.2016, lr_0 = 1.0000e-03
Validation prc-auc = 0.545666
Validation auc = 0.786722
Epoch 2
Loss = 3.9621e-01, PNorm = 73.7322, GNorm = 0.6293, lr_0 = 9.7965e-04
Loss = 4.4741e-01, PNorm = 73.8007, GNorm = 0.6936, lr_0 = 9.5130e-04
Loss = 4.0845e-01, PNorm = 73.8652, GNorm = 0.4803, lr_0 = 9.2376e-04
Validation prc-auc = 0.526237
Validation auc = 0.792009
Epoch 3
Loss = 4.1957e-01, PNorm = 73.9359, GNorm = 0.7272, lr_0 = 8.9440e-04
Loss = 4.1476e-01, PNorm = 73.9960, GNorm = 0.7657, lr_0 = 8.6851e-04
Loss = 4.4800e-01, PNorm = 74.0644, GNorm = 1.4852, lr_0 = 8.4337e-04
Validation prc-auc = 0.551121
Validation auc = 0.794360
Epoch 4
Loss = 3.7398e-01, PNorm = 74.1437, GNorm = 1.1931, lr_0 = 8.1656e-04
Loss = 4.5195e-01, PNorm = 74.2036, GNorm = 0.6827, lr_0 = 7.9293e-04
Loss = 3.9686e-01, PNorm = 74.2635, GNorm = 0.5639, lr_0 = 7.6998e-04
Loss = 1.9092e-01, PNorm = 74.2690, GNorm = 1.1718, lr_0 = 7.6772e-04
Validation prc-auc = 0.570067
Validation auc = 0.815315
Epoch 5
Loss = 3.8355e-01, PNorm = 74.3328, GNorm = 0.5022, lr_0 = 7.4550e-04
Loss = 3.4807e-01, PNorm = 74.3887, GNorm = 0.6124, lr_0 = 7.2393e-04
Validation prc-auc = 0.565726
Validation auc = 0.797689
Epoch 6
Loss = 5.4317e-01, PNorm = 74.4416, GNorm = 2.0612, lr_0 = 7.0091e-04
Loss = 4.2658e-01, PNorm = 74.5273, GNorm = 0.6420, lr_0 = 6.8063e-04
Loss = 4.4576e-01, PNorm = 74.5906, GNorm = 0.6301, lr_0 = 6.6093e-04
Validation prc-auc = 0.536057
Validation auc = 0.804348
Epoch 7
Loss = 3.0781e-01, PNorm = 74.6759, GNorm = 0.4314, lr_0 = 6.3992e-04
Loss = 3.8656e-01, PNorm = 74.7120, GNorm = 0.6884, lr_0 = 6.2139e-04
Loss = 3.8461e-01, PNorm = 74.7654, GNorm = 0.6248, lr_0 = 6.0341e-04
Validation prc-auc = 0.574145
Validation auc = 0.823541
Epoch 8
Loss = 3.7710e-01, PNorm = 74.8081, GNorm = 0.5505, lr_0 = 5.8595e-04
Loss = 3.7612e-01, PNorm = 74.8623, GNorm = 0.5021, lr_0 = 5.6899e-04
Loss = 3.5927e-01, PNorm = 74.9162, GNorm = 0.5934, lr_0 = 5.5252e-04
Validation prc-auc = 0.554922
Validation auc = 0.817470
Epoch 9
Loss = 3.6538e-01, PNorm = 74.9858, GNorm = 0.7453, lr_0 = 5.3495e-04
Loss = 3.5566e-01, PNorm = 75.0457, GNorm = 0.7610, lr_0 = 5.1947e-04
Loss = 3.7710e-01, PNorm = 75.1000, GNorm = 0.5451, lr_0 = 5.0444e-04
Validation prc-auc = 0.581371
Validation auc = 0.835292
Epoch 10
Loss = 3.4007e-01, PNorm = 75.1593, GNorm = 0.5454, lr_0 = 4.8840e-04
Loss = 3.2366e-01, PNorm = 75.2156, GNorm = 0.5921, lr_0 = 4.7426e-04
Validation prc-auc = 0.620340
Validation auc = 0.831375
Epoch 11
Loss = 3.7313e-01, PNorm = 75.2681, GNorm = 0.6288, lr_0 = 4.5919e-04
Loss = 3.6678e-01, PNorm = 75.3236, GNorm = 0.6321, lr_0 = 4.4590e-04
Loss = 3.3364e-01, PNorm = 75.3730, GNorm = 0.6407, lr_0 = 4.3299e-04
Validation prc-auc = 0.652403
Validation auc = 0.849980
Epoch 12
Loss = 3.7231e-01, PNorm = 75.4309, GNorm = 0.5518, lr_0 = 4.1923e-04
Loss = 3.1636e-01, PNorm = 75.4913, GNorm = 0.8776, lr_0 = 4.0709e-04
Loss = 3.3636e-01, PNorm = 75.5355, GNorm = 0.6478, lr_0 = 3.9531e-04
Validation prc-auc = 0.661640
Validation auc = 0.856248
Epoch 13
Loss = 3.5110e-01, PNorm = 75.5868, GNorm = 0.7551, lr_0 = 3.8274e-04
Loss = 3.0815e-01, PNorm = 75.6372, GNorm = 0.8097, lr_0 = 3.7167e-04
Loss = 3.1033e-01, PNorm = 75.6906, GNorm = 0.7560, lr_0 = 3.6091e-04
Validation prc-auc = 0.681147
Validation auc = 0.855464
Epoch 14
Loss = 2.9142e-01, PNorm = 75.7460, GNorm = 0.8569, lr_0 = 3.4944e-04
Loss = 3.6115e-01, PNorm = 75.7870, GNorm = 1.2723, lr_0 = 3.3932e-04
Loss = 3.2705e-01, PNorm = 75.8421, GNorm = 0.6142, lr_0 = 3.2950e-04
Validation prc-auc = 0.698988
Validation auc = 0.866823
Epoch 15
Loss = 2.7046e-01, PNorm = 75.8907, GNorm = 0.7910, lr_0 = 3.1996e-04
Loss = 2.9725e-01, PNorm = 75.9400, GNorm = 0.7764, lr_0 = 3.1070e-04
Loss = 3.0875e-01, PNorm = 75.9756, GNorm = 1.0880, lr_0 = 3.0171e-04
Loss = 1.8404e-01, PNorm = 75.9793, GNorm = 1.2995, lr_0 = 3.0083e-04
Validation prc-auc = 0.683571
Validation auc = 0.863298
Epoch 16
Loss = 2.8261e-01, PNorm = 76.0264, GNorm = 0.8006, lr_0 = 2.9212e-04
Loss = 2.8918e-01, PNorm = 76.0634, GNorm = 0.8679, lr_0 = 2.8367e-04
Validation prc-auc = 0.680828
Validation auc = 0.865844
Epoch 17
Loss = 3.0206e-01, PNorm = 76.1034, GNorm = 1.0654, lr_0 = 2.7465e-04
Loss = 2.8859e-01, PNorm = 76.1426, GNorm = 0.6911, lr_0 = 2.6670e-04
Loss = 2.8736e-01, PNorm = 76.1816, GNorm = 0.8568, lr_0 = 2.5898e-04
Validation prc-auc = 0.658242
Validation auc = 0.862123
Epoch 18
Loss = 2.3342e-01, PNorm = 76.2207, GNorm = 0.9349, lr_0 = 2.5075e-04
Loss = 2.7506e-01, PNorm = 76.2564, GNorm = 0.8218, lr_0 = 2.4349e-04
Loss = 2.7270e-01, PNorm = 76.2972, GNorm = 0.8125, lr_0 = 2.3644e-04
Validation prc-auc = 0.676864
Validation auc = 0.863494
Epoch 19
Loss = 2.4596e-01, PNorm = 76.3368, GNorm = 1.0456, lr_0 = 2.2893e-04
Loss = 2.8161e-01, PNorm = 76.3741, GNorm = 1.0501, lr_0 = 2.2230e-04
Loss = 2.5785e-01, PNorm = 76.4099, GNorm = 0.6656, lr_0 = 2.1587e-04
Validation prc-auc = 0.676992
Validation auc = 0.861927
Epoch 20
Loss = 2.3033e-01, PNorm = 76.4424, GNorm = 0.8706, lr_0 = 2.0900e-04
Loss = 2.4887e-01, PNorm = 76.4721, GNorm = 1.0206, lr_0 = 2.0295e-04
Loss = 2.6663e-01, PNorm = 76.5011, GNorm = 1.1606, lr_0 = 1.9708e-04
Loss = 3.1939e-01, PNorm = 76.5049, GNorm = 3.5464, lr_0 = 1.9650e-04
Validation prc-auc = 0.681170
Validation auc = 0.865061
Epoch 21
Loss = 3.0400e-01, PNorm = 76.5306, GNorm = 1.8913, lr_0 = 1.9081e-04
Loss = 2.9874e-01, PNorm = 76.5575, GNorm = 0.9027, lr_0 = 1.8529e-04
Validation prc-auc = 0.679466
Validation auc = 0.870349
Epoch 22
Loss = 2.2388e-01, PNorm = 76.5852, GNorm = 1.1509, lr_0 = 1.7993e-04
Loss = 2.7856e-01, PNorm = 76.6060, GNorm = 1.3186, lr_0 = 1.7472e-04
Loss = 2.2914e-01, PNorm = 76.6310, GNorm = 0.8286, lr_0 = 1.6966e-04
Validation prc-auc = 0.634153
Validation auc = 0.860948
Epoch 23
Loss = 2.2162e-01, PNorm = 76.6545, GNorm = 1.0015, lr_0 = 1.6427e-04
Loss = 2.6087e-01, PNorm = 76.6729, GNorm = 1.1207, lr_0 = 1.5952e-04
Loss = 2.2466e-01, PNorm = 76.6933, GNorm = 0.9828, lr_0 = 1.5490e-04
Validation prc-auc = 0.640912
Validation auc = 0.857423
Epoch 24
Loss = 2.1276e-01, PNorm = 76.7121, GNorm = 0.9496, lr_0 = 1.4998e-04
Loss = 2.3732e-01, PNorm = 76.7324, GNorm = 0.9622, lr_0 = 1.4563e-04
Loss = 2.2987e-01, PNorm = 76.7486, GNorm = 0.9577, lr_0 = 1.4142e-04
Validation prc-auc = 0.647785
Validation auc = 0.861731
Epoch 25
Loss = 2.3404e-01, PNorm = 76.7652, GNorm = 0.7897, lr_0 = 1.3692e-04
Loss = 2.1379e-01, PNorm = 76.7828, GNorm = 1.4230, lr_0 = 1.3296e-04
Loss = 2.4318e-01, PNorm = 76.8028, GNorm = 1.1114, lr_0 = 1.2911e-04
Validation prc-auc = 0.643464
Validation auc = 0.854485
Epoch 26
Loss = 2.0483e-01, PNorm = 76.8172, GNorm = 0.8665, lr_0 = 1.2501e-04
Loss = 2.6628e-01, PNorm = 76.8327, GNorm = 1.2394, lr_0 = 1.2139e-04
Validation prc-auc = 0.640053
Validation auc = 0.859773
Epoch 27
Loss = 1.8119e-01, PNorm = 76.8496, GNorm = 0.9921, lr_0 = 1.1753e-04
Loss = 1.9169e-01, PNorm = 76.8635, GNorm = 0.7609, lr_0 = 1.1413e-04
Loss = 2.4168e-01, PNorm = 76.8745, GNorm = 1.2041, lr_0 = 1.1083e-04
Validation prc-auc = 0.621237
Validation auc = 0.847043
Epoch 28
Loss = 2.0060e-01, PNorm = 76.8892, GNorm = 0.8772, lr_0 = 1.0730e-04
Loss = 2.1978e-01, PNorm = 76.9013, GNorm = 1.4054, lr_0 = 1.0420e-04
Loss = 2.0050e-01, PNorm = 76.9132, GNorm = 1.1687, lr_0 = 1.0118e-04
Validation prc-auc = 0.620859
Validation auc = 0.842342
Epoch 29
Loss = 2.6905e-01, PNorm = 76.9248, GNorm = 1.1851, lr_0 = 1.0000e-04
Loss = 1.9841e-01, PNorm = 76.9369, GNorm = 1.4715, lr_0 = 1.0000e-04
Loss = 2.0387e-01, PNorm = 76.9495, GNorm = 1.8892, lr_0 = 1.0000e-04
Validation prc-auc = 0.625937
Validation auc = 0.837838
Model 0 best validation prc-auc = 0.698988 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.508171
Model 0 test auc = 0.766351
Ensemble test prc-auc = 0.508171
Ensemble test auc = 0.766351
Fold 6
Splitting data with seed 6
Total scaffolds = 870 | train scaffolds = 641 | val scaffolds = 110 | test scaffolds = 119
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.8000e-01, PNorm = 72.7525, GNorm = 0.5662, lr_0 = 1.0000e-03
Loss = 4.3439e-01, PNorm = 73.1466, GNorm = 0.6974, lr_0 = 1.0000e-03
Validation prc-auc = 0.252145
Validation auc = 0.663678
Epoch 1
Loss = 5.3021e-01, PNorm = 73.3799, GNorm = 1.5162, lr_0 = 1.0000e-03
Loss = 4.3620e-01, PNorm = 73.5027, GNorm = 0.7876, lr_0 = 1.0000e-03
Loss = 4.5147e-01, PNorm = 73.5828, GNorm = 0.6159, lr_0 = 1.0000e-03
Validation prc-auc = 0.290532
Validation auc = 0.700460
Epoch 2
Loss = 4.2667e-01, PNorm = 73.6558, GNorm = 0.8200, lr_0 = 9.7965e-04
Loss = 4.4222e-01, PNorm = 73.7122, GNorm = 0.6041, lr_0 = 9.5130e-04
Loss = 4.1475e-01, PNorm = 73.7667, GNorm = 0.6212, lr_0 = 9.2376e-04
Validation prc-auc = 0.320591
Validation auc = 0.715402
Epoch 3
Loss = 4.2089e-01, PNorm = 73.8304, GNorm = 0.7749, lr_0 = 8.9440e-04
Loss = 3.9681e-01, PNorm = 73.8927, GNorm = 0.5131, lr_0 = 8.6851e-04
Loss = 4.0943e-01, PNorm = 73.9563, GNorm = 0.5798, lr_0 = 8.4337e-04
Validation prc-auc = 0.313854
Validation auc = 0.728506
Epoch 4
Loss = 3.9391e-01, PNorm = 74.0217, GNorm = 0.7675, lr_0 = 8.1656e-04
Loss = 3.7679e-01, PNorm = 74.0848, GNorm = 0.7381, lr_0 = 7.9293e-04
Loss = 3.8665e-01, PNorm = 74.1454, GNorm = 0.6455, lr_0 = 7.6998e-04
Loss = 2.9596e-01, PNorm = 74.1527, GNorm = 1.5461, lr_0 = 7.6772e-04
Validation prc-auc = 0.326829
Validation auc = 0.740690
Epoch 5
Loss = 3.6246e-01, PNorm = 74.2267, GNorm = 1.4927, lr_0 = 7.4550e-04
Loss = 3.8166e-01, PNorm = 74.2950, GNorm = 0.7116, lr_0 = 7.2393e-04
Validation prc-auc = 0.310269
Validation auc = 0.714713
Epoch 6
Loss = 4.1171e-01, PNorm = 74.3656, GNorm = 1.1231, lr_0 = 7.0091e-04
Loss = 3.8910e-01, PNorm = 74.4326, GNorm = 0.8786, lr_0 = 6.8063e-04
Loss = 3.8624e-01, PNorm = 74.5016, GNorm = 1.2773, lr_0 = 6.6093e-04
Validation prc-auc = 0.326302
Validation auc = 0.728966
Epoch 7
Loss = 4.3825e-01, PNorm = 74.5587, GNorm = 0.9052, lr_0 = 6.3992e-04
Loss = 3.6184e-01, PNorm = 74.6055, GNorm = 0.8611, lr_0 = 6.2139e-04
Loss = 3.8014e-01, PNorm = 74.6708, GNorm = 1.1124, lr_0 = 6.0341e-04
Validation prc-auc = 0.364917
Validation auc = 0.745747
Epoch 8
Loss = 2.9879e-01, PNorm = 74.7297, GNorm = 0.4705, lr_0 = 5.8595e-04
Loss = 3.9368e-01, PNorm = 74.7806, GNorm = 0.6602, lr_0 = 5.6899e-04
Loss = 3.5378e-01, PNorm = 74.8357, GNorm = 0.6353, lr_0 = 5.5252e-04
Validation prc-auc = 0.396463
Validation auc = 0.760690
Epoch 9
Loss = 3.0628e-01, PNorm = 74.9061, GNorm = 0.6438, lr_0 = 5.3495e-04
Loss = 3.3516e-01, PNorm = 74.9637, GNorm = 0.8724, lr_0 = 5.1947e-04
Loss = 3.8447e-01, PNorm = 75.0233, GNorm = 0.8376, lr_0 = 5.0444e-04
Validation prc-auc = 0.361997
Validation auc = 0.753563
Epoch 10
Loss = 3.0658e-01, PNorm = 75.0961, GNorm = 0.7207, lr_0 = 4.8840e-04
Loss = 3.5869e-01, PNorm = 75.1509, GNorm = 0.8013, lr_0 = 4.7426e-04
Validation prc-auc = 0.345775
Validation auc = 0.708276
Epoch 11
Loss = 2.1987e-01, PNorm = 75.2210, GNorm = 0.5709, lr_0 = 4.5919e-04
Loss = 2.9336e-01, PNorm = 75.2806, GNorm = 0.5850, lr_0 = 4.4590e-04
Loss = 3.5989e-01, PNorm = 75.3339, GNorm = 1.3438, lr_0 = 4.3299e-04
Validation prc-auc = 0.399343
Validation auc = 0.750345
Epoch 12
Loss = 2.6352e-01, PNorm = 75.3897, GNorm = 1.2731, lr_0 = 4.1923e-04
Loss = 3.0901e-01, PNorm = 75.4545, GNorm = 0.8547, lr_0 = 4.0709e-04
Loss = 3.6144e-01, PNorm = 75.5137, GNorm = 0.7917, lr_0 = 3.9531e-04
Validation prc-auc = 0.398619
Validation auc = 0.767126
Epoch 13
Loss = 3.0889e-01, PNorm = 75.5648, GNorm = 0.7932, lr_0 = 3.8274e-04
Loss = 3.0925e-01, PNorm = 75.6124, GNorm = 0.8435, lr_0 = 3.7167e-04
Loss = 3.3119e-01, PNorm = 75.6685, GNorm = 1.5997, lr_0 = 3.6091e-04
Validation prc-auc = 0.412585
Validation auc = 0.768736
Epoch 14
Loss = 3.0846e-01, PNorm = 75.7248, GNorm = 0.9074, lr_0 = 3.4944e-04
Loss = 2.9738e-01, PNorm = 75.7779, GNorm = 0.9513, lr_0 = 3.3932e-04
Loss = 3.1867e-01, PNorm = 75.8192, GNorm = 1.1151, lr_0 = 3.2950e-04
Validation prc-auc = 0.374503
Validation auc = 0.745517
Epoch 15
Loss = 3.0093e-01, PNorm = 75.8700, GNorm = 0.8669, lr_0 = 3.1996e-04
Loss = 2.9015e-01, PNorm = 75.9227, GNorm = 0.8748, lr_0 = 3.1070e-04
Loss = 3.1183e-01, PNorm = 75.9544, GNorm = 1.3861, lr_0 = 3.0171e-04
Loss = 1.7390e-01, PNorm = 75.9587, GNorm = 1.9172, lr_0 = 3.0083e-04
Validation prc-auc = 0.460826
Validation auc = 0.782069
Epoch 16
Loss = 2.7832e-01, PNorm = 76.0037, GNorm = 0.6317, lr_0 = 2.9212e-04
Loss = 3.0232e-01, PNorm = 76.0360, GNorm = 0.8923, lr_0 = 2.8367e-04
Validation prc-auc = 0.435549
Validation auc = 0.773333
Epoch 17
Loss = 2.6622e-01, PNorm = 76.0814, GNorm = 0.8311, lr_0 = 2.7465e-04
Loss = 3.0065e-01, PNorm = 76.1219, GNorm = 1.1600, lr_0 = 2.6670e-04
Loss = 2.6678e-01, PNorm = 76.1554, GNorm = 0.6834, lr_0 = 2.5898e-04
Validation prc-auc = 0.436277
Validation auc = 0.776322
Epoch 18
Loss = 2.8114e-01, PNorm = 76.1957, GNorm = 1.7667, lr_0 = 2.5075e-04
Loss = 2.6900e-01, PNorm = 76.2269, GNorm = 1.5347, lr_0 = 2.4349e-04
Loss = 2.9705e-01, PNorm = 76.2637, GNorm = 0.9633, lr_0 = 2.3644e-04
Validation prc-auc = 0.450193
Validation auc = 0.795172
Epoch 19
Loss = 2.6976e-01, PNorm = 76.2994, GNorm = 1.1494, lr_0 = 2.2893e-04
Loss = 2.9790e-01, PNorm = 76.3334, GNorm = 1.0228, lr_0 = 2.2230e-04
Loss = 1.9447e-01, PNorm = 76.3662, GNorm = 0.9520, lr_0 = 2.1587e-04
Validation prc-auc = 0.462349
Validation auc = 0.784828
Epoch 20
Loss = 2.5807e-01, PNorm = 76.4039, GNorm = 0.9737, lr_0 = 2.0900e-04
Loss = 2.8821e-01, PNorm = 76.4376, GNorm = 1.2505, lr_0 = 2.0295e-04
Loss = 2.3575e-01, PNorm = 76.4683, GNorm = 0.5971, lr_0 = 1.9708e-04
Loss = 8.1994e-02, PNorm = 76.4716, GNorm = 1.3980, lr_0 = 1.9650e-04
Validation prc-auc = 0.427305
Validation auc = 0.765057
Epoch 21
Loss = 2.5879e-01, PNorm = 76.4951, GNorm = 1.2306, lr_0 = 1.9081e-04
Loss = 2.4827e-01, PNorm = 76.5240, GNorm = 0.7189, lr_0 = 1.8529e-04
Validation prc-auc = 0.483490
Validation auc = 0.765287
Epoch 22
Loss = 2.2345e-01, PNorm = 76.5442, GNorm = 1.0270, lr_0 = 1.7993e-04
Loss = 2.3969e-01, PNorm = 76.5733, GNorm = 1.1486, lr_0 = 1.7472e-04
Loss = 2.3545e-01, PNorm = 76.5955, GNorm = 0.8862, lr_0 = 1.6966e-04
Validation prc-auc = 0.472690
Validation auc = 0.772414
Epoch 23
Loss = 2.3182e-01, PNorm = 76.6184, GNorm = 0.8921, lr_0 = 1.6427e-04
Loss = 2.0222e-01, PNorm = 76.6407, GNorm = 1.0956, lr_0 = 1.5952e-04
Loss = 2.4738e-01, PNorm = 76.6628, GNorm = 1.2734, lr_0 = 1.5490e-04
Validation prc-auc = 0.494641
Validation auc = 0.781839
Epoch 24
Loss = 2.2655e-01, PNorm = 76.6873, GNorm = 0.8631, lr_0 = 1.4998e-04
Loss = 2.0898e-01, PNorm = 76.7040, GNorm = 1.3873, lr_0 = 1.4563e-04
Loss = 2.5267e-01, PNorm = 76.7247, GNorm = 1.2004, lr_0 = 1.4142e-04
Validation prc-auc = 0.509170
Validation auc = 0.779310
Epoch 25
Loss = 2.6155e-01, PNorm = 76.7493, GNorm = 1.1920, lr_0 = 1.3692e-04
Loss = 2.3907e-01, PNorm = 76.7687, GNorm = 1.5226, lr_0 = 1.3296e-04
Loss = 2.0066e-01, PNorm = 76.7841, GNorm = 0.8898, lr_0 = 1.2911e-04
Validation prc-auc = 0.529264
Validation auc = 0.785747
Epoch 26
Loss = 1.9262e-01, PNorm = 76.8042, GNorm = 0.9141, lr_0 = 1.2501e-04
Loss = 2.1967e-01, PNorm = 76.8200, GNorm = 0.9404, lr_0 = 1.2139e-04
Validation prc-auc = 0.538778
Validation auc = 0.777471
Epoch 27
Loss = 1.0447e-01, PNorm = 76.8341, GNorm = 0.6352, lr_0 = 1.1753e-04
Loss = 1.9892e-01, PNorm = 76.8507, GNorm = 0.9027, lr_0 = 1.1413e-04
Loss = 2.0044e-01, PNorm = 76.8661, GNorm = 1.3810, lr_0 = 1.1083e-04
Validation prc-auc = 0.521721
Validation auc = 0.790115
Epoch 28
Loss = 2.3839e-01, PNorm = 76.8788, GNorm = 1.2895, lr_0 = 1.0730e-04
Loss = 1.8192e-01, PNorm = 76.8918, GNorm = 0.9458, lr_0 = 1.0420e-04
Loss = 2.1799e-01, PNorm = 76.9011, GNorm = 1.1733, lr_0 = 1.0118e-04
Validation prc-auc = 0.533508
Validation auc = 0.785517
Epoch 29
Loss = 1.6416e-01, PNorm = 76.9148, GNorm = 1.1696, lr_0 = 1.0000e-04
Loss = 2.4237e-01, PNorm = 76.9244, GNorm = 0.8866, lr_0 = 1.0000e-04
Loss = 1.8360e-01, PNorm = 76.9381, GNorm = 0.8322, lr_0 = 1.0000e-04
Validation prc-auc = 0.507164
Validation auc = 0.783448
Model 0 best validation prc-auc = 0.538778 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.672879
Model 0 test auc = 0.828571
Ensemble test prc-auc = 0.672879
Ensemble test auc = 0.828571
Fold 7
Splitting data with seed 7
Total scaffolds = 870 | train scaffolds = 632 | val scaffolds = 111 | test scaffolds = 127
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.8761e-01, PNorm = 72.7712, GNorm = 0.8213, lr_0 = 1.0000e-03
Loss = 4.6735e-01, PNorm = 73.1742, GNorm = 0.7561, lr_0 = 1.0000e-03
Validation prc-auc = 0.428762
Validation auc = 0.731900
Epoch 1
Loss = 3.5528e-01, PNorm = 73.4231, GNorm = 0.7465, lr_0 = 1.0000e-03
Loss = 4.6431e-01, PNorm = 73.5408, GNorm = 0.9565, lr_0 = 1.0000e-03
Loss = 4.6210e-01, PNorm = 73.6143, GNorm = 0.6157, lr_0 = 1.0000e-03
Validation prc-auc = 0.463787
Validation auc = 0.744721
Epoch 2
Loss = 4.3490e-01, PNorm = 73.6815, GNorm = 0.6971, lr_0 = 9.7965e-04
Loss = 4.1268e-01, PNorm = 73.7277, GNorm = 0.4772, lr_0 = 9.5130e-04
Loss = 4.0380e-01, PNorm = 73.7853, GNorm = 0.5283, lr_0 = 9.2376e-04
Validation prc-auc = 0.501823
Validation auc = 0.757730
Epoch 3
Loss = 3.7809e-01, PNorm = 73.8410, GNorm = 0.5233, lr_0 = 8.9440e-04
Loss = 4.1093e-01, PNorm = 73.8986, GNorm = 0.6047, lr_0 = 8.6851e-04
Loss = 3.9622e-01, PNorm = 73.9596, GNorm = 0.5288, lr_0 = 8.4337e-04
Validation prc-auc = 0.490811
Validation auc = 0.750000
Epoch 4
Loss = 3.6727e-01, PNorm = 74.0235, GNorm = 0.6572, lr_0 = 8.1656e-04
Loss = 3.8707e-01, PNorm = 74.0786, GNorm = 0.5517, lr_0 = 7.9293e-04
Loss = 4.1393e-01, PNorm = 74.1449, GNorm = 0.6752, lr_0 = 7.6998e-04
Loss = 4.5648e-01, PNorm = 74.1520, GNorm = 2.4178, lr_0 = 7.6772e-04
Validation prc-auc = 0.491667
Validation auc = 0.758296
Epoch 5
Loss = 3.8475e-01, PNorm = 74.2304, GNorm = 0.7769, lr_0 = 7.4550e-04
Loss = 4.1063e-01, PNorm = 74.2992, GNorm = 0.7994, lr_0 = 7.2393e-04
Validation prc-auc = 0.496038
Validation auc = 0.740762
Epoch 6
Loss = 3.6307e-01, PNorm = 74.3774, GNorm = 0.5373, lr_0 = 7.0091e-04
Loss = 4.1307e-01, PNorm = 74.4343, GNorm = 0.5109, lr_0 = 6.8063e-04
Loss = 3.4573e-01, PNorm = 74.4975, GNorm = 0.6519, lr_0 = 6.6093e-04
Validation prc-auc = 0.506209
Validation auc = 0.750189
Epoch 7
Loss = 3.8404e-01, PNorm = 74.5654, GNorm = 1.1659, lr_0 = 6.3992e-04
Loss = 3.4265e-01, PNorm = 74.6264, GNorm = 0.7103, lr_0 = 6.2139e-04
Loss = 3.7640e-01, PNorm = 74.6873, GNorm = 1.0757, lr_0 = 6.0341e-04
Validation prc-auc = 0.494063
Validation auc = 0.748869
Epoch 8
Loss = 4.0226e-01, PNorm = 74.7501, GNorm = 0.6189, lr_0 = 5.8595e-04
Loss = 3.7792e-01, PNorm = 74.8187, GNorm = 0.5678, lr_0 = 5.6899e-04
Loss = 3.3128e-01, PNorm = 74.8876, GNorm = 0.7598, lr_0 = 5.5252e-04
Validation prc-auc = 0.505463
Validation auc = 0.746041
Epoch 9
Loss = 3.5409e-01, PNorm = 74.9682, GNorm = 0.9853, lr_0 = 5.3495e-04
Loss = 2.8985e-01, PNorm = 75.0311, GNorm = 0.6704, lr_0 = 5.1947e-04
Loss = 3.7628e-01, PNorm = 75.0919, GNorm = 0.8353, lr_0 = 5.0444e-04
Validation prc-auc = 0.506438
Validation auc = 0.742081
Epoch 10
Loss = 3.1005e-01, PNorm = 75.1600, GNorm = 0.6683, lr_0 = 4.8840e-04
Loss = 3.2538e-01, PNorm = 75.2198, GNorm = 1.0467, lr_0 = 4.7426e-04
Validation prc-auc = 0.514541
Validation auc = 0.737179
Epoch 11
Loss = 2.5580e-01, PNorm = 75.2869, GNorm = 0.7509, lr_0 = 4.5919e-04
Loss = 3.3462e-01, PNorm = 75.3525, GNorm = 0.9030, lr_0 = 4.4590e-04
Loss = 3.1689e-01, PNorm = 75.4138, GNorm = 0.5563, lr_0 = 4.3299e-04
Validation prc-auc = 0.500352
Validation auc = 0.733974
Epoch 12
Loss = 3.4931e-01, PNorm = 75.4748, GNorm = 0.9003, lr_0 = 4.1923e-04
Loss = 3.0551e-01, PNorm = 75.5381, GNorm = 0.6727, lr_0 = 4.0709e-04
Loss = 3.3299e-01, PNorm = 75.5957, GNorm = 0.9204, lr_0 = 3.9531e-04
Validation prc-auc = 0.514986
Validation auc = 0.743213
Epoch 13
Loss = 2.7047e-01, PNorm = 75.6610, GNorm = 0.6592, lr_0 = 3.8274e-04
Loss = 3.1735e-01, PNorm = 75.7173, GNorm = 0.8511, lr_0 = 3.7167e-04
Loss = 2.8778e-01, PNorm = 75.7705, GNorm = 0.8031, lr_0 = 3.6091e-04
Validation prc-auc = 0.512850
Validation auc = 0.747926
Epoch 14
Loss = 3.2402e-01, PNorm = 75.8268, GNorm = 1.1357, lr_0 = 3.4944e-04
Loss = 2.4702e-01, PNorm = 75.8783, GNorm = 0.8395, lr_0 = 3.3932e-04
Loss = 3.3970e-01, PNorm = 75.9213, GNorm = 0.7708, lr_0 = 3.2950e-04
Validation prc-auc = 0.512861
Validation auc = 0.733409
Epoch 15
Loss = 2.8442e-01, PNorm = 75.9700, GNorm = 0.8220, lr_0 = 3.1996e-04
Loss = 2.8820e-01, PNorm = 76.0200, GNorm = 1.0335, lr_0 = 3.1070e-04
Loss = 3.0397e-01, PNorm = 76.0528, GNorm = 0.9523, lr_0 = 3.0171e-04
Loss = 1.4783e-01, PNorm = 76.0556, GNorm = 1.6344, lr_0 = 3.0083e-04
Validation prc-auc = 0.517621
Validation auc = 0.737745
Epoch 16
Loss = 2.3069e-01, PNorm = 76.0957, GNorm = 0.6659, lr_0 = 2.9212e-04
Loss = 2.9085e-01, PNorm = 76.1359, GNorm = 0.8605, lr_0 = 2.8367e-04
Validation prc-auc = 0.540662
Validation auc = 0.720588
Epoch 17
Loss = 2.6157e-01, PNorm = 76.1846, GNorm = 0.7673, lr_0 = 2.7465e-04
Loss = 3.1476e-01, PNorm = 76.2218, GNorm = 0.6900, lr_0 = 2.6670e-04
Loss = 2.3003e-01, PNorm = 76.2656, GNorm = 0.8475, lr_0 = 2.5898e-04
Validation prc-auc = 0.532613
Validation auc = 0.738499
Epoch 18
Loss = 2.8710e-01, PNorm = 76.3066, GNorm = 1.1270, lr_0 = 2.5075e-04
Loss = 2.6061e-01, PNorm = 76.3415, GNorm = 0.8931, lr_0 = 2.4349e-04
Loss = 2.4857e-01, PNorm = 76.3759, GNorm = 0.7327, lr_0 = 2.3644e-04
Validation prc-auc = 0.546833
Validation auc = 0.742270
Epoch 19
Loss = 2.7484e-01, PNorm = 76.4060, GNorm = 0.7816, lr_0 = 2.2893e-04
Loss = 2.4608e-01, PNorm = 76.4403, GNorm = 1.1064, lr_0 = 2.2230e-04
Loss = 2.4082e-01, PNorm = 76.4765, GNorm = 0.8314, lr_0 = 2.1587e-04
Validation prc-auc = 0.547777
Validation auc = 0.744721
Epoch 20
Loss = 2.4379e-01, PNorm = 76.5169, GNorm = 0.6705, lr_0 = 2.0900e-04
Loss = 2.7407e-01, PNorm = 76.5480, GNorm = 1.2467, lr_0 = 2.0295e-04
Loss = 2.1344e-01, PNorm = 76.5812, GNorm = 0.8160, lr_0 = 1.9708e-04
Loss = 5.2887e-01, PNorm = 76.5837, GNorm = 3.9806, lr_0 = 1.9650e-04
Validation prc-auc = 0.551743
Validation auc = 0.729638
Epoch 21
Loss = 2.5413e-01, PNorm = 76.6063, GNorm = 0.8548, lr_0 = 1.9081e-04
Loss = 2.1057e-01, PNorm = 76.6372, GNorm = 0.8442, lr_0 = 1.8529e-04
Validation prc-auc = 0.550974
Validation auc = 0.736802
Epoch 22
Loss = 1.4567e-01, PNorm = 76.6600, GNorm = 0.7811, lr_0 = 1.7993e-04
Loss = 2.4391e-01, PNorm = 76.6803, GNorm = 0.5995, lr_0 = 1.7472e-04
Loss = 2.4803e-01, PNorm = 76.6991, GNorm = 0.9399, lr_0 = 1.6966e-04
Validation prc-auc = 0.574322
Validation auc = 0.742836
Epoch 23
Loss = 1.3987e-01, PNorm = 76.7250, GNorm = 1.2145, lr_0 = 1.6427e-04
Loss = 2.1919e-01, PNorm = 76.7440, GNorm = 1.0069, lr_0 = 1.5952e-04
Loss = 2.2269e-01, PNorm = 76.7703, GNorm = 2.2067, lr_0 = 1.5490e-04
Validation prc-auc = 0.552453
Validation auc = 0.739630
Epoch 24
Loss = 2.1028e-01, PNorm = 76.7925, GNorm = 0.7281, lr_0 = 1.4998e-04
Loss = 1.8538e-01, PNorm = 76.8119, GNorm = 0.8432, lr_0 = 1.4563e-04
Loss = 2.4270e-01, PNorm = 76.8279, GNorm = 1.1171, lr_0 = 1.4142e-04
Validation prc-auc = 0.544495
Validation auc = 0.736048
Epoch 25
Loss = 2.1026e-01, PNorm = 76.8535, GNorm = 0.8670, lr_0 = 1.3692e-04
Loss = 1.9176e-01, PNorm = 76.8740, GNorm = 2.7172, lr_0 = 1.3296e-04
Loss = 2.1505e-01, PNorm = 76.8876, GNorm = 1.2132, lr_0 = 1.2911e-04
Validation prc-auc = 0.539293
Validation auc = 0.730958
Epoch 26
Loss = 1.6786e-01, PNorm = 76.9065, GNorm = 0.7624, lr_0 = 1.2501e-04
Loss = 1.9660e-01, PNorm = 76.9197, GNorm = 1.1523, lr_0 = 1.2139e-04
Validation prc-auc = 0.546768
Validation auc = 0.733974
Epoch 27
Loss = 2.4432e-01, PNorm = 76.9333, GNorm = 1.4627, lr_0 = 1.1753e-04
Loss = 1.8333e-01, PNorm = 76.9496, GNorm = 0.9090, lr_0 = 1.1413e-04
Loss = 2.0937e-01, PNorm = 76.9635, GNorm = 2.0321, lr_0 = 1.1083e-04
Validation prc-auc = 0.530433
Validation auc = 0.730581
Epoch 28
Loss = 2.2955e-01, PNorm = 76.9778, GNorm = 1.3553, lr_0 = 1.0730e-04
Loss = 1.9917e-01, PNorm = 76.9892, GNorm = 0.7604, lr_0 = 1.0420e-04
Loss = 1.8529e-01, PNorm = 77.0020, GNorm = 1.3044, lr_0 = 1.0118e-04
Validation prc-auc = 0.541775
Validation auc = 0.728695
Epoch 29
Loss = 1.5667e-01, PNorm = 77.0147, GNorm = 1.3516, lr_0 = 1.0000e-04
Loss = 1.9940e-01, PNorm = 77.0269, GNorm = 1.1162, lr_0 = 1.0000e-04
Loss = 1.9598e-01, PNorm = 77.0385, GNorm = 1.7194, lr_0 = 1.0000e-04
Validation prc-auc = 0.537433
Validation auc = 0.733974
Model 0 best validation prc-auc = 0.574322 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.637621
Model 0 test auc = 0.815693
Ensemble test prc-auc = 0.637621
Ensemble test auc = 0.815693
Fold 8
Splitting data with seed 8
Total scaffolds = 870 | train scaffolds = 657 | val scaffolds = 103 | test scaffolds = 110
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.3681e-01, PNorm = 72.7702, GNorm = 0.9981, lr_0 = 1.0000e-03
Loss = 4.6492e-01, PNorm = 73.1758, GNorm = 0.5861, lr_0 = 1.0000e-03
Validation prc-auc = 0.502176
Validation auc = 0.692441
Epoch 1
Loss = 4.0061e-01, PNorm = 73.4195, GNorm = 0.7599, lr_0 = 1.0000e-03
Loss = 4.0465e-01, PNorm = 73.5481, GNorm = 0.6466, lr_0 = 1.0000e-03
Loss = 4.1504e-01, PNorm = 73.6358, GNorm = 0.5562, lr_0 = 1.0000e-03
Validation prc-auc = 0.562128
Validation auc = 0.758697
Epoch 2
Loss = 4.3871e-01, PNorm = 73.7129, GNorm = 0.4986, lr_0 = 9.7965e-04
Loss = 4.1550e-01, PNorm = 73.7803, GNorm = 0.8047, lr_0 = 9.5130e-04
Loss = 3.8357e-01, PNorm = 73.8471, GNorm = 0.5456, lr_0 = 9.2376e-04
Validation prc-auc = 0.611394
Validation auc = 0.776407
Epoch 3
Loss = 3.5292e-01, PNorm = 73.9172, GNorm = 0.4184, lr_0 = 8.9440e-04
Loss = 4.5102e-01, PNorm = 73.9660, GNorm = 0.6080, lr_0 = 8.6851e-04
Loss = 4.1990e-01, PNorm = 74.0280, GNorm = 0.6695, lr_0 = 8.4337e-04
Validation prc-auc = 0.615384
Validation auc = 0.782416
Epoch 4
Loss = 3.8595e-01, PNorm = 74.0865, GNorm = 0.5007, lr_0 = 8.1656e-04
Loss = 4.0985e-01, PNorm = 74.1323, GNorm = 0.9453, lr_0 = 7.9293e-04
Loss = 4.1738e-01, PNorm = 74.1871, GNorm = 1.1850, lr_0 = 7.6998e-04
Loss = 2.3347e-01, PNorm = 74.1905, GNorm = 1.0505, lr_0 = 7.6772e-04
Validation prc-auc = 0.633095
Validation auc = 0.808824
Epoch 5
Loss = 3.8771e-01, PNorm = 74.2449, GNorm = 0.5042, lr_0 = 7.4550e-04
Loss = 3.7349e-01, PNorm = 74.3006, GNorm = 0.6518, lr_0 = 7.2393e-04
Validation prc-auc = 0.639919
Validation auc = 0.823213
Epoch 6
Loss = 3.7207e-01, PNorm = 74.3572, GNorm = 0.9426, lr_0 = 7.0091e-04
Loss = 3.5675e-01, PNorm = 74.4130, GNorm = 0.5481, lr_0 = 6.8063e-04
Loss = 4.0276e-01, PNorm = 74.4756, GNorm = 0.8532, lr_0 = 6.6093e-04
Validation prc-auc = 0.677813
Validation auc = 0.819734
Epoch 7
Loss = 4.1588e-01, PNorm = 74.5346, GNorm = 0.6277, lr_0 = 6.3992e-04
Loss = 3.9546e-01, PNorm = 74.6150, GNorm = 0.4782, lr_0 = 6.2139e-04
Loss = 3.5884e-01, PNorm = 74.6836, GNorm = 0.5471, lr_0 = 6.0341e-04
Validation prc-auc = 0.668462
Validation auc = 0.828590
Epoch 8
Loss = 4.1563e-01, PNorm = 74.7504, GNorm = 0.6361, lr_0 = 5.8595e-04
Loss = 3.5163e-01, PNorm = 74.8205, GNorm = 0.5458, lr_0 = 5.6899e-04
Loss = 3.7653e-01, PNorm = 74.8741, GNorm = 0.8755, lr_0 = 5.5252e-04
Validation prc-auc = 0.723589
Validation auc = 0.840923
Epoch 9
Loss = 3.5043e-01, PNorm = 74.9519, GNorm = 0.6953, lr_0 = 5.3495e-04
Loss = 3.9335e-01, PNorm = 74.9971, GNorm = 0.6716, lr_0 = 5.1947e-04
Loss = 3.2981e-01, PNorm = 75.0677, GNorm = 0.4904, lr_0 = 5.0444e-04
Validation prc-auc = 0.697274
Validation auc = 0.834915
Epoch 10
Loss = 3.5960e-01, PNorm = 75.1275, GNorm = 0.5681, lr_0 = 4.8840e-04
Loss = 3.5070e-01, PNorm = 75.1907, GNorm = 0.6611, lr_0 = 4.7426e-04
Validation prc-auc = 0.717573
Validation auc = 0.839026
Epoch 11
Loss = 1.6079e-01, PNorm = 75.2504, GNorm = 0.7783, lr_0 = 4.5919e-04
Loss = 3.1538e-01, PNorm = 75.3215, GNorm = 0.5777, lr_0 = 4.4590e-04
Loss = 3.7566e-01, PNorm = 75.3912, GNorm = 0.5053, lr_0 = 4.3299e-04
Validation prc-auc = 0.718512
Validation auc = 0.846932
Epoch 12
Loss = 2.2334e-01, PNorm = 75.4551, GNorm = 0.5318, lr_0 = 4.1923e-04
Loss = 3.1269e-01, PNorm = 75.4952, GNorm = 0.6083, lr_0 = 4.0709e-04
Loss = 3.5104e-01, PNorm = 75.5377, GNorm = 0.6933, lr_0 = 3.9531e-04
Validation prc-auc = 0.714555
Validation auc = 0.838393
Epoch 13
Loss = 3.1942e-01, PNorm = 75.5884, GNorm = 0.6681, lr_0 = 3.8274e-04
Loss = 3.1006e-01, PNorm = 75.6405, GNorm = 0.9020, lr_0 = 3.7167e-04
Loss = 3.2804e-01, PNorm = 75.6879, GNorm = 0.5614, lr_0 = 3.6091e-04
Validation prc-auc = 0.730330
Validation auc = 0.854522
Epoch 14
Loss = 2.9657e-01, PNorm = 75.7472, GNorm = 0.7356, lr_0 = 3.4944e-04
Loss = 2.9544e-01, PNorm = 75.8034, GNorm = 1.0196, lr_0 = 3.3932e-04
Loss = 3.1583e-01, PNorm = 75.8414, GNorm = 1.0457, lr_0 = 3.2950e-04
Validation prc-auc = 0.743549
Validation auc = 0.852309
Epoch 15
Loss = 2.9004e-01, PNorm = 75.8934, GNorm = 0.8403, lr_0 = 3.1996e-04
Loss = 3.2784e-01, PNorm = 75.9440, GNorm = 0.9532, lr_0 = 3.1070e-04
Loss = 2.9890e-01, PNorm = 75.9923, GNorm = 0.8744, lr_0 = 3.0171e-04
Loss = 4.1927e-01, PNorm = 75.9980, GNorm = 1.8418, lr_0 = 3.0083e-04
Validation prc-auc = 0.728635
Validation auc = 0.842979
Epoch 16
Loss = 2.6978e-01, PNorm = 76.0506, GNorm = 0.7919, lr_0 = 2.9212e-04
Loss = 2.9792e-01, PNorm = 76.0859, GNorm = 0.8289, lr_0 = 2.8367e-04
Validation prc-auc = 0.729767
Validation auc = 0.844560
Epoch 17
Loss = 2.5845e-01, PNorm = 76.1343, GNorm = 1.1781, lr_0 = 2.7465e-04
Loss = 3.0406e-01, PNorm = 76.1778, GNorm = 0.8189, lr_0 = 2.6670e-04
Loss = 2.7239e-01, PNorm = 76.2197, GNorm = 1.7322, lr_0 = 2.5898e-04
Validation prc-auc = 0.726427
Validation auc = 0.848039
Epoch 18
Loss = 3.1523e-01, PNorm = 76.2517, GNorm = 0.7123, lr_0 = 2.5075e-04
Loss = 2.7153e-01, PNorm = 76.2905, GNorm = 0.5388, lr_0 = 2.4349e-04
Loss = 2.6431e-01, PNorm = 76.3262, GNorm = 1.1355, lr_0 = 2.3644e-04
Validation prc-auc = 0.751064
Validation auc = 0.859899
Epoch 19
Loss = 2.9216e-01, PNorm = 76.3597, GNorm = 1.1361, lr_0 = 2.2893e-04
Loss = 2.5346e-01, PNorm = 76.3935, GNorm = 0.8860, lr_0 = 2.2230e-04
Loss = 2.6824e-01, PNorm = 76.4256, GNorm = 1.1634, lr_0 = 2.1587e-04
Validation prc-auc = 0.754555
Validation auc = 0.864801
Epoch 20
Loss = 2.7028e-01, PNorm = 76.4593, GNorm = 0.7051, lr_0 = 2.0900e-04
Loss = 2.9830e-01, PNorm = 76.4897, GNorm = 1.2045, lr_0 = 2.0295e-04
Loss = 2.7002e-01, PNorm = 76.5211, GNorm = 1.3867, lr_0 = 1.9708e-04
Loss = 8.0273e-02, PNorm = 76.5244, GNorm = 1.4476, lr_0 = 1.9650e-04
Validation prc-auc = 0.747676
Validation auc = 0.859266
Epoch 21
Loss = 2.6271e-01, PNorm = 76.5523, GNorm = 1.6262, lr_0 = 1.9081e-04
Loss = 2.4468e-01, PNorm = 76.5728, GNorm = 1.0895, lr_0 = 1.8529e-04
Validation prc-auc = 0.737287
Validation auc = 0.852309
Epoch 22
Loss = 1.5849e-01, PNorm = 76.6031, GNorm = 0.6733, lr_0 = 1.7993e-04
Loss = 2.6079e-01, PNorm = 76.6292, GNorm = 1.0814, lr_0 = 1.7472e-04
Loss = 2.2110e-01, PNorm = 76.6590, GNorm = 0.7726, lr_0 = 1.6966e-04
Validation prc-auc = 0.745276
Validation auc = 0.855471
Epoch 23
Loss = 2.2401e-01, PNorm = 76.6809, GNorm = 0.8359, lr_0 = 1.6427e-04
Loss = 2.2793e-01, PNorm = 76.7039, GNorm = 1.2615, lr_0 = 1.5952e-04
Loss = 2.4428e-01, PNorm = 76.7236, GNorm = 0.9754, lr_0 = 1.5490e-04
Validation prc-auc = 0.757683
Validation auc = 0.865117
Epoch 24
Loss = 1.7063e-01, PNorm = 76.7486, GNorm = 0.9910, lr_0 = 1.4998e-04
Loss = 2.3693e-01, PNorm = 76.7626, GNorm = 1.0148, lr_0 = 1.4563e-04
Loss = 2.4537e-01, PNorm = 76.7832, GNorm = 0.9028, lr_0 = 1.4142e-04
Validation prc-auc = 0.754816
Validation auc = 0.859424
Epoch 25
Loss = 2.2714e-01, PNorm = 76.8029, GNorm = 1.5501, lr_0 = 1.3692e-04
Loss = 2.2323e-01, PNorm = 76.8177, GNorm = 0.7461, lr_0 = 1.3296e-04
Loss = 2.2954e-01, PNorm = 76.8382, GNorm = 1.3505, lr_0 = 1.2911e-04
Validation prc-auc = 0.749012
Validation auc = 0.856262
Epoch 26
Loss = 2.0849e-01, PNorm = 76.8523, GNorm = 1.0130, lr_0 = 1.2501e-04
Loss = 2.0520e-01, PNorm = 76.8671, GNorm = 1.3419, lr_0 = 1.2139e-04
Validation prc-auc = 0.752869
Validation auc = 0.854839
Epoch 27
Loss = 1.6606e-01, PNorm = 76.8822, GNorm = 0.9537, lr_0 = 1.1753e-04
Loss = 2.3449e-01, PNorm = 76.8939, GNorm = 0.9057, lr_0 = 1.1413e-04
Loss = 2.0643e-01, PNorm = 76.9098, GNorm = 1.1432, lr_0 = 1.1083e-04
Validation prc-auc = 0.757452
Validation auc = 0.856262
Epoch 28
Loss = 2.4586e-01, PNorm = 76.9249, GNorm = 1.3087, lr_0 = 1.0730e-04
Loss = 1.8753e-01, PNorm = 76.9382, GNorm = 1.4176, lr_0 = 1.0420e-04
Loss = 2.3272e-01, PNorm = 76.9528, GNorm = 1.5298, lr_0 = 1.0118e-04
Validation prc-auc = 0.754576
Validation auc = 0.856262
Epoch 29
Loss = 1.9440e-01, PNorm = 76.9639, GNorm = 1.2589, lr_0 = 1.0000e-04
Loss = 2.1584e-01, PNorm = 76.9746, GNorm = 1.1026, lr_0 = 1.0000e-04
Loss = 2.1195e-01, PNorm = 76.9837, GNorm = 0.9071, lr_0 = 1.0000e-04
Validation prc-auc = 0.744634
Validation auc = 0.844402
Model 0 best validation prc-auc = 0.757683 on epoch 23
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.567053
Model 0 test auc = 0.817971
Ensemble test prc-auc = 0.567053
Ensemble test auc = 0.817971
Fold 9
Splitting data with seed 9
Total scaffolds = 870 | train scaffolds = 673 | val scaffolds = 112 | test scaffolds = 85
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.6624e-01, PNorm = 72.7662, GNorm = 0.5412, lr_0 = 1.0000e-03
Loss = 4.4341e-01, PNorm = 73.1763, GNorm = 0.5421, lr_0 = 1.0000e-03
Validation prc-auc = 0.434675
Validation auc = 0.693484
Epoch 1
Loss = 4.3209e-01, PNorm = 73.4185, GNorm = 1.0779, lr_0 = 1.0000e-03
Loss = 3.8168e-01, PNorm = 73.5339, GNorm = 0.8276, lr_0 = 1.0000e-03
Loss = 4.5587e-01, PNorm = 73.6128, GNorm = 0.6318, lr_0 = 1.0000e-03
Validation prc-auc = 0.492681
Validation auc = 0.723335
Epoch 2
Loss = 3.7201e-01, PNorm = 73.6897, GNorm = 0.6562, lr_0 = 9.7965e-04
Loss = 4.3004e-01, PNorm = 73.7596, GNorm = 0.7500, lr_0 = 9.5130e-04
Loss = 3.8513e-01, PNorm = 73.8308, GNorm = 1.0682, lr_0 = 9.2376e-04
Validation prc-auc = 0.541479
Validation auc = 0.738624
Epoch 3
Loss = 4.1782e-01, PNorm = 73.8939, GNorm = 0.8560, lr_0 = 8.9440e-04
Loss = 3.8254e-01, PNorm = 73.9534, GNorm = 0.7762, lr_0 = 8.6851e-04
Loss = 4.0544e-01, PNorm = 74.0167, GNorm = 1.0686, lr_0 = 8.4337e-04
Validation prc-auc = 0.501785
Validation auc = 0.705315
Epoch 4
Loss = 4.0753e-01, PNorm = 74.0991, GNorm = 0.7698, lr_0 = 8.1656e-04
Loss = 3.7255e-01, PNorm = 74.1604, GNorm = 0.6031, lr_0 = 7.9293e-04
Loss = 3.9044e-01, PNorm = 74.2180, GNorm = 0.7106, lr_0 = 7.6998e-04
Loss = 2.2863e-01, PNorm = 74.2237, GNorm = 1.8861, lr_0 = 7.6772e-04
Validation prc-auc = 0.528877
Validation auc = 0.736076
Epoch 5
Loss = 3.8468e-01, PNorm = 74.2872, GNorm = 0.5490, lr_0 = 7.4550e-04
Loss = 3.5751e-01, PNorm = 74.3574, GNorm = 0.6278, lr_0 = 7.2393e-04
Validation prc-auc = 0.558844
Validation auc = 0.760648
Epoch 6
Loss = 4.3310e-01, PNorm = 74.4147, GNorm = 0.5864, lr_0 = 7.0091e-04
Loss = 3.3176e-01, PNorm = 74.4784, GNorm = 0.4462, lr_0 = 6.8063e-04
Loss = 4.0857e-01, PNorm = 74.5402, GNorm = 0.6586, lr_0 = 6.6093e-04
Validation prc-auc = 0.570502
Validation auc = 0.767747
Epoch 7
Loss = 3.7772e-01, PNorm = 74.6107, GNorm = 0.6863, lr_0 = 6.3992e-04
Loss = 2.9834e-01, PNorm = 74.6831, GNorm = 1.6530, lr_0 = 6.2139e-04
Loss = 3.9578e-01, PNorm = 74.7432, GNorm = 0.9385, lr_0 = 6.0341e-04
Validation prc-auc = 0.578151
Validation auc = 0.769567
Epoch 8
Loss = 4.1953e-01, PNorm = 74.7969, GNorm = 0.5224, lr_0 = 5.8595e-04
Loss = 3.3313e-01, PNorm = 74.8651, GNorm = 0.6139, lr_0 = 5.6899e-04
Loss = 3.5755e-01, PNorm = 74.9075, GNorm = 1.1993, lr_0 = 5.5252e-04
Validation prc-auc = 0.554058
Validation auc = 0.750273
Epoch 9
Loss = 3.4714e-01, PNorm = 74.9700, GNorm = 0.8503, lr_0 = 5.3495e-04
Loss = 3.5778e-01, PNorm = 75.0201, GNorm = 0.4894, lr_0 = 5.1947e-04
Loss = 3.2170e-01, PNorm = 75.0603, GNorm = 0.5623, lr_0 = 5.0444e-04
Validation prc-auc = 0.574207
Validation auc = 0.759192
Epoch 10
Loss = 3.1637e-01, PNorm = 75.1191, GNorm = 0.9275, lr_0 = 4.8840e-04
Loss = 3.2616e-01, PNorm = 75.1714, GNorm = 0.6108, lr_0 = 4.7426e-04
Validation prc-auc = 0.587188
Validation auc = 0.762650
Epoch 11
Loss = 2.2575e-01, PNorm = 75.2258, GNorm = 0.5908, lr_0 = 4.5919e-04
Loss = 3.3951e-01, PNorm = 75.2801, GNorm = 0.7361, lr_0 = 4.4590e-04
Loss = 3.2207e-01, PNorm = 75.3370, GNorm = 0.7301, lr_0 = 4.3299e-04
Validation prc-auc = 0.589507
Validation auc = 0.763742
Epoch 12
Loss = 2.6921e-01, PNorm = 75.4010, GNorm = 0.7517, lr_0 = 4.1923e-04
Loss = 3.0468e-01, PNorm = 75.4588, GNorm = 0.8689, lr_0 = 4.0709e-04
Loss = 3.4193e-01, PNorm = 75.5091, GNorm = 0.8917, lr_0 = 3.9531e-04
Validation prc-auc = 0.560038
Validation auc = 0.775573
Epoch 13
Loss = 3.0091e-01, PNorm = 75.5748, GNorm = 0.8294, lr_0 = 3.8274e-04
Loss = 3.1935e-01, PNorm = 75.6303, GNorm = 1.4751, lr_0 = 3.7167e-04
Loss = 2.7742e-01, PNorm = 75.6937, GNorm = 1.2202, lr_0 = 3.6091e-04
Validation prc-auc = 0.569862
Validation auc = 0.755734
Epoch 14
Loss = 2.5468e-01, PNorm = 75.7462, GNorm = 1.2750, lr_0 = 3.4944e-04
Loss = 2.4196e-01, PNorm = 75.7991, GNorm = 0.8974, lr_0 = 3.3932e-04
Loss = 3.3819e-01, PNorm = 75.8374, GNorm = 0.7832, lr_0 = 3.2950e-04
Validation prc-auc = 0.587921
Validation auc = 0.753003
Epoch 15
Loss = 3.3113e-01, PNorm = 75.8864, GNorm = 0.8708, lr_0 = 3.1996e-04
Loss = 2.5751e-01, PNorm = 75.9375, GNorm = 0.7732, lr_0 = 3.1070e-04
Loss = 2.8752e-01, PNorm = 75.9757, GNorm = 1.3142, lr_0 = 3.0171e-04
Loss = 1.2099e-01, PNorm = 75.9802, GNorm = 1.6539, lr_0 = 3.0083e-04
Validation prc-auc = 0.571953
Validation auc = 0.755552
Epoch 16
Loss = 2.8138e-01, PNorm = 76.0144, GNorm = 0.8358, lr_0 = 2.9212e-04
Loss = 2.5860e-01, PNorm = 76.0598, GNorm = 0.9017, lr_0 = 2.8367e-04
Validation prc-auc = 0.562377
Validation auc = 0.752093
Epoch 17
Loss = 2.5741e-01, PNorm = 76.0969, GNorm = 0.8440, lr_0 = 2.7465e-04
Loss = 2.6204e-01, PNorm = 76.1386, GNorm = 0.7769, lr_0 = 2.6670e-04
Loss = 2.7266e-01, PNorm = 76.1664, GNorm = 0.8707, lr_0 = 2.5898e-04
Validation prc-auc = 0.564122
Validation auc = 0.752639
Epoch 18
Loss = 2.3070e-01, PNorm = 76.2113, GNorm = 1.2426, lr_0 = 2.5075e-04
Loss = 2.4551e-01, PNorm = 76.2439, GNorm = 1.0844, lr_0 = 2.4349e-04
Loss = 2.5781e-01, PNorm = 76.2832, GNorm = 1.9755, lr_0 = 2.3644e-04
Validation prc-auc = 0.567064
Validation auc = 0.750637
Epoch 19
Loss = 2.5947e-01, PNorm = 76.3182, GNorm = 1.0493, lr_0 = 2.2893e-04
Loss = 2.2606e-01, PNorm = 76.3555, GNorm = 0.9088, lr_0 = 2.2230e-04
Loss = 2.5834e-01, PNorm = 76.3856, GNorm = 0.7266, lr_0 = 2.1587e-04
Validation prc-auc = 0.571164
Validation auc = 0.760830
Epoch 20
Loss = 2.3543e-01, PNorm = 76.4276, GNorm = 0.9084, lr_0 = 2.0900e-04
Loss = 2.4792e-01, PNorm = 76.4532, GNorm = 1.0854, lr_0 = 2.0295e-04
Loss = 2.3197e-01, PNorm = 76.4795, GNorm = 1.1510, lr_0 = 1.9708e-04
Loss = 1.3217e-01, PNorm = 76.4825, GNorm = 1.5167, lr_0 = 1.9650e-04
Validation prc-auc = 0.551390
Validation auc = 0.745905
Epoch 21
Loss = 2.0570e-01, PNorm = 76.5140, GNorm = 1.1523, lr_0 = 1.9081e-04
Loss = 2.6482e-01, PNorm = 76.5433, GNorm = 1.4017, lr_0 = 1.8529e-04
Validation prc-auc = 0.585187
Validation auc = 0.744813
Epoch 22
Loss = 1.6050e-01, PNorm = 76.5601, GNorm = 0.9890, lr_0 = 1.7993e-04
Loss = 2.6249e-01, PNorm = 76.5871, GNorm = 0.9474, lr_0 = 1.7472e-04
Loss = 2.0944e-01, PNorm = 76.6059, GNorm = 0.8227, lr_0 = 1.6966e-04
Validation prc-auc = 0.551054
Validation auc = 0.746087
Epoch 23
Loss = 1.8801e-01, PNorm = 76.6285, GNorm = 0.9475, lr_0 = 1.6427e-04
Loss = 2.3438e-01, PNorm = 76.6476, GNorm = 1.0081, lr_0 = 1.5952e-04
Loss = 2.0670e-01, PNorm = 76.6718, GNorm = 1.0691, lr_0 = 1.5490e-04
Validation prc-auc = 0.575691
Validation auc = 0.750091
Epoch 24
Loss = 2.5353e-01, PNorm = 76.6982, GNorm = 1.4110, lr_0 = 1.4998e-04
Loss = 1.9652e-01, PNorm = 76.7202, GNorm = 0.9833, lr_0 = 1.4563e-04
Loss = 2.2896e-01, PNorm = 76.7379, GNorm = 1.6541, lr_0 = 1.4142e-04
Validation prc-auc = 0.579674
Validation auc = 0.745723
Epoch 25
Loss = 2.4251e-01, PNorm = 76.7577, GNorm = 1.7037, lr_0 = 1.3692e-04
Loss = 1.7481e-01, PNorm = 76.7743, GNorm = 1.3797, lr_0 = 1.3296e-04
Loss = 1.9001e-01, PNorm = 76.7915, GNorm = 0.9962, lr_0 = 1.2911e-04
Validation prc-auc = 0.578439
Validation auc = 0.744631
Epoch 26
Loss = 1.9438e-01, PNorm = 76.8075, GNorm = 1.0315, lr_0 = 1.2501e-04
Loss = 1.9742e-01, PNorm = 76.8238, GNorm = 1.1758, lr_0 = 1.2139e-04
Validation prc-auc = 0.576550
Validation auc = 0.752639
Epoch 27
Loss = 1.6507e-01, PNorm = 76.8412, GNorm = 1.1439, lr_0 = 1.1753e-04
Loss = 2.0634e-01, PNorm = 76.8508, GNorm = 1.0254, lr_0 = 1.1413e-04
Loss = 2.0281e-01, PNorm = 76.8658, GNorm = 0.5990, lr_0 = 1.1083e-04
Validation prc-auc = 0.574419
Validation auc = 0.746087
Epoch 28
Loss = 2.2631e-01, PNorm = 76.8788, GNorm = 1.5774, lr_0 = 1.0730e-04
Loss = 2.1177e-01, PNorm = 76.8927, GNorm = 1.5904, lr_0 = 1.0420e-04
Loss = 1.7265e-01, PNorm = 76.9013, GNorm = 1.4656, lr_0 = 1.0118e-04
Validation prc-auc = 0.564178
Validation auc = 0.746633
Epoch 29
Loss = 1.4987e-01, PNorm = 76.9148, GNorm = 0.8927, lr_0 = 1.0000e-04
Loss = 1.9131e-01, PNorm = 76.9245, GNorm = 1.2944, lr_0 = 1.0000e-04
Loss = 2.3870e-01, PNorm = 76.9336, GNorm = 1.4219, lr_0 = 1.0000e-04
Validation prc-auc = 0.578950
Validation auc = 0.749545
Model 0 best validation prc-auc = 0.589507 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.668348
Model 0 test auc = 0.847162
Ensemble test prc-auc = 0.668348
Ensemble test auc = 0.847162
Fold 10
Splitting data with seed 10
Total scaffolds = 870 | train scaffolds = 652 | val scaffolds = 115 | test scaffolds = 103
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.6450e-01, PNorm = 72.7679, GNorm = 0.5612, lr_0 = 1.0000e-03
Loss = 4.9097e-01, PNorm = 73.1777, GNorm = 1.3292, lr_0 = 1.0000e-03
Validation prc-auc = 0.453234
Validation auc = 0.761145
Epoch 1
Loss = 4.7442e-01, PNorm = 73.4270, GNorm = 1.0124, lr_0 = 1.0000e-03
Loss = 4.3770e-01, PNorm = 73.5494, GNorm = 0.6633, lr_0 = 1.0000e-03
Loss = 4.4997e-01, PNorm = 73.6291, GNorm = 0.6782, lr_0 = 1.0000e-03
Validation prc-auc = 0.524256
Validation auc = 0.813374
Epoch 2
Loss = 4.2610e-01, PNorm = 73.7090, GNorm = 0.5823, lr_0 = 9.7965e-04
Loss = 4.5031e-01, PNorm = 73.7824, GNorm = 1.0651, lr_0 = 9.5130e-04
Loss = 4.2165e-01, PNorm = 73.8445, GNorm = 0.8067, lr_0 = 9.2376e-04
Validation prc-auc = 0.513714
Validation auc = 0.800044
Epoch 3
Loss = 4.2309e-01, PNorm = 73.9071, GNorm = 0.9259, lr_0 = 8.9440e-04
Loss = 4.2478e-01, PNorm = 73.9723, GNorm = 1.0217, lr_0 = 8.6851e-04
Loss = 4.5538e-01, PNorm = 74.0201, GNorm = 1.2078, lr_0 = 8.4337e-04
Validation prc-auc = 0.530099
Validation auc = 0.811844
Epoch 4
Loss = 3.8381e-01, PNorm = 74.0831, GNorm = 0.5026, lr_0 = 8.1656e-04
Loss = 3.7708e-01, PNorm = 74.1348, GNorm = 0.6176, lr_0 = 7.9293e-04
Loss = 4.4571e-01, PNorm = 74.1783, GNorm = 0.7430, lr_0 = 7.6998e-04
Loss = 2.6025e-01, PNorm = 74.1846, GNorm = 1.3383, lr_0 = 7.6772e-04
Validation prc-auc = 0.563502
Validation auc = 0.827797
Epoch 5
Loss = 3.8903e-01, PNorm = 74.2474, GNorm = 1.2343, lr_0 = 7.4550e-04
Loss = 4.2245e-01, PNorm = 74.2956, GNorm = 0.7241, lr_0 = 7.2393e-04
Validation prc-auc = 0.592436
Validation auc = 0.832823
Epoch 6
Loss = 3.4601e-01, PNorm = 74.3684, GNorm = 0.4956, lr_0 = 7.0091e-04
Loss = 3.9782e-01, PNorm = 74.4323, GNorm = 0.5934, lr_0 = 6.8063e-04
Loss = 4.0220e-01, PNorm = 74.5041, GNorm = 0.4825, lr_0 = 6.6093e-04
Validation prc-auc = 0.572068
Validation auc = 0.823645
Epoch 7
Loss = 3.8644e-01, PNorm = 74.5684, GNorm = 0.5730, lr_0 = 6.3992e-04
Loss = 3.5485e-01, PNorm = 74.6388, GNorm = 0.5258, lr_0 = 6.2139e-04
Loss = 3.7731e-01, PNorm = 74.6932, GNorm = 0.8488, lr_0 = 6.0341e-04
Validation prc-auc = 0.584319
Validation auc = 0.837413
Epoch 8
Loss = 3.4985e-01, PNorm = 74.7593, GNorm = 0.6025, lr_0 = 5.8595e-04
Loss = 3.9985e-01, PNorm = 74.8179, GNorm = 0.7526, lr_0 = 5.6899e-04
Loss = 3.6871e-01, PNorm = 74.8762, GNorm = 0.7389, lr_0 = 5.5252e-04
Validation prc-auc = 0.555510
Validation auc = 0.825175
Epoch 9
Loss = 3.5169e-01, PNorm = 74.9515, GNorm = 0.6754, lr_0 = 5.3495e-04
Loss = 3.9972e-01, PNorm = 75.0217, GNorm = 0.8319, lr_0 = 5.1947e-04
Loss = 3.4835e-01, PNorm = 75.0945, GNorm = 0.6546, lr_0 = 5.0444e-04
Validation prc-auc = 0.593416
Validation auc = 0.831731
Epoch 10
Loss = 3.6401e-01, PNorm = 75.1832, GNorm = 0.6449, lr_0 = 4.8840e-04
Loss = 3.7472e-01, PNorm = 75.2508, GNorm = 0.9509, lr_0 = 4.7426e-04
Validation prc-auc = 0.594827
Validation auc = 0.838724
Epoch 11
Loss = 2.4399e-01, PNorm = 75.3301, GNorm = 0.8114, lr_0 = 4.5919e-04
Loss = 3.0502e-01, PNorm = 75.4077, GNorm = 0.5133, lr_0 = 4.4590e-04
Loss = 4.0671e-01, PNorm = 75.4659, GNorm = 0.7081, lr_0 = 4.3299e-04
Validation prc-auc = 0.613637
Validation auc = 0.849869
Epoch 12
Loss = 3.1221e-01, PNorm = 75.5306, GNorm = 0.5659, lr_0 = 4.1923e-04
Loss = 3.1419e-01, PNorm = 75.5908, GNorm = 1.1463, lr_0 = 4.0709e-04
Loss = 3.3560e-01, PNorm = 75.6440, GNorm = 0.6357, lr_0 = 3.9531e-04
Validation prc-auc = 0.620522
Validation auc = 0.850962
Epoch 13
Loss = 3.8405e-01, PNorm = 75.6956, GNorm = 1.6764, lr_0 = 3.8274e-04
Loss = 3.1183e-01, PNorm = 75.7605, GNorm = 1.6482, lr_0 = 3.7167e-04
Loss = 3.1989e-01, PNorm = 75.8071, GNorm = 0.8973, lr_0 = 3.6091e-04
Validation prc-auc = 0.596518
Validation auc = 0.837413
Epoch 14
Loss = 2.7547e-01, PNorm = 75.8712, GNorm = 0.9380, lr_0 = 3.4944e-04
Loss = 3.5143e-01, PNorm = 75.9172, GNorm = 0.9925, lr_0 = 3.3932e-04
Loss = 3.0467e-01, PNorm = 75.9597, GNorm = 0.8174, lr_0 = 3.2950e-04
Validation prc-auc = 0.591156
Validation auc = 0.836757
Epoch 15
Loss = 2.9833e-01, PNorm = 76.0087, GNorm = 0.8732, lr_0 = 3.1996e-04
Loss = 3.5012e-01, PNorm = 76.0511, GNorm = 0.8028, lr_0 = 3.1070e-04
Loss = 2.9151e-01, PNorm = 76.0977, GNorm = 1.1803, lr_0 = 3.0171e-04
Loss = 9.6037e-02, PNorm = 76.1021, GNorm = 0.9346, lr_0 = 3.0083e-04
Validation prc-auc = 0.613252
Validation auc = 0.852054
Epoch 16
Loss = 2.9491e-01, PNorm = 76.1412, GNorm = 1.1865, lr_0 = 2.9212e-04
Loss = 2.9547e-01, PNorm = 76.1818, GNorm = 1.2477, lr_0 = 2.8367e-04
Validation prc-auc = 0.586198
Validation auc = 0.836976
Epoch 17
Loss = 2.3787e-01, PNorm = 76.2256, GNorm = 1.0784, lr_0 = 2.7465e-04
Loss = 2.8728e-01, PNorm = 76.2701, GNorm = 1.2012, lr_0 = 2.6670e-04
Loss = 3.1157e-01, PNorm = 76.3175, GNorm = 0.9517, lr_0 = 2.5898e-04
Validation prc-auc = 0.614414
Validation auc = 0.847247
Epoch 18
Loss = 2.6607e-01, PNorm = 76.3523, GNorm = 0.9361, lr_0 = 2.5075e-04
Loss = 2.6005e-01, PNorm = 76.3916, GNorm = 0.8096, lr_0 = 2.4349e-04
Loss = 3.1913e-01, PNorm = 76.4342, GNorm = 0.7946, lr_0 = 2.3644e-04
Validation prc-auc = 0.618916
Validation auc = 0.845717
Epoch 19
Loss = 2.5924e-01, PNorm = 76.4738, GNorm = 0.6800, lr_0 = 2.2893e-04
Loss = 2.7067e-01, PNorm = 76.5048, GNorm = 1.0194, lr_0 = 2.2230e-04
Loss = 2.7911e-01, PNorm = 76.5370, GNorm = 1.1656, lr_0 = 2.1587e-04
Validation prc-auc = 0.605517
Validation auc = 0.848558
Epoch 20
Loss = 2.5573e-01, PNorm = 76.5788, GNorm = 0.7577, lr_0 = 2.0900e-04
Loss = 2.6879e-01, PNorm = 76.6150, GNorm = 1.2032, lr_0 = 2.0295e-04
Loss = 2.3908e-01, PNorm = 76.6470, GNorm = 0.9842, lr_0 = 1.9708e-04
Loss = 4.1159e-01, PNorm = 76.6493, GNorm = 2.6630, lr_0 = 1.9650e-04
Validation prc-auc = 0.614809
Validation auc = 0.840691
Epoch 21
Loss = 2.4905e-01, PNorm = 76.6802, GNorm = 2.2565, lr_0 = 1.9081e-04
Loss = 2.6583e-01, PNorm = 76.7027, GNorm = 1.1905, lr_0 = 1.8529e-04
Validation prc-auc = 0.605126
Validation auc = 0.835446
Epoch 22
Loss = 3.1807e-01, PNorm = 76.7298, GNorm = 1.2529, lr_0 = 1.7993e-04
Loss = 2.3669e-01, PNorm = 76.7569, GNorm = 1.3806, lr_0 = 1.7472e-04
Loss = 2.3285e-01, PNorm = 76.7851, GNorm = 0.6991, lr_0 = 1.6966e-04
Validation prc-auc = 0.573343
Validation auc = 0.829327
Epoch 23
Loss = 3.2926e-01, PNorm = 76.8052, GNorm = 1.5414, lr_0 = 1.6427e-04
Loss = 2.3674e-01, PNorm = 76.8342, GNorm = 0.9371, lr_0 = 1.5952e-04
Loss = 2.3560e-01, PNorm = 76.8545, GNorm = 1.3049, lr_0 = 1.5490e-04
Validation prc-auc = 0.574581
Validation auc = 0.832823
Epoch 24
Loss = 2.1112e-01, PNorm = 76.8796, GNorm = 0.7896, lr_0 = 1.4998e-04
Loss = 2.5526e-01, PNorm = 76.9001, GNorm = 1.0846, lr_0 = 1.4563e-04
Loss = 2.1244e-01, PNorm = 76.9209, GNorm = 1.0872, lr_0 = 1.4142e-04
Validation prc-auc = 0.595303
Validation auc = 0.836976
Epoch 25
Loss = 2.2686e-01, PNorm = 76.9436, GNorm = 0.9396, lr_0 = 1.3692e-04
Loss = 2.3186e-01, PNorm = 76.9626, GNorm = 1.4484, lr_0 = 1.3296e-04
Loss = 2.5476e-01, PNorm = 76.9774, GNorm = 1.6098, lr_0 = 1.2911e-04
Validation prc-auc = 0.579294
Validation auc = 0.822334
Epoch 26
Loss = 2.4338e-01, PNorm = 76.9998, GNorm = 1.2717, lr_0 = 1.2501e-04
Loss = 2.2859e-01, PNorm = 77.0197, GNorm = 1.7652, lr_0 = 1.2139e-04
Validation prc-auc = 0.590668
Validation auc = 0.826486
Epoch 27
Loss = 2.3179e-01, PNorm = 77.0342, GNorm = 1.1323, lr_0 = 1.1753e-04
Loss = 2.6089e-01, PNorm = 77.0503, GNorm = 1.0688, lr_0 = 1.1413e-04
Loss = 2.2282e-01, PNorm = 77.0650, GNorm = 1.2336, lr_0 = 1.1083e-04
Validation prc-auc = 0.566182
Validation auc = 0.827579
Epoch 28
Loss = 1.8118e-01, PNorm = 77.0797, GNorm = 1.2778, lr_0 = 1.0730e-04
Loss = 2.3649e-01, PNorm = 77.0899, GNorm = 1.2586, lr_0 = 1.0420e-04
Loss = 2.0683e-01, PNorm = 77.1020, GNorm = 1.0459, lr_0 = 1.0118e-04
Validation prc-auc = 0.587245
Validation auc = 0.837413
Epoch 29
Loss = 2.0127e-01, PNorm = 77.1151, GNorm = 0.7726, lr_0 = 1.0000e-04
Loss = 2.5438e-01, PNorm = 77.1291, GNorm = 1.5297, lr_0 = 1.0000e-04
Loss = 1.9786e-01, PNorm = 77.1402, GNorm = 1.1149, lr_0 = 1.0000e-04
Validation prc-auc = 0.565883
Validation auc = 0.829983
Model 0 best validation prc-auc = 0.620522 on epoch 12
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.637621
Model 0 test auc = 0.871983
Ensemble test prc-auc = 0.637621
Ensemble test auc = 0.871983
Fold 11
Splitting data with seed 11
Total scaffolds = 870 | train scaffolds = 639 | val scaffolds = 115 | test scaffolds = 116
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.6879e-01, PNorm = 72.7837, GNorm = 0.5208, lr_0 = 1.0000e-03
Loss = 4.6150e-01, PNorm = 73.1967, GNorm = 0.5029, lr_0 = 1.0000e-03
Validation prc-auc = 0.386430
Validation auc = 0.673913
Epoch 1
Loss = 4.2482e-01, PNorm = 73.4528, GNorm = 0.6006, lr_0 = 1.0000e-03
Loss = 4.0695e-01, PNorm = 73.5861, GNorm = 0.8659, lr_0 = 1.0000e-03
Loss = 4.3812e-01, PNorm = 73.6691, GNorm = 0.8540, lr_0 = 1.0000e-03
Validation prc-auc = 0.376240
Validation auc = 0.649824
Epoch 2
Loss = 4.1633e-01, PNorm = 73.7450, GNorm = 0.5838, lr_0 = 9.7965e-04
Loss = 3.9526e-01, PNorm = 73.8161, GNorm = 0.5363, lr_0 = 9.5130e-04
Loss = 4.4253e-01, PNorm = 73.8738, GNorm = 0.8195, lr_0 = 9.2376e-04
Validation prc-auc = 0.432957
Validation auc = 0.722483
Epoch 3
Loss = 4.1215e-01, PNorm = 73.9269, GNorm = 0.5576, lr_0 = 8.9440e-04
Loss = 4.1493e-01, PNorm = 73.9755, GNorm = 0.6135, lr_0 = 8.6851e-04
Loss = 3.8581e-01, PNorm = 74.0285, GNorm = 0.6081, lr_0 = 8.4337e-04
Validation prc-auc = 0.438814
Validation auc = 0.703878
Epoch 4
Loss = 3.5815e-01, PNorm = 74.0889, GNorm = 0.5050, lr_0 = 8.1656e-04
Loss = 4.0192e-01, PNorm = 74.1481, GNorm = 0.6067, lr_0 = 7.9293e-04
Loss = 3.9653e-01, PNorm = 74.2028, GNorm = 0.5913, lr_0 = 7.6998e-04
Loss = 2.9123e-01, PNorm = 74.2082, GNorm = 1.2301, lr_0 = 7.6772e-04
Validation prc-auc = 0.539961
Validation auc = 0.755386
Epoch 5
Loss = 3.9976e-01, PNorm = 74.2729, GNorm = 0.9034, lr_0 = 7.4550e-04
Loss = 3.3902e-01, PNorm = 74.3408, GNorm = 0.5247, lr_0 = 7.2393e-04
Validation prc-auc = 0.490932
Validation auc = 0.687231
Epoch 6
Loss = 2.8276e-01, PNorm = 74.4264, GNorm = 0.7423, lr_0 = 7.0091e-04
Loss = 3.7399e-01, PNorm = 74.4944, GNorm = 0.5730, lr_0 = 6.8063e-04
Loss = 4.0413e-01, PNorm = 74.5680, GNorm = 0.8577, lr_0 = 6.6093e-04
Validation prc-auc = 0.516470
Validation auc = 0.753427
Epoch 7
Loss = 3.8226e-01, PNorm = 74.6334, GNorm = 0.7217, lr_0 = 6.3992e-04
Loss = 3.7202e-01, PNorm = 74.6968, GNorm = 0.5712, lr_0 = 6.2139e-04
Loss = 3.8439e-01, PNorm = 74.7520, GNorm = 0.5766, lr_0 = 6.0341e-04
Validation prc-auc = 0.515020
Validation auc = 0.757344
Epoch 8
Loss = 4.0139e-01, PNorm = 74.8079, GNorm = 0.5597, lr_0 = 5.8595e-04
Loss = 3.3419e-01, PNorm = 74.8556, GNorm = 0.5886, lr_0 = 5.6899e-04
Loss = 3.9650e-01, PNorm = 74.9022, GNorm = 1.5458, lr_0 = 5.5252e-04
Validation prc-auc = 0.566758
Validation auc = 0.763024
Epoch 9
Loss = 3.9447e-01, PNorm = 74.9529, GNorm = 0.5170, lr_0 = 5.3495e-04
Loss = 3.2405e-01, PNorm = 74.9979, GNorm = 0.5776, lr_0 = 5.1947e-04
Loss = 3.7176e-01, PNorm = 75.0461, GNorm = 0.7198, lr_0 = 5.0444e-04
Validation prc-auc = 0.532703
Validation auc = 0.763416
Epoch 10
Loss = 3.6503e-01, PNorm = 75.1076, GNorm = 0.6579, lr_0 = 4.8840e-04
Loss = 3.3304e-01, PNorm = 75.1661, GNorm = 0.6479, lr_0 = 4.7426e-04
Validation prc-auc = 0.545363
Validation auc = 0.771445
Epoch 11
Loss = 2.0112e-01, PNorm = 75.2240, GNorm = 0.5835, lr_0 = 4.5919e-04
Loss = 3.3588e-01, PNorm = 75.2762, GNorm = 0.7538, lr_0 = 4.4590e-04
Loss = 3.1585e-01, PNorm = 75.3355, GNorm = 0.7359, lr_0 = 4.3299e-04
Validation prc-auc = 0.542964
Validation auc = 0.771837
Epoch 12
Loss = 2.7107e-01, PNorm = 75.3989, GNorm = 1.5754, lr_0 = 4.1923e-04
Loss = 3.2116e-01, PNorm = 75.4430, GNorm = 0.6852, lr_0 = 4.0709e-04
Loss = 3.1960e-01, PNorm = 75.4975, GNorm = 0.5467, lr_0 = 3.9531e-04
Validation prc-auc = 0.530760
Validation auc = 0.766745
Epoch 13
Loss = 2.9901e-01, PNorm = 75.5548, GNorm = 0.7577, lr_0 = 3.8274e-04
Loss = 3.2574e-01, PNorm = 75.6174, GNorm = 0.7852, lr_0 = 3.7167e-04
Loss = 3.2211e-01, PNorm = 75.6599, GNorm = 0.7748, lr_0 = 3.6091e-04
Validation prc-auc = 0.533259
Validation auc = 0.771641
Epoch 14
Loss = 2.5621e-01, PNorm = 75.7114, GNorm = 0.5857, lr_0 = 3.4944e-04
Loss = 3.0789e-01, PNorm = 75.7514, GNorm = 0.9452, lr_0 = 3.3932e-04
Loss = 3.3710e-01, PNorm = 75.7996, GNorm = 0.8652, lr_0 = 3.2950e-04
Validation prc-auc = 0.570456
Validation auc = 0.782609
Epoch 15
Loss = 3.1191e-01, PNorm = 75.8458, GNorm = 0.9827, lr_0 = 3.1996e-04
Loss = 2.9824e-01, PNorm = 75.8902, GNorm = 1.1106, lr_0 = 3.1070e-04
Loss = 2.9077e-01, PNorm = 75.9362, GNorm = 1.0031, lr_0 = 3.0171e-04
Loss = 1.9352e-01, PNorm = 75.9399, GNorm = 1.4076, lr_0 = 3.0083e-04
Validation prc-auc = 0.585692
Validation auc = 0.779867
Epoch 16
Loss = 2.4812e-01, PNorm = 75.9813, GNorm = 0.7272, lr_0 = 2.9212e-04
Loss = 3.1812e-01, PNorm = 76.0210, GNorm = 0.7139, lr_0 = 2.8367e-04
Validation prc-auc = 0.595163
Validation auc = 0.783000
Epoch 17
Loss = 2.5708e-01, PNorm = 76.0717, GNorm = 0.9610, lr_0 = 2.7465e-04
Loss = 3.1275e-01, PNorm = 76.0998, GNorm = 1.0455, lr_0 = 2.6670e-04
Loss = 2.4622e-01, PNorm = 76.1387, GNorm = 0.8195, lr_0 = 2.5898e-04
Validation prc-auc = 0.579561
Validation auc = 0.782805
Epoch 18
Loss = 2.3787e-01, PNorm = 76.1782, GNorm = 0.8753, lr_0 = 2.5075e-04
Loss = 2.4255e-01, PNorm = 76.2201, GNorm = 1.0452, lr_0 = 2.4349e-04
Loss = 3.3182e-01, PNorm = 76.2476, GNorm = 1.0597, lr_0 = 2.3644e-04
Validation prc-auc = 0.558804
Validation auc = 0.776146
Epoch 19
Loss = 2.7017e-01, PNorm = 76.2853, GNorm = 0.7606, lr_0 = 2.2893e-04
Loss = 2.5049e-01, PNorm = 76.3209, GNorm = 0.8345, lr_0 = 2.2230e-04
Loss = 2.5895e-01, PNorm = 76.3574, GNorm = 1.2724, lr_0 = 2.1587e-04
Validation prc-auc = 0.601827
Validation auc = 0.780846
Epoch 20
Loss = 2.3911e-01, PNorm = 76.3919, GNorm = 1.1193, lr_0 = 2.0900e-04
Loss = 2.9416e-01, PNorm = 76.4192, GNorm = 0.9044, lr_0 = 2.0295e-04
Loss = 2.6307e-01, PNorm = 76.4488, GNorm = 0.8566, lr_0 = 1.9708e-04
Loss = 1.6892e-01, PNorm = 76.4524, GNorm = 1.5424, lr_0 = 1.9650e-04
Validation prc-auc = 0.603601
Validation auc = 0.781629
Epoch 21
Loss = 2.4661e-01, PNorm = 76.4843, GNorm = 0.6879, lr_0 = 1.9081e-04
Loss = 2.4035e-01, PNorm = 76.5117, GNorm = 0.9958, lr_0 = 1.8529e-04
Validation prc-auc = 0.481367
Validation auc = 0.778300
Epoch 22
Loss = 3.5010e-01, PNorm = 76.5367, GNorm = 1.2494, lr_0 = 1.7993e-04
Loss = 2.2299e-01, PNorm = 76.5648, GNorm = 1.0023, lr_0 = 1.7472e-04
Loss = 2.6347e-01, PNorm = 76.5800, GNorm = 1.4106, lr_0 = 1.6966e-04
Validation prc-auc = 0.500616
Validation auc = 0.771837
Epoch 23
Loss = 1.6768e-01, PNorm = 76.6040, GNorm = 0.9101, lr_0 = 1.6427e-04
Loss = 2.0515e-01, PNorm = 76.6318, GNorm = 1.2154, lr_0 = 1.5952e-04
Loss = 2.2489e-01, PNorm = 76.6519, GNorm = 1.1862, lr_0 = 1.5490e-04
Validation prc-auc = 0.530951
Validation auc = 0.778888
Epoch 24
Loss = 2.1589e-01, PNorm = 76.6737, GNorm = 1.4377, lr_0 = 1.4998e-04
Loss = 2.4812e-01, PNorm = 76.6910, GNorm = 1.1941, lr_0 = 1.4563e-04
Loss = 2.4177e-01, PNorm = 76.7131, GNorm = 1.8522, lr_0 = 1.4142e-04
Validation prc-auc = 0.566659
Validation auc = 0.778888
Epoch 25
Loss = 2.6437e-01, PNorm = 76.7282, GNorm = 1.0073, lr_0 = 1.3692e-04
Loss = 2.0041e-01, PNorm = 76.7487, GNorm = 1.1655, lr_0 = 1.3296e-04
Loss = 2.2994e-01, PNorm = 76.7587, GNorm = 1.3032, lr_0 = 1.2911e-04
Validation prc-auc = 0.504295
Validation auc = 0.779671
Epoch 26
Loss = 2.5827e-01, PNorm = 76.7805, GNorm = 0.9973, lr_0 = 1.2501e-04
Loss = 2.3298e-01, PNorm = 76.7981, GNorm = 0.8999, lr_0 = 1.2139e-04
Validation prc-auc = 0.552297
Validation auc = 0.784763
Epoch 27
Loss = 1.2687e-01, PNorm = 76.8136, GNorm = 0.8282, lr_0 = 1.1753e-04
Loss = 1.8652e-01, PNorm = 76.8297, GNorm = 0.9274, lr_0 = 1.1413e-04
Loss = 2.6324e-01, PNorm = 76.8398, GNorm = 1.2404, lr_0 = 1.1083e-04
Validation prc-auc = 0.533297
Validation auc = 0.786917
Epoch 28
Loss = 1.8840e-01, PNorm = 76.8550, GNorm = 1.1799, lr_0 = 1.0730e-04
Loss = 2.3233e-01, PNorm = 76.8670, GNorm = 1.4122, lr_0 = 1.0420e-04
Loss = 1.9734e-01, PNorm = 76.8784, GNorm = 1.2226, lr_0 = 1.0118e-04
Validation prc-auc = 0.462274
Validation auc = 0.783000
Epoch 29
Loss = 1.8538e-01, PNorm = 76.8922, GNorm = 0.9803, lr_0 = 1.0000e-04
Loss = 1.6912e-01, PNorm = 76.9055, GNorm = 1.1953, lr_0 = 1.0000e-04
Loss = 2.1125e-01, PNorm = 76.9167, GNorm = 1.7626, lr_0 = 1.0000e-04
Validation prc-auc = 0.502751
Validation auc = 0.780259
Model 0 best validation prc-auc = 0.603601 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.634420
Model 0 test auc = 0.845473
Ensemble test prc-auc = 0.634420
Ensemble test auc = 0.845473
Fold 12
Splitting data with seed 12
Total scaffolds = 870 | train scaffolds = 657 | val scaffolds = 101 | test scaffolds = 112
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.3698e-01, PNorm = 72.7611, GNorm = 1.4426, lr_0 = 1.0000e-03
Loss = 4.5032e-01, PNorm = 73.1602, GNorm = 0.7148, lr_0 = 1.0000e-03
Validation prc-auc = 0.317705
Validation auc = 0.591224
Epoch 1
Loss = 4.2097e-01, PNorm = 73.3945, GNorm = 0.5940, lr_0 = 1.0000e-03
Loss = 4.6596e-01, PNorm = 73.5032, GNorm = 1.5165, lr_0 = 1.0000e-03
Loss = 4.6293e-01, PNorm = 73.5757, GNorm = 0.5662, lr_0 = 1.0000e-03
Validation prc-auc = 0.404960
Validation auc = 0.673878
Epoch 2
Loss = 4.5337e-01, PNorm = 73.6436, GNorm = 0.6135, lr_0 = 9.7965e-04
Loss = 4.0856e-01, PNorm = 73.7065, GNorm = 0.4862, lr_0 = 9.5130e-04
Loss = 4.1917e-01, PNorm = 73.7631, GNorm = 0.5747, lr_0 = 9.2376e-04
Validation prc-auc = 0.453405
Validation auc = 0.688163
Epoch 3
Loss = 3.9004e-01, PNorm = 73.8232, GNorm = 0.5207, lr_0 = 8.9440e-04
Loss = 3.8399e-01, PNorm = 73.8851, GNorm = 0.9869, lr_0 = 8.6851e-04
Loss = 4.4113e-01, PNorm = 73.9386, GNorm = 0.5825, lr_0 = 8.4337e-04
Validation prc-auc = 0.504199
Validation auc = 0.712449
Epoch 4
Loss = 4.3929e-01, PNorm = 74.0060, GNorm = 0.7134, lr_0 = 8.1656e-04
Loss = 3.8615e-01, PNorm = 74.0665, GNorm = 0.6237, lr_0 = 7.9293e-04
Loss = 3.7665e-01, PNorm = 74.1245, GNorm = 0.5514, lr_0 = 7.6998e-04
Loss = 4.0243e-01, PNorm = 74.1284, GNorm = 1.7530, lr_0 = 7.6772e-04
Validation prc-auc = 0.466739
Validation auc = 0.694082
Epoch 5
Loss = 4.0032e-01, PNorm = 74.1852, GNorm = 0.6045, lr_0 = 7.4550e-04
Loss = 4.1530e-01, PNorm = 74.2448, GNorm = 0.6323, lr_0 = 7.2393e-04
Validation prc-auc = 0.439271
Validation auc = 0.695510
Epoch 6
Loss = 3.8500e-01, PNorm = 74.3079, GNorm = 0.5994, lr_0 = 7.0091e-04
Loss = 3.7199e-01, PNorm = 74.3837, GNorm = 0.5693, lr_0 = 6.8063e-04
Loss = 3.8089e-01, PNorm = 74.4480, GNorm = 0.6829, lr_0 = 6.6093e-04
Validation prc-auc = 0.461145
Validation auc = 0.679388
Epoch 7
Loss = 3.9482e-01, PNorm = 74.5156, GNorm = 0.9955, lr_0 = 6.3992e-04
Loss = 3.6316e-01, PNorm = 74.5902, GNorm = 0.7137, lr_0 = 6.2139e-04
Loss = 3.8471e-01, PNorm = 74.6642, GNorm = 1.1797, lr_0 = 6.0341e-04
Validation prc-auc = 0.510739
Validation auc = 0.736531
Epoch 8
Loss = 3.5145e-01, PNorm = 74.7215, GNorm = 0.7533, lr_0 = 5.8595e-04
Loss = 3.7641e-01, PNorm = 74.7872, GNorm = 0.5665, lr_0 = 5.6899e-04
Loss = 3.3934e-01, PNorm = 74.8536, GNorm = 0.7073, lr_0 = 5.5252e-04
Validation prc-auc = 0.510545
Validation auc = 0.719796
Epoch 9
Loss = 3.4288e-01, PNorm = 74.9271, GNorm = 0.6666, lr_0 = 5.3495e-04
Loss = 3.4764e-01, PNorm = 74.9956, GNorm = 0.6797, lr_0 = 5.1947e-04
Loss = 3.4386e-01, PNorm = 75.0596, GNorm = 0.6198, lr_0 = 5.0444e-04
Validation prc-auc = 0.488896
Validation auc = 0.717551
Epoch 10
Loss = 3.2800e-01, PNorm = 75.1268, GNorm = 0.6923, lr_0 = 4.8840e-04
Loss = 3.8099e-01, PNorm = 75.1911, GNorm = 0.9225, lr_0 = 4.7426e-04
Validation prc-auc = 0.474513
Validation auc = 0.701224
Epoch 11
Loss = 2.7882e-01, PNorm = 75.2676, GNorm = 0.6237, lr_0 = 4.5919e-04
Loss = 3.7697e-01, PNorm = 75.3273, GNorm = 0.9271, lr_0 = 4.4590e-04
Loss = 2.8869e-01, PNorm = 75.3862, GNorm = 0.6424, lr_0 = 4.3299e-04
Validation prc-auc = 0.505391
Validation auc = 0.722857
Epoch 12
Loss = 3.2338e-01, PNorm = 75.4565, GNorm = 0.5977, lr_0 = 4.1923e-04
Loss = 3.1753e-01, PNorm = 75.5249, GNorm = 1.0498, lr_0 = 4.0709e-04
Loss = 3.8127e-01, PNorm = 75.5793, GNorm = 0.7801, lr_0 = 3.9531e-04
Validation prc-auc = 0.486998
Validation auc = 0.693878
Epoch 13
Loss = 3.5290e-01, PNorm = 75.6403, GNorm = 0.7016, lr_0 = 3.8274e-04
Loss = 3.5122e-01, PNorm = 75.6902, GNorm = 0.8118, lr_0 = 3.7167e-04
Loss = 2.8252e-01, PNorm = 75.7437, GNorm = 1.1398, lr_0 = 3.6091e-04
Validation prc-auc = 0.485237
Validation auc = 0.705510
Epoch 14
Loss = 3.0829e-01, PNorm = 75.7891, GNorm = 0.5934, lr_0 = 3.4944e-04
Loss = 2.8803e-01, PNorm = 75.8386, GNorm = 1.0249, lr_0 = 3.3932e-04
Loss = 2.9476e-01, PNorm = 75.8802, GNorm = 0.8701, lr_0 = 3.2950e-04
Validation prc-auc = 0.455362
Validation auc = 0.692653
Epoch 15
Loss = 2.9763e-01, PNorm = 75.9269, GNorm = 0.6281, lr_0 = 3.1996e-04
Loss = 2.7131e-01, PNorm = 75.9745, GNorm = 1.0450, lr_0 = 3.1070e-04
Loss = 2.9175e-01, PNorm = 76.0150, GNorm = 1.2338, lr_0 = 3.0171e-04
Loss = 1.2211e-01, PNorm = 76.0189, GNorm = 1.5268, lr_0 = 3.0083e-04
Validation prc-auc = 0.480258
Validation auc = 0.730816
Epoch 16
Loss = 2.8817e-01, PNorm = 76.0620, GNorm = 0.6932, lr_0 = 2.9212e-04
Loss = 3.1823e-01, PNorm = 76.1037, GNorm = 0.8331, lr_0 = 2.8367e-04
Validation prc-auc = 0.451082
Validation auc = 0.709388
Epoch 17
Loss = 2.7032e-01, PNorm = 76.1540, GNorm = 0.8490, lr_0 = 2.7465e-04
Loss = 2.9814e-01, PNorm = 76.1960, GNorm = 0.8205, lr_0 = 2.6670e-04
Loss = 2.4865e-01, PNorm = 76.2349, GNorm = 0.7471, lr_0 = 2.5898e-04
Validation prc-auc = 0.452730
Validation auc = 0.691020
Epoch 18
Loss = 2.7842e-01, PNorm = 76.2705, GNorm = 0.8743, lr_0 = 2.5075e-04
Loss = 2.9512e-01, PNorm = 76.3058, GNorm = 0.8682, lr_0 = 2.4349e-04
Loss = 2.4220e-01, PNorm = 76.3437, GNorm = 1.6950, lr_0 = 2.3644e-04
Validation prc-auc = 0.473851
Validation auc = 0.708367
Epoch 19
Loss = 2.1095e-01, PNorm = 76.3806, GNorm = 1.0438, lr_0 = 2.2893e-04
Loss = 2.5508e-01, PNorm = 76.4202, GNorm = 0.8109, lr_0 = 2.2230e-04
Loss = 2.9864e-01, PNorm = 76.4488, GNorm = 1.2173, lr_0 = 2.1587e-04
Validation prc-auc = 0.485559
Validation auc = 0.728776
Epoch 20
Loss = 2.2410e-01, PNorm = 76.4833, GNorm = 0.9838, lr_0 = 2.0900e-04
Loss = 2.4867e-01, PNorm = 76.5106, GNorm = 1.2486, lr_0 = 2.0295e-04
Loss = 2.6379e-01, PNorm = 76.5360, GNorm = 1.2234, lr_0 = 1.9708e-04
Loss = 1.0481e-01, PNorm = 76.5393, GNorm = 1.4577, lr_0 = 1.9650e-04
Validation prc-auc = 0.450466
Validation auc = 0.713265
Epoch 21
Loss = 2.7244e-01, PNorm = 76.5704, GNorm = 0.9442, lr_0 = 1.9081e-04
Loss = 2.2189e-01, PNorm = 76.6022, GNorm = 1.3387, lr_0 = 1.8529e-04
Validation prc-auc = 0.431962
Validation auc = 0.696122
Epoch 22
Loss = 2.2044e-01, PNorm = 76.6225, GNorm = 1.0948, lr_0 = 1.7993e-04
Loss = 2.1137e-01, PNorm = 76.6488, GNorm = 0.6616, lr_0 = 1.7472e-04
Loss = 2.5474e-01, PNorm = 76.6728, GNorm = 1.0953, lr_0 = 1.6966e-04
Validation prc-auc = 0.450131
Validation auc = 0.733878
Epoch 23
Loss = 2.4610e-01, PNorm = 76.6980, GNorm = 1.6672, lr_0 = 1.6427e-04
Loss = 2.3542e-01, PNorm = 76.7165, GNorm = 1.2897, lr_0 = 1.5952e-04
Loss = 2.4424e-01, PNorm = 76.7400, GNorm = 1.0061, lr_0 = 1.5490e-04
Validation prc-auc = 0.437903
Validation auc = 0.708163
Epoch 24
Loss = 2.4966e-01, PNorm = 76.7634, GNorm = 1.2075, lr_0 = 1.4998e-04
Loss = 2.1952e-01, PNorm = 76.7894, GNorm = 1.2053, lr_0 = 1.4563e-04
Loss = 2.2284e-01, PNorm = 76.8080, GNorm = 0.8918, lr_0 = 1.4142e-04
Validation prc-auc = 0.429328
Validation auc = 0.703061
Epoch 25
Loss = 2.0564e-01, PNorm = 76.8275, GNorm = 0.7252, lr_0 = 1.3692e-04
Loss = 2.3743e-01, PNorm = 76.8457, GNorm = 0.8517, lr_0 = 1.3296e-04
Loss = 2.0182e-01, PNorm = 76.8647, GNorm = 0.9094, lr_0 = 1.2911e-04
Validation prc-auc = 0.423938
Validation auc = 0.707347
Epoch 26
Loss = 2.0868e-01, PNorm = 76.8813, GNorm = 1.3314, lr_0 = 1.2501e-04
Loss = 2.4345e-01, PNorm = 76.9013, GNorm = 1.6692, lr_0 = 1.2139e-04
Validation prc-auc = 0.439996
Validation auc = 0.708776
Epoch 27
Loss = 1.1986e-01, PNorm = 76.9219, GNorm = 0.9428, lr_0 = 1.1753e-04
Loss = 1.7089e-01, PNorm = 76.9368, GNorm = 0.7422, lr_0 = 1.1413e-04
Loss = 2.0361e-01, PNorm = 76.9519, GNorm = 1.1258, lr_0 = 1.1083e-04
Validation prc-auc = 0.442671
Validation auc = 0.713469
Epoch 28
Loss = 1.5188e-01, PNorm = 76.9698, GNorm = 0.9429, lr_0 = 1.0730e-04
Loss = 1.8507e-01, PNorm = 76.9835, GNorm = 1.4597, lr_0 = 1.0420e-04
Loss = 2.0452e-01, PNorm = 76.9986, GNorm = 0.9631, lr_0 = 1.0118e-04
Validation prc-auc = 0.431426
Validation auc = 0.699184
Epoch 29
Loss = 1.7599e-01, PNorm = 77.0111, GNorm = 1.4482, lr_0 = 1.0000e-04
Loss = 2.2681e-01, PNorm = 77.0242, GNorm = 1.4245, lr_0 = 1.0000e-04
Loss = 1.9174e-01, PNorm = 77.0390, GNorm = 1.2700, lr_0 = 1.0000e-04
Validation prc-auc = 0.418443
Validation auc = 0.705918
Model 0 best validation prc-auc = 0.510739 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.711764
Model 0 test auc = 0.877319
Ensemble test prc-auc = 0.711764
Ensemble test auc = 0.877319
Fold 13
Splitting data with seed 13
Total scaffolds = 870 | train scaffolds = 657 | val scaffolds = 91 | test scaffolds = 122
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.3566e-01, PNorm = 72.7637, GNorm = 0.6111, lr_0 = 1.0000e-03
Loss = 4.6413e-01, PNorm = 73.1604, GNorm = 0.7982, lr_0 = 1.0000e-03
Validation prc-auc = 0.449130
Validation auc = 0.661035
Epoch 1
Loss = 4.9027e-01, PNorm = 73.3943, GNorm = 0.5322, lr_0 = 1.0000e-03
Loss = 3.9137e-01, PNorm = 73.5267, GNorm = 0.5311, lr_0 = 1.0000e-03
Loss = 4.3602e-01, PNorm = 73.6089, GNorm = 0.7918, lr_0 = 1.0000e-03
Validation prc-auc = 0.450089
Validation auc = 0.634543
Epoch 2
Loss = 4.1721e-01, PNorm = 73.6763, GNorm = 0.4756, lr_0 = 9.7965e-04
Loss = 4.5541e-01, PNorm = 73.7303, GNorm = 1.0641, lr_0 = 9.5130e-04
Loss = 4.1282e-01, PNorm = 73.7871, GNorm = 0.8993, lr_0 = 9.2376e-04
Validation prc-auc = 0.495867
Validation auc = 0.670421
Epoch 3
Loss = 4.1524e-01, PNorm = 73.8422, GNorm = 0.5095, lr_0 = 8.9440e-04
Loss = 3.5964e-01, PNorm = 73.9034, GNorm = 0.7602, lr_0 = 8.6851e-04
Loss = 4.2822e-01, PNorm = 73.9583, GNorm = 0.7119, lr_0 = 8.4337e-04
Validation prc-auc = 0.476735
Validation auc = 0.684606
Epoch 4
Loss = 3.6367e-01, PNorm = 74.0367, GNorm = 0.9959, lr_0 = 8.1656e-04
Loss = 3.9600e-01, PNorm = 74.1015, GNorm = 0.5760, lr_0 = 7.9293e-04
Loss = 4.1857e-01, PNorm = 74.1668, GNorm = 1.0154, lr_0 = 7.6998e-04
Loss = 2.7102e-01, PNorm = 74.1751, GNorm = 1.8815, lr_0 = 7.6772e-04
Validation prc-auc = 0.457984
Validation auc = 0.680851
Epoch 5
Loss = 3.9912e-01, PNorm = 74.2345, GNorm = 0.5760, lr_0 = 7.4550e-04
Loss = 3.9769e-01, PNorm = 74.3046, GNorm = 0.5660, lr_0 = 7.2393e-04
Validation prc-auc = 0.472876
Validation auc = 0.704005
Epoch 6
Loss = 3.4433e-01, PNorm = 74.3765, GNorm = 0.9540, lr_0 = 7.0091e-04
Loss = 3.8155e-01, PNorm = 74.4430, GNorm = 0.6507, lr_0 = 6.8063e-04
Loss = 4.0249e-01, PNorm = 74.4996, GNorm = 0.5375, lr_0 = 6.6093e-04
Validation prc-auc = 0.469220
Validation auc = 0.721110
Epoch 7
Loss = 3.8818e-01, PNorm = 74.5637, GNorm = 0.6315, lr_0 = 6.3992e-04
Loss = 3.7964e-01, PNorm = 74.6403, GNorm = 0.8881, lr_0 = 6.2139e-04
Loss = 3.7047e-01, PNorm = 74.7008, GNorm = 0.6342, lr_0 = 6.0341e-04
Validation prc-auc = 0.464099
Validation auc = 0.703379
Epoch 8
Loss = 3.1186e-01, PNorm = 74.7686, GNorm = 0.6212, lr_0 = 5.8595e-04
Loss = 3.4712e-01, PNorm = 74.8308, GNorm = 0.5861, lr_0 = 5.6899e-04
Loss = 3.5844e-01, PNorm = 74.8910, GNorm = 0.7458, lr_0 = 5.5252e-04
Validation prc-auc = 0.432645
Validation auc = 0.703588
Epoch 9
Loss = 4.1128e-01, PNorm = 74.9563, GNorm = 1.0646, lr_0 = 5.3495e-04
Loss = 3.4357e-01, PNorm = 75.0266, GNorm = 0.5141, lr_0 = 5.1947e-04
Loss = 3.5357e-01, PNorm = 75.0767, GNorm = 0.7013, lr_0 = 5.0444e-04
Validation prc-auc = 0.478097
Validation auc = 0.708594
Epoch 10
Loss = 3.3773e-01, PNorm = 75.1333, GNorm = 0.5831, lr_0 = 4.8840e-04
Loss = 3.5605e-01, PNorm = 75.1843, GNorm = 0.5415, lr_0 = 4.7426e-04
Validation prc-auc = 0.493184
Validation auc = 0.732791
Epoch 11
Loss = 1.4392e-01, PNorm = 75.2406, GNorm = 0.6785, lr_0 = 4.5919e-04
Loss = 3.3893e-01, PNorm = 75.2943, GNorm = 0.9496, lr_0 = 4.4590e-04
Loss = 3.5744e-01, PNorm = 75.3453, GNorm = 0.8731, lr_0 = 4.3299e-04
Validation prc-auc = 0.473518
Validation auc = 0.717772
Epoch 12
Loss = 2.5210e-01, PNorm = 75.4028, GNorm = 0.7339, lr_0 = 4.1923e-04
Loss = 3.0352e-01, PNorm = 75.4538, GNorm = 0.9717, lr_0 = 4.0709e-04
Loss = 3.5072e-01, PNorm = 75.4903, GNorm = 0.7703, lr_0 = 3.9531e-04
Validation prc-auc = 0.475905
Validation auc = 0.731748
Epoch 13
Loss = 2.9717e-01, PNorm = 75.5434, GNorm = 0.7322, lr_0 = 3.8274e-04
Loss = 3.2293e-01, PNorm = 75.5957, GNorm = 0.9479, lr_0 = 3.7167e-04
Loss = 3.2973e-01, PNorm = 75.6449, GNorm = 0.7689, lr_0 = 3.6091e-04
Validation prc-auc = 0.488840
Validation auc = 0.744681
Epoch 14
Loss = 3.4561e-01, PNorm = 75.7012, GNorm = 1.0067, lr_0 = 3.4944e-04
Loss = 2.8409e-01, PNorm = 75.7512, GNorm = 0.7794, lr_0 = 3.3932e-04
Loss = 3.0231e-01, PNorm = 75.7963, GNorm = 0.8347, lr_0 = 3.2950e-04
Validation prc-auc = 0.465490
Validation auc = 0.702753
Epoch 15
Loss = 2.9678e-01, PNorm = 75.8397, GNorm = 0.8707, lr_0 = 3.1996e-04
Loss = 2.3016e-01, PNorm = 75.8849, GNorm = 0.9251, lr_0 = 3.1070e-04
Loss = 3.3113e-01, PNorm = 75.9216, GNorm = 1.4739, lr_0 = 3.0171e-04
Loss = 9.1464e-02, PNorm = 75.9261, GNorm = 1.0964, lr_0 = 3.0083e-04
Validation prc-auc = 0.491999
Validation auc = 0.738006
Epoch 16
Loss = 2.3236e-01, PNorm = 75.9695, GNorm = 0.8027, lr_0 = 2.9212e-04
Loss = 3.0515e-01, PNorm = 76.0045, GNorm = 0.9500, lr_0 = 2.8367e-04
Validation prc-auc = 0.501109
Validation auc = 0.750313
Epoch 17
Loss = 2.5702e-01, PNorm = 76.0539, GNorm = 1.0793, lr_0 = 2.7465e-04
Loss = 2.1807e-01, PNorm = 76.1025, GNorm = 0.8248, lr_0 = 2.6670e-04
Loss = 2.9279e-01, PNorm = 76.1312, GNorm = 0.9604, lr_0 = 2.5898e-04
Validation prc-auc = 0.462945
Validation auc = 0.747601
Epoch 18
Loss = 2.6709e-01, PNorm = 76.1671, GNorm = 1.1754, lr_0 = 2.5075e-04
Loss = 2.5679e-01, PNorm = 76.2041, GNorm = 0.6118, lr_0 = 2.4349e-04
Loss = 2.8537e-01, PNorm = 76.2385, GNorm = 0.9266, lr_0 = 2.3644e-04
Validation prc-auc = 0.495869
Validation auc = 0.756988
Epoch 19
Loss = 2.1246e-01, PNorm = 76.2773, GNorm = 0.9247, lr_0 = 2.2893e-04
Loss = 2.5951e-01, PNorm = 76.3121, GNorm = 1.2767, lr_0 = 2.2230e-04
Loss = 2.6482e-01, PNorm = 76.3451, GNorm = 1.3959, lr_0 = 2.1587e-04
Validation prc-auc = 0.465798
Validation auc = 0.751356
Epoch 20
Loss = 2.2128e-01, PNorm = 76.3750, GNorm = 1.1463, lr_0 = 2.0900e-04
Loss = 2.5952e-01, PNorm = 76.3977, GNorm = 1.3178, lr_0 = 2.0295e-04
Loss = 2.6315e-01, PNorm = 76.4265, GNorm = 0.9642, lr_0 = 1.9708e-04
Loss = 2.2686e-01, PNorm = 76.4304, GNorm = 2.7146, lr_0 = 1.9650e-04
Validation prc-auc = 0.444629
Validation auc = 0.747601
Epoch 21
Loss = 2.7126e-01, PNorm = 76.4617, GNorm = 1.1912, lr_0 = 1.9081e-04
Loss = 2.0339e-01, PNorm = 76.4946, GNorm = 0.9019, lr_0 = 1.8529e-04
Validation prc-auc = 0.437691
Validation auc = 0.744472
Epoch 22
Loss = 3.1069e-01, PNorm = 76.5174, GNorm = 1.3137, lr_0 = 1.7993e-04
Loss = 2.3593e-01, PNorm = 76.5405, GNorm = 0.9966, lr_0 = 1.7472e-04
Loss = 2.0541e-01, PNorm = 76.5644, GNorm = 1.0051, lr_0 = 1.6966e-04
Validation prc-auc = 0.439207
Validation auc = 0.749270
Epoch 23
Loss = 1.7721e-01, PNorm = 76.5914, GNorm = 0.9164, lr_0 = 1.6427e-04
Loss = 2.3970e-01, PNorm = 76.6176, GNorm = 1.6598, lr_0 = 1.5952e-04
Loss = 2.3330e-01, PNorm = 76.6382, GNorm = 0.8595, lr_0 = 1.5490e-04
Validation prc-auc = 0.448090
Validation auc = 0.737589
Epoch 24
Loss = 2.2346e-01, PNorm = 76.6574, GNorm = 0.7477, lr_0 = 1.4998e-04
Loss = 2.0908e-01, PNorm = 76.6756, GNorm = 0.9916, lr_0 = 1.4563e-04
Loss = 2.4032e-01, PNorm = 76.6947, GNorm = 1.1811, lr_0 = 1.4142e-04
Validation prc-auc = 0.453367
Validation auc = 0.745932
Epoch 25
Loss = 1.8821e-01, PNorm = 76.7172, GNorm = 0.9331, lr_0 = 1.3692e-04
Loss = 2.3551e-01, PNorm = 76.7314, GNorm = 1.1078, lr_0 = 1.3296e-04
Loss = 2.2120e-01, PNorm = 76.7487, GNorm = 1.1986, lr_0 = 1.2911e-04
Validation prc-auc = 0.457721
Validation auc = 0.747810
Epoch 26
Loss = 2.1834e-01, PNorm = 76.7644, GNorm = 1.3833, lr_0 = 1.2501e-04
Loss = 2.0277e-01, PNorm = 76.7847, GNorm = 0.8400, lr_0 = 1.2139e-04
Validation prc-auc = 0.455719
Validation auc = 0.750104
Epoch 27
Loss = 1.7046e-01, PNorm = 76.7999, GNorm = 1.1031, lr_0 = 1.1753e-04
Loss = 2.2026e-01, PNorm = 76.8106, GNorm = 1.1739, lr_0 = 1.1413e-04
Loss = 2.1811e-01, PNorm = 76.8223, GNorm = 1.2418, lr_0 = 1.1083e-04
Validation prc-auc = 0.397156
Validation auc = 0.742804
Epoch 28
Loss = 2.1371e-01, PNorm = 76.8382, GNorm = 1.2187, lr_0 = 1.0730e-04
Loss = 2.1598e-01, PNorm = 76.8484, GNorm = 1.3815, lr_0 = 1.0420e-04
Loss = 1.9198e-01, PNorm = 76.8616, GNorm = 0.8312, lr_0 = 1.0118e-04
Validation prc-auc = 0.415902
Validation auc = 0.757822
Epoch 29
Loss = 1.9022e-01, PNorm = 76.8742, GNorm = 0.9293, lr_0 = 1.0000e-04
Loss = 2.2233e-01, PNorm = 76.8851, GNorm = 0.9610, lr_0 = 1.0000e-04
Loss = 1.8973e-01, PNorm = 76.8971, GNorm = 1.0230, lr_0 = 1.0000e-04
Validation prc-auc = 0.427207
Validation auc = 0.742178
Model 0 best validation prc-auc = 0.501109 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.636175
Model 0 test auc = 0.821336
Ensemble test prc-auc = 0.636175
Ensemble test auc = 0.821336
Fold 14
Splitting data with seed 14
Total scaffolds = 870 | train scaffolds = 638 | val scaffolds = 97 | test scaffolds = 135
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 8.4122e-01, PNorm = 72.7607, GNorm = 1.5145, lr_0 = 1.0000e-03
Loss = 4.3113e-01, PNorm = 73.1623, GNorm = 0.4831, lr_0 = 1.0000e-03
Validation prc-auc = 0.407413
Validation auc = 0.702962
Epoch 1
Loss = 4.7134e-01, PNorm = 73.3944, GNorm = 0.5936, lr_0 = 1.0000e-03
Loss = 5.0177e-01, PNorm = 73.5129, GNorm = 0.7318, lr_0 = 1.0000e-03
Loss = 4.2422e-01, PNorm = 73.6023, GNorm = 0.5503, lr_0 = 1.0000e-03
Validation prc-auc = 0.439245
Validation auc = 0.699625
Epoch 2
Loss = 3.6415e-01, PNorm = 73.6769, GNorm = 0.5172, lr_0 = 9.7965e-04
Loss = 4.6926e-01, PNorm = 73.7263, GNorm = 0.5359, lr_0 = 9.5130e-04
Loss = 4.3602e-01, PNorm = 73.7758, GNorm = 0.5267, lr_0 = 9.2376e-04
Validation prc-auc = 0.441588
Validation auc = 0.703171
Epoch 3
Loss = 4.3378e-01, PNorm = 73.8329, GNorm = 0.8413, lr_0 = 8.9440e-04
Loss = 3.9375e-01, PNorm = 73.8943, GNorm = 1.2971, lr_0 = 8.6851e-04
Loss = 3.7632e-01, PNorm = 73.9450, GNorm = 0.9563, lr_0 = 8.4337e-04
Validation prc-auc = 0.437434
Validation auc = 0.674593
Epoch 4
Loss = 3.9810e-01, PNorm = 74.0138, GNorm = 0.6373, lr_0 = 8.1656e-04
Loss = 3.5371e-01, PNorm = 74.0761, GNorm = 0.7176, lr_0 = 7.9293e-04
Loss = 4.1831e-01, PNorm = 74.1352, GNorm = 1.0832, lr_0 = 7.6998e-04
Loss = 4.0834e-01, PNorm = 74.1408, GNorm = 1.6742, lr_0 = 7.6772e-04
Validation prc-auc = 0.442352
Validation auc = 0.680225
Epoch 5
Loss = 3.9384e-01, PNorm = 74.2126, GNorm = 0.9855, lr_0 = 7.4550e-04
Loss = 3.8835e-01, PNorm = 74.2786, GNorm = 1.0345, lr_0 = 7.2393e-04
Validation prc-auc = 0.437759
Validation auc = 0.667292
Epoch 6
Loss = 2.9515e-01, PNorm = 74.3507, GNorm = 0.4485, lr_0 = 7.0091e-04
Loss = 4.0158e-01, PNorm = 74.4161, GNorm = 0.6256, lr_0 = 6.8063e-04
Loss = 3.7901e-01, PNorm = 74.4813, GNorm = 1.0775, lr_0 = 6.6093e-04
Validation prc-auc = 0.428725
Validation auc = 0.699207
Epoch 7
Loss = 3.7249e-01, PNorm = 74.5465, GNorm = 0.6484, lr_0 = 6.3992e-04
Loss = 3.6997e-01, PNorm = 74.6134, GNorm = 0.6723, lr_0 = 6.2139e-04
Loss = 3.5018e-01, PNorm = 74.6801, GNorm = 0.9001, lr_0 = 6.0341e-04
Validation prc-auc = 0.414658
Validation auc = 0.692115
Epoch 8
Loss = 4.6434e-01, PNorm = 74.7373, GNorm = 0.6371, lr_0 = 5.8595e-04
Loss = 3.5664e-01, PNorm = 74.8083, GNorm = 1.4664, lr_0 = 5.6899e-04
Loss = 3.6686e-01, PNorm = 74.8639, GNorm = 0.7116, lr_0 = 5.5252e-04
Validation prc-auc = 0.400271
Validation auc = 0.665415
Epoch 9
Loss = 3.5496e-01, PNorm = 74.9339, GNorm = 0.8136, lr_0 = 5.3495e-04
Loss = 3.4015e-01, PNorm = 74.9905, GNorm = 0.8410, lr_0 = 5.1947e-04
Loss = 3.4316e-01, PNorm = 75.0465, GNorm = 0.7675, lr_0 = 5.0444e-04
Validation prc-auc = 0.415987
Validation auc = 0.678348
Epoch 10
Loss = 3.3460e-01, PNorm = 75.1057, GNorm = 0.8248, lr_0 = 4.8840e-04
Loss = 3.1380e-01, PNorm = 75.1652, GNorm = 0.5992, lr_0 = 4.7426e-04
Validation prc-auc = 0.401831
Validation auc = 0.674593
Epoch 11
Loss = 2.6825e-01, PNorm = 75.2172, GNorm = 0.6267, lr_0 = 4.5919e-04
Loss = 3.0529e-01, PNorm = 75.2798, GNorm = 0.7791, lr_0 = 4.4590e-04
Loss = 3.3510e-01, PNorm = 75.3340, GNorm = 0.8001, lr_0 = 4.3299e-04
Validation prc-auc = 0.378651
Validation auc = 0.671882
Epoch 12
Loss = 2.4643e-01, PNorm = 75.4060, GNorm = 0.7853, lr_0 = 4.1923e-04
Loss = 3.2196e-01, PNorm = 75.4618, GNorm = 0.9086, lr_0 = 4.0709e-04
Loss = 3.0270e-01, PNorm = 75.5199, GNorm = 1.0823, lr_0 = 3.9531e-04
Validation prc-auc = 0.406085
Validation auc = 0.679599
Epoch 13
Loss = 3.2741e-01, PNorm = 75.5782, GNorm = 1.4915, lr_0 = 3.8274e-04
Loss = 3.0296e-01, PNorm = 75.6306, GNorm = 0.8229, lr_0 = 3.7167e-04
Loss = 3.0345e-01, PNorm = 75.6845, GNorm = 1.5917, lr_0 = 3.6091e-04
Validation prc-auc = 0.350118
Validation auc = 0.688569
Epoch 14
Loss = 2.9568e-01, PNorm = 75.7338, GNorm = 0.8274, lr_0 = 3.4944e-04
Loss = 2.8874e-01, PNorm = 75.7829, GNorm = 0.7703, lr_0 = 3.3932e-04
Loss = 3.2775e-01, PNorm = 75.8310, GNorm = 0.6102, lr_0 = 3.2950e-04
Validation prc-auc = 0.405825
Validation auc = 0.657280
Epoch 15
Loss = 3.2339e-01, PNorm = 75.8707, GNorm = 0.7436, lr_0 = 3.1996e-04
Loss = 2.4178e-01, PNorm = 75.9162, GNorm = 0.6321, lr_0 = 3.1070e-04
Loss = 2.9075e-01, PNorm = 75.9563, GNorm = 1.0966, lr_0 = 3.0171e-04
Loss = 7.5677e-02, PNorm = 75.9614, GNorm = 0.9119, lr_0 = 3.0083e-04
Validation prc-auc = 0.360196
Validation auc = 0.652274
Epoch 16
Loss = 2.4395e-01, PNorm = 76.0047, GNorm = 0.6557, lr_0 = 2.9212e-04
Loss = 2.7729e-01, PNorm = 76.0480, GNorm = 1.1076, lr_0 = 2.8367e-04
Validation prc-auc = 0.373665
Validation auc = 0.646224
Epoch 17
Loss = 2.9426e-01, PNorm = 76.0874, GNorm = 0.8963, lr_0 = 2.7465e-04
Loss = 2.9590e-01, PNorm = 76.1358, GNorm = 1.4115, lr_0 = 2.6670e-04
Loss = 2.6854e-01, PNorm = 76.1739, GNorm = 0.8747, lr_0 = 2.5898e-04
Validation prc-auc = 0.381600
Validation auc = 0.627660
Epoch 18
Loss = 3.1495e-01, PNorm = 76.2175, GNorm = 1.2488, lr_0 = 2.5075e-04
Loss = 2.3981e-01, PNorm = 76.2511, GNorm = 0.7853, lr_0 = 2.4349e-04
Loss = 2.4916e-01, PNorm = 76.2836, GNorm = 0.6875, lr_0 = 2.3644e-04
Validation prc-auc = 0.338489
Validation auc = 0.651856
Epoch 19
Loss = 2.2596e-01, PNorm = 76.3233, GNorm = 0.9653, lr_0 = 2.2893e-04
Loss = 2.2438e-01, PNorm = 76.3498, GNorm = 0.8733, lr_0 = 2.2230e-04
Loss = 2.6109e-01, PNorm = 76.3783, GNorm = 0.8866, lr_0 = 2.1587e-04
Validation prc-auc = 0.357067
Validation auc = 0.638298
Epoch 20
Loss = 2.2866e-01, PNorm = 76.4161, GNorm = 0.8113, lr_0 = 2.0900e-04
Loss = 2.4123e-01, PNorm = 76.4440, GNorm = 0.6639, lr_0 = 2.0295e-04
Loss = 2.7815e-01, PNorm = 76.4696, GNorm = 1.2510, lr_0 = 1.9708e-04
Loss = 1.4698e-01, PNorm = 76.4723, GNorm = 1.8379, lr_0 = 1.9650e-04
Validation prc-auc = 0.373354
Validation auc = 0.635795
Epoch 21
Loss = 1.7711e-01, PNorm = 76.4993, GNorm = 0.9062, lr_0 = 1.9081e-04
Loss = 2.5559e-01, PNorm = 76.5248, GNorm = 1.0995, lr_0 = 1.8529e-04
Validation prc-auc = 0.371664
Validation auc = 0.625365
Epoch 22
Loss = 1.8096e-01, PNorm = 76.5476, GNorm = 1.0297, lr_0 = 1.7993e-04
Loss = 2.7337e-01, PNorm = 76.5677, GNorm = 0.8896, lr_0 = 1.7472e-04
Loss = 2.4359e-01, PNorm = 76.5939, GNorm = 0.8988, lr_0 = 1.6966e-04
Validation prc-auc = 0.363897
Validation auc = 0.630788
Epoch 23
Loss = 1.7238e-01, PNorm = 76.6183, GNorm = 1.1684, lr_0 = 1.6427e-04
Loss = 2.2275e-01, PNorm = 76.6342, GNorm = 1.1806, lr_0 = 1.5952e-04
Loss = 2.6109e-01, PNorm = 76.6522, GNorm = 1.1103, lr_0 = 1.5490e-04
Validation prc-auc = 0.334216
Validation auc = 0.644764
Epoch 24
Loss = 2.6702e-01, PNorm = 76.6701, GNorm = 1.7134, lr_0 = 1.4998e-04
Loss = 2.4293e-01, PNorm = 76.6908, GNorm = 1.3426, lr_0 = 1.4563e-04
Loss = 2.4539e-01, PNorm = 76.7082, GNorm = 1.4602, lr_0 = 1.4142e-04
Validation prc-auc = 0.355160
Validation auc = 0.614935
Epoch 25
Loss = 2.4091e-01, PNorm = 76.7301, GNorm = 1.6950, lr_0 = 1.3692e-04
Loss = 2.2560e-01, PNorm = 76.7456, GNorm = 1.2126, lr_0 = 1.3296e-04
Loss = 2.0897e-01, PNorm = 76.7663, GNorm = 1.2994, lr_0 = 1.2911e-04
Validation prc-auc = 0.359351
Validation auc = 0.624531
Epoch 26
Loss = 2.1609e-01, PNorm = 76.7827, GNorm = 0.7543, lr_0 = 1.2501e-04
Loss = 1.9040e-01, PNorm = 76.7965, GNorm = 1.1461, lr_0 = 1.2139e-04
Validation prc-auc = 0.368338
Validation auc = 0.620985
Epoch 27
Loss = 3.6891e-01, PNorm = 76.8160, GNorm = 1.5936, lr_0 = 1.1753e-04
Loss = 1.8279e-01, PNorm = 76.8292, GNorm = 1.4938, lr_0 = 1.1413e-04
Loss = 2.0293e-01, PNorm = 76.8408, GNorm = 1.0954, lr_0 = 1.1083e-04
Validation prc-auc = 0.366110
Validation auc = 0.610555
Epoch 28
Loss = 2.3561e-01, PNorm = 76.8546, GNorm = 1.2896, lr_0 = 1.0730e-04
Loss = 1.9226e-01, PNorm = 76.8653, GNorm = 1.6131, lr_0 = 1.0420e-04
Loss = 1.7798e-01, PNorm = 76.8784, GNorm = 1.0363, lr_0 = 1.0118e-04
Validation prc-auc = 0.334120
Validation auc = 0.611806
Epoch 29
Loss = 1.5263e-01, PNorm = 76.8912, GNorm = 1.3262, lr_0 = 1.0000e-04
Loss = 2.1543e-01, PNorm = 76.9004, GNorm = 1.1510, lr_0 = 1.0000e-04
Loss = 2.0886e-01, PNorm = 76.9123, GNorm = 1.1609, lr_0 = 1.0000e-04
Validation prc-auc = 0.348398
Validation auc = 0.625574
Model 0 best validation prc-auc = 0.442352 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.660523
Model 0 test auc = 0.827883
Ensemble test prc-auc = 0.660523
Ensemble test auc = 0.827883
Fold 15
Splitting data with seed 15
Total scaffolds = 870 | train scaffolds = 639 | val scaffolds = 116 | test scaffolds = 115
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 5.5814e-01, PNorm = 72.7557, GNorm = 0.6394, lr_0 = 1.0000e-03
Loss = 4.7843e-01, PNorm = 73.1484, GNorm = 0.9878, lr_0 = 1.0000e-03
Validation prc-auc = 0.363730
Validation auc = 0.673611
Epoch 1
Loss = 4.1603e-01, PNorm = 73.3897, GNorm = 0.6907, lr_0 = 1.0000e-03
Loss = 4.1497e-01, PNorm = 73.5222, GNorm = 0.7322, lr_0 = 1.0000e-03
Loss = 4.5058e-01, PNorm = 73.6106, GNorm = 1.4029, lr_0 = 1.0000e-03
Validation prc-auc = 0.382378
Validation auc = 0.708109
Epoch 2
Loss = 3.9985e-01, PNorm = 73.6979, GNorm = 1.2985, lr_0 = 9.7965e-04
Loss = 4.0362e-01, PNorm = 73.7739, GNorm = 1.3820, lr_0 = 9.5130e-04
Loss = 4.1361e-01, PNorm = 73.8368, GNorm = 0.9386, lr_0 = 9.2376e-04
Validation prc-auc = 0.365049
Validation auc = 0.687948
Epoch 3
Loss = 4.5501e-01, PNorm = 73.9087, GNorm = 0.9712, lr_0 = 8.9440e-04
Loss = 4.1281e-01, PNorm = 73.9775, GNorm = 0.6468, lr_0 = 8.6851e-04
Loss = 4.1223e-01, PNorm = 74.0326, GNorm = 0.7334, lr_0 = 8.4337e-04
Validation prc-auc = 0.371159
Validation auc = 0.695116
Epoch 4
Loss = 3.2158e-01, PNorm = 74.1122, GNorm = 0.5699, lr_0 = 8.1656e-04
Loss = 3.7627e-01, PNorm = 74.1844, GNorm = 0.5164, lr_0 = 7.9293e-04
Loss = 4.3855e-01, PNorm = 74.2462, GNorm = 0.5463, lr_0 = 7.6998e-04
Loss = 5.8541e-01, PNorm = 74.2537, GNorm = 1.8360, lr_0 = 7.6772e-04
Validation prc-auc = 0.405120
Validation auc = 0.721326
Epoch 5
Loss = 3.8701e-01, PNorm = 74.3273, GNorm = 0.7765, lr_0 = 7.4550e-04
Loss = 3.7845e-01, PNorm = 74.4007, GNorm = 0.5094, lr_0 = 7.2393e-04
Validation prc-auc = 0.415974
Validation auc = 0.713486
Epoch 6
Loss = 3.4678e-01, PNorm = 74.4728, GNorm = 0.9153, lr_0 = 7.0091e-04
Loss = 3.7356e-01, PNorm = 74.5311, GNorm = 0.5113, lr_0 = 6.8063e-04
Loss = 3.6486e-01, PNorm = 74.6062, GNorm = 0.5537, lr_0 = 6.6093e-04
Validation prc-auc = 0.380337
Validation auc = 0.677867
Epoch 7
Loss = 4.5463e-01, PNorm = 74.6915, GNorm = 1.2352, lr_0 = 6.3992e-04
Loss = 3.5241e-01, PNorm = 74.7725, GNorm = 1.1247, lr_0 = 6.2139e-04
Loss = 3.5729e-01, PNorm = 74.8348, GNorm = 0.7892, lr_0 = 6.0341e-04
Validation prc-auc = 0.428675
Validation auc = 0.721774
Epoch 8
Loss = 3.8347e-01, PNorm = 74.9082, GNorm = 0.9090, lr_0 = 5.8595e-04
Loss = 3.2869e-01, PNorm = 74.9846, GNorm = 0.5218, lr_0 = 5.6899e-04
Loss = 3.5375e-01, PNorm = 75.0486, GNorm = 0.7167, lr_0 = 5.5252e-04
Validation prc-auc = 0.387243
Validation auc = 0.710797
Epoch 9
Loss = 3.4205e-01, PNorm = 75.1273, GNorm = 0.7728, lr_0 = 5.3495e-04
Loss = 2.9045e-01, PNorm = 75.2112, GNorm = 0.5638, lr_0 = 5.1947e-04
Loss = 3.6505e-01, PNorm = 75.2810, GNorm = 0.9740, lr_0 = 5.0444e-04
Validation prc-auc = 0.392991
Validation auc = 0.715054
Epoch 10
Loss = 3.0220e-01, PNorm = 75.3792, GNorm = 0.8577, lr_0 = 4.8840e-04
Loss = 3.4598e-01, PNorm = 75.4494, GNorm = 0.7197, lr_0 = 4.7426e-04
Validation prc-auc = 0.415313
Validation auc = 0.723790
Epoch 11
Loss = 2.7045e-01, PNorm = 75.5407, GNorm = 0.6956, lr_0 = 4.5919e-04
Loss = 3.0591e-01, PNorm = 75.6225, GNorm = 0.6209, lr_0 = 4.4590e-04
Loss = 3.1484e-01, PNorm = 75.6873, GNorm = 1.2229, lr_0 = 4.3299e-04
Validation prc-auc = 0.373201
Validation auc = 0.699149
Epoch 12
Loss = 3.8237e-01, PNorm = 75.7602, GNorm = 0.6762, lr_0 = 4.1923e-04
Loss = 3.2396e-01, PNorm = 75.8314, GNorm = 0.7217, lr_0 = 4.0709e-04
Loss = 3.2853e-01, PNorm = 75.8957, GNorm = 0.9589, lr_0 = 3.9531e-04
Validation prc-auc = 0.415589
Validation auc = 0.711694
Epoch 13
Loss = 3.2578e-01, PNorm = 75.9677, GNorm = 0.7466, lr_0 = 3.8274e-04
Loss = 3.0355e-01, PNorm = 76.0152, GNorm = 0.7838, lr_0 = 3.7167e-04
Loss = 2.8154e-01, PNorm = 76.0679, GNorm = 0.7133, lr_0 = 3.6091e-04
Validation prc-auc = 0.407010
Validation auc = 0.725358
Epoch 14
Loss = 2.6261e-01, PNorm = 76.1278, GNorm = 1.0623, lr_0 = 3.4944e-04
Loss = 2.9821e-01, PNorm = 76.1844, GNorm = 0.8769, lr_0 = 3.3932e-04
Loss = 3.1112e-01, PNorm = 76.2414, GNorm = 0.9260, lr_0 = 3.2950e-04
Validation prc-auc = 0.374747
Validation auc = 0.724238
Epoch 15
Loss = 2.6416e-01, PNorm = 76.2830, GNorm = 0.6225, lr_0 = 3.1996e-04
Loss = 3.0335e-01, PNorm = 76.3339, GNorm = 0.8341, lr_0 = 3.1070e-04
Loss = 2.6521e-01, PNorm = 76.3685, GNorm = 0.5703, lr_0 = 3.0171e-04
Loss = 1.9847e-01, PNorm = 76.3724, GNorm = 2.1596, lr_0 = 3.0083e-04
Validation prc-auc = 0.442132
Validation auc = 0.733423
Epoch 16
Loss = 2.4890e-01, PNorm = 76.4233, GNorm = 0.8460, lr_0 = 2.9212e-04
Loss = 3.0020e-01, PNorm = 76.4675, GNorm = 0.6406, lr_0 = 2.8367e-04
Validation prc-auc = 0.421136
Validation auc = 0.731631
Epoch 17
Loss = 1.6262e-01, PNorm = 76.5180, GNorm = 0.6204, lr_0 = 2.7465e-04
Loss = 2.4710e-01, PNorm = 76.5597, GNorm = 1.7143, lr_0 = 2.6670e-04
Loss = 3.0341e-01, PNorm = 76.6098, GNorm = 1.2567, lr_0 = 2.5898e-04
Validation prc-auc = 0.414753
Validation auc = 0.749552
Epoch 18
Loss = 2.7162e-01, PNorm = 76.6533, GNorm = 0.8545, lr_0 = 2.5075e-04
Loss = 2.6090e-01, PNorm = 76.6934, GNorm = 1.1870, lr_0 = 2.4349e-04
Loss = 2.3769e-01, PNorm = 76.7334, GNorm = 0.8408, lr_0 = 2.3644e-04
Validation prc-auc = 0.412878
Validation auc = 0.719758
Epoch 19
Loss = 2.1774e-01, PNorm = 76.7760, GNorm = 0.4681, lr_0 = 2.2893e-04
Loss = 2.4686e-01, PNorm = 76.8122, GNorm = 1.8977, lr_0 = 2.2230e-04
Loss = 2.4322e-01, PNorm = 76.8473, GNorm = 1.2319, lr_0 = 2.1587e-04
Validation prc-auc = 0.394850
Validation auc = 0.710125
Epoch 20
Loss = 2.1273e-01, PNorm = 76.8766, GNorm = 0.6729, lr_0 = 2.0900e-04
Loss = 2.1370e-01, PNorm = 76.9172, GNorm = 1.0076, lr_0 = 2.0295e-04
Loss = 2.9234e-01, PNorm = 76.9406, GNorm = 1.2672, lr_0 = 1.9708e-04
Loss = 4.1342e-01, PNorm = 76.9428, GNorm = 3.6491, lr_0 = 1.9650e-04
Validation prc-auc = 0.426941
Validation auc = 0.739695
Epoch 21
Loss = 2.2084e-01, PNorm = 76.9737, GNorm = 0.7708, lr_0 = 1.9081e-04
Loss = 2.4356e-01, PNorm = 77.0021, GNorm = 0.9002, lr_0 = 1.8529e-04
Validation prc-auc = 0.407410
Validation auc = 0.726254
Epoch 22
Loss = 1.3799e-01, PNorm = 77.0321, GNorm = 0.7711, lr_0 = 1.7993e-04
Loss = 2.3272e-01, PNorm = 77.0626, GNorm = 1.2279, lr_0 = 1.7472e-04
Loss = 2.2586e-01, PNorm = 77.0876, GNorm = 0.7432, lr_0 = 1.6966e-04
Validation prc-auc = 0.406435
Validation auc = 0.730063
Epoch 23
Loss = 1.5989e-01, PNorm = 77.1102, GNorm = 0.8989, lr_0 = 1.6427e-04
Loss = 2.0119e-01, PNorm = 77.1379, GNorm = 1.1065, lr_0 = 1.5952e-04
Loss = 2.3528e-01, PNorm = 77.1566, GNorm = 1.1900, lr_0 = 1.5490e-04
Validation prc-auc = 0.402235
Validation auc = 0.718862
Epoch 24
Loss = 2.1093e-01, PNorm = 77.1755, GNorm = 1.1656, lr_0 = 1.4998e-04
Loss = 2.2639e-01, PNorm = 77.1974, GNorm = 0.8809, lr_0 = 1.4563e-04
Loss = 2.1349e-01, PNorm = 77.2214, GNorm = 2.7507, lr_0 = 1.4142e-04
Validation prc-auc = 0.438113
Validation auc = 0.718862
Epoch 25
Loss = 1.8709e-01, PNorm = 77.2402, GNorm = 1.0813, lr_0 = 1.3692e-04
Loss = 2.0095e-01, PNorm = 77.2552, GNorm = 1.0545, lr_0 = 1.3296e-04
Loss = 1.9014e-01, PNorm = 77.2723, GNorm = 1.2664, lr_0 = 1.2911e-04
Validation prc-auc = 0.418173
Validation auc = 0.731183
Epoch 26
Loss = 2.2562e-01, PNorm = 77.2904, GNorm = 1.2822, lr_0 = 1.2501e-04
Loss = 1.8969e-01, PNorm = 77.3060, GNorm = 1.4909, lr_0 = 1.2139e-04
Validation prc-auc = 0.420164
Validation auc = 0.726030
Epoch 27
Loss = 2.4128e-01, PNorm = 77.3234, GNorm = 1.1231, lr_0 = 1.1753e-04
Loss = 1.9118e-01, PNorm = 77.3422, GNorm = 1.2684, lr_0 = 1.1413e-04
Loss = 1.7925e-01, PNorm = 77.3557, GNorm = 1.2590, lr_0 = 1.1083e-04
Validation prc-auc = 0.424376
Validation auc = 0.731183
Epoch 28
Loss = 1.1335e-01, PNorm = 77.3717, GNorm = 1.2009, lr_0 = 1.0730e-04
Loss = 1.5428e-01, PNorm = 77.3851, GNorm = 1.4412, lr_0 = 1.0420e-04
Loss = 2.1784e-01, PNorm = 77.3951, GNorm = 1.0962, lr_0 = 1.0118e-04
Validation prc-auc = 0.408670
Validation auc = 0.728047
Epoch 29
Loss = 1.8083e-01, PNorm = 77.4086, GNorm = 0.9866, lr_0 = 1.0000e-04
Loss = 1.7681e-01, PNorm = 77.4208, GNorm = 1.5475, lr_0 = 1.0000e-04
Loss = 1.6359e-01, PNorm = 77.4326, GNorm = 0.8892, lr_0 = 1.0000e-04
Validation prc-auc = 0.431262
Validation auc = 0.724238
Model 0 best validation prc-auc = 0.442132 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.679604
Model 0 test auc = 0.782194
Ensemble test prc-auc = 0.679604
Ensemble test auc = 0.782194
Fold 16
Splitting data with seed 16
Total scaffolds = 870 | train scaffolds = 648 | val scaffolds = 105 | test scaffolds = 117
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.6165e-01, PNorm = 72.7999, GNorm = 0.5214, lr_0 = 1.0000e-03
Loss = 4.4474e-01, PNorm = 73.2332, GNorm = 0.7702, lr_0 = 1.0000e-03
Validation prc-auc = 0.499241
Validation auc = 0.736842
Epoch 1
Loss = 3.8548e-01, PNorm = 73.4782, GNorm = 0.4872, lr_0 = 1.0000e-03
Loss = 4.4522e-01, PNorm = 73.6010, GNorm = 0.5510, lr_0 = 1.0000e-03
Loss = 4.3162e-01, PNorm = 73.6908, GNorm = 0.5632, lr_0 = 1.0000e-03
Validation prc-auc = 0.534426
Validation auc = 0.748836
Epoch 2
Loss = 3.9141e-01, PNorm = 73.7599, GNorm = 0.5838, lr_0 = 9.7965e-04
Loss = 4.1449e-01, PNorm = 73.8218, GNorm = 0.5793, lr_0 = 9.5130e-04
Loss = 3.8993e-01, PNorm = 73.8826, GNorm = 0.7268, lr_0 = 9.2376e-04
Validation prc-auc = 0.575988
Validation auc = 0.747762
Epoch 3
Loss = 3.3550e-01, PNorm = 73.9514, GNorm = 0.5147, lr_0 = 8.9440e-04
Loss = 4.3453e-01, PNorm = 74.0160, GNorm = 0.8481, lr_0 = 8.6851e-04
Loss = 4.1042e-01, PNorm = 74.0721, GNorm = 0.6718, lr_0 = 8.4337e-04
Validation prc-auc = 0.611288
Validation auc = 0.774078
Epoch 4
Loss = 3.5633e-01, PNorm = 74.1532, GNorm = 0.5409, lr_0 = 8.1656e-04
Loss = 3.9527e-01, PNorm = 74.2073, GNorm = 0.6357, lr_0 = 7.9293e-04
Loss = 4.0501e-01, PNorm = 74.2668, GNorm = 0.5990, lr_0 = 7.6998e-04
Loss = 3.8494e-01, PNorm = 74.2738, GNorm = 1.5711, lr_0 = 7.6772e-04
Validation prc-auc = 0.581194
Validation auc = 0.752954
Epoch 5
Loss = 3.8590e-01, PNorm = 74.3395, GNorm = 0.5579, lr_0 = 7.4550e-04
Loss = 3.9047e-01, PNorm = 74.4014, GNorm = 0.6222, lr_0 = 7.2393e-04
Validation prc-auc = 0.613884
Validation auc = 0.781955
Epoch 6
Loss = 4.3065e-01, PNorm = 74.4624, GNorm = 0.8980, lr_0 = 7.0091e-04
Loss = 3.6932e-01, PNorm = 74.5278, GNorm = 0.4274, lr_0 = 6.8063e-04
Loss = 3.5736e-01, PNorm = 74.5842, GNorm = 0.5967, lr_0 = 6.6093e-04
Validation prc-auc = 0.616921
Validation auc = 0.764590
Epoch 7
Loss = 2.5789e-01, PNorm = 74.6539, GNorm = 0.4585, lr_0 = 6.3992e-04
Loss = 3.8064e-01, PNorm = 74.7042, GNorm = 0.7048, lr_0 = 6.2139e-04
Loss = 3.8031e-01, PNorm = 74.7637, GNorm = 0.5545, lr_0 = 6.0341e-04
Validation prc-auc = 0.666767
Validation auc = 0.794844
Epoch 8
Loss = 3.4295e-01, PNorm = 74.8258, GNorm = 0.6791, lr_0 = 5.8595e-04
Loss = 3.6394e-01, PNorm = 74.8914, GNorm = 1.3866, lr_0 = 5.6899e-04
Loss = 3.4044e-01, PNorm = 74.9457, GNorm = 0.6167, lr_0 = 5.5252e-04
Validation prc-auc = 0.732665
Validation auc = 0.837630
Epoch 9
Loss = 3.9302e-01, PNorm = 75.0079, GNorm = 0.7703, lr_0 = 5.3495e-04
Loss = 3.2600e-01, PNorm = 75.0667, GNorm = 0.5985, lr_0 = 5.1947e-04
Loss = 2.9972e-01, PNorm = 75.1338, GNorm = 0.6194, lr_0 = 5.0444e-04
Validation prc-auc = 0.729604
Validation auc = 0.845686
Epoch 10
Loss = 3.5167e-01, PNorm = 75.2047, GNorm = 0.7012, lr_0 = 4.8840e-04
Loss = 3.3581e-01, PNorm = 75.2637, GNorm = 0.7131, lr_0 = 4.7426e-04
Validation prc-auc = 0.683343
Validation auc = 0.803616
Epoch 11
Loss = 2.5460e-01, PNorm = 75.3336, GNorm = 0.6364, lr_0 = 4.5919e-04
Loss = 3.3835e-01, PNorm = 75.4025, GNorm = 0.6652, lr_0 = 4.4590e-04
Loss = 3.1491e-01, PNorm = 75.4635, GNorm = 0.6288, lr_0 = 4.3299e-04
Validation prc-auc = 0.689591
Validation auc = 0.823487
Epoch 12
Loss = 3.1247e-01, PNorm = 75.5357, GNorm = 0.7143, lr_0 = 4.1923e-04
Loss = 3.2823e-01, PNorm = 75.6007, GNorm = 0.9140, lr_0 = 4.0709e-04
Loss = 3.0252e-01, PNorm = 75.6641, GNorm = 0.6665, lr_0 = 3.9531e-04
Validation prc-auc = 0.693701
Validation auc = 0.812388
Epoch 13
Loss = 3.3193e-01, PNorm = 75.7271, GNorm = 0.7393, lr_0 = 3.8274e-04
Loss = 3.0657e-01, PNorm = 75.7806, GNorm = 1.0117, lr_0 = 3.7167e-04
Loss = 2.7749e-01, PNorm = 75.8420, GNorm = 0.7697, lr_0 = 3.6091e-04
Validation prc-auc = 0.704667
Validation auc = 0.815968
Epoch 14
Loss = 3.0069e-01, PNorm = 75.8994, GNorm = 0.8055, lr_0 = 3.4944e-04
Loss = 3.0246e-01, PNorm = 75.9500, GNorm = 0.8753, lr_0 = 3.3932e-04
Loss = 3.0954e-01, PNorm = 75.9987, GNorm = 0.7605, lr_0 = 3.2950e-04
Validation prc-auc = 0.681361
Validation auc = 0.798425
Epoch 15
Loss = 3.1721e-01, PNorm = 76.0395, GNorm = 0.6652, lr_0 = 3.1996e-04
Loss = 2.4310e-01, PNorm = 76.0810, GNorm = 0.8277, lr_0 = 3.1070e-04
Loss = 2.9744e-01, PNorm = 76.1208, GNorm = 1.0578, lr_0 = 3.0171e-04
Loss = 2.6101e-01, PNorm = 76.1252, GNorm = 1.8139, lr_0 = 3.0083e-04
Validation prc-auc = 0.709258
Validation auc = 0.809882
Epoch 16
Loss = 2.9034e-01, PNorm = 76.1773, GNorm = 0.5773, lr_0 = 2.9212e-04
Loss = 2.7038e-01, PNorm = 76.2159, GNorm = 1.1110, lr_0 = 2.8367e-04
Validation prc-auc = 0.703844
Validation auc = 0.797888
Epoch 17
Loss = 2.9208e-01, PNorm = 76.2552, GNorm = 1.2271, lr_0 = 2.7465e-04
Loss = 2.7015e-01, PNorm = 76.2958, GNorm = 0.9674, lr_0 = 2.6670e-04
Loss = 2.5888e-01, PNorm = 76.3375, GNorm = 1.6432, lr_0 = 2.5898e-04
Validation prc-auc = 0.694512
Validation auc = 0.793770
Epoch 18
Loss = 2.3850e-01, PNorm = 76.3841, GNorm = 1.0654, lr_0 = 2.5075e-04
Loss = 2.6952e-01, PNorm = 76.4180, GNorm = 1.2405, lr_0 = 2.4349e-04
Loss = 2.9272e-01, PNorm = 76.4635, GNorm = 0.8702, lr_0 = 2.3644e-04
Validation prc-auc = 0.694422
Validation auc = 0.780702
Epoch 19
Loss = 2.4481e-01, PNorm = 76.5084, GNorm = 0.8012, lr_0 = 2.2893e-04
Loss = 2.7556e-01, PNorm = 76.5394, GNorm = 1.2539, lr_0 = 2.2230e-04
Loss = 2.4364e-01, PNorm = 76.5775, GNorm = 0.5647, lr_0 = 2.1587e-04
Validation prc-auc = 0.698849
Validation auc = 0.782134
Epoch 20
Loss = 2.4394e-01, PNorm = 76.6094, GNorm = 0.9229, lr_0 = 2.0900e-04
Loss = 2.3896e-01, PNorm = 76.6416, GNorm = 0.8130, lr_0 = 2.0295e-04
Loss = 2.3361e-01, PNorm = 76.6669, GNorm = 0.9731, lr_0 = 1.9708e-04
Loss = 2.9807e-01, PNorm = 76.6700, GNorm = 3.8887, lr_0 = 1.9650e-04
Validation prc-auc = 0.709695
Validation auc = 0.797888
Epoch 21
Loss = 2.9097e-01, PNorm = 76.6940, GNorm = 1.0774, lr_0 = 1.9081e-04
Loss = 2.4539e-01, PNorm = 76.7195, GNorm = 0.7877, lr_0 = 1.8529e-04
Validation prc-auc = 0.710791
Validation auc = 0.791622
Epoch 22
Loss = 2.5704e-01, PNorm = 76.7436, GNorm = 1.5189, lr_0 = 1.7993e-04
Loss = 2.0825e-01, PNorm = 76.7675, GNorm = 0.8790, lr_0 = 1.7472e-04
Loss = 2.3636e-01, PNorm = 76.7973, GNorm = 2.4033, lr_0 = 1.6966e-04
Validation prc-auc = 0.703084
Validation auc = 0.793949
Epoch 23
Loss = 2.3531e-01, PNorm = 76.8143, GNorm = 1.0477, lr_0 = 1.6427e-04
Loss = 2.2841e-01, PNorm = 76.8342, GNorm = 1.1221, lr_0 = 1.5952e-04
Loss = 2.3901e-01, PNorm = 76.8528, GNorm = 1.5728, lr_0 = 1.5490e-04
Validation prc-auc = 0.698191
Validation auc = 0.784998
Epoch 24
Loss = 2.3265e-01, PNorm = 76.8767, GNorm = 1.0362, lr_0 = 1.4998e-04
Loss = 1.9567e-01, PNorm = 76.8929, GNorm = 1.0094, lr_0 = 1.4563e-04
Loss = 2.2451e-01, PNorm = 76.9102, GNorm = 1.2405, lr_0 = 1.4142e-04
Validation prc-auc = 0.672451
Validation auc = 0.761905
Epoch 25
Loss = 2.3319e-01, PNorm = 76.9307, GNorm = 1.3253, lr_0 = 1.3692e-04
Loss = 2.3807e-01, PNorm = 76.9452, GNorm = 1.1263, lr_0 = 1.3296e-04
Loss = 2.0108e-01, PNorm = 76.9636, GNorm = 1.6867, lr_0 = 1.2911e-04
Validation prc-auc = 0.682678
Validation auc = 0.794486
Epoch 26
Loss = 2.0971e-01, PNorm = 76.9826, GNorm = 0.9915, lr_0 = 1.2501e-04
Loss = 1.9138e-01, PNorm = 77.0003, GNorm = 1.7048, lr_0 = 1.2139e-04
Validation prc-auc = 0.666915
Validation auc = 0.771572
Epoch 27
Loss = 2.0001e-01, PNorm = 77.0129, GNorm = 0.9032, lr_0 = 1.1753e-04
Loss = 2.0612e-01, PNorm = 77.0287, GNorm = 0.9466, lr_0 = 1.1413e-04
Loss = 1.7975e-01, PNorm = 77.0462, GNorm = 0.7870, lr_0 = 1.1083e-04
Validation prc-auc = 0.679056
Validation auc = 0.779449
Epoch 28
Loss = 2.1921e-01, PNorm = 77.0551, GNorm = 2.2680, lr_0 = 1.0730e-04
Loss = 2.1416e-01, PNorm = 77.0715, GNorm = 1.3006, lr_0 = 1.0420e-04
Loss = 1.5842e-01, PNorm = 77.0815, GNorm = 0.7715, lr_0 = 1.0118e-04
Validation prc-auc = 0.668191
Validation auc = 0.766022
Epoch 29
Loss = 1.9700e-01, PNorm = 77.0926, GNorm = 1.0158, lr_0 = 1.0000e-04
Loss = 1.9247e-01, PNorm = 77.1094, GNorm = 1.4634, lr_0 = 1.0000e-04
Loss = 1.8247e-01, PNorm = 77.1218, GNorm = 1.1694, lr_0 = 1.0000e-04
Validation prc-auc = 0.655362
Validation auc = 0.760652
Model 0 best validation prc-auc = 0.732665 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.661487
Model 0 test auc = 0.829246
Ensemble test prc-auc = 0.661487
Ensemble test auc = 0.829246
Fold 17
Splitting data with seed 17
Total scaffolds = 870 | train scaffolds = 638 | val scaffolds = 119 | test scaffolds = 113
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.5597e-01, PNorm = 72.7664, GNorm = 0.6343, lr_0 = 1.0000e-03
Loss = 4.4012e-01, PNorm = 73.1707, GNorm = 0.7564, lr_0 = 1.0000e-03
Validation prc-auc = 0.452194
Validation auc = 0.718737
Epoch 1
Loss = 5.5473e-01, PNorm = 73.4152, GNorm = 0.9873, lr_0 = 1.0000e-03
Loss = 4.3005e-01, PNorm = 73.5401, GNorm = 1.1334, lr_0 = 1.0000e-03
Loss = 5.0515e-01, PNorm = 73.6293, GNorm = 1.0509, lr_0 = 1.0000e-03
Validation prc-auc = 0.517314
Validation auc = 0.749040
Epoch 2
Loss = 4.4495e-01, PNorm = 73.7055, GNorm = 0.9409, lr_0 = 9.7965e-04
Loss = 4.3173e-01, PNorm = 73.7731, GNorm = 0.6140, lr_0 = 9.5130e-04
Loss = 4.1338e-01, PNorm = 73.8359, GNorm = 0.6292, lr_0 = 9.2376e-04
Validation prc-auc = 0.521762
Validation auc = 0.749040
Epoch 3
Loss = 4.2776e-01, PNorm = 73.8928, GNorm = 0.7202, lr_0 = 8.9440e-04
Loss = 4.2082e-01, PNorm = 73.9562, GNorm = 0.6720, lr_0 = 8.6851e-04
Loss = 3.9454e-01, PNorm = 74.0187, GNorm = 0.6575, lr_0 = 8.4337e-04
Validation prc-auc = 0.528762
Validation auc = 0.759923
Epoch 4
Loss = 3.8013e-01, PNorm = 74.0822, GNorm = 0.5614, lr_0 = 8.1656e-04
Loss = 4.1291e-01, PNorm = 74.1446, GNorm = 0.5263, lr_0 = 7.9293e-04
Loss = 4.0606e-01, PNorm = 74.2108, GNorm = 0.6180, lr_0 = 7.6998e-04
Loss = 4.7740e-01, PNorm = 74.2176, GNorm = 1.8606, lr_0 = 7.6772e-04
Validation prc-auc = 0.538046
Validation auc = 0.777849
Epoch 5
Loss = 3.8844e-01, PNorm = 74.2949, GNorm = 0.6915, lr_0 = 7.4550e-04
Loss = 3.8725e-01, PNorm = 74.3733, GNorm = 0.8462, lr_0 = 7.2393e-04
Validation prc-auc = 0.548868
Validation auc = 0.756722
Epoch 6
Loss = 3.4588e-01, PNorm = 74.4570, GNorm = 0.9445, lr_0 = 7.0091e-04
Loss = 3.5694e-01, PNorm = 74.5504, GNorm = 0.6102, lr_0 = 6.8063e-04
Loss = 3.8828e-01, PNorm = 74.6237, GNorm = 0.6070, lr_0 = 6.6093e-04
Validation prc-auc = 0.551305
Validation auc = 0.773581
Epoch 7
Loss = 3.7718e-01, PNorm = 74.6997, GNorm = 1.0433, lr_0 = 6.3992e-04
Loss = 3.6130e-01, PNorm = 74.7696, GNorm = 0.5501, lr_0 = 6.2139e-04
Loss = 3.7202e-01, PNorm = 74.8280, GNorm = 0.6085, lr_0 = 6.0341e-04
Validation prc-auc = 0.583089
Validation auc = 0.787452
Epoch 8
Loss = 3.9220e-01, PNorm = 74.8828, GNorm = 0.6723, lr_0 = 5.8595e-04
Loss = 4.2025e-01, PNorm = 74.9414, GNorm = 0.8593, lr_0 = 5.6899e-04
Loss = 3.4473e-01, PNorm = 75.0026, GNorm = 0.5863, lr_0 = 5.5252e-04
Validation prc-auc = 0.593583
Validation auc = 0.793641
Epoch 9
Loss = 2.9441e-01, PNorm = 75.0733, GNorm = 0.8339, lr_0 = 5.3495e-04
Loss = 3.1847e-01, PNorm = 75.1400, GNorm = 1.0758, lr_0 = 5.1947e-04
Loss = 4.2029e-01, PNorm = 75.1987, GNorm = 0.6893, lr_0 = 5.0444e-04
Validation prc-auc = 0.612868
Validation auc = 0.807512
Epoch 10
Loss = 3.0389e-01, PNorm = 75.2819, GNorm = 0.8506, lr_0 = 4.8840e-04
Loss = 3.8606e-01, PNorm = 75.3348, GNorm = 0.8466, lr_0 = 4.7426e-04
Validation prc-auc = 0.597255
Validation auc = 0.804524
Epoch 11
Loss = 3.5865e-01, PNorm = 75.4002, GNorm = 0.7565, lr_0 = 4.5919e-04
Loss = 3.4218e-01, PNorm = 75.4584, GNorm = 0.8464, lr_0 = 4.4590e-04
Loss = 3.1291e-01, PNorm = 75.5110, GNorm = 0.6581, lr_0 = 4.3299e-04
Validation prc-auc = 0.607482
Validation auc = 0.788519
Epoch 12
Loss = 2.7864e-01, PNorm = 75.5850, GNorm = 1.2525, lr_0 = 4.1923e-04
Loss = 3.2332e-01, PNorm = 75.6321, GNorm = 0.7324, lr_0 = 4.0709e-04
Loss = 3.0533e-01, PNorm = 75.6909, GNorm = 0.8221, lr_0 = 3.9531e-04
Validation prc-auc = 0.615438
Validation auc = 0.816901
Epoch 13
Loss = 3.2128e-01, PNorm = 75.7566, GNorm = 1.3861, lr_0 = 3.8274e-04
Loss = 3.0643e-01, PNorm = 75.8196, GNorm = 1.1713, lr_0 = 3.7167e-04
Loss = 3.5754e-01, PNorm = 75.8712, GNorm = 0.7993, lr_0 = 3.6091e-04
Validation prc-auc = 0.615274
Validation auc = 0.811353
Epoch 14
Loss = 3.1274e-01, PNorm = 75.9302, GNorm = 1.2271, lr_0 = 3.4944e-04
Loss = 3.5025e-01, PNorm = 75.9790, GNorm = 0.8694, lr_0 = 3.3932e-04
Loss = 3.0442e-01, PNorm = 76.0292, GNorm = 0.5548, lr_0 = 3.2950e-04
Validation prc-auc = 0.610726
Validation auc = 0.801323
Epoch 15
Loss = 2.9106e-01, PNorm = 76.0712, GNorm = 0.8810, lr_0 = 3.1996e-04
Loss = 2.9369e-01, PNorm = 76.1160, GNorm = 0.5841, lr_0 = 3.1070e-04
Loss = 2.8422e-01, PNorm = 76.1575, GNorm = 0.7764, lr_0 = 3.0171e-04
Loss = 4.1552e-01, PNorm = 76.1622, GNorm = 2.4190, lr_0 = 3.0083e-04
Validation prc-auc = 0.622751
Validation auc = 0.815834
Epoch 16
Loss = 2.7476e-01, PNorm = 76.2057, GNorm = 0.9242, lr_0 = 2.9212e-04
Loss = 2.8623e-01, PNorm = 76.2507, GNorm = 1.0543, lr_0 = 2.8367e-04
Validation prc-auc = 0.641581
Validation auc = 0.812847
Epoch 17
Loss = 2.4039e-01, PNorm = 76.2960, GNorm = 0.8177, lr_0 = 2.7465e-04
Loss = 2.9225e-01, PNorm = 76.3402, GNorm = 0.7620, lr_0 = 2.6670e-04
Loss = 2.6768e-01, PNorm = 76.3845, GNorm = 1.0786, lr_0 = 2.5898e-04
Validation prc-auc = 0.639088
Validation auc = 0.820102
Epoch 18
Loss = 2.3019e-01, PNorm = 76.4288, GNorm = 0.8387, lr_0 = 2.5075e-04
Loss = 3.0040e-01, PNorm = 76.4654, GNorm = 0.6777, lr_0 = 2.4349e-04
Loss = 3.0016e-01, PNorm = 76.5031, GNorm = 0.7486, lr_0 = 2.3644e-04
Validation prc-auc = 0.661571
Validation auc = 0.822450
Epoch 19
Loss = 2.3524e-01, PNorm = 76.5429, GNorm = 0.9064, lr_0 = 2.2893e-04
Loss = 2.7418e-01, PNorm = 76.5693, GNorm = 0.9858, lr_0 = 2.2230e-04
Loss = 2.5478e-01, PNorm = 76.6010, GNorm = 1.0276, lr_0 = 2.1587e-04
Validation prc-auc = 0.664554
Validation auc = 0.823090
Epoch 20
Loss = 2.5189e-01, PNorm = 76.6368, GNorm = 0.8943, lr_0 = 2.0900e-04
Loss = 2.5931e-01, PNorm = 76.6619, GNorm = 1.6939, lr_0 = 2.0295e-04
Loss = 2.5688e-01, PNorm = 76.6899, GNorm = 1.0169, lr_0 = 1.9708e-04
Loss = 2.8087e-01, PNorm = 76.6932, GNorm = 2.7972, lr_0 = 1.9650e-04
Validation prc-auc = 0.630979
Validation auc = 0.818609
Epoch 21
Loss = 2.0000e-01, PNorm = 76.7217, GNorm = 0.5380, lr_0 = 1.9081e-04
Loss = 2.6873e-01, PNorm = 76.7421, GNorm = 1.0422, lr_0 = 1.8529e-04
Validation prc-auc = 0.627160
Validation auc = 0.817755
Epoch 22
Loss = 4.0696e-01, PNorm = 76.7682, GNorm = 1.2517, lr_0 = 1.7993e-04
Loss = 2.2367e-01, PNorm = 76.7923, GNorm = 0.8326, lr_0 = 1.7472e-04
Loss = 2.6865e-01, PNorm = 76.8160, GNorm = 1.0523, lr_0 = 1.6966e-04
Validation prc-auc = 0.637561
Validation auc = 0.813487
Epoch 23
Loss = 2.5490e-01, PNorm = 76.8397, GNorm = 1.1002, lr_0 = 1.6427e-04
Loss = 2.3343e-01, PNorm = 76.8583, GNorm = 0.9497, lr_0 = 1.5952e-04
Loss = 2.5902e-01, PNorm = 76.8785, GNorm = 1.4342, lr_0 = 1.5490e-04
Validation prc-auc = 0.633995
Validation auc = 0.813274
Epoch 24
Loss = 2.0392e-01, PNorm = 76.8977, GNorm = 1.2100, lr_0 = 1.4998e-04
Loss = 2.5395e-01, PNorm = 76.9157, GNorm = 1.0352, lr_0 = 1.4563e-04
Loss = 2.4889e-01, PNorm = 76.9365, GNorm = 0.8848, lr_0 = 1.4142e-04
Validation prc-auc = 0.637002
Validation auc = 0.815621
Epoch 25
Loss = 2.2226e-01, PNorm = 76.9545, GNorm = 1.1106, lr_0 = 1.3692e-04
Loss = 2.3667e-01, PNorm = 76.9704, GNorm = 1.0159, lr_0 = 1.3296e-04
Loss = 2.3357e-01, PNorm = 76.9880, GNorm = 0.9816, lr_0 = 1.2911e-04
Validation prc-auc = 0.648451
Validation auc = 0.818395
Epoch 26
Loss = 2.2546e-01, PNorm = 77.0049, GNorm = 1.2460, lr_0 = 1.2501e-04
Loss = 2.1804e-01, PNorm = 77.0203, GNorm = 1.5674, lr_0 = 1.2139e-04
Validation prc-auc = 0.650168
Validation auc = 0.813914
Epoch 27
Loss = 1.9955e-01, PNorm = 77.0396, GNorm = 0.9452, lr_0 = 1.1753e-04
Loss = 2.4108e-01, PNorm = 77.0520, GNorm = 1.6822, lr_0 = 1.1413e-04
Loss = 1.9803e-01, PNorm = 77.0627, GNorm = 1.1419, lr_0 = 1.1083e-04
Validation prc-auc = 0.666127
Validation auc = 0.834827
Epoch 28
Loss = 2.0130e-01, PNorm = 77.0770, GNorm = 1.2196, lr_0 = 1.0730e-04
Loss = 2.1781e-01, PNorm = 77.0901, GNorm = 1.2785, lr_0 = 1.0420e-04
Loss = 2.0234e-01, PNorm = 77.1020, GNorm = 0.9742, lr_0 = 1.0118e-04
Validation prc-auc = 0.654479
Validation auc = 0.820529
Epoch 29
Loss = 1.8233e-01, PNorm = 77.1126, GNorm = 1.0853, lr_0 = 1.0000e-04
Loss = 2.5615e-01, PNorm = 77.1229, GNorm = 0.7965, lr_0 = 1.0000e-04
Loss = 2.1814e-01, PNorm = 77.1335, GNorm = 1.1765, lr_0 = 1.0000e-04
Validation prc-auc = 0.640652
Validation auc = 0.827785
Model 0 best validation prc-auc = 0.666127 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.663401
Model 0 test auc = 0.839152
Ensemble test prc-auc = 0.663401
Ensemble test auc = 0.839152
Fold 18
Splitting data with seed 18
Total scaffolds = 870 | train scaffolds = 653 | val scaffolds = 96 | test scaffolds = 121
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.5828e-01, PNorm = 72.7633, GNorm = 1.1845, lr_0 = 1.0000e-03
Loss = 4.7920e-01, PNorm = 73.1623, GNorm = 0.7947, lr_0 = 1.0000e-03
Validation prc-auc = 0.490024
Validation auc = 0.731224
Epoch 1
Loss = 4.6144e-01, PNorm = 73.3988, GNorm = 0.5533, lr_0 = 1.0000e-03
Loss = 4.6308e-01, PNorm = 73.5219, GNorm = 0.6307, lr_0 = 1.0000e-03
Loss = 4.1477e-01, PNorm = 73.6091, GNorm = 1.4364, lr_0 = 1.0000e-03
Validation prc-auc = 0.643612
Validation auc = 0.801837
Epoch 2
Loss = 3.9596e-01, PNorm = 73.6906, GNorm = 0.9139, lr_0 = 9.7965e-04
Loss = 4.6094e-01, PNorm = 73.7597, GNorm = 1.0642, lr_0 = 9.5130e-04
Loss = 3.9060e-01, PNorm = 73.8220, GNorm = 0.9323, lr_0 = 9.2376e-04
Validation prc-auc = 0.624680
Validation auc = 0.796122
Epoch 3
Loss = 4.0611e-01, PNorm = 73.8902, GNorm = 1.7455, lr_0 = 8.9440e-04
Loss = 4.4668e-01, PNorm = 73.9458, GNorm = 0.6565, lr_0 = 8.6851e-04
Loss = 4.2107e-01, PNorm = 73.9972, GNorm = 0.7330, lr_0 = 8.4337e-04
Validation prc-auc = 0.634630
Validation auc = 0.804490
Epoch 4
Loss = 3.9332e-01, PNorm = 74.0675, GNorm = 0.5232, lr_0 = 8.1656e-04
Loss = 3.9709e-01, PNorm = 74.1272, GNorm = 0.7550, lr_0 = 7.9293e-04
Loss = 4.2487e-01, PNorm = 74.1895, GNorm = 1.3427, lr_0 = 7.6998e-04
Loss = 6.0642e-01, PNorm = 74.1961, GNorm = 2.1951, lr_0 = 7.6772e-04
Validation prc-auc = 0.641312
Validation auc = 0.796939
Epoch 5
Loss = 4.1898e-01, PNorm = 74.2627, GNorm = 0.5872, lr_0 = 7.4550e-04
Loss = 4.0267e-01, PNorm = 74.3285, GNorm = 0.7811, lr_0 = 7.2393e-04
Validation prc-auc = 0.620621
Validation auc = 0.799388
Epoch 6
Loss = 3.9884e-01, PNorm = 74.3897, GNorm = 0.6645, lr_0 = 7.0091e-04
Loss = 3.7332e-01, PNorm = 74.4588, GNorm = 0.7726, lr_0 = 6.8063e-04
Loss = 3.8132e-01, PNorm = 74.5209, GNorm = 0.9589, lr_0 = 6.6093e-04
Validation prc-auc = 0.663351
Validation auc = 0.802041
Epoch 7
Loss = 3.9417e-01, PNorm = 74.5917, GNorm = 0.6238, lr_0 = 6.3992e-04
Loss = 3.7454e-01, PNorm = 74.6532, GNorm = 0.8323, lr_0 = 6.2139e-04
Loss = 3.7574e-01, PNorm = 74.7094, GNorm = 0.7508, lr_0 = 6.0341e-04
Validation prc-auc = 0.664651
Validation auc = 0.817959
Epoch 8
Loss = 3.8552e-01, PNorm = 74.7674, GNorm = 1.1124, lr_0 = 5.8595e-04
Loss = 3.7091e-01, PNorm = 74.8338, GNorm = 1.0183, lr_0 = 5.6899e-04
Loss = 3.7022e-01, PNorm = 74.9015, GNorm = 0.8315, lr_0 = 5.5252e-04
Validation prc-auc = 0.651984
Validation auc = 0.809592
Epoch 9
Loss = 3.4937e-01, PNorm = 74.9609, GNorm = 0.9249, lr_0 = 5.3495e-04
Loss = 3.6413e-01, PNorm = 75.0178, GNorm = 0.7156, lr_0 = 5.1947e-04
Loss = 3.7842e-01, PNorm = 75.0701, GNorm = 1.0911, lr_0 = 5.0444e-04
Validation prc-auc = 0.670181
Validation auc = 0.818980
Epoch 10
Loss = 3.2055e-01, PNorm = 75.1487, GNorm = 0.9891, lr_0 = 4.8840e-04
Loss = 3.6282e-01, PNorm = 75.2123, GNorm = 0.9135, lr_0 = 4.7426e-04
Validation prc-auc = 0.692011
Validation auc = 0.820612
Epoch 11
Loss = 2.1673e-01, PNorm = 75.2623, GNorm = 0.8643, lr_0 = 4.5919e-04
Loss = 3.6924e-01, PNorm = 75.3155, GNorm = 0.9287, lr_0 = 4.4590e-04
Loss = 3.5623e-01, PNorm = 75.3731, GNorm = 1.1461, lr_0 = 4.3299e-04
Validation prc-auc = 0.701591
Validation auc = 0.833061
Epoch 12
Loss = 3.8179e-01, PNorm = 75.4202, GNorm = 1.0844, lr_0 = 4.1923e-04
Loss = 3.4145e-01, PNorm = 75.4797, GNorm = 0.5277, lr_0 = 4.0709e-04
Loss = 3.1738e-01, PNorm = 75.5431, GNorm = 0.9835, lr_0 = 3.9531e-04
Validation prc-auc = 0.679093
Validation auc = 0.807143
Epoch 13
Loss = 3.3730e-01, PNorm = 75.5998, GNorm = 0.9218, lr_0 = 3.8274e-04
Loss = 3.2397e-01, PNorm = 75.6578, GNorm = 1.2427, lr_0 = 3.7167e-04
Loss = 3.4868e-01, PNorm = 75.7120, GNorm = 0.9487, lr_0 = 3.6091e-04
Validation prc-auc = 0.713024
Validation auc = 0.820612
Epoch 14
Loss = 3.4984e-01, PNorm = 75.7750, GNorm = 0.7860, lr_0 = 3.4944e-04
Loss = 3.1686e-01, PNorm = 75.8302, GNorm = 1.2618, lr_0 = 3.3932e-04
Loss = 2.8913e-01, PNorm = 75.8824, GNorm = 0.9976, lr_0 = 3.2950e-04
Validation prc-auc = 0.697450
Validation auc = 0.814286
Epoch 15
Loss = 3.1606e-01, PNorm = 75.9307, GNorm = 0.9758, lr_0 = 3.1996e-04
Loss = 2.8728e-01, PNorm = 75.9907, GNorm = 0.7496, lr_0 = 3.1070e-04
Loss = 3.0581e-01, PNorm = 76.0387, GNorm = 0.9240, lr_0 = 3.0171e-04
Loss = 8.7119e-02, PNorm = 76.0436, GNorm = 1.8504, lr_0 = 3.0083e-04
Validation prc-auc = 0.685772
Validation auc = 0.814694
Epoch 16
Loss = 2.6711e-01, PNorm = 76.0933, GNorm = 1.0120, lr_0 = 2.9212e-04
Loss = 2.6388e-01, PNorm = 76.1355, GNorm = 1.1160, lr_0 = 2.8367e-04
Validation prc-auc = 0.679295
Validation auc = 0.811020
Epoch 17
Loss = 3.2236e-01, PNorm = 76.1714, GNorm = 1.4739, lr_0 = 2.7465e-04
Loss = 2.8874e-01, PNorm = 76.2251, GNorm = 0.6472, lr_0 = 2.6670e-04
Loss = 3.2314e-01, PNorm = 76.2630, GNorm = 0.7745, lr_0 = 2.5898e-04
Validation prc-auc = 0.668895
Validation auc = 0.811224
Epoch 18
Loss = 2.3359e-01, PNorm = 76.3018, GNorm = 0.7698, lr_0 = 2.5075e-04
Loss = 3.0817e-01, PNorm = 76.3417, GNorm = 1.2575, lr_0 = 2.4349e-04
Loss = 2.7873e-01, PNorm = 76.3808, GNorm = 1.0709, lr_0 = 2.3644e-04
Validation prc-auc = 0.705359
Validation auc = 0.815102
Epoch 19
Loss = 2.5762e-01, PNorm = 76.4225, GNorm = 0.7955, lr_0 = 2.2893e-04
Loss = 2.3192e-01, PNorm = 76.4552, GNorm = 0.8158, lr_0 = 2.2230e-04
Loss = 3.2524e-01, PNorm = 76.4797, GNorm = 1.1500, lr_0 = 2.1587e-04
Validation prc-auc = 0.653032
Validation auc = 0.806735
Epoch 20
Loss = 3.1264e-01, PNorm = 76.5172, GNorm = 1.4653, lr_0 = 2.0900e-04
Loss = 2.8684e-01, PNorm = 76.5503, GNorm = 1.0327, lr_0 = 2.0295e-04
Loss = 2.4677e-01, PNorm = 76.5843, GNorm = 1.3423, lr_0 = 1.9708e-04
Loss = 1.0289e-01, PNorm = 76.5871, GNorm = 1.3107, lr_0 = 1.9650e-04
Validation prc-auc = 0.685637
Validation auc = 0.819592
Epoch 21
Loss = 2.5137e-01, PNorm = 76.6117, GNorm = 0.9938, lr_0 = 1.9081e-04
Loss = 2.3776e-01, PNorm = 76.6369, GNorm = 1.5300, lr_0 = 1.8529e-04
Validation prc-auc = 0.680816
Validation auc = 0.816735
Epoch 22
Loss = 3.4998e-01, PNorm = 76.6585, GNorm = 1.2899, lr_0 = 1.7993e-04
Loss = 2.2822e-01, PNorm = 76.6879, GNorm = 0.9783, lr_0 = 1.7472e-04
Loss = 2.1845e-01, PNorm = 76.7133, GNorm = 1.1829, lr_0 = 1.6966e-04
Validation prc-auc = 0.688785
Validation auc = 0.817755
Epoch 23
Loss = 2.4132e-01, PNorm = 76.7410, GNorm = 1.1947, lr_0 = 1.6427e-04
Loss = 2.1577e-01, PNorm = 76.7657, GNorm = 1.9982, lr_0 = 1.5952e-04
Loss = 2.3289e-01, PNorm = 76.7874, GNorm = 1.0256, lr_0 = 1.5490e-04
Validation prc-auc = 0.684863
Validation auc = 0.825714
Epoch 24
Loss = 2.7290e-01, PNorm = 76.8071, GNorm = 1.3896, lr_0 = 1.4998e-04
Loss = 2.2114e-01, PNorm = 76.8344, GNorm = 1.0391, lr_0 = 1.4563e-04
Loss = 2.1108e-01, PNorm = 76.8528, GNorm = 0.7740, lr_0 = 1.4142e-04
Validation prc-auc = 0.678765
Validation auc = 0.812653
Epoch 25
Loss = 2.3697e-01, PNorm = 76.8730, GNorm = 0.8454, lr_0 = 1.3692e-04
Loss = 2.4057e-01, PNorm = 76.8919, GNorm = 1.3051, lr_0 = 1.3296e-04
Loss = 2.2131e-01, PNorm = 76.9053, GNorm = 1.2467, lr_0 = 1.2911e-04
Validation prc-auc = 0.685979
Validation auc = 0.817347
Epoch 26
Loss = 1.9578e-01, PNorm = 76.9231, GNorm = 1.0203, lr_0 = 1.2501e-04
Loss = 2.1703e-01, PNorm = 76.9416, GNorm = 1.5855, lr_0 = 1.2139e-04
Validation prc-auc = 0.674943
Validation auc = 0.818571
Epoch 27
Loss = 1.5187e-01, PNorm = 76.9581, GNorm = 1.0318, lr_0 = 1.1753e-04
Loss = 2.2784e-01, PNorm = 76.9713, GNorm = 1.0714, lr_0 = 1.1413e-04
Loss = 2.0737e-01, PNorm = 76.9878, GNorm = 1.2198, lr_0 = 1.1083e-04
Validation prc-auc = 0.689221
Validation auc = 0.821020
Epoch 28
Loss = 1.8813e-01, PNorm = 77.0013, GNorm = 1.0520, lr_0 = 1.0730e-04
Loss = 1.9258e-01, PNorm = 77.0153, GNorm = 0.9390, lr_0 = 1.0420e-04
Loss = 1.8738e-01, PNorm = 77.0269, GNorm = 1.2312, lr_0 = 1.0118e-04
Validation prc-auc = 0.689004
Validation auc = 0.818776
Epoch 29
Loss = 1.9363e-01, PNorm = 77.0396, GNorm = 0.9702, lr_0 = 1.0000e-04
Loss = 2.1820e-01, PNorm = 77.0559, GNorm = 2.5338, lr_0 = 1.0000e-04
Loss = 2.1113e-01, PNorm = 77.0628, GNorm = 1.5202, lr_0 = 1.0000e-04
Validation prc-auc = 0.680749
Validation auc = 0.821020
Model 0 best validation prc-auc = 0.713024 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.423667
Model 0 test auc = 0.773810
Ensemble test prc-auc = 0.423667
Ensemble test auc = 0.773810
Fold 19
Splitting data with seed 19
Total scaffolds = 870 | train scaffolds = 643 | val scaffolds = 108 | test scaffolds = 119
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.2572e-01, PNorm = 72.7672, GNorm = 0.7356, lr_0 = 1.0000e-03
Loss = 4.1976e-01, PNorm = 73.1716, GNorm = 0.5816, lr_0 = 1.0000e-03
Validation prc-auc = 0.383363
Validation auc = 0.730769
Epoch 1
Loss = 5.3258e-01, PNorm = 73.4108, GNorm = 1.0858, lr_0 = 1.0000e-03
Loss = 4.5537e-01, PNorm = 73.5451, GNorm = 0.8321, lr_0 = 1.0000e-03
Loss = 4.4335e-01, PNorm = 73.6294, GNorm = 0.6147, lr_0 = 1.0000e-03
Validation prc-auc = 0.452214
Validation auc = 0.764329
Epoch 2
Loss = 4.4741e-01, PNorm = 73.6987, GNorm = 0.5078, lr_0 = 9.7965e-04
Loss = 3.8044e-01, PNorm = 73.7609, GNorm = 0.9451, lr_0 = 9.5130e-04
Loss = 4.4810e-01, PNorm = 73.8128, GNorm = 0.5427, lr_0 = 9.2376e-04
Validation prc-auc = 0.465113
Validation auc = 0.775452
Epoch 3
Loss = 4.2082e-01, PNorm = 73.8681, GNorm = 0.4323, lr_0 = 8.9440e-04
Loss = 3.6800e-01, PNorm = 73.9326, GNorm = 0.6730, lr_0 = 8.6851e-04
Loss = 4.7460e-01, PNorm = 73.9674, GNorm = 0.6169, lr_0 = 8.4337e-04
Validation prc-auc = 0.472931
Validation auc = 0.767157
Epoch 4
Loss = 3.8312e-01, PNorm = 74.0320, GNorm = 0.4596, lr_0 = 8.1656e-04
Loss = 3.9209e-01, PNorm = 74.0770, GNorm = 0.4853, lr_0 = 7.9293e-04
Loss = 4.1911e-01, PNorm = 74.1318, GNorm = 0.5370, lr_0 = 7.6998e-04
Loss = 1.7443e-01, PNorm = 74.1363, GNorm = 0.8012, lr_0 = 7.6772e-04
Validation prc-auc = 0.482239
Validation auc = 0.773944
Epoch 5
Loss = 3.6453e-01, PNorm = 74.1863, GNorm = 0.7668, lr_0 = 7.4550e-04
Loss = 3.7342e-01, PNorm = 74.2434, GNorm = 0.7374, lr_0 = 7.2393e-04
Validation prc-auc = 0.496911
Validation auc = 0.784691
Epoch 6
Loss = 3.7825e-01, PNorm = 74.3160, GNorm = 0.5957, lr_0 = 7.0091e-04
Loss = 3.6609e-01, PNorm = 74.3833, GNorm = 0.6168, lr_0 = 6.8063e-04
Loss = 3.9048e-01, PNorm = 74.4601, GNorm = 1.4364, lr_0 = 6.6093e-04
Validation prc-auc = 0.521940
Validation auc = 0.783183
Epoch 7
Loss = 4.3244e-01, PNorm = 74.5316, GNorm = 0.7568, lr_0 = 6.3992e-04
Loss = 3.4931e-01, PNorm = 74.5998, GNorm = 0.5892, lr_0 = 6.2139e-04
Loss = 3.4282e-01, PNorm = 74.6703, GNorm = 0.8344, lr_0 = 6.0341e-04
Validation prc-auc = 0.526123
Validation auc = 0.770739
Epoch 8
Loss = 3.3368e-01, PNorm = 74.7396, GNorm = 0.6749, lr_0 = 5.8595e-04
Loss = 3.6866e-01, PNorm = 74.8117, GNorm = 0.7586, lr_0 = 5.6899e-04
Loss = 3.3032e-01, PNorm = 74.8855, GNorm = 0.5756, lr_0 = 5.5252e-04
Validation prc-auc = 0.547388
Validation auc = 0.781486
Epoch 9
Loss = 3.2602e-01, PNorm = 74.9674, GNorm = 0.8386, lr_0 = 5.3495e-04
Loss = 3.7750e-01, PNorm = 75.0240, GNorm = 0.7183, lr_0 = 5.1947e-04
Loss = 3.6683e-01, PNorm = 75.0861, GNorm = 0.5737, lr_0 = 5.0444e-04
Validation prc-auc = 0.516276
Validation auc = 0.778469
Epoch 10
Loss = 3.4900e-01, PNorm = 75.1475, GNorm = 0.6831, lr_0 = 4.8840e-04
Loss = 3.1771e-01, PNorm = 75.2078, GNorm = 0.8860, lr_0 = 4.7426e-04
Validation prc-auc = 0.548559
Validation auc = 0.791478
Epoch 11
Loss = 3.5322e-01, PNorm = 75.2864, GNorm = 0.9458, lr_0 = 4.5919e-04
Loss = 3.3752e-01, PNorm = 75.3564, GNorm = 0.6570, lr_0 = 4.4590e-04
Loss = 3.3566e-01, PNorm = 75.4160, GNorm = 1.0051, lr_0 = 4.3299e-04
Validation prc-auc = 0.543384
Validation auc = 0.783183
Epoch 12
Loss = 3.2497e-01, PNorm = 75.4731, GNorm = 0.7202, lr_0 = 4.1923e-04
Loss = 3.2377e-01, PNorm = 75.5291, GNorm = 0.6702, lr_0 = 4.0709e-04
Loss = 3.3339e-01, PNorm = 75.5770, GNorm = 0.6501, lr_0 = 3.9531e-04
Validation prc-auc = 0.545057
Validation auc = 0.768477
Epoch 13
Loss = 2.4569e-01, PNorm = 75.6342, GNorm = 0.7203, lr_0 = 3.8274e-04
Loss = 3.6193e-01, PNorm = 75.6873, GNorm = 0.8560, lr_0 = 3.7167e-04
Loss = 2.7153e-01, PNorm = 75.7366, GNorm = 0.6221, lr_0 = 3.6091e-04
Validation prc-auc = 0.562877
Validation auc = 0.774887
Epoch 14
Loss = 3.2929e-01, PNorm = 75.7818, GNorm = 0.7813, lr_0 = 3.4944e-04
Loss = 3.2248e-01, PNorm = 75.8290, GNorm = 1.0545, lr_0 = 3.3932e-04
Loss = 2.9250e-01, PNorm = 75.8773, GNorm = 0.8291, lr_0 = 3.2950e-04
Validation prc-auc = 0.576614
Validation auc = 0.784691
Epoch 15
Loss = 2.7972e-01, PNorm = 75.9211, GNorm = 1.0953, lr_0 = 3.1996e-04
Loss = 2.7673e-01, PNorm = 75.9653, GNorm = 0.6067, lr_0 = 3.1070e-04
Loss = 2.8846e-01, PNorm = 76.0104, GNorm = 0.9172, lr_0 = 3.0171e-04
Loss = 1.3937e-01, PNorm = 76.0153, GNorm = 1.2794, lr_0 = 3.0083e-04
Validation prc-auc = 0.558913
Validation auc = 0.772436
Epoch 16
Loss = 2.8388e-01, PNorm = 76.0620, GNorm = 1.4551, lr_0 = 2.9212e-04
Loss = 2.8328e-01, PNorm = 76.1080, GNorm = 1.1571, lr_0 = 2.8367e-04
Validation prc-auc = 0.561678
Validation auc = 0.774698
Epoch 17
Loss = 2.1707e-01, PNorm = 76.1562, GNorm = 0.6384, lr_0 = 2.7465e-04
Loss = 2.8992e-01, PNorm = 76.1970, GNorm = 1.4283, lr_0 = 2.6670e-04
Loss = 2.9309e-01, PNorm = 76.2411, GNorm = 0.8964, lr_0 = 2.5898e-04
Validation prc-auc = 0.558559
Validation auc = 0.768854
Epoch 18
Loss = 2.8099e-01, PNorm = 76.2767, GNorm = 0.8312, lr_0 = 2.5075e-04
Loss = 2.9191e-01, PNorm = 76.3226, GNorm = 0.9749, lr_0 = 2.4349e-04
Loss = 2.6880e-01, PNorm = 76.3539, GNorm = 0.8353, lr_0 = 2.3644e-04
Validation prc-auc = 0.567537
Validation auc = 0.787142
Epoch 19
Loss = 2.2205e-01, PNorm = 76.3982, GNorm = 0.6202, lr_0 = 2.2893e-04
Loss = 2.8291e-01, PNorm = 76.4253, GNorm = 0.9075, lr_0 = 2.2230e-04
Loss = 2.4288e-01, PNorm = 76.4597, GNorm = 0.8123, lr_0 = 2.1587e-04
Validation prc-auc = 0.560101
Validation auc = 0.772813
Epoch 20
Loss = 2.4615e-01, PNorm = 76.4936, GNorm = 1.0044, lr_0 = 2.0900e-04
Loss = 2.1852e-01, PNorm = 76.5300, GNorm = 1.3257, lr_0 = 2.0295e-04
Loss = 2.5811e-01, PNorm = 76.5543, GNorm = 1.0523, lr_0 = 1.9708e-04
Loss = 1.0175e-01, PNorm = 76.5567, GNorm = 1.0501, lr_0 = 1.9650e-04
Validation prc-auc = 0.565487
Validation auc = 0.780920
Epoch 21
Loss = 2.3255e-01, PNorm = 76.5825, GNorm = 0.9217, lr_0 = 1.9081e-04
Loss = 2.6757e-01, PNorm = 76.6108, GNorm = 0.8797, lr_0 = 1.8529e-04
Validation prc-auc = 0.554755
Validation auc = 0.777526
Epoch 22
Loss = 2.9629e-01, PNorm = 76.6359, GNorm = 1.1296, lr_0 = 1.7993e-04
Loss = 2.0083e-01, PNorm = 76.6635, GNorm = 0.9740, lr_0 = 1.7472e-04
Loss = 2.4277e-01, PNorm = 76.6857, GNorm = 0.7549, lr_0 = 1.6966e-04
Validation prc-auc = 0.562896
Validation auc = 0.776584
Epoch 23
Loss = 2.6223e-01, PNorm = 76.7114, GNorm = 0.8068, lr_0 = 1.6427e-04
Loss = 2.2292e-01, PNorm = 76.7391, GNorm = 1.4149, lr_0 = 1.5952e-04
Loss = 2.1166e-01, PNorm = 76.7544, GNorm = 1.3228, lr_0 = 1.5490e-04
Validation prc-auc = 0.548682
Validation auc = 0.767722
Epoch 24
Loss = 2.2164e-01, PNorm = 76.7776, GNorm = 0.8096, lr_0 = 1.4998e-04
Loss = 2.3594e-01, PNorm = 76.7964, GNorm = 1.4015, lr_0 = 1.4563e-04
Loss = 2.2224e-01, PNorm = 76.8165, GNorm = 0.6057, lr_0 = 1.4142e-04
Validation prc-auc = 0.553420
Validation auc = 0.769796
Epoch 25
Loss = 2.0088e-01, PNorm = 76.8394, GNorm = 1.4724, lr_0 = 1.3692e-04
Loss = 1.7928e-01, PNorm = 76.8601, GNorm = 1.2251, lr_0 = 1.3296e-04
Loss = 2.3381e-01, PNorm = 76.8736, GNorm = 1.0345, lr_0 = 1.2911e-04
Validation prc-auc = 0.551365
Validation auc = 0.768477
Epoch 26
Loss = 1.8236e-01, PNorm = 76.8958, GNorm = 2.1189, lr_0 = 1.2501e-04
Loss = 2.4147e-01, PNorm = 76.9104, GNorm = 2.1903, lr_0 = 1.2139e-04
Validation prc-auc = 0.552898
Validation auc = 0.774321
Epoch 27
Loss = 1.3049e-01, PNorm = 76.9294, GNorm = 0.9031, lr_0 = 1.1753e-04
Loss = 2.0660e-01, PNorm = 76.9434, GNorm = 0.9077, lr_0 = 1.1413e-04
Loss = 1.7665e-01, PNorm = 76.9601, GNorm = 1.3127, lr_0 = 1.1083e-04
Validation prc-auc = 0.559851
Validation auc = 0.780166
Epoch 28
Loss = 1.8931e-01, PNorm = 76.9743, GNorm = 0.8321, lr_0 = 1.0730e-04
Loss = 2.1449e-01, PNorm = 76.9849, GNorm = 1.1762, lr_0 = 1.0420e-04
Loss = 2.4509e-01, PNorm = 76.9962, GNorm = 1.4821, lr_0 = 1.0118e-04
Validation prc-auc = 0.546533
Validation auc = 0.773567
Epoch 29
Loss = 1.5982e-01, PNorm = 77.0103, GNorm = 0.7726, lr_0 = 1.0000e-04
Loss = 2.1396e-01, PNorm = 77.0222, GNorm = 1.1162, lr_0 = 1.0000e-04
Loss = 2.0594e-01, PNorm = 77.0332, GNorm = 1.4984, lr_0 = 1.0000e-04
Validation prc-auc = 0.543576
Validation auc = 0.760935
Model 0 best validation prc-auc = 0.576614 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.716155
Model 0 test auc = 0.831752
Ensemble test prc-auc = 0.716155
Ensemble test auc = 0.831752
Fold 20
Splitting data with seed 20
Total scaffolds = 870 | train scaffolds = 649 | val scaffolds = 120 | test scaffolds = 101
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.3121e-01, PNorm = 72.7865, GNorm = 0.5317, lr_0 = 1.0000e-03
Loss = 4.1980e-01, PNorm = 73.2034, GNorm = 0.5815, lr_0 = 1.0000e-03
Validation prc-auc = 0.408137
Validation auc = 0.702393
Epoch 1
Loss = 3.3609e-01, PNorm = 73.4540, GNorm = 0.7925, lr_0 = 1.0000e-03
Loss = 4.7907e-01, PNorm = 73.5850, GNorm = 1.9028, lr_0 = 1.0000e-03
Loss = 4.0241e-01, PNorm = 73.6739, GNorm = 1.0032, lr_0 = 1.0000e-03
Validation prc-auc = 0.467267
Validation auc = 0.738632
Epoch 2
Loss = 4.1952e-01, PNorm = 73.7512, GNorm = 0.6164, lr_0 = 9.7965e-04
Loss = 3.8527e-01, PNorm = 73.8188, GNorm = 0.6935, lr_0 = 9.5130e-04
Loss = 3.9738e-01, PNorm = 73.8776, GNorm = 0.8257, lr_0 = 9.2376e-04
Validation prc-auc = 0.484733
Validation auc = 0.734701
Epoch 3
Loss = 3.9813e-01, PNorm = 73.9379, GNorm = 0.5647, lr_0 = 8.9440e-04
Loss = 3.7995e-01, PNorm = 73.9939, GNorm = 1.1136, lr_0 = 8.6851e-04
Loss = 4.2953e-01, PNorm = 74.0554, GNorm = 0.6881, lr_0 = 8.4337e-04
Validation prc-auc = 0.526421
Validation auc = 0.761538
Epoch 4
Loss = 3.4752e-01, PNorm = 74.1240, GNorm = 0.4903, lr_0 = 8.1656e-04
Loss = 4.2231e-01, PNorm = 74.1664, GNorm = 0.6336, lr_0 = 7.9293e-04
Loss = 3.7757e-01, PNorm = 74.2197, GNorm = 0.6152, lr_0 = 7.6998e-04
Loss = 3.9644e-01, PNorm = 74.2239, GNorm = 1.5062, lr_0 = 7.6772e-04
Validation prc-auc = 0.516095
Validation auc = 0.755214
Epoch 5
Loss = 3.5092e-01, PNorm = 74.2895, GNorm = 0.8748, lr_0 = 7.4550e-04
Loss = 4.0148e-01, PNorm = 74.3334, GNorm = 0.7071, lr_0 = 7.2393e-04
Validation prc-auc = 0.518072
Validation auc = 0.755385
Epoch 6
Loss = 4.7113e-01, PNorm = 74.3957, GNorm = 0.4835, lr_0 = 7.0091e-04
Loss = 3.6211e-01, PNorm = 74.4618, GNorm = 0.8167, lr_0 = 6.8063e-04
Loss = 3.8179e-01, PNorm = 74.5314, GNorm = 0.6150, lr_0 = 6.6093e-04
Validation prc-auc = 0.557914
Validation auc = 0.758120
Epoch 7
Loss = 3.5590e-01, PNorm = 74.6133, GNorm = 1.4680, lr_0 = 6.3992e-04
Loss = 3.5921e-01, PNorm = 74.6932, GNorm = 0.8539, lr_0 = 6.2139e-04
Loss = 4.0177e-01, PNorm = 74.7556, GNorm = 0.5681, lr_0 = 6.0341e-04
Validation prc-auc = 0.596065
Validation auc = 0.756239
Epoch 8
Loss = 3.4072e-01, PNorm = 74.8055, GNorm = 0.6041, lr_0 = 5.8595e-04
Loss = 3.7064e-01, PNorm = 74.8537, GNorm = 0.7433, lr_0 = 5.6899e-04
Loss = 3.2975e-01, PNorm = 74.9143, GNorm = 0.7784, lr_0 = 5.5252e-04
Validation prc-auc = 0.582900
Validation auc = 0.766667
Epoch 9
Loss = 3.0378e-01, PNorm = 74.9836, GNorm = 0.7534, lr_0 = 5.3495e-04
Loss = 3.4638e-01, PNorm = 75.0421, GNorm = 0.7887, lr_0 = 5.1947e-04
Loss = 3.4614e-01, PNorm = 75.1098, GNorm = 0.8701, lr_0 = 5.0444e-04
Validation prc-auc = 0.575561
Validation auc = 0.763248
Epoch 10
Loss = 3.7226e-01, PNorm = 75.1841, GNorm = 0.7433, lr_0 = 4.8840e-04
Loss = 3.6846e-01, PNorm = 75.2474, GNorm = 0.6104, lr_0 = 4.7426e-04
Validation prc-auc = 0.621483
Validation auc = 0.772650
Epoch 11
Loss = 2.6875e-01, PNorm = 75.3174, GNorm = 0.5760, lr_0 = 4.5919e-04
Loss = 3.0172e-01, PNorm = 75.3851, GNorm = 0.6638, lr_0 = 4.4590e-04
Loss = 3.1731e-01, PNorm = 75.4460, GNorm = 0.6113, lr_0 = 4.3299e-04
Validation prc-auc = 0.636445
Validation auc = 0.773333
Epoch 12
Loss = 2.4250e-01, PNorm = 75.5107, GNorm = 0.6903, lr_0 = 4.1923e-04
Loss = 3.2765e-01, PNorm = 75.5737, GNorm = 0.7643, lr_0 = 4.0709e-04
Loss = 3.1969e-01, PNorm = 75.6268, GNorm = 0.6995, lr_0 = 3.9531e-04
Validation prc-auc = 0.640185
Validation auc = 0.788205
Epoch 13
Loss = 3.0783e-01, PNorm = 75.6861, GNorm = 0.5930, lr_0 = 3.8274e-04
Loss = 2.8206e-01, PNorm = 75.7477, GNorm = 0.6550, lr_0 = 3.7167e-04
Loss = 3.0602e-01, PNorm = 75.8001, GNorm = 0.7953, lr_0 = 3.6091e-04
Validation prc-auc = 0.634724
Validation auc = 0.783761
Epoch 14
Loss = 2.6192e-01, PNorm = 75.8546, GNorm = 0.5483, lr_0 = 3.4944e-04
Loss = 2.6530e-01, PNorm = 75.9085, GNorm = 0.8863, lr_0 = 3.3932e-04
Loss = 3.0730e-01, PNorm = 75.9529, GNorm = 0.6786, lr_0 = 3.2950e-04
Validation prc-auc = 0.641792
Validation auc = 0.781026
Epoch 15
Loss = 3.0052e-01, PNorm = 76.0133, GNorm = 0.6732, lr_0 = 3.1996e-04
Loss = 3.0658e-01, PNorm = 76.0639, GNorm = 0.7458, lr_0 = 3.1070e-04
Loss = 2.2296e-01, PNorm = 76.1194, GNorm = 0.6522, lr_0 = 3.0171e-04
Loss = 5.4635e-01, PNorm = 76.1241, GNorm = 3.6371, lr_0 = 3.0083e-04
Validation prc-auc = 0.648961
Validation auc = 0.797778
Epoch 16
Loss = 2.5430e-01, PNorm = 76.1665, GNorm = 1.2195, lr_0 = 2.9212e-04
Loss = 2.7203e-01, PNorm = 76.2234, GNorm = 1.1781, lr_0 = 2.8367e-04
Validation prc-auc = 0.604920
Validation auc = 0.786154
Epoch 17
Loss = 2.9611e-01, PNorm = 76.2611, GNorm = 1.0198, lr_0 = 2.7465e-04
Loss = 2.4516e-01, PNorm = 76.3070, GNorm = 1.0915, lr_0 = 2.6670e-04
Loss = 2.9197e-01, PNorm = 76.3377, GNorm = 1.2730, lr_0 = 2.5898e-04
Validation prc-auc = 0.648236
Validation auc = 0.788547
Epoch 18
Loss = 3.0750e-01, PNorm = 76.3788, GNorm = 0.8994, lr_0 = 2.5075e-04
Loss = 2.3481e-01, PNorm = 76.4201, GNorm = 0.8259, lr_0 = 2.4349e-04
Loss = 2.4551e-01, PNorm = 76.4495, GNorm = 0.9826, lr_0 = 2.3644e-04
Validation prc-auc = 0.636714
Validation auc = 0.788376
Epoch 19
Loss = 2.4303e-01, PNorm = 76.4930, GNorm = 1.3900, lr_0 = 2.2893e-04
Loss = 2.3243e-01, PNorm = 76.5265, GNorm = 1.0205, lr_0 = 2.2230e-04
Loss = 2.5272e-01, PNorm = 76.5575, GNorm = 1.0177, lr_0 = 2.1587e-04
Validation prc-auc = 0.649766
Validation auc = 0.783590
Epoch 20
Loss = 2.3022e-01, PNorm = 76.5916, GNorm = 1.0221, lr_0 = 2.0900e-04
Loss = 2.4057e-01, PNorm = 76.6282, GNorm = 0.6679, lr_0 = 2.0295e-04
Loss = 2.4742e-01, PNorm = 76.6606, GNorm = 0.9623, lr_0 = 1.9708e-04
Loss = 1.2861e-01, PNorm = 76.6636, GNorm = 1.5808, lr_0 = 1.9650e-04
Validation prc-auc = 0.627563
Validation auc = 0.784274
Epoch 21
Loss = 2.3238e-01, PNorm = 76.6915, GNorm = 0.9835, lr_0 = 1.9081e-04
Loss = 2.5613e-01, PNorm = 76.7202, GNorm = 0.8926, lr_0 = 1.8529e-04
Validation prc-auc = 0.657828
Validation auc = 0.804615
Epoch 22
Loss = 2.5643e-01, PNorm = 76.7530, GNorm = 1.3571, lr_0 = 1.7993e-04
Loss = 2.1693e-01, PNorm = 76.7779, GNorm = 0.8461, lr_0 = 1.7472e-04
Loss = 1.9801e-01, PNorm = 76.8069, GNorm = 0.8220, lr_0 = 1.6966e-04
Validation prc-auc = 0.667190
Validation auc = 0.801368
Epoch 23
Loss = 2.0699e-01, PNorm = 76.8306, GNorm = 1.0277, lr_0 = 1.6427e-04
Loss = 2.0389e-01, PNorm = 76.8582, GNorm = 1.5287, lr_0 = 1.5952e-04
Loss = 2.4469e-01, PNorm = 76.8769, GNorm = 2.0235, lr_0 = 1.5490e-04
Validation prc-auc = 0.643842
Validation auc = 0.792308
Epoch 24
Loss = 2.2420e-01, PNorm = 76.9040, GNorm = 1.0946, lr_0 = 1.4998e-04
Loss = 2.2396e-01, PNorm = 76.9230, GNorm = 0.7039, lr_0 = 1.4563e-04
Loss = 1.8934e-01, PNorm = 76.9473, GNorm = 1.6911, lr_0 = 1.4142e-04
Validation prc-auc = 0.656856
Validation auc = 0.805470
Epoch 25
Loss = 2.1422e-01, PNorm = 76.9644, GNorm = 0.9051, lr_0 = 1.3692e-04
Loss = 1.8562e-01, PNorm = 76.9839, GNorm = 1.1125, lr_0 = 1.3296e-04
Loss = 2.3928e-01, PNorm = 76.9986, GNorm = 1.6364, lr_0 = 1.2911e-04
Validation prc-auc = 0.658215
Validation auc = 0.799145
Epoch 26
Loss = 2.0881e-01, PNorm = 77.0144, GNorm = 0.8694, lr_0 = 1.2501e-04
Loss = 1.9781e-01, PNorm = 77.0348, GNorm = 1.5248, lr_0 = 1.2139e-04
Validation prc-auc = 0.649941
Validation auc = 0.797265
Epoch 27
Loss = 2.4594e-01, PNorm = 77.0491, GNorm = 1.1021, lr_0 = 1.1753e-04
Loss = 1.9436e-01, PNorm = 77.0640, GNorm = 0.9423, lr_0 = 1.1413e-04
Loss = 1.6785e-01, PNorm = 77.0765, GNorm = 0.7262, lr_0 = 1.1083e-04
Validation prc-auc = 0.649502
Validation auc = 0.790940
Epoch 28
Loss = 2.1581e-01, PNorm = 77.0912, GNorm = 1.0972, lr_0 = 1.0730e-04
Loss = 1.8667e-01, PNorm = 77.1046, GNorm = 1.5591, lr_0 = 1.0420e-04
Loss = 1.9438e-01, PNorm = 77.1174, GNorm = 0.9811, lr_0 = 1.0118e-04
Validation prc-auc = 0.648518
Validation auc = 0.790085
Epoch 29
Loss = 2.3349e-01, PNorm = 77.1293, GNorm = 2.5860, lr_0 = 1.0000e-04
Loss = 1.9780e-01, PNorm = 77.1412, GNorm = 1.0603, lr_0 = 1.0000e-04
Loss = 1.7588e-01, PNorm = 77.1555, GNorm = 1.2059, lr_0 = 1.0000e-04
Validation prc-auc = 0.657441
Validation auc = 0.803761
Model 0 best validation prc-auc = 0.667190 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.609091
Model 0 test auc = 0.813869
Ensemble test prc-auc = 0.609091
Ensemble test auc = 0.813869
Fold 21
Splitting data with seed 21
Total scaffolds = 870 | train scaffolds = 649 | val scaffolds = 114 | test scaffolds = 107
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.1518e-01, PNorm = 72.7957, GNorm = 0.5670, lr_0 = 1.0000e-03
Loss = 5.1957e-01, PNorm = 73.2175, GNorm = 0.4872, lr_0 = 1.0000e-03
Validation prc-auc = 0.440134
Validation auc = 0.727521
Epoch 1
Loss = 3.5150e-01, PNorm = 73.4620, GNorm = 0.5347, lr_0 = 1.0000e-03
Loss = 4.0599e-01, PNorm = 73.5897, GNorm = 0.5663, lr_0 = 1.0000e-03
Loss = 3.8505e-01, PNorm = 73.6725, GNorm = 0.7599, lr_0 = 1.0000e-03
Validation prc-auc = 0.483218
Validation auc = 0.752991
Epoch 2
Loss = 4.0519e-01, PNorm = 73.7454, GNorm = 0.6009, lr_0 = 9.7965e-04
Loss = 3.9221e-01, PNorm = 73.8029, GNorm = 0.9387, lr_0 = 9.5130e-04
Loss = 4.1657e-01, PNorm = 73.8582, GNorm = 0.5522, lr_0 = 9.2376e-04
Validation prc-auc = 0.522223
Validation auc = 0.762393
Epoch 3
Loss = 3.6743e-01, PNorm = 73.9261, GNorm = 0.4728, lr_0 = 8.9440e-04
Loss = 4.0973e-01, PNorm = 73.9902, GNorm = 0.7379, lr_0 = 8.6851e-04
Loss = 3.9454e-01, PNorm = 74.0488, GNorm = 1.4184, lr_0 = 8.4337e-04
Validation prc-auc = 0.521717
Validation auc = 0.759658
Epoch 4
Loss = 3.6762e-01, PNorm = 74.1265, GNorm = 0.6457, lr_0 = 8.1656e-04
Loss = 4.0005e-01, PNorm = 74.1863, GNorm = 0.5826, lr_0 = 7.9293e-04
Loss = 3.7345e-01, PNorm = 74.2360, GNorm = 0.4575, lr_0 = 7.6998e-04
Loss = 1.5159e-01, PNorm = 74.2414, GNorm = 0.7895, lr_0 = 7.6772e-04
Validation prc-auc = 0.542422
Validation auc = 0.771282
Epoch 5
Loss = 3.9749e-01, PNorm = 74.2915, GNorm = 0.5502, lr_0 = 7.4550e-04
Loss = 3.2418e-01, PNorm = 74.3532, GNorm = 1.0177, lr_0 = 7.2393e-04
Validation prc-auc = 0.574367
Validation auc = 0.767009
Epoch 6
Loss = 5.6238e-01, PNorm = 74.4207, GNorm = 1.9801, lr_0 = 7.0091e-04
Loss = 3.5858e-01, PNorm = 74.4787, GNorm = 0.4532, lr_0 = 6.8063e-04
Loss = 3.6699e-01, PNorm = 74.5327, GNorm = 0.4895, lr_0 = 6.6093e-04
Validation prc-auc = 0.564415
Validation auc = 0.777094
Epoch 7
Loss = 3.1830e-01, PNorm = 74.6025, GNorm = 0.5770, lr_0 = 6.3992e-04
Loss = 3.6658e-01, PNorm = 74.6587, GNorm = 0.6373, lr_0 = 6.2139e-04
Loss = 3.5017e-01, PNorm = 74.7169, GNorm = 0.9618, lr_0 = 6.0341e-04
Validation prc-auc = 0.555097
Validation auc = 0.777778
Epoch 8
Loss = 3.1707e-01, PNorm = 74.7796, GNorm = 0.6325, lr_0 = 5.8595e-04
Loss = 3.5453e-01, PNorm = 74.8453, GNorm = 0.5191, lr_0 = 5.6899e-04
Loss = 3.2812e-01, PNorm = 74.9203, GNorm = 0.5337, lr_0 = 5.5252e-04
Validation prc-auc = 0.592672
Validation auc = 0.781368
Epoch 9
Loss = 3.0528e-01, PNorm = 74.9874, GNorm = 0.6136, lr_0 = 5.3495e-04
Loss = 3.4934e-01, PNorm = 75.0568, GNorm = 0.6175, lr_0 = 5.1947e-04
Loss = 3.1950e-01, PNorm = 75.1258, GNorm = 0.6866, lr_0 = 5.0444e-04
Validation prc-auc = 0.597488
Validation auc = 0.786154
Epoch 10
Loss = 3.4288e-01, PNorm = 75.1892, GNorm = 0.5951, lr_0 = 4.8840e-04
Loss = 3.1434e-01, PNorm = 75.2443, GNorm = 0.5887, lr_0 = 4.7426e-04
Validation prc-auc = 0.601268
Validation auc = 0.800342
Epoch 11
Loss = 3.0452e-01, PNorm = 75.3178, GNorm = 0.7606, lr_0 = 4.5919e-04
Loss = 2.9028e-01, PNorm = 75.3748, GNorm = 0.7226, lr_0 = 4.4590e-04
Loss = 3.2591e-01, PNorm = 75.4339, GNorm = 0.8967, lr_0 = 4.3299e-04
Validation prc-auc = 0.597000
Validation auc = 0.799829
Epoch 12
Loss = 2.1599e-01, PNorm = 75.5053, GNorm = 0.6200, lr_0 = 4.1923e-04
Loss = 3.4216e-01, PNorm = 75.5759, GNorm = 0.7034, lr_0 = 4.0709e-04
Loss = 3.0503e-01, PNorm = 75.6427, GNorm = 0.6829, lr_0 = 3.9531e-04
Validation prc-auc = 0.643037
Validation auc = 0.800855
Epoch 13
Loss = 2.9619e-01, PNorm = 75.7090, GNorm = 1.0341, lr_0 = 3.8274e-04
Loss = 3.2646e-01, PNorm = 75.7736, GNorm = 0.7921, lr_0 = 3.7167e-04
Loss = 2.5156e-01, PNorm = 75.8401, GNorm = 0.7272, lr_0 = 3.6091e-04
Validation prc-auc = 0.662506
Validation auc = 0.790085
Epoch 14
Loss = 3.1261e-01, PNorm = 75.8907, GNorm = 0.8689, lr_0 = 3.4944e-04
Loss = 2.7812e-01, PNorm = 75.9474, GNorm = 0.9436, lr_0 = 3.3932e-04
Loss = 2.9379e-01, PNorm = 76.0024, GNorm = 1.5246, lr_0 = 3.2950e-04
Validation prc-auc = 0.644448
Validation auc = 0.796581
Epoch 15
Loss = 2.7352e-01, PNorm = 76.0632, GNorm = 1.2678, lr_0 = 3.1996e-04
Loss = 3.1669e-01, PNorm = 76.1120, GNorm = 1.0013, lr_0 = 3.1070e-04
Loss = 2.6572e-01, PNorm = 76.1599, GNorm = 0.7601, lr_0 = 3.0171e-04
Loss = 7.4498e-02, PNorm = 76.1662, GNorm = 1.0723, lr_0 = 3.0083e-04
Validation prc-auc = 0.637644
Validation auc = 0.800513
Epoch 16
Loss = 3.0842e-01, PNorm = 76.2105, GNorm = 0.7909, lr_0 = 2.9212e-04
Loss = 2.6149e-01, PNorm = 76.2638, GNorm = 0.6501, lr_0 = 2.8367e-04
Validation prc-auc = 0.668492
Validation auc = 0.800513
Epoch 17
Loss = 2.4794e-01, PNorm = 76.3052, GNorm = 0.8614, lr_0 = 2.7465e-04
Loss = 2.7881e-01, PNorm = 76.3531, GNorm = 0.9002, lr_0 = 2.6670e-04
Loss = 2.3463e-01, PNorm = 76.3908, GNorm = 0.7757, lr_0 = 2.5898e-04
Validation prc-auc = 0.688148
Validation auc = 0.822051
Epoch 18
Loss = 2.9162e-01, PNorm = 76.4338, GNorm = 1.5857, lr_0 = 2.5075e-04
Loss = 2.3512e-01, PNorm = 76.4672, GNorm = 0.8026, lr_0 = 2.4349e-04
Loss = 2.4505e-01, PNorm = 76.5064, GNorm = 1.1356, lr_0 = 2.3644e-04
Validation prc-auc = 0.660863
Validation auc = 0.803761
Epoch 19
Loss = 1.8993e-01, PNorm = 76.5465, GNorm = 0.8288, lr_0 = 2.2893e-04
Loss = 2.6236e-01, PNorm = 76.5765, GNorm = 0.8180, lr_0 = 2.2230e-04
Loss = 2.7175e-01, PNorm = 76.6160, GNorm = 2.4887, lr_0 = 2.1587e-04
Validation prc-auc = 0.698258
Validation auc = 0.813504
Epoch 20
Loss = 2.4656e-01, PNorm = 76.6412, GNorm = 1.2459, lr_0 = 2.0900e-04
Loss = 2.3609e-01, PNorm = 76.6745, GNorm = 0.7036, lr_0 = 2.0295e-04
Loss = 2.3740e-01, PNorm = 76.7066, GNorm = 1.0627, lr_0 = 1.9708e-04
Loss = 5.9065e-02, PNorm = 76.7098, GNorm = 0.6481, lr_0 = 1.9650e-04
Validation prc-auc = 0.670644
Validation auc = 0.807179
Epoch 21
Loss = 2.2825e-01, PNorm = 76.7412, GNorm = 1.1225, lr_0 = 1.9081e-04
Loss = 2.0824e-01, PNorm = 76.7670, GNorm = 1.4469, lr_0 = 1.8529e-04
Validation prc-auc = 0.693605
Validation auc = 0.801026
Epoch 22
Loss = 2.7660e-01, PNorm = 76.7977, GNorm = 1.1905, lr_0 = 1.7993e-04
Loss = 2.0294e-01, PNorm = 76.8206, GNorm = 0.9156, lr_0 = 1.7472e-04
Loss = 2.0635e-01, PNorm = 76.8457, GNorm = 1.2857, lr_0 = 1.6966e-04
Validation prc-auc = 0.677062
Validation auc = 0.789744
Epoch 23
Loss = 2.0192e-01, PNorm = 76.8745, GNorm = 0.8791, lr_0 = 1.6427e-04
Loss = 2.0671e-01, PNorm = 76.9009, GNorm = 0.7859, lr_0 = 1.5952e-04
Loss = 2.0613e-01, PNorm = 76.9224, GNorm = 1.4454, lr_0 = 1.5490e-04
Validation prc-auc = 0.684927
Validation auc = 0.814701
Epoch 24
Loss = 1.7596e-01, PNorm = 76.9455, GNorm = 0.9862, lr_0 = 1.4998e-04
Loss = 2.2811e-01, PNorm = 76.9648, GNorm = 1.3242, lr_0 = 1.4563e-04
Loss = 1.9968e-01, PNorm = 76.9875, GNorm = 1.2581, lr_0 = 1.4142e-04
Validation prc-auc = 0.692491
Validation auc = 0.803077
Epoch 25
Loss = 2.0053e-01, PNorm = 77.0061, GNorm = 0.8848, lr_0 = 1.3692e-04
Loss = 1.7570e-01, PNorm = 77.0274, GNorm = 1.1298, lr_0 = 1.3296e-04
Loss = 1.8601e-01, PNorm = 77.0478, GNorm = 1.6809, lr_0 = 1.2911e-04
Validation prc-auc = 0.676483
Validation auc = 0.807179
Epoch 26
Loss = 1.9055e-01, PNorm = 77.0620, GNorm = 1.0607, lr_0 = 1.2501e-04
Loss = 1.7858e-01, PNorm = 77.0810, GNorm = 1.5414, lr_0 = 1.2139e-04
Validation prc-auc = 0.675418
Validation auc = 0.811111
Epoch 27
Loss = 1.5857e-01, PNorm = 77.0948, GNorm = 1.1657, lr_0 = 1.1753e-04
Loss = 1.8013e-01, PNorm = 77.1110, GNorm = 0.9061, lr_0 = 1.1413e-04
Loss = 2.0056e-01, PNorm = 77.1265, GNorm = 1.8167, lr_0 = 1.1083e-04
Validation prc-auc = 0.688277
Validation auc = 0.801880
Epoch 28
Loss = 1.5545e-01, PNorm = 77.1401, GNorm = 1.1858, lr_0 = 1.0730e-04
Loss = 1.8005e-01, PNorm = 77.1552, GNorm = 0.9677, lr_0 = 1.0420e-04
Loss = 1.8336e-01, PNorm = 77.1693, GNorm = 0.8368, lr_0 = 1.0118e-04
Validation prc-auc = 0.673991
Validation auc = 0.801026
Epoch 29
Loss = 1.7438e-01, PNorm = 77.1818, GNorm = 1.0672, lr_0 = 1.0000e-04
Loss = 1.6341e-01, PNorm = 77.1967, GNorm = 1.5812, lr_0 = 1.0000e-04
Loss = 1.5574e-01, PNorm = 77.2106, GNorm = 1.4606, lr_0 = 1.0000e-04
Validation prc-auc = 0.668433
Validation auc = 0.802051
Model 0 best validation prc-auc = 0.698258 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.585705
Model 0 test auc = 0.743613
Ensemble test prc-auc = 0.585705
Ensemble test auc = 0.743613
Fold 22
Splitting data with seed 22
Total scaffolds = 870 | train scaffolds = 644 | val scaffolds = 100 | test scaffolds = 126
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 8.7647e-01, PNorm = 72.7484, GNorm = 0.5095, lr_0 = 1.0000e-03
Loss = 4.3249e-01, PNorm = 73.1405, GNorm = 0.6230, lr_0 = 1.0000e-03
Validation prc-auc = 0.340500
Validation auc = 0.635708
Epoch 1
Loss = 4.8941e-01, PNorm = 73.3691, GNorm = 1.1029, lr_0 = 1.0000e-03
Loss = 4.2048e-01, PNorm = 73.4859, GNorm = 0.5332, lr_0 = 1.0000e-03
Loss = 4.2399e-01, PNorm = 73.5673, GNorm = 0.5847, lr_0 = 1.0000e-03
Validation prc-auc = 0.429220
Validation auc = 0.724869
Epoch 2
Loss = 4.0769e-01, PNorm = 73.6378, GNorm = 0.5308, lr_0 = 9.7965e-04
Loss = 4.1307e-01, PNorm = 73.7036, GNorm = 1.2126, lr_0 = 9.5130e-04
Loss = 4.0753e-01, PNorm = 73.7581, GNorm = 0.5398, lr_0 = 9.2376e-04
Validation prc-auc = 0.497236
Validation auc = 0.793051
Epoch 3
Loss = 3.5638e-01, PNorm = 73.8323, GNorm = 1.3863, lr_0 = 8.9440e-04
Loss = 3.8487e-01, PNorm = 73.8919, GNorm = 0.7470, lr_0 = 8.6851e-04
Loss = 4.5507e-01, PNorm = 73.9496, GNorm = 0.7195, lr_0 = 8.4337e-04
Validation prc-auc = 0.477626
Validation auc = 0.778191
Epoch 4
Loss = 3.7851e-01, PNorm = 74.0178, GNorm = 0.7167, lr_0 = 8.1656e-04
Loss = 4.3421e-01, PNorm = 74.0801, GNorm = 0.7210, lr_0 = 7.9293e-04
Loss = 3.7013e-01, PNorm = 74.1354, GNorm = 0.6724, lr_0 = 7.6998e-04
Loss = 1.3996e-01, PNorm = 74.1428, GNorm = 1.2600, lr_0 = 7.6772e-04
Validation prc-auc = 0.529849
Validation auc = 0.792614
Epoch 5
Loss = 3.9071e-01, PNorm = 74.1988, GNorm = 0.9839, lr_0 = 7.4550e-04
Loss = 3.8796e-01, PNorm = 74.2511, GNorm = 0.7108, lr_0 = 7.2393e-04
Validation prc-auc = 0.496407
Validation auc = 0.786932
Epoch 6
Loss = 5.0504e-01, PNorm = 74.3118, GNorm = 0.9956, lr_0 = 7.0091e-04
Loss = 4.1483e-01, PNorm = 74.3555, GNorm = 0.6811, lr_0 = 6.8063e-04
Loss = 3.5252e-01, PNorm = 74.4182, GNorm = 0.5573, lr_0 = 6.6093e-04
Validation prc-auc = 0.496479
Validation auc = 0.779939
Epoch 7
Loss = 4.2133e-01, PNorm = 74.4682, GNorm = 1.2059, lr_0 = 6.3992e-04
Loss = 3.8384e-01, PNorm = 74.5142, GNorm = 0.6996, lr_0 = 6.2139e-04
Loss = 3.4462e-01, PNorm = 74.5642, GNorm = 0.5843, lr_0 = 6.0341e-04
Validation prc-auc = 0.542300
Validation auc = 0.794362
Epoch 8
Loss = 2.8771e-01, PNorm = 74.6185, GNorm = 0.5974, lr_0 = 5.8595e-04
Loss = 3.7072e-01, PNorm = 74.6751, GNorm = 0.6622, lr_0 = 5.6899e-04
Loss = 3.7402e-01, PNorm = 74.7273, GNorm = 0.6641, lr_0 = 5.5252e-04
Validation prc-auc = 0.494700
Validation auc = 0.770542
Epoch 9
Loss = 3.4010e-01, PNorm = 74.7850, GNorm = 0.7211, lr_0 = 5.3495e-04
Loss = 3.4640e-01, PNorm = 74.8335, GNorm = 0.5196, lr_0 = 5.1947e-04
Loss = 3.4460e-01, PNorm = 74.8936, GNorm = 1.0848, lr_0 = 5.0444e-04
Validation prc-auc = 0.560454
Validation auc = 0.809878
Epoch 10
Loss = 2.9795e-01, PNorm = 74.9566, GNorm = 0.6058, lr_0 = 4.8840e-04
Loss = 3.9397e-01, PNorm = 75.0046, GNorm = 0.9727, lr_0 = 4.7426e-04
Validation prc-auc = 0.547657
Validation auc = 0.794362
Epoch 11
Loss = 3.6521e-01, PNorm = 75.0733, GNorm = 1.1091, lr_0 = 4.5919e-04
Loss = 2.9716e-01, PNorm = 75.1310, GNorm = 0.7190, lr_0 = 4.4590e-04
Loss = 3.3411e-01, PNorm = 75.1826, GNorm = 0.7247, lr_0 = 4.3299e-04
Validation prc-auc = 0.564222
Validation auc = 0.804196
Epoch 12
Loss = 3.2919e-01, PNorm = 75.2462, GNorm = 0.6973, lr_0 = 4.1923e-04
Loss = 2.9456e-01, PNorm = 75.3192, GNorm = 1.0588, lr_0 = 4.0709e-04
Loss = 3.5200e-01, PNorm = 75.3708, GNorm = 1.3699, lr_0 = 3.9531e-04
Validation prc-auc = 0.547277
Validation auc = 0.789117
Epoch 13
Loss = 3.3974e-01, PNorm = 75.4277, GNorm = 0.6894, lr_0 = 3.8274e-04
Loss = 3.1223e-01, PNorm = 75.4770, GNorm = 1.2839, lr_0 = 3.7167e-04
Loss = 2.7892e-01, PNorm = 75.5236, GNorm = 0.6326, lr_0 = 3.6091e-04
Validation prc-auc = 0.540510
Validation auc = 0.784091
Epoch 14
Loss = 3.0988e-01, PNorm = 75.5825, GNorm = 0.9247, lr_0 = 3.4944e-04
Loss = 2.8039e-01, PNorm = 75.6412, GNorm = 0.7993, lr_0 = 3.3932e-04
Loss = 3.2877e-01, PNorm = 75.6821, GNorm = 0.9070, lr_0 = 3.2950e-04
Validation prc-auc = 0.529317
Validation auc = 0.753715
Epoch 15
Loss = 2.8719e-01, PNorm = 75.7200, GNorm = 0.9728, lr_0 = 3.1996e-04
Loss = 2.5492e-01, PNorm = 75.7583, GNorm = 0.7677, lr_0 = 3.1070e-04
Loss = 3.2836e-01, PNorm = 75.7971, GNorm = 1.0182, lr_0 = 3.0171e-04
Loss = 1.4573e-01, PNorm = 75.8009, GNorm = 1.4395, lr_0 = 3.0083e-04
Validation prc-auc = 0.577810
Validation auc = 0.791958
Epoch 16
Loss = 2.7778e-01, PNorm = 75.8358, GNorm = 0.9977, lr_0 = 2.9212e-04
Loss = 2.4032e-01, PNorm = 75.8762, GNorm = 0.6731, lr_0 = 2.8367e-04
Validation prc-auc = 0.512453
Validation auc = 0.765079
Epoch 17
Loss = 2.7120e-01, PNorm = 75.9111, GNorm = 0.7472, lr_0 = 2.7465e-04
Loss = 2.4722e-01, PNorm = 75.9510, GNorm = 1.1365, lr_0 = 2.6670e-04
Loss = 2.4972e-01, PNorm = 75.9860, GNorm = 0.9843, lr_0 = 2.5898e-04
Validation prc-auc = 0.565962
Validation auc = 0.791302
Epoch 18
Loss = 2.6392e-01, PNorm = 76.0197, GNorm = 1.7164, lr_0 = 2.5075e-04
Loss = 2.9503e-01, PNorm = 76.0523, GNorm = 0.9300, lr_0 = 2.4349e-04
Loss = 2.4698e-01, PNorm = 76.0911, GNorm = 0.9213, lr_0 = 2.3644e-04
Validation prc-auc = 0.515278
Validation auc = 0.766390
Epoch 19
Loss = 2.6211e-01, PNorm = 76.1284, GNorm = 1.1686, lr_0 = 2.2893e-04
Loss = 2.6055e-01, PNorm = 76.1586, GNorm = 0.7419, lr_0 = 2.2230e-04
Loss = 2.8269e-01, PNorm = 76.1882, GNorm = 0.8591, lr_0 = 2.1587e-04
Validation prc-auc = 0.528836
Validation auc = 0.775568
Epoch 20
Loss = 2.4932e-01, PNorm = 76.2257, GNorm = 1.2213, lr_0 = 2.0900e-04
Loss = 2.2999e-01, PNorm = 76.2524, GNorm = 1.1141, lr_0 = 2.0295e-04
Loss = 2.7123e-01, PNorm = 76.2770, GNorm = 0.8462, lr_0 = 1.9708e-04
Loss = 3.9090e-01, PNorm = 76.2781, GNorm = 3.8206, lr_0 = 1.9650e-04
Validation prc-auc = 0.558811
Validation auc = 0.796766
Epoch 21
Loss = 2.3569e-01, PNorm = 76.3060, GNorm = 0.6317, lr_0 = 1.9081e-04
Loss = 2.6927e-01, PNorm = 76.3277, GNorm = 1.2271, lr_0 = 1.8529e-04
Validation prc-auc = 0.523552
Validation auc = 0.757212
Epoch 22
Loss = 1.7660e-01, PNorm = 76.3556, GNorm = 0.7760, lr_0 = 1.7993e-04
Loss = 2.5499e-01, PNorm = 76.3818, GNorm = 1.4205, lr_0 = 1.7472e-04
Loss = 2.5275e-01, PNorm = 76.3999, GNorm = 1.2843, lr_0 = 1.6966e-04
Validation prc-auc = 0.551157
Validation auc = 0.787369
Epoch 23
Loss = 2.4037e-01, PNorm = 76.4230, GNorm = 0.9880, lr_0 = 1.6427e-04
Loss = 2.2828e-01, PNorm = 76.4427, GNorm = 0.5784, lr_0 = 1.5952e-04
Loss = 2.4690e-01, PNorm = 76.4605, GNorm = 0.8885, lr_0 = 1.5490e-04
Validation prc-auc = 0.546834
Validation auc = 0.781469
Epoch 24
Loss = 2.0410e-01, PNorm = 76.4825, GNorm = 1.1556, lr_0 = 1.4998e-04
Loss = 2.3609e-01, PNorm = 76.4976, GNorm = 1.4558, lr_0 = 1.4563e-04
Loss = 2.0829e-01, PNorm = 76.5143, GNorm = 1.3813, lr_0 = 1.4142e-04
Validation prc-auc = 0.522316
Validation auc = 0.772509
Epoch 25
Loss = 2.0722e-01, PNorm = 76.5297, GNorm = 0.8900, lr_0 = 1.3692e-04
Loss = 2.5385e-01, PNorm = 76.5470, GNorm = 1.2519, lr_0 = 1.3296e-04
Loss = 2.3361e-01, PNorm = 76.5681, GNorm = 1.8064, lr_0 = 1.2911e-04
Validation prc-auc = 0.525421
Validation auc = 0.763330
Epoch 26
Loss = 1.9702e-01, PNorm = 76.5780, GNorm = 1.0175, lr_0 = 1.2501e-04
Loss = 2.3067e-01, PNorm = 76.5949, GNorm = 1.6506, lr_0 = 1.2139e-04
Validation prc-auc = 0.526730
Validation auc = 0.772290
Epoch 27
Loss = 1.2123e-01, PNorm = 76.6077, GNorm = 0.6964, lr_0 = 1.1753e-04
Loss = 2.1187e-01, PNorm = 76.6208, GNorm = 1.5716, lr_0 = 1.1413e-04
Loss = 2.2471e-01, PNorm = 76.6342, GNorm = 1.3683, lr_0 = 1.1083e-04
Validation prc-auc = 0.520971
Validation auc = 0.767920
Epoch 28
Loss = 1.8194e-01, PNorm = 76.6479, GNorm = 0.8568, lr_0 = 1.0730e-04
Loss = 1.9533e-01, PNorm = 76.6611, GNorm = 1.1572, lr_0 = 1.0420e-04
Loss = 2.1561e-01, PNorm = 76.6720, GNorm = 1.5769, lr_0 = 1.0118e-04
Validation prc-auc = 0.540151
Validation auc = 0.779502
Epoch 29
Loss = 1.8806e-01, PNorm = 76.6826, GNorm = 1.6462, lr_0 = 1.0000e-04
Loss = 1.8813e-01, PNorm = 76.6962, GNorm = 1.3642, lr_0 = 1.0000e-04
Loss = 1.9862e-01, PNorm = 76.7065, GNorm = 1.0676, lr_0 = 1.0000e-04
Validation prc-auc = 0.540612
Validation auc = 0.769886
Model 0 best validation prc-auc = 0.577810 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.646887
Model 0 test auc = 0.817168
Ensemble test prc-auc = 0.646887
Ensemble test auc = 0.817168
Fold 23
Splitting data with seed 23
Total scaffolds = 870 | train scaffolds = 646 | val scaffolds = 113 | test scaffolds = 111
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.1306e-01, PNorm = 72.7654, GNorm = 0.8159, lr_0 = 1.0000e-03
Loss = 4.8934e-01, PNorm = 73.1534, GNorm = 0.9380, lr_0 = 1.0000e-03
Validation prc-auc = 0.582357
Validation auc = 0.823996
Epoch 1
Loss = 3.8264e-01, PNorm = 73.3883, GNorm = 0.3832, lr_0 = 1.0000e-03
Loss = 4.2770e-01, PNorm = 73.5047, GNorm = 1.1026, lr_0 = 1.0000e-03
Loss = 4.6535e-01, PNorm = 73.5726, GNorm = 0.7838, lr_0 = 1.0000e-03
Validation prc-auc = 0.521413
Validation auc = 0.770261
Epoch 2
Loss = 3.8506e-01, PNorm = 73.6456, GNorm = 0.4273, lr_0 = 9.7965e-04
Loss = 4.0450e-01, PNorm = 73.7025, GNorm = 0.5032, lr_0 = 9.5130e-04
Loss = 4.1603e-01, PNorm = 73.7586, GNorm = 0.6359, lr_0 = 9.2376e-04
Validation prc-auc = 0.657047
Validation auc = 0.851832
Epoch 3
Loss = 3.4521e-01, PNorm = 73.8241, GNorm = 0.5623, lr_0 = 8.9440e-04
Loss = 4.0503e-01, PNorm = 73.8888, GNorm = 0.6163, lr_0 = 8.6851e-04
Loss = 4.2472e-01, PNorm = 73.9446, GNorm = 0.8177, lr_0 = 8.4337e-04
Validation prc-auc = 0.660600
Validation auc = 0.858351
Epoch 4
Loss = 4.4113e-01, PNorm = 74.0130, GNorm = 1.3394, lr_0 = 8.1656e-04
Loss = 3.9367e-01, PNorm = 74.0857, GNorm = 1.2061, lr_0 = 7.9293e-04
Loss = 3.4700e-01, PNorm = 74.1458, GNorm = 0.8068, lr_0 = 7.6998e-04
Loss = 2.1476e-01, PNorm = 74.1534, GNorm = 1.2120, lr_0 = 7.6772e-04
Validation prc-auc = 0.683139
Validation auc = 0.846723
Epoch 5
Loss = 4.0021e-01, PNorm = 74.2168, GNorm = 1.0425, lr_0 = 7.4550e-04
Loss = 4.1087e-01, PNorm = 74.2849, GNorm = 0.8916, lr_0 = 7.2393e-04
Validation prc-auc = 0.628986
Validation auc = 0.855004
Epoch 6
Loss = 2.3670e-01, PNorm = 74.3545, GNorm = 0.5124, lr_0 = 7.0091e-04
Loss = 3.8211e-01, PNorm = 74.4146, GNorm = 0.5565, lr_0 = 6.8063e-04
Loss = 3.9415e-01, PNorm = 74.4871, GNorm = 0.6398, lr_0 = 6.6093e-04
Validation prc-auc = 0.690707
Validation auc = 0.862579
Epoch 7
Loss = 3.9377e-01, PNorm = 74.5581, GNorm = 0.6716, lr_0 = 6.3992e-04
Loss = 3.6419e-01, PNorm = 74.6340, GNorm = 0.7010, lr_0 = 6.2139e-04
Loss = 3.4906e-01, PNorm = 74.7053, GNorm = 0.7185, lr_0 = 6.0341e-04
Validation prc-auc = 0.678548
Validation auc = 0.872093
Epoch 8
Loss = 3.2820e-01, PNorm = 74.7799, GNorm = 0.5227, lr_0 = 5.8595e-04
Loss = 3.6567e-01, PNorm = 74.8634, GNorm = 0.8840, lr_0 = 5.6899e-04
Loss = 4.1234e-01, PNorm = 74.9264, GNorm = 1.0011, lr_0 = 5.5252e-04
Validation prc-auc = 0.626166
Validation auc = 0.837738
Epoch 9
Loss = 3.4763e-01, PNorm = 75.0049, GNorm = 0.5656, lr_0 = 5.3495e-04
Loss = 3.6584e-01, PNorm = 75.0730, GNorm = 0.6812, lr_0 = 5.1947e-04
Loss = 3.2359e-01, PNorm = 75.1236, GNorm = 0.5361, lr_0 = 5.0444e-04
Validation prc-auc = 0.709036
Validation auc = 0.877555
Epoch 10
Loss = 3.0312e-01, PNorm = 75.1945, GNorm = 0.9764, lr_0 = 4.8840e-04
Loss = 3.8810e-01, PNorm = 75.2483, GNorm = 0.9467, lr_0 = 4.7426e-04
Validation prc-auc = 0.705767
Validation auc = 0.863636
Epoch 11
Loss = 2.1436e-01, PNorm = 75.3105, GNorm = 0.5701, lr_0 = 4.5919e-04
Loss = 3.1579e-01, PNorm = 75.3677, GNorm = 0.6237, lr_0 = 4.4590e-04
Loss = 3.6261e-01, PNorm = 75.4260, GNorm = 0.6517, lr_0 = 4.3299e-04
Validation prc-auc = 0.653419
Validation auc = 0.826462
Epoch 12
Loss = 3.8459e-01, PNorm = 75.4852, GNorm = 0.7421, lr_0 = 4.1923e-04
Loss = 3.2518e-01, PNorm = 75.5505, GNorm = 1.3115, lr_0 = 4.0709e-04
Loss = 2.9694e-01, PNorm = 75.5995, GNorm = 0.8548, lr_0 = 3.9531e-04
Validation prc-auc = 0.760158
Validation auc = 0.887068
Epoch 13
Loss = 3.0860e-01, PNorm = 75.6549, GNorm = 0.7549, lr_0 = 3.8274e-04
Loss = 2.6182e-01, PNorm = 75.7049, GNorm = 0.7556, lr_0 = 3.7167e-04
Loss = 3.5751e-01, PNorm = 75.7399, GNorm = 0.9084, lr_0 = 3.6091e-04
Validation prc-auc = 0.731883
Validation auc = 0.868041
Epoch 14
Loss = 2.7713e-01, PNorm = 75.7938, GNorm = 0.6300, lr_0 = 3.4944e-04
Loss = 3.2142e-01, PNorm = 75.8376, GNorm = 0.7890, lr_0 = 3.3932e-04
Loss = 3.1384e-01, PNorm = 75.8840, GNorm = 1.0529, lr_0 = 3.2950e-04
Validation prc-auc = 0.720299
Validation auc = 0.876674
Epoch 15
Loss = 3.7716e-01, PNorm = 75.9169, GNorm = 0.8516, lr_0 = 3.1996e-04
Loss = 2.9504e-01, PNorm = 75.9718, GNorm = 0.6953, lr_0 = 3.1070e-04
Loss = 3.3150e-01, PNorm = 76.0090, GNorm = 0.5718, lr_0 = 3.0171e-04
Loss = 3.0148e-01, PNorm = 76.0117, GNorm = 1.5026, lr_0 = 3.0083e-04
Validation prc-auc = 0.753582
Validation auc = 0.885130
Epoch 16
Loss = 2.5563e-01, PNorm = 76.0538, GNorm = 0.7467, lr_0 = 2.9212e-04
Loss = 3.1704e-01, PNorm = 76.0849, GNorm = 0.7777, lr_0 = 2.8367e-04
Validation prc-auc = 0.751885
Validation auc = 0.885130
Epoch 17
Loss = 2.2360e-01, PNorm = 76.1283, GNorm = 0.5626, lr_0 = 2.7465e-04
Loss = 3.1643e-01, PNorm = 76.1694, GNorm = 2.9391, lr_0 = 2.6670e-04
Loss = 2.8379e-01, PNorm = 76.2022, GNorm = 0.6890, lr_0 = 2.5898e-04
Validation prc-auc = 0.729459
Validation auc = 0.875440
Epoch 18
Loss = 3.3735e-01, PNorm = 76.2493, GNorm = 0.5994, lr_0 = 2.5075e-04
Loss = 2.4040e-01, PNorm = 76.2741, GNorm = 0.8430, lr_0 = 2.4349e-04
Loss = 2.9113e-01, PNorm = 76.3088, GNorm = 0.6809, lr_0 = 2.3644e-04
Validation prc-auc = 0.732274
Validation auc = 0.873150
Epoch 19
Loss = 2.8600e-01, PNorm = 76.3427, GNorm = 0.6450, lr_0 = 2.2893e-04
Loss = 2.7512e-01, PNorm = 76.3735, GNorm = 0.8702, lr_0 = 2.2230e-04
Loss = 2.5262e-01, PNorm = 76.4039, GNorm = 0.8006, lr_0 = 2.1587e-04
Validation prc-auc = 0.744801
Validation auc = 0.885130
Epoch 20
Loss = 2.9565e-01, PNorm = 76.4337, GNorm = 0.9024, lr_0 = 2.0900e-04
Loss = 2.7455e-01, PNorm = 76.4655, GNorm = 1.0716, lr_0 = 2.0295e-04
Loss = 2.5868e-01, PNorm = 76.4886, GNorm = 1.2509, lr_0 = 1.9708e-04
Loss = 5.8685e-02, PNorm = 76.4908, GNorm = 0.6498, lr_0 = 1.9650e-04
Validation prc-auc = 0.769662
Validation auc = 0.895701
Epoch 21
Loss = 2.6507e-01, PNorm = 76.5156, GNorm = 0.7838, lr_0 = 1.9081e-04
Loss = 2.4358e-01, PNorm = 76.5412, GNorm = 0.7973, lr_0 = 1.8529e-04
Validation prc-auc = 0.761750
Validation auc = 0.887773
Epoch 22
Loss = 2.9508e-01, PNorm = 76.5637, GNorm = 0.7905, lr_0 = 1.7993e-04
Loss = 2.4007e-01, PNorm = 76.5890, GNorm = 0.9503, lr_0 = 1.7472e-04
Loss = 2.5189e-01, PNorm = 76.6075, GNorm = 0.9907, lr_0 = 1.6966e-04
Validation prc-auc = 0.770100
Validation auc = 0.888125
Epoch 23
Loss = 2.8669e-01, PNorm = 76.6326, GNorm = 0.7867, lr_0 = 1.6427e-04
Loss = 2.2985e-01, PNorm = 76.6535, GNorm = 0.7165, lr_0 = 1.5952e-04
Loss = 2.2076e-01, PNorm = 76.6745, GNorm = 1.0000, lr_0 = 1.5490e-04
Validation prc-auc = 0.761847
Validation auc = 0.871564
Epoch 24
Loss = 2.9271e-01, PNorm = 76.6957, GNorm = 1.0221, lr_0 = 1.4998e-04
Loss = 2.2394e-01, PNorm = 76.7141, GNorm = 1.0072, lr_0 = 1.4563e-04
Loss = 2.3612e-01, PNorm = 76.7303, GNorm = 0.9840, lr_0 = 1.4142e-04
Validation prc-auc = 0.771392
Validation auc = 0.882840
Epoch 25
Loss = 1.9594e-01, PNorm = 76.7538, GNorm = 1.2035, lr_0 = 1.3692e-04
Loss = 2.5669e-01, PNorm = 76.7692, GNorm = 1.1351, lr_0 = 1.3296e-04
Loss = 2.6269e-01, PNorm = 76.7878, GNorm = 0.9234, lr_0 = 1.2911e-04
Validation prc-auc = 0.773374
Validation auc = 0.886364
Epoch 26
Loss = 2.4383e-01, PNorm = 76.8080, GNorm = 0.9930, lr_0 = 1.2501e-04
Loss = 2.3613e-01, PNorm = 76.8243, GNorm = 0.9847, lr_0 = 1.2139e-04
Validation prc-auc = 0.757725
Validation auc = 0.878083
Epoch 27
Loss = 2.9579e-01, PNorm = 76.8400, GNorm = 1.3437, lr_0 = 1.1753e-04
Loss = 2.0321e-01, PNorm = 76.8548, GNorm = 0.8448, lr_0 = 1.1413e-04
Loss = 1.8289e-01, PNorm = 76.8689, GNorm = 0.8803, lr_0 = 1.1083e-04
Validation prc-auc = 0.761513
Validation auc = 0.875617
Epoch 28
Loss = 2.4560e-01, PNorm = 76.8813, GNorm = 1.1208, lr_0 = 1.0730e-04
Loss = 2.1035e-01, PNorm = 76.8963, GNorm = 0.9885, lr_0 = 1.0420e-04
Loss = 2.0251e-01, PNorm = 76.9088, GNorm = 0.7594, lr_0 = 1.0118e-04
Validation prc-auc = 0.759505
Validation auc = 0.874383
Epoch 29
Loss = 2.0644e-01, PNorm = 76.9184, GNorm = 0.9276, lr_0 = 1.0000e-04
Loss = 2.0270e-01, PNorm = 76.9313, GNorm = 0.9812, lr_0 = 1.0000e-04
Loss = 1.9598e-01, PNorm = 76.9436, GNorm = 0.6602, lr_0 = 1.0000e-04
Validation prc-auc = 0.766220
Validation auc = 0.872445
Model 0 best validation prc-auc = 0.773374 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.573706
Model 0 test auc = 0.777609
Ensemble test prc-auc = 0.573706
Ensemble test auc = 0.777609
Fold 24
Splitting data with seed 24
Total scaffolds = 870 | train scaffolds = 643 | val scaffolds = 106 | test scaffolds = 121
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.4488e-01, PNorm = 72.7760, GNorm = 0.6605, lr_0 = 1.0000e-03
Loss = 4.7779e-01, PNorm = 73.1851, GNorm = 0.7544, lr_0 = 1.0000e-03
Validation prc-auc = 0.550411
Validation auc = 0.764502
Epoch 1
Loss = 4.8673e-01, PNorm = 73.4295, GNorm = 0.7921, lr_0 = 1.0000e-03
Loss = 3.8719e-01, PNorm = 73.5592, GNorm = 0.6309, lr_0 = 1.0000e-03
Loss = 4.3086e-01, PNorm = 73.6466, GNorm = 0.6709, lr_0 = 1.0000e-03
Validation prc-auc = 0.569197
Validation auc = 0.777372
Epoch 2
Loss = 4.8081e-01, PNorm = 73.7264, GNorm = 0.8327, lr_0 = 9.7965e-04
Loss = 4.2952e-01, PNorm = 73.7958, GNorm = 0.7881, lr_0 = 9.5130e-04
Loss = 4.0934e-01, PNorm = 73.8681, GNorm = 1.3032, lr_0 = 9.2376e-04
Validation prc-auc = 0.565415
Validation auc = 0.773915
Epoch 3
Loss = 3.8761e-01, PNorm = 73.9350, GNorm = 1.0778, lr_0 = 8.9440e-04
Loss = 3.9926e-01, PNorm = 73.9941, GNorm = 0.5679, lr_0 = 8.6851e-04
Loss = 4.2130e-01, PNorm = 74.0577, GNorm = 0.5167, lr_0 = 8.4337e-04
Validation prc-auc = 0.558523
Validation auc = 0.784864
Epoch 4
Loss = 3.7899e-01, PNorm = 74.1234, GNorm = 0.6153, lr_0 = 8.1656e-04
Loss = 4.2829e-01, PNorm = 74.1922, GNorm = 0.7627, lr_0 = 7.9293e-04
Loss = 3.7132e-01, PNorm = 74.2496, GNorm = 0.5136, lr_0 = 7.6998e-04
Loss = 6.7343e-01, PNorm = 74.2524, GNorm = 2.9156, lr_0 = 7.6772e-04
Validation prc-auc = 0.584636
Validation auc = 0.783903
Epoch 5
Loss = 3.9092e-01, PNorm = 74.3251, GNorm = 0.6258, lr_0 = 7.4550e-04
Loss = 4.0345e-01, PNorm = 74.3759, GNorm = 0.5908, lr_0 = 7.2393e-04
Validation prc-auc = 0.596149
Validation auc = 0.785248
Epoch 6
Loss = 3.4559e-01, PNorm = 74.4521, GNorm = 0.9576, lr_0 = 7.0091e-04
Loss = 3.9296e-01, PNorm = 74.5048, GNorm = 0.7021, lr_0 = 6.8063e-04
Loss = 3.6981e-01, PNorm = 74.5592, GNorm = 0.9149, lr_0 = 6.6093e-04
Validation prc-auc = 0.609670
Validation auc = 0.798118
Epoch 7
Loss = 3.3679e-01, PNorm = 74.6244, GNorm = 0.9913, lr_0 = 6.3992e-04
Loss = 3.6196e-01, PNorm = 74.6865, GNorm = 0.6190, lr_0 = 6.2139e-04
Loss = 3.7987e-01, PNorm = 74.7431, GNorm = 0.5834, lr_0 = 6.0341e-04
Validation prc-auc = 0.611107
Validation auc = 0.809835
Epoch 8
Loss = 3.4547e-01, PNorm = 74.8074, GNorm = 0.6171, lr_0 = 5.8595e-04
Loss = 3.1843e-01, PNorm = 74.8719, GNorm = 0.9684, lr_0 = 5.6899e-04
Loss = 3.6139e-01, PNorm = 74.9200, GNorm = 0.5760, lr_0 = 5.5252e-04
Validation prc-auc = 0.627505
Validation auc = 0.810027
Epoch 9
Loss = 3.2081e-01, PNorm = 74.9899, GNorm = 0.5626, lr_0 = 5.3495e-04
Loss = 3.2530e-01, PNorm = 75.0533, GNorm = 0.6159, lr_0 = 5.1947e-04
Loss = 3.5937e-01, PNorm = 75.1137, GNorm = 0.6220, lr_0 = 5.0444e-04
Validation prc-auc = 0.639256
Validation auc = 0.810411
Epoch 10
Loss = 3.4902e-01, PNorm = 75.1901, GNorm = 0.6560, lr_0 = 4.8840e-04
Loss = 3.4959e-01, PNorm = 75.2521, GNorm = 1.0213, lr_0 = 4.7426e-04
Validation prc-auc = 0.610550
Validation auc = 0.811371
Epoch 11
Loss = 3.3027e-01, PNorm = 75.3238, GNorm = 0.9372, lr_0 = 4.5919e-04
Loss = 3.1994e-01, PNorm = 75.3801, GNorm = 0.9356, lr_0 = 4.4590e-04
Loss = 3.4397e-01, PNorm = 75.4422, GNorm = 1.1265, lr_0 = 4.3299e-04
Validation prc-auc = 0.663818
Validation auc = 0.833269
Epoch 12
Loss = 2.3143e-01, PNorm = 75.5085, GNorm = 0.6101, lr_0 = 4.1923e-04
Loss = 3.2929e-01, PNorm = 75.5638, GNorm = 0.6443, lr_0 = 4.0709e-04
Loss = 3.3173e-01, PNorm = 75.6341, GNorm = 0.6268, lr_0 = 3.9531e-04
Validation prc-auc = 0.641005
Validation auc = 0.818095
Epoch 13
Loss = 3.1210e-01, PNorm = 75.6956, GNorm = 0.9138, lr_0 = 3.8274e-04
Loss = 3.1639e-01, PNorm = 75.7430, GNorm = 0.5541, lr_0 = 3.7167e-04
Loss = 3.2034e-01, PNorm = 75.7880, GNorm = 0.6067, lr_0 = 3.6091e-04
Validation prc-auc = 0.657190
Validation auc = 0.818671
Epoch 14
Loss = 3.4965e-01, PNorm = 75.8456, GNorm = 0.7730, lr_0 = 3.4944e-04
Loss = 2.9044e-01, PNorm = 75.9031, GNorm = 0.9616, lr_0 = 3.3932e-04
Loss = 2.6440e-01, PNorm = 75.9496, GNorm = 0.8524, lr_0 = 3.2950e-04
Validation prc-auc = 0.665147
Validation auc = 0.832693
Epoch 15
Loss = 2.8448e-01, PNorm = 76.0010, GNorm = 1.4483, lr_0 = 3.1996e-04
Loss = 2.5794e-01, PNorm = 76.0559, GNorm = 1.0266, lr_0 = 3.1070e-04
Loss = 2.9471e-01, PNorm = 76.1024, GNorm = 1.3549, lr_0 = 3.0171e-04
Loss = 2.8358e-01, PNorm = 76.1065, GNorm = 2.3603, lr_0 = 3.0083e-04
Validation prc-auc = 0.690742
Validation auc = 0.844410
Epoch 16
Loss = 2.6587e-01, PNorm = 76.1521, GNorm = 0.5601, lr_0 = 2.9212e-04
Loss = 3.0519e-01, PNorm = 76.1992, GNorm = 0.8558, lr_0 = 2.8367e-04
Validation prc-auc = 0.670816
Validation auc = 0.831925
Epoch 17
Loss = 2.7765e-01, PNorm = 76.2525, GNorm = 1.2601, lr_0 = 2.7465e-04
Loss = 2.3872e-01, PNorm = 76.2991, GNorm = 0.7633, lr_0 = 2.6670e-04
Loss = 2.7963e-01, PNorm = 76.3328, GNorm = 0.9545, lr_0 = 2.5898e-04
Validation prc-auc = 0.701458
Validation auc = 0.848060
Epoch 18
Loss = 2.4692e-01, PNorm = 76.3767, GNorm = 1.1138, lr_0 = 2.5075e-04
Loss = 2.6200e-01, PNorm = 76.4168, GNorm = 0.9516, lr_0 = 2.4349e-04
Loss = 2.6447e-01, PNorm = 76.4445, GNorm = 1.1515, lr_0 = 2.3644e-04
Validation prc-auc = 0.684933
Validation auc = 0.830964
Epoch 19
Loss = 2.5478e-01, PNorm = 76.4864, GNorm = 0.9108, lr_0 = 2.2893e-04
Loss = 2.2532e-01, PNorm = 76.5147, GNorm = 0.6550, lr_0 = 2.2230e-04
Loss = 2.5589e-01, PNorm = 76.5442, GNorm = 0.9380, lr_0 = 2.1587e-04
Validation prc-auc = 0.702412
Validation auc = 0.854399
Epoch 20
Loss = 2.9650e-01, PNorm = 76.5757, GNorm = 0.8388, lr_0 = 2.0900e-04
Loss = 2.4393e-01, PNorm = 76.6072, GNorm = 0.8040, lr_0 = 2.0295e-04
Loss = 2.1405e-01, PNorm = 76.6423, GNorm = 1.3089, lr_0 = 1.9708e-04
Loss = 6.5604e-02, PNorm = 76.6452, GNorm = 0.8891, lr_0 = 1.9650e-04
Validation prc-auc = 0.708729
Validation auc = 0.855743
Epoch 21
Loss = 2.2682e-01, PNorm = 76.6691, GNorm = 1.0334, lr_0 = 1.9081e-04
Loss = 2.3678e-01, PNorm = 76.6945, GNorm = 1.2108, lr_0 = 1.8529e-04
Validation prc-auc = 0.712514
Validation auc = 0.851517
Epoch 22
Loss = 1.8996e-01, PNorm = 76.7214, GNorm = 0.9169, lr_0 = 1.7993e-04
Loss = 2.3932e-01, PNorm = 76.7446, GNorm = 0.7807, lr_0 = 1.7472e-04
Loss = 2.6401e-01, PNorm = 76.7738, GNorm = 0.8586, lr_0 = 1.6966e-04
Validation prc-auc = 0.695116
Validation auc = 0.848060
Epoch 23
Loss = 1.9983e-01, PNorm = 76.8042, GNorm = 1.4447, lr_0 = 1.6427e-04
Loss = 2.1074e-01, PNorm = 76.8258, GNorm = 0.7601, lr_0 = 1.5952e-04
Loss = 2.5291e-01, PNorm = 76.8483, GNorm = 0.6182, lr_0 = 1.5490e-04
Validation prc-auc = 0.726009
Validation auc = 0.849789
Epoch 24
Loss = 1.9721e-01, PNorm = 76.8737, GNorm = 1.1239, lr_0 = 1.4998e-04
Loss = 1.9768e-01, PNorm = 76.8967, GNorm = 0.6701, lr_0 = 1.4563e-04
Loss = 2.3503e-01, PNorm = 76.9128, GNorm = 2.0038, lr_0 = 1.4142e-04
Validation prc-auc = 0.728580
Validation auc = 0.851710
Epoch 25
Loss = 2.6693e-01, PNorm = 76.9366, GNorm = 1.0609, lr_0 = 1.3692e-04
Loss = 1.8545e-01, PNorm = 76.9564, GNorm = 1.1396, lr_0 = 1.3296e-04
Loss = 1.8767e-01, PNorm = 76.9791, GNorm = 1.0268, lr_0 = 1.2911e-04
Validation prc-auc = 0.733392
Validation auc = 0.856320
Epoch 26
Loss = 2.0062e-01, PNorm = 76.9938, GNorm = 2.0761, lr_0 = 1.2501e-04
Loss = 1.9653e-01, PNorm = 77.0134, GNorm = 0.9327, lr_0 = 1.2139e-04
Validation prc-auc = 0.725735
Validation auc = 0.858817
Epoch 27
Loss = 2.3263e-01, PNorm = 77.0256, GNorm = 1.0213, lr_0 = 1.1753e-04
Loss = 1.9509e-01, PNorm = 77.0419, GNorm = 0.8370, lr_0 = 1.1413e-04
Loss = 1.9964e-01, PNorm = 77.0582, GNorm = 1.4814, lr_0 = 1.1083e-04
Validation prc-auc = 0.721919
Validation auc = 0.855167
Epoch 28
Loss = 1.9701e-01, PNorm = 77.0747, GNorm = 0.9350, lr_0 = 1.0730e-04
Loss = 1.9490e-01, PNorm = 77.0884, GNorm = 1.1026, lr_0 = 1.0420e-04
Loss = 2.0400e-01, PNorm = 77.1013, GNorm = 1.3300, lr_0 = 1.0118e-04
Validation prc-auc = 0.720871
Validation auc = 0.855359
Epoch 29
Loss = 2.0707e-01, PNorm = 77.1140, GNorm = 0.6886, lr_0 = 1.0000e-04
Loss = 1.7038e-01, PNorm = 77.1251, GNorm = 1.3782, lr_0 = 1.0000e-04
Loss = 1.9119e-01, PNorm = 77.1356, GNorm = 0.8664, lr_0 = 1.0000e-04
Validation prc-auc = 0.728861
Validation auc = 0.862082
Model 0 best validation prc-auc = 0.733392 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.513564
Model 0 test auc = 0.702713
Ensemble test prc-auc = 0.513564
Ensemble test auc = 0.702713
Fold 25
Splitting data with seed 25
Total scaffolds = 870 | train scaffolds = 632 | val scaffolds = 110 | test scaffolds = 128
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 5.3418e-01, PNorm = 72.7702, GNorm = 1.0486, lr_0 = 1.0000e-03
Loss = 4.5847e-01, PNorm = 73.1514, GNorm = 1.3944, lr_0 = 1.0000e-03
Validation prc-auc = 0.520262
Validation auc = 0.718739
Epoch 1
Loss = 4.5684e-01, PNorm = 73.3790, GNorm = 0.7053, lr_0 = 1.0000e-03
Loss = 3.9530e-01, PNorm = 73.5064, GNorm = 0.5260, lr_0 = 1.0000e-03
Loss = 4.2826e-01, PNorm = 73.5966, GNorm = 0.5360, lr_0 = 1.0000e-03
Validation prc-auc = 0.576458
Validation auc = 0.735254
Epoch 2
Loss = 3.7596e-01, PNorm = 73.6797, GNorm = 0.5608, lr_0 = 9.7965e-04
Loss = 3.6010e-01, PNorm = 73.7574, GNorm = 0.6528, lr_0 = 9.5130e-04
Loss = 4.0803e-01, PNorm = 73.8324, GNorm = 0.9345, lr_0 = 9.2376e-04
Validation prc-auc = 0.591793
Validation auc = 0.749073
Epoch 3
Loss = 3.8630e-01, PNorm = 73.9268, GNorm = 0.5755, lr_0 = 8.9440e-04
Loss = 4.2381e-01, PNorm = 74.0038, GNorm = 1.0176, lr_0 = 8.6851e-04
Loss = 3.6098e-01, PNorm = 74.0861, GNorm = 0.7596, lr_0 = 8.4337e-04
Validation prc-auc = 0.652774
Validation auc = 0.771149
Epoch 4
Loss = 3.8829e-01, PNorm = 74.1629, GNorm = 0.7639, lr_0 = 8.1656e-04
Loss = 3.7860e-01, PNorm = 74.2261, GNorm = 0.5739, lr_0 = 7.9293e-04
Loss = 3.8196e-01, PNorm = 74.2955, GNorm = 0.8673, lr_0 = 7.6998e-04
Loss = 2.8922e-01, PNorm = 74.3053, GNorm = 1.7699, lr_0 = 7.6772e-04
Validation prc-auc = 0.649735
Validation auc = 0.762555
Epoch 5
Loss = 3.6678e-01, PNorm = 74.3758, GNorm = 0.6612, lr_0 = 7.4550e-04
Loss = 3.7552e-01, PNorm = 74.4521, GNorm = 0.8229, lr_0 = 7.2393e-04
Validation prc-auc = 0.673730
Validation auc = 0.780249
Epoch 6
Loss = 2.8661e-01, PNorm = 74.5302, GNorm = 0.7443, lr_0 = 7.0091e-04
Loss = 3.8071e-01, PNorm = 74.5994, GNorm = 0.7288, lr_0 = 6.8063e-04
Loss = 3.7891e-01, PNorm = 74.6777, GNorm = 1.0014, lr_0 = 6.6093e-04
Validation prc-auc = 0.673757
Validation auc = 0.787496
Epoch 7
Loss = 3.3937e-01, PNorm = 74.7529, GNorm = 0.8677, lr_0 = 6.3992e-04
Loss = 3.4531e-01, PNorm = 74.8324, GNorm = 0.6494, lr_0 = 6.2139e-04
Loss = 3.6989e-01, PNorm = 74.9094, GNorm = 0.6912, lr_0 = 6.0341e-04
Validation prc-auc = 0.658775
Validation auc = 0.768622
Epoch 8
Loss = 3.1087e-01, PNorm = 74.9831, GNorm = 0.6166, lr_0 = 5.8595e-04
Loss = 3.7071e-01, PNorm = 75.0491, GNorm = 0.7621, lr_0 = 5.6899e-04
Loss = 3.4533e-01, PNorm = 75.1121, GNorm = 0.6230, lr_0 = 5.5252e-04
Validation prc-auc = 0.683226
Validation auc = 0.787664
Epoch 9
Loss = 3.3503e-01, PNorm = 75.1897, GNorm = 1.2003, lr_0 = 5.3495e-04
Loss = 3.2348e-01, PNorm = 75.2578, GNorm = 0.7559, lr_0 = 5.1947e-04
Loss = 3.4431e-01, PNorm = 75.3199, GNorm = 0.6736, lr_0 = 5.0444e-04
Validation prc-auc = 0.675002
Validation auc = 0.785811
Epoch 10
Loss = 3.2316e-01, PNorm = 75.3770, GNorm = 0.7905, lr_0 = 4.8840e-04
Loss = 3.5075e-01, PNorm = 75.4285, GNorm = 0.8477, lr_0 = 4.7426e-04
Validation prc-auc = 0.690588
Validation auc = 0.797438
Epoch 11
Loss = 2.3550e-01, PNorm = 75.4917, GNorm = 0.5276, lr_0 = 4.5919e-04
Loss = 2.9591e-01, PNorm = 75.5508, GNorm = 0.8189, lr_0 = 4.4590e-04
Loss = 3.2804e-01, PNorm = 75.6079, GNorm = 0.7891, lr_0 = 4.3299e-04
Validation prc-auc = 0.704665
Validation auc = 0.795079
Epoch 12
Loss = 3.2615e-01, PNorm = 75.6648, GNorm = 0.9891, lr_0 = 4.1923e-04
Loss = 2.4957e-01, PNorm = 75.7290, GNorm = 0.5701, lr_0 = 4.0709e-04
Loss = 3.7450e-01, PNorm = 75.7837, GNorm = 1.2284, lr_0 = 3.9531e-04
Validation prc-auc = 0.688272
Validation auc = 0.795079
Epoch 13
Loss = 2.6148e-01, PNorm = 75.8499, GNorm = 0.7631, lr_0 = 3.8274e-04
Loss = 2.6029e-01, PNorm = 75.8994, GNorm = 0.8234, lr_0 = 3.7167e-04
Loss = 3.2416e-01, PNorm = 75.9492, GNorm = 0.6548, lr_0 = 3.6091e-04
Validation prc-auc = 0.700398
Validation auc = 0.808729
Epoch 14
Loss = 3.0568e-01, PNorm = 76.0169, GNorm = 0.8170, lr_0 = 3.4944e-04
Loss = 2.9915e-01, PNorm = 76.0706, GNorm = 0.8859, lr_0 = 3.3932e-04
Loss = 2.8999e-01, PNorm = 76.1294, GNorm = 0.9609, lr_0 = 3.2950e-04
Validation prc-auc = 0.707446
Validation auc = 0.807718
Epoch 15
Loss = 2.8482e-01, PNorm = 76.1822, GNorm = 0.7403, lr_0 = 3.1996e-04
Loss = 2.6275e-01, PNorm = 76.2329, GNorm = 0.8489, lr_0 = 3.1070e-04
Loss = 3.0344e-01, PNorm = 76.2759, GNorm = 0.6095, lr_0 = 3.0171e-04
Loss = 8.2805e-02, PNorm = 76.2821, GNorm = 0.9047, lr_0 = 3.0083e-04
Validation prc-auc = 0.717344
Validation auc = 0.807887
Epoch 16
Loss = 2.7298e-01, PNorm = 76.3191, GNorm = 0.8465, lr_0 = 2.9212e-04
Loss = 2.6888e-01, PNorm = 76.3659, GNorm = 0.7025, lr_0 = 2.8367e-04
Validation prc-auc = 0.709853
Validation auc = 0.811257
Epoch 17
Loss = 3.4406e-01, PNorm = 76.4054, GNorm = 1.2290, lr_0 = 2.7465e-04
Loss = 3.0700e-01, PNorm = 76.4555, GNorm = 0.5855, lr_0 = 2.6670e-04
Loss = 2.5467e-01, PNorm = 76.5014, GNorm = 0.9063, lr_0 = 2.5898e-04
Validation prc-auc = 0.727076
Validation auc = 0.821705
Epoch 18
Loss = 2.3772e-01, PNorm = 76.5411, GNorm = 0.8949, lr_0 = 2.5075e-04
Loss = 2.9400e-01, PNorm = 76.5787, GNorm = 1.1790, lr_0 = 2.4349e-04
Loss = 2.4303e-01, PNorm = 76.6160, GNorm = 0.8478, lr_0 = 2.3644e-04
Validation prc-auc = 0.703457
Validation auc = 0.812774
Epoch 19
Loss = 2.5691e-01, PNorm = 76.6563, GNorm = 0.8266, lr_0 = 2.2893e-04
Loss = 2.4327e-01, PNorm = 76.6910, GNorm = 0.7675, lr_0 = 2.2230e-04
Loss = 2.5254e-01, PNorm = 76.7185, GNorm = 0.9353, lr_0 = 2.1587e-04
Validation prc-auc = 0.706292
Validation auc = 0.812268
Epoch 20
Loss = 2.3059e-01, PNorm = 76.7546, GNorm = 1.0258, lr_0 = 2.0900e-04
Loss = 2.3227e-01, PNorm = 76.7857, GNorm = 1.4861, lr_0 = 2.0295e-04
Loss = 2.5598e-01, PNorm = 76.8107, GNorm = 0.7596, lr_0 = 1.9708e-04
Loss = 5.7208e-02, PNorm = 76.8143, GNorm = 1.3015, lr_0 = 1.9650e-04
Validation prc-auc = 0.711001
Validation auc = 0.816144
Epoch 21
Loss = 2.6557e-01, PNorm = 76.8365, GNorm = 1.4641, lr_0 = 1.9081e-04
Loss = 2.1065e-01, PNorm = 76.8622, GNorm = 1.1537, lr_0 = 1.8529e-04
Validation prc-auc = 0.696348
Validation auc = 0.817661
Epoch 22
Loss = 2.7917e-01, PNorm = 76.8875, GNorm = 0.9943, lr_0 = 1.7993e-04
Loss = 2.3059e-01, PNorm = 76.9122, GNorm = 0.7682, lr_0 = 1.7472e-04
Loss = 2.5708e-01, PNorm = 76.9354, GNorm = 1.0008, lr_0 = 1.6966e-04
Validation prc-auc = 0.699952
Validation auc = 0.808055
Epoch 23
Loss = 2.7948e-01, PNorm = 76.9616, GNorm = 1.8462, lr_0 = 1.6427e-04
Loss = 1.9812e-01, PNorm = 76.9805, GNorm = 0.7240, lr_0 = 1.5952e-04
Loss = 2.1335e-01, PNorm = 77.0012, GNorm = 0.7194, lr_0 = 1.5490e-04
Validation prc-auc = 0.710516
Validation auc = 0.826424
Epoch 24
Loss = 2.1178e-01, PNorm = 77.0197, GNorm = 0.7282, lr_0 = 1.4998e-04
Loss = 2.2618e-01, PNorm = 77.0417, GNorm = 1.3997, lr_0 = 1.4563e-04
Loss = 2.4631e-01, PNorm = 77.0581, GNorm = 1.1140, lr_0 = 1.4142e-04
Validation prc-auc = 0.708097
Validation auc = 0.819009
Epoch 25
Loss = 2.0982e-01, PNorm = 77.0783, GNorm = 0.7421, lr_0 = 1.3692e-04
Loss = 2.5038e-01, PNorm = 77.0933, GNorm = 0.8289, lr_0 = 1.3296e-04
Loss = 2.2317e-01, PNorm = 77.1175, GNorm = 1.4839, lr_0 = 1.2911e-04
Validation prc-auc = 0.687958
Validation auc = 0.805359
Epoch 26
Loss = 2.0891e-01, PNorm = 77.1318, GNorm = 0.7038, lr_0 = 1.2501e-04
Loss = 2.2723e-01, PNorm = 77.1458, GNorm = 1.1939, lr_0 = 1.2139e-04
Validation prc-auc = 0.706426
Validation auc = 0.823391
Epoch 27
Loss = 1.4676e-01, PNorm = 77.1664, GNorm = 1.0729, lr_0 = 1.1753e-04
Loss = 2.0792e-01, PNorm = 77.1788, GNorm = 2.0589, lr_0 = 1.1413e-04
Loss = 2.2972e-01, PNorm = 77.1934, GNorm = 1.5158, lr_0 = 1.1083e-04
Validation prc-auc = 0.705786
Validation auc = 0.815976
Epoch 28
Loss = 2.0389e-01, PNorm = 77.2082, GNorm = 0.7883, lr_0 = 1.0730e-04
Loss = 1.9329e-01, PNorm = 77.2203, GNorm = 0.9342, lr_0 = 1.0420e-04
Loss = 2.2309e-01, PNorm = 77.2309, GNorm = 1.1229, lr_0 = 1.0118e-04
Validation prc-auc = 0.701728
Validation auc = 0.803337
Epoch 29
Loss = 1.3075e-01, PNorm = 77.2442, GNorm = 0.6672, lr_0 = 1.0000e-04
Loss = 1.7996e-01, PNorm = 77.2574, GNorm = 0.8941, lr_0 = 1.0000e-04
Loss = 2.0154e-01, PNorm = 77.2674, GNorm = 0.8904, lr_0 = 1.0000e-04
Validation prc-auc = 0.696776
Validation auc = 0.816481
Model 0 best validation prc-auc = 0.727076 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.575376
Model 0 test auc = 0.775097
Ensemble test prc-auc = 0.575376
Ensemble test auc = 0.775097
Fold 26
Splitting data with seed 26
Total scaffolds = 870 | train scaffolds = 636 | val scaffolds = 117 | test scaffolds = 117
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.2575e-01, PNorm = 72.7740, GNorm = 0.6055, lr_0 = 1.0000e-03
Loss = 4.7199e-01, PNorm = 73.1766, GNorm = 1.5040, lr_0 = 1.0000e-03
Validation prc-auc = 0.484638
Validation auc = 0.733704
Epoch 1
Loss = 4.8181e-01, PNorm = 73.4098, GNorm = 0.5894, lr_0 = 1.0000e-03
Loss = 4.2519e-01, PNorm = 73.5369, GNorm = 0.6383, lr_0 = 1.0000e-03
Loss = 4.3421e-01, PNorm = 73.6078, GNorm = 0.6651, lr_0 = 1.0000e-03
Validation prc-auc = 0.541698
Validation auc = 0.760926
Epoch 2
Loss = 4.9556e-01, PNorm = 73.6725, GNorm = 0.4827, lr_0 = 9.7965e-04
Loss = 4.0972e-01, PNorm = 73.7307, GNorm = 0.4068, lr_0 = 9.5130e-04
Loss = 4.1702e-01, PNorm = 73.7733, GNorm = 0.4126, lr_0 = 9.2376e-04
Validation prc-auc = 0.569603
Validation auc = 0.787037
Epoch 3
Loss = 3.8154e-01, PNorm = 73.8326, GNorm = 0.7156, lr_0 = 8.9440e-04
Loss = 3.9404e-01, PNorm = 73.8901, GNorm = 1.0442, lr_0 = 8.6851e-04
Loss = 3.9723e-01, PNorm = 73.9340, GNorm = 0.9439, lr_0 = 8.4337e-04
Validation prc-auc = 0.581996
Validation auc = 0.795741
Epoch 4
Loss = 3.5812e-01, PNorm = 74.0057, GNorm = 0.6774, lr_0 = 8.1656e-04
Loss = 3.8467e-01, PNorm = 74.0651, GNorm = 0.4977, lr_0 = 7.9293e-04
Loss = 3.7748e-01, PNorm = 74.1257, GNorm = 0.6537, lr_0 = 7.6998e-04
Loss = 8.0139e-01, PNorm = 74.1283, GNorm = 3.3826, lr_0 = 7.6772e-04
Validation prc-auc = 0.593957
Validation auc = 0.793889
Epoch 5
Loss = 3.9081e-01, PNorm = 74.1980, GNorm = 0.9704, lr_0 = 7.4550e-04
Loss = 3.7062e-01, PNorm = 74.2639, GNorm = 0.4971, lr_0 = 7.2393e-04
Validation prc-auc = 0.591275
Validation auc = 0.795370
Epoch 6
Loss = 4.2621e-01, PNorm = 74.3273, GNorm = 0.6462, lr_0 = 7.0091e-04
Loss = 3.5678e-01, PNorm = 74.4013, GNorm = 1.1860, lr_0 = 6.8063e-04
Loss = 3.5245e-01, PNorm = 74.4557, GNorm = 0.6427, lr_0 = 6.6093e-04
Validation prc-auc = 0.582977
Validation auc = 0.795556
Epoch 7
Loss = 3.3739e-01, PNorm = 74.5259, GNorm = 0.6128, lr_0 = 6.3992e-04
Loss = 3.3013e-01, PNorm = 74.5940, GNorm = 1.6978, lr_0 = 6.2139e-04
Loss = 3.5789e-01, PNorm = 74.6471, GNorm = 0.7907, lr_0 = 6.0341e-04
Validation prc-auc = 0.598760
Validation auc = 0.782593
Epoch 8
Loss = 3.8696e-01, PNorm = 74.7098, GNorm = 0.5541, lr_0 = 5.8595e-04
Loss = 3.5005e-01, PNorm = 74.7751, GNorm = 0.6626, lr_0 = 5.6899e-04
Loss = 3.0378e-01, PNorm = 74.8503, GNorm = 0.5460, lr_0 = 5.5252e-04
Validation prc-auc = 0.596552
Validation auc = 0.800000
Epoch 9
Loss = 3.6459e-01, PNorm = 74.9134, GNorm = 1.0999, lr_0 = 5.3495e-04
Loss = 3.1963e-01, PNorm = 74.9942, GNorm = 0.9171, lr_0 = 5.1947e-04
Loss = 3.7664e-01, PNorm = 75.0575, GNorm = 1.0082, lr_0 = 5.0444e-04
Validation prc-auc = 0.605360
Validation auc = 0.795926
Epoch 10
Loss = 3.2211e-01, PNorm = 75.1121, GNorm = 0.6404, lr_0 = 4.8840e-04
Loss = 3.0031e-01, PNorm = 75.1688, GNorm = 1.1439, lr_0 = 4.7426e-04
Validation prc-auc = 0.626204
Validation auc = 0.804444
Epoch 11
Loss = 2.1096e-01, PNorm = 75.2203, GNorm = 0.6768, lr_0 = 4.5919e-04
Loss = 3.0770e-01, PNorm = 75.2740, GNorm = 0.6192, lr_0 = 4.4590e-04
Loss = 3.4236e-01, PNorm = 75.3272, GNorm = 0.6347, lr_0 = 4.3299e-04
Validation prc-auc = 0.631038
Validation auc = 0.804630
Epoch 12
Loss = 3.7258e-01, PNorm = 75.3824, GNorm = 1.0242, lr_0 = 4.1923e-04
Loss = 2.9192e-01, PNorm = 75.4511, GNorm = 0.9039, lr_0 = 4.0709e-04
Loss = 3.5052e-01, PNorm = 75.5032, GNorm = 0.7408, lr_0 = 3.9531e-04
Validation prc-auc = 0.632235
Validation auc = 0.792037
Epoch 13
Loss = 3.5666e-01, PNorm = 75.5518, GNorm = 0.6803, lr_0 = 3.8274e-04
Loss = 2.9011e-01, PNorm = 75.6036, GNorm = 0.7039, lr_0 = 3.7167e-04
Loss = 3.0860e-01, PNorm = 75.6442, GNorm = 0.7809, lr_0 = 3.6091e-04
Validation prc-auc = 0.648645
Validation auc = 0.810926
Epoch 14
Loss = 2.9573e-01, PNorm = 75.6898, GNorm = 0.6657, lr_0 = 3.4944e-04
Loss = 3.0703e-01, PNorm = 75.7437, GNorm = 1.1614, lr_0 = 3.3932e-04
Loss = 2.9733e-01, PNorm = 75.7831, GNorm = 0.5813, lr_0 = 3.2950e-04
Validation prc-auc = 0.655572
Validation auc = 0.807963
Epoch 15
Loss = 2.4392e-01, PNorm = 75.8366, GNorm = 0.6750, lr_0 = 3.1996e-04
Loss = 2.9768e-01, PNorm = 75.8794, GNorm = 0.8168, lr_0 = 3.1070e-04
Loss = 2.9609e-01, PNorm = 75.9247, GNorm = 0.7747, lr_0 = 3.0171e-04
Loss = 7.2712e-01, PNorm = 75.9289, GNorm = 4.2408, lr_0 = 3.0083e-04
Validation prc-auc = 0.643138
Validation auc = 0.806296
Epoch 16
Loss = 2.3722e-01, PNorm = 75.9791, GNorm = 1.0328, lr_0 = 2.9212e-04
Loss = 2.6578e-01, PNorm = 76.0225, GNorm = 1.2027, lr_0 = 2.8367e-04
Validation prc-auc = 0.660221
Validation auc = 0.803889
Epoch 17
Loss = 1.7698e-01, PNorm = 76.0568, GNorm = 0.8003, lr_0 = 2.7465e-04
Loss = 2.6252e-01, PNorm = 76.0927, GNorm = 1.2142, lr_0 = 2.6670e-04
Loss = 2.8590e-01, PNorm = 76.1300, GNorm = 0.9627, lr_0 = 2.5898e-04
Validation prc-auc = 0.655524
Validation auc = 0.798148
Epoch 18
Loss = 2.5220e-01, PNorm = 76.1701, GNorm = 0.6535, lr_0 = 2.5075e-04
Loss = 2.5764e-01, PNorm = 76.2024, GNorm = 1.7854, lr_0 = 2.4349e-04
Loss = 2.7122e-01, PNorm = 76.2279, GNorm = 1.0131, lr_0 = 2.3644e-04
Validation prc-auc = 0.661251
Validation auc = 0.804630
Epoch 19
Loss = 2.3260e-01, PNorm = 76.2641, GNorm = 0.9541, lr_0 = 2.2893e-04
Loss = 2.3483e-01, PNorm = 76.2944, GNorm = 1.0437, lr_0 = 2.2230e-04
Loss = 2.6175e-01, PNorm = 76.3202, GNorm = 0.9027, lr_0 = 2.1587e-04
Validation prc-auc = 0.656633
Validation auc = 0.803704
Epoch 20
Loss = 2.8984e-01, PNorm = 76.3506, GNorm = 0.9386, lr_0 = 2.0900e-04
Loss = 2.3370e-01, PNorm = 76.3848, GNorm = 1.1177, lr_0 = 2.0295e-04
Loss = 2.3538e-01, PNorm = 76.4147, GNorm = 0.9933, lr_0 = 1.9708e-04
Loss = 1.7173e-01, PNorm = 76.4180, GNorm = 2.0296, lr_0 = 1.9650e-04
Validation prc-auc = 0.663854
Validation auc = 0.797963
Epoch 21
Loss = 2.4283e-01, PNorm = 76.4406, GNorm = 1.3862, lr_0 = 1.9081e-04
Loss = 2.7681e-01, PNorm = 76.4642, GNorm = 1.1236, lr_0 = 1.8529e-04
Validation prc-auc = 0.664140
Validation auc = 0.806667
Epoch 22
Loss = 1.2126e-01, PNorm = 76.4937, GNorm = 0.6733, lr_0 = 1.7993e-04
Loss = 2.3648e-01, PNorm = 76.5121, GNorm = 0.9044, lr_0 = 1.7472e-04
Loss = 2.4625e-01, PNorm = 76.5306, GNorm = 1.3831, lr_0 = 1.6966e-04
Validation prc-auc = 0.670314
Validation auc = 0.810370
Epoch 23
Loss = 2.8862e-01, PNorm = 76.5560, GNorm = 0.8467, lr_0 = 1.6427e-04
Loss = 2.3580e-01, PNorm = 76.5806, GNorm = 0.8672, lr_0 = 1.5952e-04
Loss = 2.0496e-01, PNorm = 76.6047, GNorm = 1.1468, lr_0 = 1.5490e-04
Validation prc-auc = 0.667607
Validation auc = 0.809444
Epoch 24
Loss = 2.2995e-01, PNorm = 76.6265, GNorm = 1.2576, lr_0 = 1.4998e-04
Loss = 2.4307e-01, PNorm = 76.6381, GNorm = 0.8335, lr_0 = 1.4563e-04
Loss = 2.1272e-01, PNorm = 76.6582, GNorm = 1.2892, lr_0 = 1.4142e-04
Validation prc-auc = 0.677424
Validation auc = 0.813148
Epoch 25
Loss = 2.2833e-01, PNorm = 76.6728, GNorm = 1.3011, lr_0 = 1.3692e-04
Loss = 2.0453e-01, PNorm = 76.6924, GNorm = 1.0597, lr_0 = 1.3296e-04
Loss = 2.2991e-01, PNorm = 76.7057, GNorm = 1.3678, lr_0 = 1.2911e-04
Validation prc-auc = 0.684362
Validation auc = 0.820926
Epoch 26
Loss = 1.9796e-01, PNorm = 76.7249, GNorm = 0.9190, lr_0 = 1.2501e-04
Loss = 2.0899e-01, PNorm = 76.7390, GNorm = 1.1027, lr_0 = 1.2139e-04
Validation prc-auc = 0.674233
Validation auc = 0.820000
Epoch 27
Loss = 3.0809e-01, PNorm = 76.7527, GNorm = 1.2338, lr_0 = 1.1753e-04
Loss = 1.7226e-01, PNorm = 76.7683, GNorm = 1.1053, lr_0 = 1.1413e-04
Loss = 2.1229e-01, PNorm = 76.7795, GNorm = 1.6658, lr_0 = 1.1083e-04
Validation prc-auc = 0.658198
Validation auc = 0.810926
Epoch 28
Loss = 2.1500e-01, PNorm = 76.7936, GNorm = 1.2538, lr_0 = 1.0730e-04
Loss = 1.9473e-01, PNorm = 76.8060, GNorm = 1.2497, lr_0 = 1.0420e-04
Loss = 1.9839e-01, PNorm = 76.8159, GNorm = 1.3998, lr_0 = 1.0118e-04
Validation prc-auc = 0.660350
Validation auc = 0.806296
Epoch 29
Loss = 2.4092e-01, PNorm = 76.8261, GNorm = 1.1248, lr_0 = 1.0000e-04
Loss = 2.0320e-01, PNorm = 76.8379, GNorm = 0.7389, lr_0 = 1.0000e-04
Loss = 1.7667e-01, PNorm = 76.8497, GNorm = 0.7759, lr_0 = 1.0000e-04
Validation prc-auc = 0.661956
Validation auc = 0.805000
Model 0 best validation prc-auc = 0.684362 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.565234
Model 0 test auc = 0.734981
Ensemble test prc-auc = 0.565234
Ensemble test auc = 0.734981
Fold 27
Splitting data with seed 27
Total scaffolds = 870 | train scaffolds = 666 | val scaffolds = 102 | test scaffolds = 102
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.5286e-01, PNorm = 72.7690, GNorm = 0.7249, lr_0 = 1.0000e-03
Loss = 5.1720e-01, PNorm = 73.1729, GNorm = 1.1750, lr_0 = 1.0000e-03
Validation prc-auc = 0.370130
Validation auc = 0.687050
Epoch 1
Loss = 3.8272e-01, PNorm = 73.4151, GNorm = 0.6126, lr_0 = 1.0000e-03
Loss = 4.5947e-01, PNorm = 73.5460, GNorm = 0.7656, lr_0 = 1.0000e-03
Loss = 4.5154e-01, PNorm = 73.6348, GNorm = 1.1283, lr_0 = 1.0000e-03
Validation prc-auc = 0.381944
Validation auc = 0.700440
Epoch 2
Loss = 4.0886e-01, PNorm = 73.7171, GNorm = 0.5285, lr_0 = 9.7965e-04
Loss = 4.1050e-01, PNorm = 73.7790, GNorm = 0.7386, lr_0 = 9.5130e-04
Loss = 4.5652e-01, PNorm = 73.8240, GNorm = 0.8850, lr_0 = 9.2376e-04
Validation prc-auc = 0.424264
Validation auc = 0.721623
Epoch 3
Loss = 4.9954e-01, PNorm = 73.8839, GNorm = 0.9129, lr_0 = 8.9440e-04
Loss = 3.9045e-01, PNorm = 73.9311, GNorm = 0.4373, lr_0 = 8.6851e-04
Loss = 4.3103e-01, PNorm = 73.9761, GNorm = 0.5612, lr_0 = 8.4337e-04
Validation prc-auc = 0.438034
Validation auc = 0.727818
Epoch 4
Loss = 4.0910e-01, PNorm = 74.0310, GNorm = 0.4506, lr_0 = 8.1656e-04
Loss = 3.9509e-01, PNorm = 74.0813, GNorm = 0.5611, lr_0 = 7.9293e-04
Loss = 3.7814e-01, PNorm = 74.1426, GNorm = 0.6129, lr_0 = 7.6998e-04
Loss = 4.6117e-01, PNorm = 74.1498, GNorm = 1.7151, lr_0 = 7.6772e-04
Validation prc-auc = 0.432558
Validation auc = 0.738010
Epoch 5
Loss = 3.8364e-01, PNorm = 74.2055, GNorm = 0.7382, lr_0 = 7.4550e-04
Loss = 3.9882e-01, PNorm = 74.2738, GNorm = 0.5071, lr_0 = 7.2393e-04
Validation prc-auc = 0.489349
Validation auc = 0.739009
Epoch 6
Loss = 3.7854e-01, PNorm = 74.3430, GNorm = 0.6460, lr_0 = 7.0091e-04
Loss = 3.6150e-01, PNorm = 74.4067, GNorm = 0.7231, lr_0 = 6.8063e-04
Loss = 3.8734e-01, PNorm = 74.4635, GNorm = 0.8531, lr_0 = 6.6093e-04
Validation prc-auc = 0.508993
Validation auc = 0.739209
Epoch 7
Loss = 3.6698e-01, PNorm = 74.5184, GNorm = 0.6151, lr_0 = 6.3992e-04
Loss = 3.4945e-01, PNorm = 74.5872, GNorm = 0.6198, lr_0 = 6.2139e-04
Loss = 3.9883e-01, PNorm = 74.6420, GNorm = 0.8089, lr_0 = 6.0341e-04
Validation prc-auc = 0.475684
Validation auc = 0.737210
Epoch 8
Loss = 3.5266e-01, PNorm = 74.7083, GNorm = 0.8472, lr_0 = 5.8595e-04
Loss = 3.8528e-01, PNorm = 74.7683, GNorm = 0.8116, lr_0 = 5.6899e-04
Loss = 3.3708e-01, PNorm = 74.8275, GNorm = 0.6314, lr_0 = 5.5252e-04
Validation prc-auc = 0.502740
Validation auc = 0.745204
Epoch 9
Loss = 3.8960e-01, PNorm = 74.8980, GNorm = 0.6324, lr_0 = 5.3495e-04
Loss = 3.6587e-01, PNorm = 74.9722, GNorm = 0.6813, lr_0 = 5.1947e-04
Loss = 3.3126e-01, PNorm = 75.0414, GNorm = 0.7489, lr_0 = 5.0444e-04
Validation prc-auc = 0.491829
Validation auc = 0.745803
Epoch 10
Loss = 3.0824e-01, PNorm = 75.1137, GNorm = 0.8155, lr_0 = 4.8840e-04
Loss = 3.8079e-01, PNorm = 75.1686, GNorm = 0.8411, lr_0 = 4.7426e-04
Validation prc-auc = 0.472289
Validation auc = 0.745604
Epoch 11
Loss = 3.6066e-01, PNorm = 75.2386, GNorm = 1.2316, lr_0 = 4.5919e-04
Loss = 3.4677e-01, PNorm = 75.3135, GNorm = 0.9623, lr_0 = 4.4590e-04
Loss = 3.6606e-01, PNorm = 75.3690, GNorm = 0.5350, lr_0 = 4.3299e-04
Validation prc-auc = 0.487049
Validation auc = 0.738809
Epoch 12
Loss = 2.9016e-01, PNorm = 75.4336, GNorm = 0.7778, lr_0 = 4.1923e-04
Loss = 3.2888e-01, PNorm = 75.4876, GNorm = 0.7358, lr_0 = 4.0709e-04
Loss = 3.1372e-01, PNorm = 75.5451, GNorm = 0.9346, lr_0 = 3.9531e-04
Validation prc-auc = 0.529553
Validation auc = 0.750400
Epoch 13
Loss = 3.8142e-01, PNorm = 75.6032, GNorm = 0.7438, lr_0 = 3.8274e-04
Loss = 2.9910e-01, PNorm = 75.6533, GNorm = 0.5985, lr_0 = 3.7167e-04
Loss = 3.0003e-01, PNorm = 75.7113, GNorm = 0.7489, lr_0 = 3.6091e-04
Validation prc-auc = 0.531079
Validation auc = 0.755795
Epoch 14
Loss = 3.2147e-01, PNorm = 75.7748, GNorm = 0.7023, lr_0 = 3.4944e-04
Loss = 2.9798e-01, PNorm = 75.8313, GNorm = 0.8171, lr_0 = 3.3932e-04
Loss = 3.1713e-01, PNorm = 75.8737, GNorm = 0.7343, lr_0 = 3.2950e-04
Validation prc-auc = 0.528198
Validation auc = 0.750799
Epoch 15
Loss = 2.6994e-01, PNorm = 75.9261, GNorm = 0.6752, lr_0 = 3.1996e-04
Loss = 3.3150e-01, PNorm = 75.9721, GNorm = 1.1788, lr_0 = 3.1070e-04
Loss = 3.3170e-01, PNorm = 76.0254, GNorm = 1.1105, lr_0 = 3.0171e-04
Loss = 2.5411e-01, PNorm = 76.0298, GNorm = 2.2849, lr_0 = 3.0083e-04
Validation prc-auc = 0.551434
Validation auc = 0.756795
Epoch 16
Loss = 2.8512e-01, PNorm = 76.0775, GNorm = 0.6435, lr_0 = 2.9212e-04
Loss = 2.9478e-01, PNorm = 76.1166, GNorm = 0.8334, lr_0 = 2.8367e-04
Validation prc-auc = 0.547660
Validation auc = 0.760592
Epoch 17
Loss = 2.9185e-01, PNorm = 76.1655, GNorm = 0.9098, lr_0 = 2.7465e-04
Loss = 3.1242e-01, PNorm = 76.2048, GNorm = 1.1670, lr_0 = 2.6670e-04
Loss = 2.5585e-01, PNorm = 76.2536, GNorm = 1.6517, lr_0 = 2.5898e-04
Validation prc-auc = 0.512434
Validation auc = 0.751399
Epoch 18
Loss = 2.3831e-01, PNorm = 76.2948, GNorm = 1.0067, lr_0 = 2.5075e-04
Loss = 2.8525e-01, PNorm = 76.3356, GNorm = 1.2081, lr_0 = 2.4349e-04
Loss = 3.0467e-01, PNorm = 76.3660, GNorm = 0.9909, lr_0 = 2.3644e-04
Validation prc-auc = 0.554999
Validation auc = 0.748801
Epoch 19
Loss = 2.7553e-01, PNorm = 76.4108, GNorm = 0.8415, lr_0 = 2.2893e-04
Loss = 2.6962e-01, PNorm = 76.4483, GNorm = 0.8410, lr_0 = 2.2230e-04
Loss = 2.8063e-01, PNorm = 76.4828, GNorm = 0.7679, lr_0 = 2.1587e-04
Validation prc-auc = 0.574822
Validation auc = 0.763789
Epoch 20
Loss = 2.8283e-01, PNorm = 76.5157, GNorm = 1.2333, lr_0 = 2.0900e-04
Loss = 2.4016e-01, PNorm = 76.5498, GNorm = 0.9061, lr_0 = 2.0295e-04
Loss = 2.6359e-01, PNorm = 76.5760, GNorm = 1.0361, lr_0 = 1.9708e-04
Loss = 3.3192e-02, PNorm = 76.5792, GNorm = 0.4801, lr_0 = 1.9650e-04
Validation prc-auc = 0.556378
Validation auc = 0.768785
Epoch 21
Loss = 2.5667e-01, PNorm = 76.6057, GNorm = 1.4153, lr_0 = 1.9081e-04
Loss = 2.2068e-01, PNorm = 76.6352, GNorm = 0.9117, lr_0 = 1.8529e-04
Validation prc-auc = 0.577056
Validation auc = 0.766986
Epoch 22
Loss = 1.7275e-01, PNorm = 76.6584, GNorm = 0.8931, lr_0 = 1.7993e-04
Loss = 2.4579e-01, PNorm = 76.6862, GNorm = 1.0200, lr_0 = 1.7472e-04
Loss = 2.7243e-01, PNorm = 76.7078, GNorm = 0.8835, lr_0 = 1.6966e-04
Validation prc-auc = 0.577495
Validation auc = 0.765987
Epoch 23
Loss = 2.2452e-01, PNorm = 76.7377, GNorm = 0.9878, lr_0 = 1.6427e-04
Loss = 2.4001e-01, PNorm = 76.7591, GNorm = 1.3791, lr_0 = 1.5952e-04
Loss = 2.2408e-01, PNorm = 76.7834, GNorm = 0.9034, lr_0 = 1.5490e-04
Validation prc-auc = 0.566231
Validation auc = 0.760791
Epoch 24
Loss = 2.5320e-01, PNorm = 76.8042, GNorm = 0.7690, lr_0 = 1.4998e-04
Loss = 2.0283e-01, PNorm = 76.8236, GNorm = 1.1121, lr_0 = 1.4563e-04
Loss = 2.0931e-01, PNorm = 76.8461, GNorm = 1.0408, lr_0 = 1.4142e-04
Validation prc-auc = 0.544160
Validation auc = 0.757794
Epoch 25
Loss = 2.3387e-01, PNorm = 76.8685, GNorm = 1.2585, lr_0 = 1.3692e-04
Loss = 2.4575e-01, PNorm = 76.8839, GNorm = 1.8661, lr_0 = 1.3296e-04
Loss = 2.0896e-01, PNorm = 76.9050, GNorm = 1.3143, lr_0 = 1.2911e-04
Validation prc-auc = 0.592111
Validation auc = 0.772182
Epoch 26
Loss = 2.1592e-01, PNorm = 76.9219, GNorm = 1.0216, lr_0 = 1.2501e-04
Loss = 2.1774e-01, PNorm = 76.9388, GNorm = 1.0800, lr_0 = 1.2139e-04
Validation prc-auc = 0.597031
Validation auc = 0.772582
Epoch 27
Loss = 1.0633e-01, PNorm = 76.9558, GNorm = 0.7214, lr_0 = 1.1753e-04
Loss = 2.1539e-01, PNorm = 76.9693, GNorm = 1.1413, lr_0 = 1.1413e-04
Loss = 2.3958e-01, PNorm = 76.9844, GNorm = 2.5643, lr_0 = 1.1083e-04
Validation prc-auc = 0.571081
Validation auc = 0.759592
Epoch 28
Loss = 1.7330e-01, PNorm = 76.9970, GNorm = 1.1390, lr_0 = 1.0730e-04
Loss = 2.2473e-01, PNorm = 77.0150, GNorm = 0.9970, lr_0 = 1.0420e-04
Loss = 2.3590e-01, PNorm = 77.0212, GNorm = 0.8557, lr_0 = 1.0118e-04
Validation prc-auc = 0.550041
Validation auc = 0.755196
Epoch 29
Loss = 2.3149e-01, PNorm = 77.0318, GNorm = 1.5367, lr_0 = 1.0000e-04
Loss = 2.1219e-01, PNorm = 77.0464, GNorm = 1.1042, lr_0 = 1.0000e-04
Loss = 2.1463e-01, PNorm = 77.0584, GNorm = 1.0629, lr_0 = 1.0000e-04
Validation prc-auc = 0.581594
Validation auc = 0.765188
Model 0 best validation prc-auc = 0.597031 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.457833
Model 0 test auc = 0.826222
Ensemble test prc-auc = 0.457833
Ensemble test auc = 0.826222
Fold 28
Splitting data with seed 28
Total scaffolds = 870 | train scaffolds = 635 | val scaffolds = 111 | test scaffolds = 124
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 5.8442e-01, PNorm = 72.7686, GNorm = 1.4761, lr_0 = 1.0000e-03
Loss = 4.4839e-01, PNorm = 73.1574, GNorm = 0.5327, lr_0 = 1.0000e-03
Validation prc-auc = 0.441894
Validation auc = 0.708291
Epoch 1
Loss = 5.9055e-01, PNorm = 73.3911, GNorm = 0.8480, lr_0 = 1.0000e-03
Loss = 3.7868e-01, PNorm = 73.5157, GNorm = 0.4258, lr_0 = 1.0000e-03
Loss = 4.5228e-01, PNorm = 73.5966, GNorm = 0.9103, lr_0 = 1.0000e-03
Validation prc-auc = 0.473883
Validation auc = 0.728345
Epoch 2
Loss = 3.8623e-01, PNorm = 73.6736, GNorm = 0.6151, lr_0 = 9.7965e-04
Loss = 4.2723e-01, PNorm = 73.7456, GNorm = 0.8785, lr_0 = 9.5130e-04
Loss = 4.2719e-01, PNorm = 73.7997, GNorm = 0.6635, lr_0 = 9.2376e-04
Validation prc-auc = 0.488544
Validation auc = 0.733738
Epoch 3
Loss = 4.2179e-01, PNorm = 73.8671, GNorm = 0.4844, lr_0 = 8.9440e-04
Loss = 4.1222e-01, PNorm = 73.9326, GNorm = 0.5167, lr_0 = 8.6851e-04
Loss = 3.4360e-01, PNorm = 73.9925, GNorm = 0.7321, lr_0 = 8.4337e-04
Validation prc-auc = 0.559514
Validation auc = 0.767779
Epoch 4
Loss = 3.9309e-01, PNorm = 74.0508, GNorm = 0.4892, lr_0 = 8.1656e-04
Loss = 3.5196e-01, PNorm = 74.1090, GNorm = 0.5492, lr_0 = 7.9293e-04
Loss = 4.2709e-01, PNorm = 74.1666, GNorm = 0.5612, lr_0 = 7.6998e-04
Loss = 2.6244e-01, PNorm = 74.1725, GNorm = 0.9547, lr_0 = 7.6772e-04
Validation prc-auc = 0.560948
Validation auc = 0.771655
Epoch 5
Loss = 3.7856e-01, PNorm = 74.2278, GNorm = 0.5454, lr_0 = 7.4550e-04
Loss = 4.0877e-01, PNorm = 74.2863, GNorm = 0.9654, lr_0 = 7.2393e-04
Validation prc-auc = 0.561787
Validation auc = 0.767442
Epoch 6
Loss = 4.3721e-01, PNorm = 74.3573, GNorm = 0.8633, lr_0 = 7.0091e-04
Loss = 4.1227e-01, PNorm = 74.4278, GNorm = 0.9964, lr_0 = 6.8063e-04
Loss = 3.8057e-01, PNorm = 74.4922, GNorm = 0.4397, lr_0 = 6.6093e-04
Validation prc-auc = 0.565816
Validation auc = 0.767947
Epoch 7
Loss = 3.5550e-01, PNorm = 74.5598, GNorm = 0.6204, lr_0 = 6.3992e-04
Loss = 3.8638e-01, PNorm = 74.6405, GNorm = 0.5370, lr_0 = 6.2139e-04
Loss = 3.8224e-01, PNorm = 74.6973, GNorm = 0.7726, lr_0 = 6.0341e-04
Validation prc-auc = 0.619559
Validation auc = 0.785305
Epoch 8
Loss = 3.8070e-01, PNorm = 74.7510, GNorm = 0.9170, lr_0 = 5.8595e-04
Loss = 3.4396e-01, PNorm = 74.8246, GNorm = 0.6058, lr_0 = 5.6899e-04
Loss = 3.7607e-01, PNorm = 74.8706, GNorm = 0.6108, lr_0 = 5.5252e-04
Validation prc-auc = 0.648300
Validation auc = 0.785137
Epoch 9
Loss = 3.8265e-01, PNorm = 74.9296, GNorm = 1.0333, lr_0 = 5.3495e-04
Loss = 3.3538e-01, PNorm = 74.9858, GNorm = 0.9136, lr_0 = 5.1947e-04
Loss = 3.1703e-01, PNorm = 75.0524, GNorm = 0.5821, lr_0 = 5.0444e-04
Validation prc-auc = 0.646940
Validation auc = 0.794068
Epoch 10
Loss = 3.9640e-01, PNorm = 75.1019, GNorm = 1.2811, lr_0 = 4.8840e-04
Loss = 3.3678e-01, PNorm = 75.1645, GNorm = 0.6315, lr_0 = 4.7426e-04
Validation prc-auc = 0.671323
Validation auc = 0.808561
Epoch 11
Loss = 4.2002e-01, PNorm = 75.2078, GNorm = 0.6706, lr_0 = 4.5919e-04
Loss = 3.5350e-01, PNorm = 75.2573, GNorm = 0.6683, lr_0 = 4.4590e-04
Loss = 3.1095e-01, PNorm = 75.3130, GNorm = 0.6055, lr_0 = 4.3299e-04
Validation prc-auc = 0.662767
Validation auc = 0.799798
Epoch 12
Loss = 3.2953e-01, PNorm = 75.3734, GNorm = 0.9919, lr_0 = 4.1923e-04
Loss = 3.6305e-01, PNorm = 75.4265, GNorm = 0.7485, lr_0 = 4.0709e-04
Loss = 2.9658e-01, PNorm = 75.4835, GNorm = 0.6577, lr_0 = 3.9531e-04
Validation prc-auc = 0.665745
Validation auc = 0.799292
Epoch 13
Loss = 3.2923e-01, PNorm = 75.5376, GNorm = 0.9679, lr_0 = 3.8274e-04
Loss = 3.5124e-01, PNorm = 75.5954, GNorm = 0.6313, lr_0 = 3.7167e-04
Loss = 2.9673e-01, PNorm = 75.6415, GNorm = 0.8478, lr_0 = 3.6091e-04
Validation prc-auc = 0.667414
Validation auc = 0.803168
Epoch 14
Loss = 3.0535e-01, PNorm = 75.6945, GNorm = 0.7134, lr_0 = 3.4944e-04
Loss = 3.2239e-01, PNorm = 75.7426, GNorm = 0.7094, lr_0 = 3.3932e-04
Loss = 2.8558e-01, PNorm = 75.7941, GNorm = 0.7506, lr_0 = 3.2950e-04
Validation prc-auc = 0.681745
Validation auc = 0.806876
Epoch 15
Loss = 2.7882e-01, PNorm = 75.8434, GNorm = 0.6406, lr_0 = 3.1996e-04
Loss = 3.4677e-01, PNorm = 75.8909, GNorm = 0.9596, lr_0 = 3.1070e-04
Loss = 2.6978e-01, PNorm = 75.9396, GNorm = 0.6765, lr_0 = 3.0171e-04
Loss = 3.8073e-01, PNorm = 75.9440, GNorm = 2.8061, lr_0 = 3.0083e-04
Validation prc-auc = 0.651242
Validation auc = 0.807381
Epoch 16
Loss = 3.1350e-01, PNorm = 75.9697, GNorm = 0.7476, lr_0 = 2.9212e-04
Loss = 2.8625e-01, PNorm = 76.0146, GNorm = 0.7775, lr_0 = 2.8367e-04
Validation prc-auc = 0.665884
Validation auc = 0.796427
Epoch 17
Loss = 4.1594e-01, PNorm = 76.0585, GNorm = 0.7401, lr_0 = 2.7465e-04
Loss = 2.7409e-01, PNorm = 76.1057, GNorm = 0.7756, lr_0 = 2.6670e-04
Loss = 3.1091e-01, PNorm = 76.1337, GNorm = 1.1097, lr_0 = 2.5898e-04
Validation prc-auc = 0.675495
Validation auc = 0.803337
Epoch 18
Loss = 2.6893e-01, PNorm = 76.1767, GNorm = 1.0445, lr_0 = 2.5075e-04
Loss = 2.6727e-01, PNorm = 76.2092, GNorm = 0.6141, lr_0 = 2.4349e-04
Loss = 2.8363e-01, PNorm = 76.2416, GNorm = 0.6933, lr_0 = 2.3644e-04
Validation prc-auc = 0.689587
Validation auc = 0.808898
Epoch 19
Loss = 2.3120e-01, PNorm = 76.2790, GNorm = 0.7729, lr_0 = 2.2893e-04
Loss = 2.8912e-01, PNorm = 76.3056, GNorm = 0.8611, lr_0 = 2.2230e-04
Loss = 3.1335e-01, PNorm = 76.3401, GNorm = 1.4596, lr_0 = 2.1587e-04
Validation prc-auc = 0.683479
Validation auc = 0.821368
Epoch 20
Loss = 3.1967e-01, PNorm = 76.3785, GNorm = 0.9441, lr_0 = 2.0900e-04
Loss = 2.3952e-01, PNorm = 76.4106, GNorm = 1.2262, lr_0 = 2.0295e-04
Loss = 2.4839e-01, PNorm = 76.4370, GNorm = 1.1047, lr_0 = 1.9708e-04
Loss = 1.5212e-01, PNorm = 76.4405, GNorm = 2.3961, lr_0 = 1.9650e-04
Validation prc-auc = 0.673601
Validation auc = 0.809403
Epoch 21
Loss = 2.7777e-01, PNorm = 76.4681, GNorm = 0.7229, lr_0 = 1.9081e-04
Loss = 2.4127e-01, PNorm = 76.4928, GNorm = 0.9553, lr_0 = 1.8529e-04
Validation prc-auc = 0.696466
Validation auc = 0.814122
Epoch 22
Loss = 1.3890e-01, PNorm = 76.5230, GNorm = 0.8409, lr_0 = 1.7993e-04
Loss = 2.3725e-01, PNorm = 76.5468, GNorm = 0.9438, lr_0 = 1.7472e-04
Loss = 2.6287e-01, PNorm = 76.5713, GNorm = 0.8624, lr_0 = 1.6966e-04
Validation prc-auc = 0.705608
Validation auc = 0.811257
Epoch 23
Loss = 2.4133e-01, PNorm = 76.6035, GNorm = 0.7373, lr_0 = 1.6427e-04
Loss = 2.5227e-01, PNorm = 76.6238, GNorm = 1.0272, lr_0 = 1.5952e-04
Loss = 2.1081e-01, PNorm = 76.6471, GNorm = 0.6447, lr_0 = 1.5490e-04
Validation prc-auc = 0.687593
Validation auc = 0.808898
Epoch 24
Loss = 2.0661e-01, PNorm = 76.6649, GNorm = 1.3099, lr_0 = 1.4998e-04
Loss = 2.4042e-01, PNorm = 76.6926, GNorm = 1.0479, lr_0 = 1.4563e-04
Loss = 2.5211e-01, PNorm = 76.7103, GNorm = 0.9387, lr_0 = 1.4142e-04
Validation prc-auc = 0.685038
Validation auc = 0.806707
Epoch 25
Loss = 2.5482e-01, PNorm = 76.7312, GNorm = 0.8610, lr_0 = 1.3692e-04
Loss = 2.1392e-01, PNorm = 76.7531, GNorm = 1.1675, lr_0 = 1.3296e-04
Loss = 2.5043e-01, PNorm = 76.7700, GNorm = 1.1239, lr_0 = 1.2911e-04
Validation prc-auc = 0.705347
Validation auc = 0.815302
Epoch 26
Loss = 2.2536e-01, PNorm = 76.7937, GNorm = 0.8872, lr_0 = 1.2501e-04
Loss = 1.8567e-01, PNorm = 76.8129, GNorm = 0.7994, lr_0 = 1.2139e-04
Validation prc-auc = 0.694011
Validation auc = 0.814796
Epoch 27
Loss = 1.7334e-01, PNorm = 76.8284, GNorm = 0.7386, lr_0 = 1.1753e-04
Loss = 2.1976e-01, PNorm = 76.8452, GNorm = 1.2537, lr_0 = 1.1413e-04
Loss = 2.1623e-01, PNorm = 76.8589, GNorm = 0.6449, lr_0 = 1.1083e-04
Validation prc-auc = 0.697065
Validation auc = 0.816818
Epoch 28
Loss = 2.0039e-01, PNorm = 76.8732, GNorm = 1.0560, lr_0 = 1.0730e-04
Loss = 1.9432e-01, PNorm = 76.8851, GNorm = 1.1187, lr_0 = 1.0420e-04
Loss = 2.0648e-01, PNorm = 76.8953, GNorm = 1.4679, lr_0 = 1.0118e-04
Validation prc-auc = 0.699218
Validation auc = 0.812942
Epoch 29
Loss = 2.0586e-01, PNorm = 76.9083, GNorm = 1.2581, lr_0 = 1.0000e-04
Loss = 2.1653e-01, PNorm = 76.9193, GNorm = 1.1424, lr_0 = 1.0000e-04
Loss = 1.7838e-01, PNorm = 76.9325, GNorm = 1.6409, lr_0 = 1.0000e-04
Validation prc-auc = 0.701562
Validation auc = 0.814291
Model 0 best validation prc-auc = 0.705608 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.658104
Model 0 test auc = 0.795438
Ensemble test prc-auc = 0.658104
Ensemble test auc = 0.795438
Fold 29
Splitting data with seed 29
Total scaffolds = 870 | train scaffolds = 632 | val scaffolds = 119 | test scaffolds = 119
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 8.7876e-01, PNorm = 72.7540, GNorm = 1.4991, lr_0 = 1.0000e-03
Loss = 4.5513e-01, PNorm = 73.1375, GNorm = 0.9174, lr_0 = 1.0000e-03
Validation prc-auc = 0.496505
Validation auc = 0.750455
Epoch 1
Loss = 5.0651e-01, PNorm = 73.3579, GNorm = 0.7575, lr_0 = 1.0000e-03
Loss = 4.4411e-01, PNorm = 73.4696, GNorm = 0.5020, lr_0 = 1.0000e-03
Loss = 4.2454e-01, PNorm = 73.5415, GNorm = 0.6782, lr_0 = 1.0000e-03
Validation prc-auc = 0.576329
Validation auc = 0.770477
Epoch 2
Loss = 4.0390e-01, PNorm = 73.6087, GNorm = 0.6935, lr_0 = 9.7965e-04
Loss = 4.5587e-01, PNorm = 73.6557, GNorm = 0.4410, lr_0 = 9.5130e-04
Loss = 4.0578e-01, PNorm = 73.7035, GNorm = 0.5268, lr_0 = 9.2376e-04
Validation prc-auc = 0.580939
Validation auc = 0.769567
Epoch 3
Loss = 4.1751e-01, PNorm = 73.7589, GNorm = 0.6789, lr_0 = 8.9440e-04
Loss = 4.2589e-01, PNorm = 73.7966, GNorm = 0.4364, lr_0 = 8.6851e-04
Loss = 3.7542e-01, PNorm = 73.8491, GNorm = 0.4412, lr_0 = 8.4337e-04
Validation prc-auc = 0.605740
Validation auc = 0.775573
Epoch 4
Loss = 3.6721e-01, PNorm = 73.9091, GNorm = 0.5488, lr_0 = 8.1656e-04
Loss = 4.1849e-01, PNorm = 73.9575, GNorm = 0.5277, lr_0 = 7.9293e-04
Loss = 4.2496e-01, PNorm = 74.0075, GNorm = 0.5102, lr_0 = 7.6998e-04
Loss = 1.5777e-01, PNorm = 74.0129, GNorm = 0.9881, lr_0 = 7.6772e-04
Validation prc-auc = 0.636241
Validation auc = 0.795413
Epoch 5
Loss = 3.9960e-01, PNorm = 74.0606, GNorm = 0.5335, lr_0 = 7.4550e-04
Loss = 3.7246e-01, PNorm = 74.1131, GNorm = 1.0500, lr_0 = 7.2393e-04
Validation prc-auc = 0.635288
Validation auc = 0.805060
Epoch 6
Loss = 4.2537e-01, PNorm = 74.1654, GNorm = 0.9967, lr_0 = 7.0091e-04
Loss = 3.9050e-01, PNorm = 74.2363, GNorm = 0.5730, lr_0 = 6.8063e-04
Loss = 3.7225e-01, PNorm = 74.2976, GNorm = 0.7009, lr_0 = 6.6093e-04
Validation prc-auc = 0.648658
Validation auc = 0.809793
Epoch 7
Loss = 4.1949e-01, PNorm = 74.3646, GNorm = 1.6171, lr_0 = 6.3992e-04
Loss = 3.1359e-01, PNorm = 74.4094, GNorm = 0.4790, lr_0 = 6.2139e-04
Loss = 4.1752e-01, PNorm = 74.4544, GNorm = 0.7172, lr_0 = 6.0341e-04
Validation prc-auc = 0.632713
Validation auc = 0.808154
Epoch 8
Loss = 3.3807e-01, PNorm = 74.5138, GNorm = 0.5466, lr_0 = 5.8595e-04
Loss = 3.4855e-01, PNorm = 74.5659, GNorm = 0.5936, lr_0 = 5.6899e-04
Loss = 3.7435e-01, PNorm = 74.6139, GNorm = 0.7537, lr_0 = 5.5252e-04
Validation prc-auc = 0.655673
Validation auc = 0.814707
Epoch 9
Loss = 3.7043e-01, PNorm = 74.6588, GNorm = 1.1148, lr_0 = 5.3495e-04
Loss = 3.8694e-01, PNorm = 74.7077, GNorm = 0.5884, lr_0 = 5.1947e-04
Loss = 3.5643e-01, PNorm = 74.7634, GNorm = 0.5703, lr_0 = 5.0444e-04
Validation prc-auc = 0.655780
Validation auc = 0.817619
Epoch 10
Loss = 3.5559e-01, PNorm = 74.8164, GNorm = 0.5943, lr_0 = 4.8840e-04
Loss = 3.3160e-01, PNorm = 74.8612, GNorm = 0.5550, lr_0 = 4.7426e-04
Validation prc-auc = 0.640755
Validation auc = 0.814343
Epoch 11
Loss = 4.7511e-01, PNorm = 74.9131, GNorm = 0.7924, lr_0 = 4.5919e-04
Loss = 3.5083e-01, PNorm = 74.9755, GNorm = 0.9520, lr_0 = 4.4590e-04
Loss = 3.0718e-01, PNorm = 75.0411, GNorm = 0.9267, lr_0 = 4.3299e-04
Validation prc-auc = 0.665833
Validation auc = 0.827630
Epoch 12
Loss = 3.8256e-01, PNorm = 75.1028, GNorm = 0.8633, lr_0 = 4.1923e-04
Loss = 3.7451e-01, PNorm = 75.1522, GNorm = 1.4599, lr_0 = 4.0709e-04
Loss = 3.4426e-01, PNorm = 75.1979, GNorm = 0.9681, lr_0 = 3.9531e-04
Validation prc-auc = 0.647556
Validation auc = 0.822716
Epoch 13
Loss = 3.3166e-01, PNorm = 75.2465, GNorm = 0.6402, lr_0 = 3.8274e-04
Loss = 3.2226e-01, PNorm = 75.2911, GNorm = 0.7329, lr_0 = 3.7167e-04
Loss = 3.1544e-01, PNorm = 75.3450, GNorm = 0.6638, lr_0 = 3.6091e-04
Validation prc-auc = 0.670209
Validation auc = 0.823262
Epoch 14
Loss = 3.4401e-01, PNorm = 75.3877, GNorm = 1.3295, lr_0 = 3.4944e-04
Loss = 3.3117e-01, PNorm = 75.4310, GNorm = 0.9130, lr_0 = 3.3932e-04
Loss = 3.1029e-01, PNorm = 75.4759, GNorm = 0.8068, lr_0 = 3.2950e-04
Validation prc-auc = 0.668631
Validation auc = 0.828904
Epoch 15
Loss = 3.3447e-01, PNorm = 75.5235, GNorm = 1.9766, lr_0 = 3.1996e-04
Loss = 3.0845e-01, PNorm = 75.5626, GNorm = 0.9412, lr_0 = 3.1070e-04
Loss = 2.7401e-01, PNorm = 75.6038, GNorm = 0.6935, lr_0 = 3.0171e-04
Loss = 1.2738e-01, PNorm = 75.6091, GNorm = 1.2657, lr_0 = 3.0083e-04
Validation prc-auc = 0.655638
Validation auc = 0.833273
Epoch 16
Loss = 3.1584e-01, PNorm = 75.6554, GNorm = 0.9994, lr_0 = 2.9212e-04
Loss = 2.8171e-01, PNorm = 75.7026, GNorm = 1.5093, lr_0 = 2.8367e-04
Validation prc-auc = 0.675935
Validation auc = 0.840007
Epoch 17
Loss = 2.8991e-01, PNorm = 75.7437, GNorm = 0.9989, lr_0 = 2.7465e-04
Loss = 2.8285e-01, PNorm = 75.7894, GNorm = 1.7244, lr_0 = 2.6670e-04
Loss = 2.8722e-01, PNorm = 75.8234, GNorm = 1.0272, lr_0 = 2.5898e-04
Validation prc-auc = 0.659273
Validation auc = 0.836913
Epoch 18
Loss = 2.8599e-01, PNorm = 75.8615, GNorm = 0.7009, lr_0 = 2.5075e-04
Loss = 2.9379e-01, PNorm = 75.8950, GNorm = 0.7925, lr_0 = 2.4349e-04
Loss = 2.8322e-01, PNorm = 75.9336, GNorm = 1.2824, lr_0 = 2.3644e-04
Validation prc-auc = 0.654700
Validation auc = 0.843284
Epoch 19
Loss = 2.4150e-01, PNorm = 75.9728, GNorm = 0.7870, lr_0 = 2.2893e-04
Loss = 2.5894e-01, PNorm = 76.0021, GNorm = 1.0997, lr_0 = 2.2230e-04
Loss = 2.8440e-01, PNorm = 76.0315, GNorm = 0.9537, lr_0 = 2.1587e-04
Validation prc-auc = 0.642351
Validation auc = 0.837095
Epoch 20
Loss = 3.1878e-01, PNorm = 76.0651, GNorm = 2.7277, lr_0 = 2.0900e-04
Loss = 2.5599e-01, PNorm = 76.0899, GNorm = 1.1513, lr_0 = 2.0295e-04
Loss = 2.8202e-01, PNorm = 76.1140, GNorm = 1.2070, lr_0 = 1.9708e-04
Loss = 1.9469e-01, PNorm = 76.1166, GNorm = 1.9965, lr_0 = 1.9650e-04
Validation prc-auc = 0.634811
Validation auc = 0.830906
Epoch 21
Loss = 2.5050e-01, PNorm = 76.1416, GNorm = 1.1067, lr_0 = 1.9081e-04
Loss = 2.7781e-01, PNorm = 76.1678, GNorm = 0.9950, lr_0 = 1.8529e-04
Validation prc-auc = 0.649639
Validation auc = 0.837641
Epoch 22
Loss = 3.3794e-01, PNorm = 76.1901, GNorm = 1.0875, lr_0 = 1.7993e-04
Loss = 2.4366e-01, PNorm = 76.2153, GNorm = 1.1239, lr_0 = 1.7472e-04
Loss = 2.6318e-01, PNorm = 76.2413, GNorm = 1.0784, lr_0 = 1.6966e-04
Validation prc-auc = 0.645673
Validation auc = 0.838005
Epoch 23
Loss = 3.5362e-01, PNorm = 76.2605, GNorm = 0.9797, lr_0 = 1.6427e-04
Loss = 2.6437e-01, PNorm = 76.2843, GNorm = 1.2367, lr_0 = 1.5952e-04
Loss = 2.8004e-01, PNorm = 76.3045, GNorm = 1.0675, lr_0 = 1.5490e-04
Validation prc-auc = 0.650849
Validation auc = 0.847470
Epoch 24
Loss = 2.4093e-01, PNorm = 76.3320, GNorm = 0.8662, lr_0 = 1.4998e-04
Loss = 2.3284e-01, PNorm = 76.3545, GNorm = 1.0046, lr_0 = 1.4563e-04
Loss = 2.3299e-01, PNorm = 76.3744, GNorm = 0.8685, lr_0 = 1.4142e-04
Validation prc-auc = 0.647267
Validation auc = 0.842373
Epoch 25
Loss = 2.1298e-01, PNorm = 76.3922, GNorm = 1.1524, lr_0 = 1.3692e-04
Loss = 2.1769e-01, PNorm = 76.4073, GNorm = 0.8678, lr_0 = 1.3296e-04
Loss = 2.5195e-01, PNorm = 76.4265, GNorm = 1.1476, lr_0 = 1.2911e-04
Validation prc-auc = 0.651498
Validation auc = 0.844194
Epoch 26
Loss = 2.3831e-01, PNorm = 76.4404, GNorm = 1.5285, lr_0 = 1.2501e-04
Loss = 2.4917e-01, PNorm = 76.4541, GNorm = 0.9860, lr_0 = 1.2139e-04
Validation prc-auc = 0.645804
Validation auc = 0.843102
Epoch 27
Loss = 1.8919e-01, PNorm = 76.4713, GNorm = 0.9122, lr_0 = 1.1753e-04
Loss = 2.2664e-01, PNorm = 76.4854, GNorm = 1.1605, lr_0 = 1.1413e-04
Loss = 2.5026e-01, PNorm = 76.4981, GNorm = 1.2324, lr_0 = 1.1083e-04
Validation prc-auc = 0.639293
Validation auc = 0.836185
Epoch 28
Loss = 2.6341e-01, PNorm = 76.5097, GNorm = 1.6089, lr_0 = 1.0730e-04
Loss = 2.5554e-01, PNorm = 76.5250, GNorm = 1.1633, lr_0 = 1.0420e-04
Loss = 2.1118e-01, PNorm = 76.5357, GNorm = 0.8490, lr_0 = 1.0118e-04
Validation prc-auc = 0.652947
Validation auc = 0.844012
Epoch 29
Loss = 2.2267e-01, PNorm = 76.5459, GNorm = 0.9210, lr_0 = 1.0000e-04
Loss = 2.0186e-01, PNorm = 76.5580, GNorm = 0.9886, lr_0 = 1.0000e-04
Loss = 2.4203e-01, PNorm = 76.5683, GNorm = 1.5087, lr_0 = 1.0000e-04
Validation prc-auc = 0.649910
Validation auc = 0.842556
Model 0 best validation prc-auc = 0.675935 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.653296
Model 0 test auc = 0.880418
Ensemble test prc-auc = 0.653296
Ensemble test auc = 0.880418
Fold 30
Splitting data with seed 30
Total scaffolds = 870 | train scaffolds = 636 | val scaffolds = 111 | test scaffolds = 123
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.3280e-01, PNorm = 72.7629, GNorm = 0.5824, lr_0 = 1.0000e-03
Loss = 4.8585e-01, PNorm = 73.1568, GNorm = 0.6587, lr_0 = 1.0000e-03
Validation prc-auc = 0.468174
Validation auc = 0.689440
Epoch 1
Loss = 3.8247e-01, PNorm = 73.3986, GNorm = 0.8114, lr_0 = 1.0000e-03
Loss = 4.8072e-01, PNorm = 73.5127, GNorm = 0.7963, lr_0 = 1.0000e-03
Loss = 4.3033e-01, PNorm = 73.5890, GNorm = 1.1203, lr_0 = 1.0000e-03
Validation prc-auc = 0.549784
Validation auc = 0.731040
Epoch 2
Loss = 4.5305e-01, PNorm = 73.6637, GNorm = 0.4485, lr_0 = 9.7965e-04
Loss = 3.7435e-01, PNorm = 73.7237, GNorm = 1.2698, lr_0 = 9.5130e-04
Loss = 3.9989e-01, PNorm = 73.7675, GNorm = 0.5299, lr_0 = 9.2376e-04
Validation prc-auc = 0.561526
Validation auc = 0.722240
Epoch 3
Loss = 3.8612e-01, PNorm = 73.8248, GNorm = 1.0504, lr_0 = 8.9440e-04
Loss = 3.7238e-01, PNorm = 73.8810, GNorm = 0.5317, lr_0 = 8.6851e-04
Loss = 3.8579e-01, PNorm = 73.9452, GNorm = 0.5577, lr_0 = 8.4337e-04
Validation prc-auc = 0.566487
Validation auc = 0.732960
Epoch 4
Loss = 3.6041e-01, PNorm = 74.0132, GNorm = 0.8334, lr_0 = 8.1656e-04
Loss = 3.8536e-01, PNorm = 74.0886, GNorm = 0.9085, lr_0 = 7.9293e-04
Loss = 4.2071e-01, PNorm = 74.1505, GNorm = 0.6153, lr_0 = 7.6998e-04
Loss = 3.4036e-01, PNorm = 74.1573, GNorm = 1.7184, lr_0 = 7.6772e-04
Validation prc-auc = 0.626127
Validation auc = 0.750560
Epoch 5
Loss = 3.5200e-01, PNorm = 74.2325, GNorm = 0.5665, lr_0 = 7.4550e-04
Loss = 3.5669e-01, PNorm = 74.2886, GNorm = 0.5667, lr_0 = 7.2393e-04
Validation prc-auc = 0.630020
Validation auc = 0.750560
Epoch 6
Loss = 3.9904e-01, PNorm = 74.3535, GNorm = 0.6559, lr_0 = 7.0091e-04
Loss = 3.4747e-01, PNorm = 74.4128, GNorm = 0.6089, lr_0 = 6.8063e-04
Loss = 3.4947e-01, PNorm = 74.4780, GNorm = 1.8726, lr_0 = 6.6093e-04
Validation prc-auc = 0.644797
Validation auc = 0.752320
Epoch 7
Loss = 4.2347e-01, PNorm = 74.5422, GNorm = 0.5926, lr_0 = 6.3992e-04
Loss = 3.5564e-01, PNorm = 74.5953, GNorm = 0.6341, lr_0 = 6.2139e-04
Loss = 3.3247e-01, PNorm = 74.6679, GNorm = 0.5264, lr_0 = 6.0341e-04
Validation prc-auc = 0.654100
Validation auc = 0.756960
Epoch 8
Loss = 3.5438e-01, PNorm = 74.7402, GNorm = 0.9636, lr_0 = 5.8595e-04
Loss = 3.1495e-01, PNorm = 74.8096, GNorm = 0.5445, lr_0 = 5.6899e-04
Loss = 3.9209e-01, PNorm = 74.8626, GNorm = 0.7068, lr_0 = 5.5252e-04
Validation prc-auc = 0.651875
Validation auc = 0.764640
Epoch 9
Loss = 3.3769e-01, PNorm = 74.9369, GNorm = 0.6999, lr_0 = 5.3495e-04
Loss = 3.4304e-01, PNorm = 75.0080, GNorm = 0.5855, lr_0 = 5.1947e-04
Loss = 3.6183e-01, PNorm = 75.0655, GNorm = 0.6643, lr_0 = 5.0444e-04
Validation prc-auc = 0.679454
Validation auc = 0.768640
Epoch 10
Loss = 3.4715e-01, PNorm = 75.1359, GNorm = 0.8159, lr_0 = 4.8840e-04
Loss = 2.7889e-01, PNorm = 75.2091, GNorm = 0.7877, lr_0 = 4.7426e-04
Validation prc-auc = 0.691489
Validation auc = 0.768960
Epoch 11
Loss = 2.8469e-01, PNorm = 75.2709, GNorm = 0.5656, lr_0 = 4.5919e-04
Loss = 3.0041e-01, PNorm = 75.3389, GNorm = 0.6384, lr_0 = 4.4590e-04
Loss = 3.3956e-01, PNorm = 75.3996, GNorm = 0.8056, lr_0 = 4.3299e-04
Validation prc-auc = 0.687141
Validation auc = 0.773280
Epoch 12
Loss = 3.3447e-01, PNorm = 75.4705, GNorm = 0.8631, lr_0 = 4.1923e-04
Loss = 2.9647e-01, PNorm = 75.5273, GNorm = 0.6281, lr_0 = 4.0709e-04
Loss = 3.6621e-01, PNorm = 75.5808, GNorm = 0.7492, lr_0 = 3.9531e-04
Validation prc-auc = 0.700357
Validation auc = 0.777920
Epoch 13
Loss = 2.9555e-01, PNorm = 75.6570, GNorm = 0.8617, lr_0 = 3.8274e-04
Loss = 2.9986e-01, PNorm = 75.7191, GNorm = 0.8766, lr_0 = 3.7167e-04
Loss = 3.0385e-01, PNorm = 75.7656, GNorm = 0.7808, lr_0 = 3.6091e-04
Validation prc-auc = 0.694111
Validation auc = 0.783200
Epoch 14
Loss = 2.9624e-01, PNorm = 75.8265, GNorm = 0.6940, lr_0 = 3.4944e-04
Loss = 3.1206e-01, PNorm = 75.8815, GNorm = 1.2782, lr_0 = 3.3932e-04
Loss = 2.7402e-01, PNorm = 75.9327, GNorm = 0.9196, lr_0 = 3.2950e-04
Validation prc-auc = 0.697205
Validation auc = 0.771840
Epoch 15
Loss = 2.9777e-01, PNorm = 75.9754, GNorm = 0.6144, lr_0 = 3.1996e-04
Loss = 2.7703e-01, PNorm = 76.0262, GNorm = 0.7133, lr_0 = 3.1070e-04
Loss = 2.8465e-01, PNorm = 76.0620, GNorm = 0.6556, lr_0 = 3.0171e-04
Loss = 5.6738e-01, PNorm = 76.0646, GNorm = 3.3910, lr_0 = 3.0083e-04
Validation prc-auc = 0.708832
Validation auc = 0.780480
Epoch 16
Loss = 2.8301e-01, PNorm = 76.1100, GNorm = 1.0249, lr_0 = 2.9212e-04
Loss = 3.1348e-01, PNorm = 76.1497, GNorm = 0.9793, lr_0 = 2.8367e-04
Validation prc-auc = 0.712687
Validation auc = 0.796480
Epoch 17
Loss = 2.7693e-01, PNorm = 76.1959, GNorm = 0.8426, lr_0 = 2.7465e-04
Loss = 2.7479e-01, PNorm = 76.2261, GNorm = 0.8213, lr_0 = 2.6670e-04
Loss = 2.6647e-01, PNorm = 76.2676, GNorm = 0.9304, lr_0 = 2.5898e-04
Validation prc-auc = 0.714589
Validation auc = 0.792960
Epoch 18
Loss = 2.6660e-01, PNorm = 76.3032, GNorm = 1.3857, lr_0 = 2.5075e-04
Loss = 2.5430e-01, PNorm = 76.3436, GNorm = 1.2357, lr_0 = 2.4349e-04
Loss = 2.7603e-01, PNorm = 76.3771, GNorm = 1.0830, lr_0 = 2.3644e-04
Validation prc-auc = 0.722469
Validation auc = 0.796160
Epoch 19
Loss = 2.5759e-01, PNorm = 76.4180, GNorm = 0.9323, lr_0 = 2.2893e-04
Loss = 2.5050e-01, PNorm = 76.4470, GNorm = 1.1322, lr_0 = 2.2230e-04
Loss = 2.5183e-01, PNorm = 76.4767, GNorm = 0.9692, lr_0 = 2.1587e-04
Validation prc-auc = 0.713524
Validation auc = 0.799040
Epoch 20
Loss = 2.5222e-01, PNorm = 76.5122, GNorm = 0.9258, lr_0 = 2.0900e-04
Loss = 2.4547e-01, PNorm = 76.5459, GNorm = 0.9349, lr_0 = 2.0295e-04
Loss = 2.2024e-01, PNorm = 76.5794, GNorm = 0.6443, lr_0 = 1.9708e-04
Loss = 3.6369e-02, PNorm = 76.5833, GNorm = 0.6781, lr_0 = 1.9650e-04
Validation prc-auc = 0.707334
Validation auc = 0.797760
Epoch 21
Loss = 2.6611e-01, PNorm = 76.5995, GNorm = 0.7960, lr_0 = 1.9081e-04
Loss = 2.2878e-01, PNorm = 76.6223, GNorm = 1.1401, lr_0 = 1.8529e-04
Validation prc-auc = 0.709922
Validation auc = 0.796640
Epoch 22
Loss = 3.6312e-01, PNorm = 76.6467, GNorm = 1.0793, lr_0 = 1.7993e-04
Loss = 2.3004e-01, PNorm = 76.6722, GNorm = 0.9208, lr_0 = 1.7472e-04
Loss = 2.4786e-01, PNorm = 76.6981, GNorm = 0.5347, lr_0 = 1.6966e-04
Validation prc-auc = 0.710606
Validation auc = 0.797280
Epoch 23
Loss = 2.5514e-01, PNorm = 76.7171, GNorm = 1.1421, lr_0 = 1.6427e-04
Loss = 2.1570e-01, PNorm = 76.7374, GNorm = 0.8267, lr_0 = 1.5952e-04
Loss = 2.3376e-01, PNorm = 76.7576, GNorm = 1.0920, lr_0 = 1.5490e-04
Validation prc-auc = 0.708306
Validation auc = 0.799520
Epoch 24
Loss = 1.8444e-01, PNorm = 76.7872, GNorm = 1.1919, lr_0 = 1.4998e-04
Loss = 2.2825e-01, PNorm = 76.8109, GNorm = 0.7481, lr_0 = 1.4563e-04
Loss = 2.3328e-01, PNorm = 76.8250, GNorm = 0.9802, lr_0 = 1.4142e-04
Validation prc-auc = 0.701424
Validation auc = 0.795360
Epoch 25
Loss = 2.1415e-01, PNorm = 76.8507, GNorm = 0.7135, lr_0 = 1.3692e-04
Loss = 2.3705e-01, PNorm = 76.8659, GNorm = 1.1971, lr_0 = 1.3296e-04
Loss = 2.0740e-01, PNorm = 76.8813, GNorm = 1.3189, lr_0 = 1.2911e-04
Validation prc-auc = 0.699233
Validation auc = 0.794720
Epoch 26
Loss = 2.0791e-01, PNorm = 76.9011, GNorm = 0.8687, lr_0 = 1.2501e-04
Loss = 1.8566e-01, PNorm = 76.9139, GNorm = 1.6377, lr_0 = 1.2139e-04
Validation prc-auc = 0.698017
Validation auc = 0.796320
Epoch 27
Loss = 2.0831e-01, PNorm = 76.9303, GNorm = 1.0232, lr_0 = 1.1753e-04
Loss = 2.0123e-01, PNorm = 76.9442, GNorm = 0.5669, lr_0 = 1.1413e-04
Loss = 2.1288e-01, PNorm = 76.9577, GNorm = 1.0094, lr_0 = 1.1083e-04
Validation prc-auc = 0.708799
Validation auc = 0.794240
Epoch 28
Loss = 2.1889e-01, PNorm = 76.9704, GNorm = 0.6318, lr_0 = 1.0730e-04
Loss = 1.7679e-01, PNorm = 76.9840, GNorm = 1.6746, lr_0 = 1.0420e-04
Loss = 1.9109e-01, PNorm = 76.9988, GNorm = 0.7543, lr_0 = 1.0118e-04
Validation prc-auc = 0.698991
Validation auc = 0.799040
Epoch 29
Loss = 2.2237e-01, PNorm = 77.0057, GNorm = 1.2417, lr_0 = 1.0000e-04
Loss = 1.7522e-01, PNorm = 77.0202, GNorm = 0.8209, lr_0 = 1.0000e-04
Loss = 1.9091e-01, PNorm = 77.0295, GNorm = 1.0773, lr_0 = 1.0000e-04
Validation prc-auc = 0.698407
Validation auc = 0.797760
Model 0 best validation prc-auc = 0.722469 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.538950
Model 0 test auc = 0.757507
Ensemble test prc-auc = 0.538950
Ensemble test auc = 0.757507
Fold 31
Splitting data with seed 31
Total scaffolds = 870 | train scaffolds = 641 | val scaffolds = 115 | test scaffolds = 114
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.2373e-01, PNorm = 72.7708, GNorm = 0.5911, lr_0 = 1.0000e-03
Loss = 4.9311e-01, PNorm = 73.1686, GNorm = 0.6292, lr_0 = 1.0000e-03
Validation prc-auc = 0.522037
Validation auc = 0.844843
Epoch 1
Loss = 4.1204e-01, PNorm = 73.4022, GNorm = 0.6033, lr_0 = 1.0000e-03
Loss = 4.3388e-01, PNorm = 73.5287, GNorm = 0.5144, lr_0 = 1.0000e-03
Loss = 4.4562e-01, PNorm = 73.6082, GNorm = 0.6632, lr_0 = 1.0000e-03
Validation prc-auc = 0.541861
Validation auc = 0.847902
Epoch 2
Loss = 5.0512e-01, PNorm = 73.6729, GNorm = 0.6770, lr_0 = 9.7965e-04
Loss = 3.9723e-01, PNorm = 73.7372, GNorm = 0.8250, lr_0 = 9.5130e-04
Loss = 4.1107e-01, PNorm = 73.7842, GNorm = 0.5279, lr_0 = 9.2376e-04
Validation prc-auc = 0.584379
Validation auc = 0.867788
Epoch 3
Loss = 3.6610e-01, PNorm = 73.8533, GNorm = 0.5268, lr_0 = 8.9440e-04
Loss = 4.3223e-01, PNorm = 73.9066, GNorm = 0.9090, lr_0 = 8.6851e-04
Loss = 4.0587e-01, PNorm = 73.9615, GNorm = 0.7654, lr_0 = 8.4337e-04
Validation prc-auc = 0.575415
Validation auc = 0.845280
Epoch 4
Loss = 4.2501e-01, PNorm = 74.0222, GNorm = 0.5998, lr_0 = 8.1656e-04
Loss = 3.8852e-01, PNorm = 74.0779, GNorm = 0.5892, lr_0 = 7.9293e-04
Loss = 3.8867e-01, PNorm = 74.1446, GNorm = 0.6893, lr_0 = 7.6998e-04
Loss = 4.2770e-01, PNorm = 74.1503, GNorm = 1.4408, lr_0 = 7.6772e-04
Validation prc-auc = 0.612959
Validation auc = 0.878059
Epoch 5
Loss = 3.7732e-01, PNorm = 74.2135, GNorm = 0.6056, lr_0 = 7.4550e-04
Loss = 3.9770e-01, PNorm = 74.2735, GNorm = 0.5661, lr_0 = 7.2393e-04
Validation prc-auc = 0.613436
Validation auc = 0.879152
Epoch 6
Loss = 4.1707e-01, PNorm = 74.3482, GNorm = 1.0636, lr_0 = 7.0091e-04
Loss = 3.2788e-01, PNorm = 74.4188, GNorm = 0.9589, lr_0 = 6.8063e-04
Loss = 4.3161e-01, PNorm = 74.4723, GNorm = 0.6444, lr_0 = 6.6093e-04
Validation prc-auc = 0.638685
Validation auc = 0.888549
Epoch 7
Loss = 4.0130e-01, PNorm = 74.5351, GNorm = 0.5259, lr_0 = 6.3992e-04
Loss = 3.7624e-01, PNorm = 74.5901, GNorm = 0.5893, lr_0 = 6.2139e-04
Loss = 3.7749e-01, PNorm = 74.6536, GNorm = 1.0286, lr_0 = 6.0341e-04
Validation prc-auc = 0.637562
Validation auc = 0.881119
Epoch 8
Loss = 3.4132e-01, PNorm = 74.7162, GNorm = 1.0272, lr_0 = 5.8595e-04
Loss = 3.4163e-01, PNorm = 74.7795, GNorm = 0.5872, lr_0 = 5.6899e-04
Loss = 3.8302e-01, PNorm = 74.8395, GNorm = 0.6907, lr_0 = 5.5252e-04
Validation prc-auc = 0.705712
Validation auc = 0.888767
Epoch 9
Loss = 3.7449e-01, PNorm = 74.9158, GNorm = 0.6715, lr_0 = 5.3495e-04
Loss = 3.7379e-01, PNorm = 74.9732, GNorm = 0.6963, lr_0 = 5.1947e-04
Loss = 3.3454e-01, PNorm = 75.0410, GNorm = 0.5802, lr_0 = 5.0444e-04
Validation prc-auc = 0.693897
Validation auc = 0.888112
Epoch 10
Loss = 3.3812e-01, PNorm = 75.1109, GNorm = 0.7566, lr_0 = 4.8840e-04
Loss = 3.1291e-01, PNorm = 75.1748, GNorm = 0.6439, lr_0 = 4.7426e-04
Validation prc-auc = 0.700099
Validation auc = 0.870411
Epoch 11
Loss = 1.9778e-01, PNorm = 75.2453, GNorm = 0.6509, lr_0 = 4.5919e-04
Loss = 2.9987e-01, PNorm = 75.3022, GNorm = 0.5531, lr_0 = 4.4590e-04
Loss = 3.4345e-01, PNorm = 75.3596, GNorm = 0.7745, lr_0 = 4.3299e-04
Validation prc-auc = 0.713104
Validation auc = 0.883304
Epoch 12
Loss = 2.8155e-01, PNorm = 75.4231, GNorm = 0.6590, lr_0 = 4.1923e-04
Loss = 3.3266e-01, PNorm = 75.4775, GNorm = 0.9284, lr_0 = 4.0709e-04
Loss = 3.3502e-01, PNorm = 75.5356, GNorm = 0.6859, lr_0 = 3.9531e-04
Validation prc-auc = 0.705733
Validation auc = 0.879152
Epoch 13
Loss = 2.8781e-01, PNorm = 75.5945, GNorm = 0.9402, lr_0 = 3.8274e-04
Loss = 3.3002e-01, PNorm = 75.6447, GNorm = 0.6528, lr_0 = 3.7167e-04
Loss = 2.9884e-01, PNorm = 75.6935, GNorm = 0.7637, lr_0 = 3.6091e-04
Validation prc-auc = 0.720793
Validation auc = 0.887456
Epoch 14
Loss = 2.9163e-01, PNorm = 75.7597, GNorm = 1.8420, lr_0 = 3.4944e-04
Loss = 3.0850e-01, PNorm = 75.8014, GNorm = 0.8639, lr_0 = 3.3932e-04
Loss = 3.2753e-01, PNorm = 75.8474, GNorm = 0.8934, lr_0 = 3.2950e-04
Validation prc-auc = 0.688613
Validation auc = 0.873033
Epoch 15
Loss = 2.6470e-01, PNorm = 75.8959, GNorm = 0.8109, lr_0 = 3.1996e-04
Loss = 3.0242e-01, PNorm = 75.9407, GNorm = 1.3236, lr_0 = 3.1070e-04
Loss = 2.9447e-01, PNorm = 75.9768, GNorm = 0.7552, lr_0 = 3.0171e-04
Loss = 2.4018e-01, PNorm = 75.9810, GNorm = 2.0779, lr_0 = 3.0083e-04
Validation prc-auc = 0.691950
Validation auc = 0.877404
Epoch 16
Loss = 2.7515e-01, PNorm = 76.0230, GNorm = 0.8362, lr_0 = 2.9212e-04
Loss = 2.8292e-01, PNorm = 76.0603, GNorm = 0.7050, lr_0 = 2.8367e-04
Validation prc-auc = 0.715883
Validation auc = 0.875437
Epoch 17
Loss = 2.7001e-01, PNorm = 76.1034, GNorm = 0.9007, lr_0 = 2.7465e-04
Loss = 2.5756e-01, PNorm = 76.1463, GNorm = 0.8493, lr_0 = 2.6670e-04
Loss = 2.4609e-01, PNorm = 76.1806, GNorm = 0.9264, lr_0 = 2.5898e-04
Validation prc-auc = 0.707538
Validation auc = 0.885271
Epoch 18
Loss = 2.2799e-01, PNorm = 76.2174, GNorm = 1.0995, lr_0 = 2.5075e-04
Loss = 2.7642e-01, PNorm = 76.2610, GNorm = 1.3390, lr_0 = 2.4349e-04
Loss = 2.4977e-01, PNorm = 76.2936, GNorm = 1.3123, lr_0 = 2.3644e-04
Validation prc-auc = 0.710448
Validation auc = 0.873689
Epoch 19
Loss = 2.6026e-01, PNorm = 76.3247, GNorm = 0.8923, lr_0 = 2.2893e-04
Loss = 2.3299e-01, PNorm = 76.3531, GNorm = 0.8198, lr_0 = 2.2230e-04
Loss = 2.8432e-01, PNorm = 76.3815, GNorm = 1.4589, lr_0 = 2.1587e-04
Validation prc-auc = 0.666155
Validation auc = 0.864729
Epoch 20
Loss = 2.5233e-01, PNorm = 76.4240, GNorm = 1.2301, lr_0 = 2.0900e-04
Loss = 2.2777e-01, PNorm = 76.4509, GNorm = 0.8665, lr_0 = 2.0295e-04
Loss = 2.9105e-01, PNorm = 76.4777, GNorm = 1.0565, lr_0 = 1.9708e-04
Loss = 3.2228e-01, PNorm = 76.4807, GNorm = 2.2537, lr_0 = 1.9650e-04
Validation prc-auc = 0.678438
Validation auc = 0.873033
Epoch 21
Loss = 2.5447e-01, PNorm = 76.5064, GNorm = 0.8980, lr_0 = 1.9081e-04
Loss = 2.4761e-01, PNorm = 76.5332, GNorm = 1.0034, lr_0 = 1.8529e-04
Validation prc-auc = 0.688384
Validation auc = 0.870192
Epoch 22
Loss = 1.8776e-01, PNorm = 76.5617, GNorm = 0.9076, lr_0 = 1.7993e-04
Loss = 2.4999e-01, PNorm = 76.5826, GNorm = 1.4288, lr_0 = 1.7472e-04
Loss = 2.4782e-01, PNorm = 76.6070, GNorm = 0.9296, lr_0 = 1.6966e-04
Validation prc-auc = 0.687164
Validation auc = 0.871066
Epoch 23
Loss = 2.8979e-01, PNorm = 76.6351, GNorm = 1.3877, lr_0 = 1.6427e-04
Loss = 2.4168e-01, PNorm = 76.6540, GNorm = 1.1329, lr_0 = 1.5952e-04
Loss = 2.0854e-01, PNorm = 76.6793, GNorm = 2.1236, lr_0 = 1.5490e-04
Validation prc-auc = 0.664497
Validation auc = 0.869755
Epoch 24
Loss = 2.3807e-01, PNorm = 76.6985, GNorm = 0.9149, lr_0 = 1.4998e-04
Loss = 2.0333e-01, PNorm = 76.7187, GNorm = 1.1880, lr_0 = 1.4563e-04
Loss = 2.3045e-01, PNorm = 76.7405, GNorm = 0.7618, lr_0 = 1.4142e-04
Validation prc-auc = 0.686991
Validation auc = 0.871285
Epoch 25
Loss = 2.4314e-01, PNorm = 76.7565, GNorm = 1.0610, lr_0 = 1.3692e-04
Loss = 2.1083e-01, PNorm = 76.7786, GNorm = 1.2876, lr_0 = 1.3296e-04
Loss = 2.5898e-01, PNorm = 76.7922, GNorm = 1.1791, lr_0 = 1.2911e-04
Validation prc-auc = 0.693047
Validation auc = 0.877622
Epoch 26
Loss = 1.9976e-01, PNorm = 76.8128, GNorm = 0.9816, lr_0 = 1.2501e-04
Loss = 2.4985e-01, PNorm = 76.8251, GNorm = 0.9200, lr_0 = 1.2139e-04
Validation prc-auc = 0.704814
Validation auc = 0.880026
Epoch 27
Loss = 2.1530e-01, PNorm = 76.8409, GNorm = 1.1289, lr_0 = 1.1753e-04
Loss = 2.0793e-01, PNorm = 76.8558, GNorm = 1.1592, lr_0 = 1.1413e-04
Loss = 1.7225e-01, PNorm = 76.8712, GNorm = 1.1000, lr_0 = 1.1083e-04
Validation prc-auc = 0.676437
Validation auc = 0.871941
Epoch 28
Loss = 1.9977e-01, PNorm = 76.8873, GNorm = 1.3685, lr_0 = 1.0730e-04
Loss = 2.4167e-01, PNorm = 76.9001, GNorm = 1.5399, lr_0 = 1.0420e-04
Loss = 1.8430e-01, PNorm = 76.9125, GNorm = 1.0689, lr_0 = 1.0118e-04
Validation prc-auc = 0.681384
Validation auc = 0.868444
Epoch 29
Loss = 1.8258e-01, PNorm = 76.9243, GNorm = 1.0953, lr_0 = 1.0000e-04
Loss = 1.9578e-01, PNorm = 76.9348, GNorm = 0.9208, lr_0 = 1.0000e-04
Loss = 2.0465e-01, PNorm = 76.9475, GNorm = 1.5371, lr_0 = 1.0000e-04
Validation prc-auc = 0.684694
Validation auc = 0.867788
Model 0 best validation prc-auc = 0.720793 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.458766
Model 0 test auc = 0.729982
Ensemble test prc-auc = 0.458766
Ensemble test auc = 0.729982
Fold 32
Splitting data with seed 32
Total scaffolds = 870 | train scaffolds = 643 | val scaffolds = 110 | test scaffolds = 117
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 5.6560e-01, PNorm = 72.7539, GNorm = 1.8515, lr_0 = 1.0000e-03
Loss = 4.2974e-01, PNorm = 73.1512, GNorm = 0.5129, lr_0 = 1.0000e-03
Validation prc-auc = 0.446253
Validation auc = 0.699829
Epoch 1
Loss = 3.7799e-01, PNorm = 73.3971, GNorm = 0.5333, lr_0 = 1.0000e-03
Loss = 4.1321e-01, PNorm = 73.5264, GNorm = 0.5747, lr_0 = 1.0000e-03
Loss = 4.1726e-01, PNorm = 73.6246, GNorm = 0.9031, lr_0 = 1.0000e-03
Validation prc-auc = 0.459265
Validation auc = 0.694359
Epoch 2
Loss = 3.3714e-01, PNorm = 73.7168, GNorm = 0.7736, lr_0 = 9.7965e-04
Loss = 3.7700e-01, PNorm = 73.7960, GNorm = 0.8242, lr_0 = 9.5130e-04
Loss = 4.5405e-01, PNorm = 73.8721, GNorm = 1.3303, lr_0 = 9.2376e-04
Validation prc-auc = 0.464724
Validation auc = 0.701368
Epoch 3
Loss = 3.7520e-01, PNorm = 73.9545, GNorm = 0.8389, lr_0 = 8.9440e-04
Loss = 3.5901e-01, PNorm = 74.0315, GNorm = 0.5716, lr_0 = 8.6851e-04
Loss = 3.9206e-01, PNorm = 74.1023, GNorm = 1.1628, lr_0 = 8.4337e-04
Validation prc-auc = 0.478101
Validation auc = 0.718120
Epoch 4
Loss = 3.6579e-01, PNorm = 74.1721, GNorm = 0.5825, lr_0 = 8.1656e-04
Loss = 3.7874e-01, PNorm = 74.2372, GNorm = 0.7153, lr_0 = 7.9293e-04
Loss = 3.8138e-01, PNorm = 74.2928, GNorm = 0.4934, lr_0 = 7.6998e-04
Loss = 6.2985e-01, PNorm = 74.2973, GNorm = 3.3353, lr_0 = 7.6772e-04
Validation prc-auc = 0.494234
Validation auc = 0.710427
Epoch 5
Loss = 3.5257e-01, PNorm = 74.3728, GNorm = 1.0197, lr_0 = 7.4550e-04
Loss = 3.7597e-01, PNorm = 74.4291, GNorm = 1.2069, lr_0 = 7.2393e-04
Validation prc-auc = 0.514878
Validation auc = 0.728889
Epoch 6
Loss = 3.4125e-01, PNorm = 74.4970, GNorm = 0.7340, lr_0 = 7.0091e-04
Loss = 3.3768e-01, PNorm = 74.5709, GNorm = 1.0276, lr_0 = 6.8063e-04
Loss = 3.8427e-01, PNorm = 74.6314, GNorm = 0.5447, lr_0 = 6.6093e-04
Validation prc-auc = 0.510003
Validation auc = 0.733162
Epoch 7
Loss = 3.3494e-01, PNorm = 74.7063, GNorm = 0.7887, lr_0 = 6.3992e-04
Loss = 3.3497e-01, PNorm = 74.7927, GNorm = 0.5610, lr_0 = 6.2139e-04
Loss = 3.6771e-01, PNorm = 74.8601, GNorm = 0.5356, lr_0 = 6.0341e-04
Validation prc-auc = 0.508885
Validation auc = 0.727863
Epoch 8
Loss = 3.3972e-01, PNorm = 74.9349, GNorm = 0.6025, lr_0 = 5.8595e-04
Loss = 3.4756e-01, PNorm = 74.9993, GNorm = 0.7913, lr_0 = 5.6899e-04
Loss = 3.2822e-01, PNorm = 75.0694, GNorm = 0.5338, lr_0 = 5.5252e-04
Validation prc-auc = 0.537252
Validation auc = 0.738291
Epoch 9
Loss = 3.2466e-01, PNorm = 75.1403, GNorm = 0.6226, lr_0 = 5.3495e-04
Loss = 3.1064e-01, PNorm = 75.2153, GNorm = 1.1612, lr_0 = 5.1947e-04
Loss = 3.1535e-01, PNorm = 75.2758, GNorm = 0.5935, lr_0 = 5.0444e-04
Validation prc-auc = 0.540947
Validation auc = 0.728718
Epoch 10
Loss = 3.5264e-01, PNorm = 75.3577, GNorm = 1.3470, lr_0 = 4.8840e-04
Loss = 3.2576e-01, PNorm = 75.4396, GNorm = 1.1372, lr_0 = 4.7426e-04
Validation prc-auc = 0.528349
Validation auc = 0.723077
Epoch 11
Loss = 2.9720e-01, PNorm = 75.5208, GNorm = 0.8494, lr_0 = 4.5919e-04
Loss = 3.1281e-01, PNorm = 75.5891, GNorm = 0.6605, lr_0 = 4.4590e-04
Loss = 3.0600e-01, PNorm = 75.6676, GNorm = 1.0203, lr_0 = 4.3299e-04
Validation prc-auc = 0.569354
Validation auc = 0.742564
Epoch 12
Loss = 2.9466e-01, PNorm = 75.7183, GNorm = 0.6554, lr_0 = 4.1923e-04
Loss = 3.1928e-01, PNorm = 75.7870, GNorm = 0.5486, lr_0 = 4.0709e-04
Loss = 3.1370e-01, PNorm = 75.8542, GNorm = 0.8805, lr_0 = 3.9531e-04
Validation prc-auc = 0.569662
Validation auc = 0.737778
Epoch 13
Loss = 2.7486e-01, PNorm = 75.9296, GNorm = 0.5792, lr_0 = 3.8274e-04
Loss = 3.1142e-01, PNorm = 75.9878, GNorm = 0.7080, lr_0 = 3.7167e-04
Loss = 2.6570e-01, PNorm = 76.0561, GNorm = 1.1291, lr_0 = 3.6091e-04
Validation prc-auc = 0.566233
Validation auc = 0.743419
Epoch 14
Loss = 3.1992e-01, PNorm = 76.1236, GNorm = 0.8321, lr_0 = 3.4944e-04
Loss = 2.8127e-01, PNorm = 76.1842, GNorm = 0.9182, lr_0 = 3.3932e-04
Loss = 2.4790e-01, PNorm = 76.2271, GNorm = 0.9140, lr_0 = 3.2950e-04
Validation prc-auc = 0.570670
Validation auc = 0.746838
Epoch 15
Loss = 2.3961e-01, PNorm = 76.2734, GNorm = 0.9264, lr_0 = 3.1996e-04
Loss = 2.5856e-01, PNorm = 76.3161, GNorm = 0.9236, lr_0 = 3.1070e-04
Loss = 2.9635e-01, PNorm = 76.3592, GNorm = 0.6234, lr_0 = 3.0171e-04
Loss = 3.6440e-01, PNorm = 76.3640, GNorm = 2.5627, lr_0 = 3.0083e-04
Validation prc-auc = 0.576960
Validation auc = 0.752650
Epoch 16
Loss = 2.4111e-01, PNorm = 76.4133, GNorm = 0.4219, lr_0 = 2.9212e-04
Loss = 2.7101e-01, PNorm = 76.4569, GNorm = 0.9669, lr_0 = 2.8367e-04
Validation prc-auc = 0.578275
Validation auc = 0.747863
Epoch 17
Loss = 3.3069e-01, PNorm = 76.5109, GNorm = 0.8163, lr_0 = 2.7465e-04
Loss = 2.9077e-01, PNorm = 76.5570, GNorm = 1.0879, lr_0 = 2.6670e-04
Loss = 2.0681e-01, PNorm = 76.6006, GNorm = 1.0932, lr_0 = 2.5898e-04
Validation prc-auc = 0.573997
Validation auc = 0.761880
Epoch 18
Loss = 2.6732e-01, PNorm = 76.6424, GNorm = 1.3258, lr_0 = 2.5075e-04
Loss = 2.4517e-01, PNorm = 76.6839, GNorm = 1.1308, lr_0 = 2.4349e-04
Loss = 2.3005e-01, PNorm = 76.7308, GNorm = 0.9339, lr_0 = 2.3644e-04
Validation prc-auc = 0.536380
Validation auc = 0.753504
Epoch 19
Loss = 2.1891e-01, PNorm = 76.7723, GNorm = 1.8643, lr_0 = 2.2893e-04
Loss = 2.3912e-01, PNorm = 76.8091, GNorm = 1.0837, lr_0 = 2.2230e-04
Loss = 3.1275e-01, PNorm = 76.8387, GNorm = 1.3279, lr_0 = 2.1587e-04
Validation prc-auc = 0.595735
Validation auc = 0.765128
Epoch 20
Loss = 2.2064e-01, PNorm = 76.8779, GNorm = 1.1489, lr_0 = 2.0900e-04
Loss = 2.2381e-01, PNorm = 76.9104, GNorm = 1.0140, lr_0 = 2.0295e-04
Loss = 2.4775e-01, PNorm = 76.9404, GNorm = 1.0971, lr_0 = 1.9708e-04
Loss = 4.9379e-01, PNorm = 76.9438, GNorm = 3.7113, lr_0 = 1.9650e-04
Validation prc-auc = 0.576089
Validation auc = 0.764786
Epoch 21
Loss = 2.1749e-01, PNorm = 76.9735, GNorm = 0.8476, lr_0 = 1.9081e-04
Loss = 2.4535e-01, PNorm = 77.0012, GNorm = 1.1004, lr_0 = 1.8529e-04
Validation prc-auc = 0.579693
Validation auc = 0.768376
Epoch 22
Loss = 3.0424e-01, PNorm = 77.0299, GNorm = 1.2203, lr_0 = 1.7993e-04
Loss = 1.7822e-01, PNorm = 77.0557, GNorm = 0.9458, lr_0 = 1.7472e-04
Loss = 2.2738e-01, PNorm = 77.0815, GNorm = 0.9402, lr_0 = 1.6966e-04
Validation prc-auc = 0.575971
Validation auc = 0.760855
Epoch 23
Loss = 2.2617e-01, PNorm = 77.1106, GNorm = 1.0649, lr_0 = 1.6427e-04
Loss = 1.9979e-01, PNorm = 77.1347, GNorm = 1.0768, lr_0 = 1.5952e-04
Loss = 2.0299e-01, PNorm = 77.1578, GNorm = 0.9664, lr_0 = 1.5490e-04
Validation prc-auc = 0.568341
Validation auc = 0.768205
Epoch 24
Loss = 1.9639e-01, PNorm = 77.1790, GNorm = 1.1004, lr_0 = 1.4998e-04
Loss = 2.0526e-01, PNorm = 77.1989, GNorm = 1.9088, lr_0 = 1.4563e-04
Loss = 1.8084e-01, PNorm = 77.2215, GNorm = 0.5769, lr_0 = 1.4142e-04
Validation prc-auc = 0.580204
Validation auc = 0.764103
Epoch 25
Loss = 1.9003e-01, PNorm = 77.2396, GNorm = 1.2788, lr_0 = 1.3692e-04
Loss = 2.0108e-01, PNorm = 77.2559, GNorm = 1.0009, lr_0 = 1.3296e-04
Loss = 2.0642e-01, PNorm = 77.2775, GNorm = 1.2263, lr_0 = 1.2911e-04
Validation prc-auc = 0.547114
Validation auc = 0.764444
Epoch 26
Loss = 1.9517e-01, PNorm = 77.2973, GNorm = 1.3647, lr_0 = 1.2501e-04
Loss = 2.2913e-01, PNorm = 77.3140, GNorm = 0.7373, lr_0 = 1.2139e-04
Validation prc-auc = 0.559656
Validation auc = 0.767350
Epoch 27
Loss = 2.2831e-01, PNorm = 77.3287, GNorm = 1.0991, lr_0 = 1.1753e-04
Loss = 1.5383e-01, PNorm = 77.3471, GNorm = 1.8108, lr_0 = 1.1413e-04
Loss = 2.1054e-01, PNorm = 77.3571, GNorm = 0.9571, lr_0 = 1.1083e-04
Validation prc-auc = 0.566966
Validation auc = 0.768376
Epoch 28
Loss = 1.7070e-01, PNorm = 77.3738, GNorm = 1.1627, lr_0 = 1.0730e-04
Loss = 1.8733e-01, PNorm = 77.3868, GNorm = 1.3457, lr_0 = 1.0420e-04
Loss = 1.7218e-01, PNorm = 77.4000, GNorm = 0.7467, lr_0 = 1.0118e-04
Validation prc-auc = 0.549545
Validation auc = 0.768376
Epoch 29
Loss = 1.0527e-01, PNorm = 77.4136, GNorm = 0.9698, lr_0 = 1.0000e-04
Loss = 2.0229e-01, PNorm = 77.4262, GNorm = 1.2940, lr_0 = 1.0000e-04
Loss = 1.7079e-01, PNorm = 77.4398, GNorm = 1.4700, lr_0 = 1.0000e-04
Validation prc-auc = 0.537021
Validation auc = 0.767863
Model 0 best validation prc-auc = 0.595735 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.631764
Model 0 test auc = 0.750434
Ensemble test prc-auc = 0.631764
Ensemble test auc = 0.750434
Fold 33
Splitting data with seed 33
Total scaffolds = 870 | train scaffolds = 649 | val scaffolds = 110 | test scaffolds = 111
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.0474e-01, PNorm = 72.7660, GNorm = 1.5169, lr_0 = 1.0000e-03
Loss = 4.2789e-01, PNorm = 73.1685, GNorm = 0.8126, lr_0 = 1.0000e-03
Validation prc-auc = 0.473837
Validation auc = 0.701933
Epoch 1
Loss = 4.6562e-01, PNorm = 73.4007, GNorm = 0.6848, lr_0 = 1.0000e-03
Loss = 4.0946e-01, PNorm = 73.5292, GNorm = 0.6693, lr_0 = 1.0000e-03
Loss = 4.3078e-01, PNorm = 73.6068, GNorm = 0.6999, lr_0 = 1.0000e-03
Validation prc-auc = 0.454952
Validation auc = 0.682599
Epoch 2
Loss = 4.7839e-01, PNorm = 73.6749, GNorm = 0.6148, lr_0 = 9.7965e-04
Loss = 4.1183e-01, PNorm = 73.7395, GNorm = 0.5805, lr_0 = 9.5130e-04
Loss = 4.2619e-01, PNorm = 73.7998, GNorm = 1.3747, lr_0 = 9.2376e-04
Validation prc-auc = 0.491268
Validation auc = 0.677766
Epoch 3
Loss = 3.7475e-01, PNorm = 73.8532, GNorm = 0.5961, lr_0 = 8.9440e-04
Loss = 4.5462e-01, PNorm = 73.8958, GNorm = 0.5417, lr_0 = 8.6851e-04
Loss = 3.7672e-01, PNorm = 73.9556, GNorm = 0.6139, lr_0 = 8.4337e-04
Validation prc-auc = 0.493096
Validation auc = 0.685285
Epoch 4
Loss = 3.9553e-01, PNorm = 74.0183, GNorm = 0.6223, lr_0 = 8.1656e-04
Loss = 3.7922e-01, PNorm = 74.0777, GNorm = 0.8942, lr_0 = 7.9293e-04
Loss = 3.7807e-01, PNorm = 74.1434, GNorm = 0.6787, lr_0 = 7.6998e-04
Loss = 5.4428e-01, PNorm = 74.1487, GNorm = 1.9232, lr_0 = 7.6772e-04
Validation prc-auc = 0.502116
Validation auc = 0.682599
Epoch 5
Loss = 3.7062e-01, PNorm = 74.2024, GNorm = 0.5352, lr_0 = 7.4550e-04
Loss = 3.9774e-01, PNorm = 74.2740, GNorm = 1.3790, lr_0 = 7.2393e-04
Validation prc-auc = 0.513872
Validation auc = 0.693520
Epoch 6
Loss = 3.6516e-01, PNorm = 74.3548, GNorm = 1.1449, lr_0 = 7.0091e-04
Loss = 3.7079e-01, PNorm = 74.4145, GNorm = 0.7289, lr_0 = 6.8063e-04
Loss = 3.5732e-01, PNorm = 74.4827, GNorm = 0.6131, lr_0 = 6.6093e-04
Validation prc-auc = 0.496377
Validation auc = 0.688149
Epoch 7
Loss = 3.5843e-01, PNorm = 74.5533, GNorm = 0.6263, lr_0 = 6.3992e-04
Loss = 3.4459e-01, PNorm = 74.6257, GNorm = 0.6087, lr_0 = 6.2139e-04
Loss = 3.7079e-01, PNorm = 74.6978, GNorm = 0.7816, lr_0 = 6.0341e-04
Validation prc-auc = 0.508820
Validation auc = 0.681883
Epoch 8
Loss = 3.2814e-01, PNorm = 74.7691, GNorm = 0.8644, lr_0 = 5.8595e-04
Loss = 3.3366e-01, PNorm = 74.8510, GNorm = 0.6060, lr_0 = 5.6899e-04
Loss = 3.1614e-01, PNorm = 74.9290, GNorm = 0.5636, lr_0 = 5.5252e-04
Validation prc-auc = 0.482878
Validation auc = 0.686538
Epoch 9
Loss = 3.2762e-01, PNorm = 75.0138, GNorm = 0.7316, lr_0 = 5.3495e-04
Loss = 3.5488e-01, PNorm = 75.0848, GNorm = 0.7467, lr_0 = 5.1947e-04
Loss = 3.5890e-01, PNorm = 75.1479, GNorm = 0.8022, lr_0 = 5.0444e-04
Validation prc-auc = 0.475529
Validation auc = 0.681346
Epoch 10
Loss = 3.4459e-01, PNorm = 75.2121, GNorm = 0.8970, lr_0 = 4.8840e-04
Loss = 2.9698e-01, PNorm = 75.2790, GNorm = 0.5304, lr_0 = 4.7426e-04
Validation prc-auc = 0.504509
Validation auc = 0.684569
Epoch 11
Loss = 2.7709e-01, PNorm = 75.3382, GNorm = 0.8420, lr_0 = 4.5919e-04
Loss = 2.9657e-01, PNorm = 75.4121, GNorm = 1.5302, lr_0 = 4.4590e-04
Loss = 3.6150e-01, PNorm = 75.4642, GNorm = 0.8974, lr_0 = 4.3299e-04
Validation prc-auc = 0.510224
Validation auc = 0.681883
Epoch 12
Loss = 2.9946e-01, PNorm = 75.5360, GNorm = 1.0525, lr_0 = 4.1923e-04
Loss = 3.4092e-01, PNorm = 75.6039, GNorm = 1.0566, lr_0 = 4.0709e-04
Loss = 3.1516e-01, PNorm = 75.6517, GNorm = 0.6082, lr_0 = 3.9531e-04
Validation prc-auc = 0.469149
Validation auc = 0.670068
Epoch 13
Loss = 3.1832e-01, PNorm = 75.7126, GNorm = 0.9992, lr_0 = 3.8274e-04
Loss = 3.3378e-01, PNorm = 75.7646, GNorm = 0.7223, lr_0 = 3.7167e-04
Loss = 2.6412e-01, PNorm = 75.8160, GNorm = 0.5895, lr_0 = 3.6091e-04
Validation prc-auc = 0.463458
Validation auc = 0.670068
Epoch 14
Loss = 2.9855e-01, PNorm = 75.8869, GNorm = 1.0491, lr_0 = 3.4944e-04
Loss = 3.1294e-01, PNorm = 75.9408, GNorm = 1.0674, lr_0 = 3.3932e-04
Loss = 2.9694e-01, PNorm = 75.9869, GNorm = 0.9035, lr_0 = 3.2950e-04
Validation prc-auc = 0.478453
Validation auc = 0.681167
Epoch 15
Loss = 2.7843e-01, PNorm = 76.0374, GNorm = 0.8994, lr_0 = 3.1996e-04
Loss = 2.5979e-01, PNorm = 76.0819, GNorm = 0.6993, lr_0 = 3.1070e-04
Loss = 2.8153e-01, PNorm = 76.1179, GNorm = 0.7986, lr_0 = 3.0171e-04
Loss = 1.9771e-01, PNorm = 76.1217, GNorm = 2.0988, lr_0 = 3.0083e-04
Validation prc-auc = 0.456097
Validation auc = 0.685643
Epoch 16
Loss = 2.6660e-01, PNorm = 76.1578, GNorm = 1.0807, lr_0 = 2.9212e-04
Loss = 2.5417e-01, PNorm = 76.1977, GNorm = 0.5645, lr_0 = 2.8367e-04
Validation prc-auc = 0.492236
Validation auc = 0.683494
Epoch 17
Loss = 2.2979e-01, PNorm = 76.2426, GNorm = 0.8711, lr_0 = 2.7465e-04
Loss = 2.8311e-01, PNorm = 76.2861, GNorm = 1.7030, lr_0 = 2.6670e-04
Loss = 2.6904e-01, PNorm = 76.3345, GNorm = 1.2078, lr_0 = 2.5898e-04
Validation prc-auc = 0.456216
Validation auc = 0.689044
Epoch 18
Loss = 2.7517e-01, PNorm = 76.3696, GNorm = 1.0871, lr_0 = 2.5075e-04
Loss = 2.4885e-01, PNorm = 76.4098, GNorm = 1.0455, lr_0 = 2.4349e-04
Loss = 2.3961e-01, PNorm = 76.4392, GNorm = 0.9807, lr_0 = 2.3644e-04
Validation prc-auc = 0.463099
Validation auc = 0.678482
Epoch 19
Loss = 2.2917e-01, PNorm = 76.4725, GNorm = 0.9025, lr_0 = 2.2893e-04
Loss = 2.4175e-01, PNorm = 76.5048, GNorm = 1.1915, lr_0 = 2.2230e-04
Loss = 2.5537e-01, PNorm = 76.5327, GNorm = 0.8254, lr_0 = 2.1587e-04
Validation prc-auc = 0.482086
Validation auc = 0.691371
Epoch 20
Loss = 2.3971e-01, PNorm = 76.5615, GNorm = 1.4597, lr_0 = 2.0900e-04
Loss = 2.2536e-01, PNorm = 76.5907, GNorm = 0.9852, lr_0 = 2.0295e-04
Loss = 2.5799e-01, PNorm = 76.6154, GNorm = 1.2044, lr_0 = 1.9708e-04
Loss = 5.4000e-01, PNorm = 76.6171, GNorm = 3.9533, lr_0 = 1.9650e-04
Validation prc-auc = 0.461052
Validation auc = 0.682062
Epoch 21
Loss = 2.5108e-01, PNorm = 76.6507, GNorm = 1.7390, lr_0 = 1.9081e-04
Loss = 2.2698e-01, PNorm = 76.6720, GNorm = 0.7664, lr_0 = 1.8529e-04
Validation prc-auc = 0.466403
Validation auc = 0.689760
Epoch 22
Loss = 2.2789e-01, PNorm = 76.6961, GNorm = 0.8235, lr_0 = 1.7993e-04
Loss = 2.2586e-01, PNorm = 76.7176, GNorm = 0.8361, lr_0 = 1.7472e-04
Loss = 1.9662e-01, PNorm = 76.7425, GNorm = 0.7193, lr_0 = 1.6966e-04
Validation prc-auc = 0.479205
Validation auc = 0.687970
Epoch 23
Loss = 2.3064e-01, PNorm = 76.7643, GNorm = 1.2052, lr_0 = 1.6427e-04
Loss = 2.3219e-01, PNorm = 76.7806, GNorm = 1.1714, lr_0 = 1.5952e-04
Loss = 2.2937e-01, PNorm = 76.7989, GNorm = 1.1019, lr_0 = 1.5490e-04
Validation prc-auc = 0.433889
Validation auc = 0.682599
Epoch 24
Loss = 2.2035e-01, PNorm = 76.8177, GNorm = 0.9619, lr_0 = 1.4998e-04
Loss = 1.8793e-01, PNorm = 76.8353, GNorm = 1.2566, lr_0 = 1.4563e-04
Loss = 2.1257e-01, PNorm = 76.8537, GNorm = 1.0977, lr_0 = 1.4142e-04
Validation prc-auc = 0.486081
Validation auc = 0.693340
Epoch 25
Loss = 2.3274e-01, PNorm = 76.8758, GNorm = 2.0355, lr_0 = 1.3692e-04
Loss = 1.9183e-01, PNorm = 76.8907, GNorm = 1.1719, lr_0 = 1.3296e-04
Loss = 1.9172e-01, PNorm = 76.9091, GNorm = 1.1687, lr_0 = 1.2911e-04
Validation prc-auc = 0.468470
Validation auc = 0.691550
Epoch 26
Loss = 2.1958e-01, PNorm = 76.9243, GNorm = 2.0315, lr_0 = 1.2501e-04
Loss = 2.0393e-01, PNorm = 76.9401, GNorm = 1.5309, lr_0 = 1.2139e-04
Validation prc-auc = 0.453549
Validation auc = 0.688865
Epoch 27
Loss = 7.0519e-02, PNorm = 76.9553, GNorm = 0.6268, lr_0 = 1.1753e-04
Loss = 1.9983e-01, PNorm = 76.9677, GNorm = 1.2384, lr_0 = 1.1413e-04
Loss = 1.6504e-01, PNorm = 76.9821, GNorm = 1.5066, lr_0 = 1.1083e-04
Validation prc-auc = 0.447859
Validation auc = 0.686717
Epoch 28
Loss = 1.8451e-01, PNorm = 76.9960, GNorm = 1.3526, lr_0 = 1.0730e-04
Loss = 2.0435e-01, PNorm = 77.0118, GNorm = 1.1033, lr_0 = 1.0420e-04
Loss = 1.7453e-01, PNorm = 77.0243, GNorm = 1.3218, lr_0 = 1.0118e-04
Validation prc-auc = 0.449005
Validation auc = 0.685464
Epoch 29
Loss = 1.7660e-01, PNorm = 77.0367, GNorm = 0.8461, lr_0 = 1.0000e-04
Loss = 1.9151e-01, PNorm = 77.0471, GNorm = 1.5390, lr_0 = 1.0000e-04
Loss = 1.9280e-01, PNorm = 77.0587, GNorm = 1.0499, lr_0 = 1.0000e-04
Validation prc-auc = 0.456687
Validation auc = 0.688686
Model 0 best validation prc-auc = 0.513872 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.508594
Model 0 test auc = 0.796825
Ensemble test prc-auc = 0.508594
Ensemble test auc = 0.796825
Fold 34
Splitting data with seed 34
Total scaffolds = 870 | train scaffolds = 648 | val scaffolds = 122 | test scaffolds = 100
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.9301e-01, PNorm = 72.7768, GNorm = 0.8990, lr_0 = 1.0000e-03
Loss = 4.9001e-01, PNorm = 73.1941, GNorm = 0.5439, lr_0 = 1.0000e-03
Validation prc-auc = 0.331554
Validation auc = 0.676527
Epoch 1
Loss = 4.9512e-01, PNorm = 73.4388, GNorm = 0.9090, lr_0 = 1.0000e-03
Loss = 4.0133e-01, PNorm = 73.5694, GNorm = 0.5555, lr_0 = 1.0000e-03
Loss = 4.6167e-01, PNorm = 73.6475, GNorm = 0.7290, lr_0 = 1.0000e-03
Validation prc-auc = 0.422907
Validation auc = 0.707069
Epoch 2
Loss = 4.5813e-01, PNorm = 73.7124, GNorm = 0.9516, lr_0 = 9.7965e-04
Loss = 4.3345e-01, PNorm = 73.7728, GNorm = 0.6160, lr_0 = 9.5130e-04
Loss = 4.1314e-01, PNorm = 73.8288, GNorm = 0.4606, lr_0 = 9.2376e-04
Validation prc-auc = 0.417978
Validation auc = 0.691126
Epoch 3
Loss = 3.5726e-01, PNorm = 73.8821, GNorm = 0.5034, lr_0 = 8.9440e-04
Loss = 4.3665e-01, PNorm = 73.9279, GNorm = 0.7121, lr_0 = 8.6851e-04
Loss = 3.9574e-01, PNorm = 73.9874, GNorm = 0.6209, lr_0 = 8.4337e-04
Validation prc-auc = 0.483956
Validation auc = 0.723396
Epoch 4
Loss = 3.7696e-01, PNorm = 74.0557, GNorm = 0.4375, lr_0 = 8.1656e-04
Loss = 4.1266e-01, PNorm = 74.1191, GNorm = 0.5899, lr_0 = 7.9293e-04
Loss = 4.1468e-01, PNorm = 74.1780, GNorm = 0.5898, lr_0 = 7.6998e-04
Loss = 4.8462e-01, PNorm = 74.1832, GNorm = 1.8823, lr_0 = 7.6772e-04
Validation prc-auc = 0.504662
Validation auc = 0.727814
Epoch 5
Loss = 3.8393e-01, PNorm = 74.2485, GNorm = 1.0259, lr_0 = 7.4550e-04
Loss = 3.8646e-01, PNorm = 74.3040, GNorm = 0.6455, lr_0 = 7.2393e-04
Validation prc-auc = 0.515314
Validation auc = 0.745294
Epoch 6
Loss = 3.1687e-01, PNorm = 74.3716, GNorm = 0.5777, lr_0 = 7.0091e-04
Loss = 4.0646e-01, PNorm = 74.4209, GNorm = 0.7741, lr_0 = 6.8063e-04
Loss = 3.9462e-01, PNorm = 74.4822, GNorm = 0.4398, lr_0 = 6.6093e-04
Validation prc-auc = 0.530672
Validation auc = 0.750288
Epoch 7
Loss = 3.6418e-01, PNorm = 74.5379, GNorm = 0.4979, lr_0 = 6.3992e-04
Loss = 3.7890e-01, PNorm = 74.5907, GNorm = 0.9482, lr_0 = 6.2139e-04
Loss = 3.8743e-01, PNorm = 74.6409, GNorm = 0.8821, lr_0 = 6.0341e-04
Validation prc-auc = 0.548401
Validation auc = 0.750096
Epoch 8
Loss = 4.0137e-01, PNorm = 74.7011, GNorm = 0.6343, lr_0 = 5.8595e-04
Loss = 3.6907e-01, PNorm = 74.7565, GNorm = 0.9206, lr_0 = 5.6899e-04
Loss = 3.6144e-01, PNorm = 74.8198, GNorm = 0.6917, lr_0 = 5.5252e-04
Validation prc-auc = 0.560690
Validation auc = 0.760277
Epoch 9
Loss = 3.8377e-01, PNorm = 74.8807, GNorm = 1.1672, lr_0 = 5.3495e-04
Loss = 4.0934e-01, PNorm = 74.9240, GNorm = 0.7756, lr_0 = 5.1947e-04
Loss = 3.7804e-01, PNorm = 74.9845, GNorm = 0.5359, lr_0 = 5.0444e-04
Validation prc-auc = 0.560508
Validation auc = 0.770073
Epoch 10
Loss = 3.5367e-01, PNorm = 75.0274, GNorm = 0.8317, lr_0 = 4.8840e-04
Loss = 3.1747e-01, PNorm = 75.0805, GNorm = 0.4351, lr_0 = 4.7426e-04
Validation prc-auc = 0.581160
Validation auc = 0.777949
Epoch 11
Loss = 3.4035e-01, PNorm = 75.1341, GNorm = 0.5568, lr_0 = 4.5919e-04
Loss = 3.2638e-01, PNorm = 75.1894, GNorm = 0.6558, lr_0 = 4.4590e-04
Loss = 3.4887e-01, PNorm = 75.2282, GNorm = 0.6388, lr_0 = 4.3299e-04
Validation prc-auc = 0.603789
Validation auc = 0.782174
Epoch 12
Loss = 3.0483e-01, PNorm = 75.2771, GNorm = 0.6292, lr_0 = 4.1923e-04
Loss = 3.2938e-01, PNorm = 75.3338, GNorm = 0.5191, lr_0 = 4.0709e-04
Loss = 3.1395e-01, PNorm = 75.3785, GNorm = 0.7526, lr_0 = 3.9531e-04
Validation prc-auc = 0.633820
Validation auc = 0.799846
Epoch 13
Loss = 3.1458e-01, PNorm = 75.4316, GNorm = 0.8257, lr_0 = 3.8274e-04
Loss = 2.9504e-01, PNorm = 75.4838, GNorm = 0.8482, lr_0 = 3.7167e-04
Loss = 3.4004e-01, PNorm = 75.5249, GNorm = 1.1409, lr_0 = 3.6091e-04
Validation prc-auc = 0.632589
Validation auc = 0.796197
Epoch 14
Loss = 2.7985e-01, PNorm = 75.5840, GNorm = 0.7567, lr_0 = 3.4944e-04
Loss = 3.2347e-01, PNorm = 75.6381, GNorm = 0.8205, lr_0 = 3.3932e-04
Loss = 3.4730e-01, PNorm = 75.6787, GNorm = 1.6299, lr_0 = 3.2950e-04
Validation prc-auc = 0.652302
Validation auc = 0.809066
Epoch 15
Loss = 3.0798e-01, PNorm = 75.7187, GNorm = 1.0757, lr_0 = 3.1996e-04
Loss = 3.0764e-01, PNorm = 75.7582, GNorm = 0.7453, lr_0 = 3.1070e-04
Loss = 3.3152e-01, PNorm = 75.7974, GNorm = 1.0120, lr_0 = 3.0171e-04
Loss = 1.4001e-01, PNorm = 75.8017, GNorm = 1.3512, lr_0 = 3.0083e-04
Validation prc-auc = 0.637906
Validation auc = 0.799462
Epoch 16
Loss = 3.0392e-01, PNorm = 75.8474, GNorm = 0.9078, lr_0 = 2.9212e-04
Loss = 3.3134e-01, PNorm = 75.8887, GNorm = 1.1243, lr_0 = 2.8367e-04
Validation prc-auc = 0.655777
Validation auc = 0.802536
Epoch 17
Loss = 2.5909e-01, PNorm = 75.9337, GNorm = 0.7558, lr_0 = 2.7465e-04
Loss = 3.3590e-01, PNorm = 75.9798, GNorm = 1.0281, lr_0 = 2.6670e-04
Loss = 3.0192e-01, PNorm = 76.0131, GNorm = 0.9059, lr_0 = 2.5898e-04
Validation prc-auc = 0.655067
Validation auc = 0.795236
Epoch 18
Loss = 2.4429e-01, PNorm = 76.0492, GNorm = 0.6511, lr_0 = 2.5075e-04
Loss = 3.2527e-01, PNorm = 76.0770, GNorm = 0.8376, lr_0 = 2.4349e-04
Loss = 2.6212e-01, PNorm = 76.1072, GNorm = 1.0020, lr_0 = 2.3644e-04
Validation prc-auc = 0.663840
Validation auc = 0.794660
Epoch 19
Loss = 2.5476e-01, PNorm = 76.1380, GNorm = 0.8939, lr_0 = 2.2893e-04
Loss = 2.8548e-01, PNorm = 76.1626, GNorm = 0.8891, lr_0 = 2.2230e-04
Loss = 2.7327e-01, PNorm = 76.1893, GNorm = 0.8730, lr_0 = 2.1587e-04
Validation prc-auc = 0.666462
Validation auc = 0.800807
Epoch 20
Loss = 2.5367e-01, PNorm = 76.2193, GNorm = 0.9153, lr_0 = 2.0900e-04
Loss = 2.8910e-01, PNorm = 76.2536, GNorm = 1.3721, lr_0 = 2.0295e-04
Loss = 2.9165e-01, PNorm = 76.2772, GNorm = 1.3778, lr_0 = 1.9708e-04
Loss = 3.8104e-01, PNorm = 76.2797, GNorm = 3.3988, lr_0 = 1.9650e-04
Validation prc-auc = 0.674308
Validation auc = 0.797541
Epoch 21
Loss = 2.6217e-01, PNorm = 76.3024, GNorm = 1.1191, lr_0 = 1.9081e-04
Loss = 2.3989e-01, PNorm = 76.3251, GNorm = 1.0067, lr_0 = 1.8529e-04
Validation prc-auc = 0.685195
Validation auc = 0.800999
Epoch 22
Loss = 3.6710e-01, PNorm = 76.3519, GNorm = 1.2853, lr_0 = 1.7993e-04
Loss = 2.3738e-01, PNorm = 76.3801, GNorm = 0.8589, lr_0 = 1.7472e-04
Loss = 2.4658e-01, PNorm = 76.4004, GNorm = 0.9900, lr_0 = 1.6966e-04
Validation prc-auc = 0.698766
Validation auc = 0.803880
Epoch 23
Loss = 2.2493e-01, PNorm = 76.4223, GNorm = 1.1507, lr_0 = 1.6427e-04
Loss = 2.5678e-01, PNorm = 76.4429, GNorm = 1.9492, lr_0 = 1.5952e-04
Loss = 2.4372e-01, PNorm = 76.4600, GNorm = 0.9953, lr_0 = 1.5490e-04
Validation prc-auc = 0.692662
Validation auc = 0.798310
Epoch 24
Loss = 2.5888e-01, PNorm = 76.4798, GNorm = 0.9408, lr_0 = 1.4998e-04
Loss = 2.6188e-01, PNorm = 76.5013, GNorm = 0.9842, lr_0 = 1.4563e-04
Loss = 2.6760e-01, PNorm = 76.5175, GNorm = 1.2502, lr_0 = 1.4142e-04
Validation prc-auc = 0.692588
Validation auc = 0.801767
Epoch 25
Loss = 2.8838e-01, PNorm = 76.5405, GNorm = 1.3120, lr_0 = 1.3692e-04
Loss = 2.2621e-01, PNorm = 76.5612, GNorm = 0.9294, lr_0 = 1.3296e-04
Loss = 2.4905e-01, PNorm = 76.5749, GNorm = 0.8801, lr_0 = 1.2911e-04
Validation prc-auc = 0.697294
Validation auc = 0.798886
Epoch 26
Loss = 2.4274e-01, PNorm = 76.5937, GNorm = 0.8608, lr_0 = 1.2501e-04
Loss = 2.4451e-01, PNorm = 76.6110, GNorm = 1.0200, lr_0 = 1.2139e-04
Validation prc-auc = 0.691072
Validation auc = 0.794276
Epoch 27
Loss = 1.9267e-01, PNorm = 76.6272, GNorm = 1.0664, lr_0 = 1.1753e-04
Loss = 2.4504e-01, PNorm = 76.6402, GNorm = 1.3484, lr_0 = 1.1413e-04
Loss = 2.3873e-01, PNorm = 76.6502, GNorm = 1.4645, lr_0 = 1.1083e-04
Validation prc-auc = 0.701829
Validation auc = 0.799654
Epoch 28
Loss = 2.5018e-01, PNorm = 76.6667, GNorm = 1.2643, lr_0 = 1.0730e-04
Loss = 2.2775e-01, PNorm = 76.6767, GNorm = 0.9105, lr_0 = 1.0420e-04
Loss = 2.1916e-01, PNorm = 76.6883, GNorm = 1.0893, lr_0 = 1.0118e-04
Validation prc-auc = 0.709632
Validation auc = 0.805033
Epoch 29
Loss = 2.4615e-01, PNorm = 76.7018, GNorm = 0.9344, lr_0 = 1.0000e-04
Loss = 2.3248e-01, PNorm = 76.7142, GNorm = 1.2541, lr_0 = 1.0000e-04
Loss = 2.1803e-01, PNorm = 76.7229, GNorm = 1.3398, lr_0 = 1.0000e-04
Validation prc-auc = 0.715077
Validation auc = 0.802728
Model 0 best validation prc-auc = 0.715077 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.582113
Model 0 test auc = 0.882469
Ensemble test prc-auc = 0.582113
Ensemble test auc = 0.882469
Fold 35
Splitting data with seed 35
Total scaffolds = 870 | train scaffolds = 657 | val scaffolds = 123 | test scaffolds = 90
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.4121e-01, PNorm = 72.7790, GNorm = 1.3513, lr_0 = 1.0000e-03
Loss = 4.4512e-01, PNorm = 73.1973, GNorm = 0.7790, lr_0 = 1.0000e-03
Validation prc-auc = 0.323900
Validation auc = 0.669872
Epoch 1
Loss = 5.0636e-01, PNorm = 73.4453, GNorm = 1.1330, lr_0 = 1.0000e-03
Loss = 4.4671e-01, PNorm = 73.5705, GNorm = 0.5150, lr_0 = 1.0000e-03
Loss = 4.2598e-01, PNorm = 73.6563, GNorm = 0.4715, lr_0 = 1.0000e-03
Validation prc-auc = 0.340572
Validation auc = 0.678922
Epoch 2
Loss = 3.6590e-01, PNorm = 73.7385, GNorm = 0.5676, lr_0 = 9.7965e-04
Loss = 4.2090e-01, PNorm = 73.8103, GNorm = 0.9992, lr_0 = 9.5130e-04
Loss = 4.1401e-01, PNorm = 73.8763, GNorm = 0.5974, lr_0 = 9.2376e-04
Validation prc-auc = 0.419088
Validation auc = 0.687217
Epoch 3
Loss = 4.0695e-01, PNorm = 73.9455, GNorm = 0.6593, lr_0 = 8.9440e-04
Loss = 3.8411e-01, PNorm = 74.0128, GNorm = 0.5418, lr_0 = 8.6851e-04
Loss = 4.1066e-01, PNorm = 74.0733, GNorm = 0.6542, lr_0 = 8.4337e-04
Validation prc-auc = 0.413716
Validation auc = 0.711538
Epoch 4
Loss = 3.6928e-01, PNorm = 74.1510, GNorm = 0.6180, lr_0 = 8.1656e-04
Loss = 3.7511e-01, PNorm = 74.2300, GNorm = 0.6973, lr_0 = 7.9293e-04
Loss = 4.4508e-01, PNorm = 74.3003, GNorm = 0.7262, lr_0 = 7.6998e-04
Loss = 3.9410e-01, PNorm = 74.3093, GNorm = 1.9860, lr_0 = 7.6772e-04
Validation prc-auc = 0.430251
Validation auc = 0.700415
Epoch 5
Loss = 3.8626e-01, PNorm = 74.3979, GNorm = 0.6605, lr_0 = 7.4550e-04
Loss = 3.8252e-01, PNorm = 74.4629, GNorm = 0.9142, lr_0 = 7.2393e-04
Validation prc-auc = 0.431821
Validation auc = 0.698152
Epoch 6
Loss = 4.5909e-01, PNorm = 74.5347, GNorm = 0.6649, lr_0 = 7.0091e-04
Loss = 3.5825e-01, PNorm = 74.6041, GNorm = 0.6443, lr_0 = 6.8063e-04
Loss = 3.9683e-01, PNorm = 74.6666, GNorm = 1.1849, lr_0 = 6.6093e-04
Validation prc-auc = 0.441091
Validation auc = 0.712104
Epoch 7
Loss = 3.4765e-01, PNorm = 74.7502, GNorm = 2.7143, lr_0 = 6.3992e-04
Loss = 3.9786e-01, PNorm = 74.8180, GNorm = 0.9887, lr_0 = 6.2139e-04
Loss = 3.7523e-01, PNorm = 74.8933, GNorm = 0.7113, lr_0 = 6.0341e-04
Validation prc-auc = 0.459519
Validation auc = 0.711350
Epoch 8
Loss = 3.7033e-01, PNorm = 74.9535, GNorm = 0.9558, lr_0 = 5.8595e-04
Loss = 3.5180e-01, PNorm = 75.0192, GNorm = 0.5310, lr_0 = 5.6899e-04
Loss = 3.6181e-01, PNorm = 75.0654, GNorm = 0.6245, lr_0 = 5.5252e-04
Validation prc-auc = 0.476911
Validation auc = 0.730392
Epoch 9
Loss = 3.8931e-01, PNorm = 75.1280, GNorm = 0.7370, lr_0 = 5.3495e-04
Loss = 3.1033e-01, PNorm = 75.1865, GNorm = 0.7205, lr_0 = 5.1947e-04
Loss = 3.8021e-01, PNorm = 75.2278, GNorm = 0.8259, lr_0 = 5.0444e-04
Validation prc-auc = 0.483744
Validation auc = 0.723416
Epoch 10
Loss = 3.2292e-01, PNorm = 75.2979, GNorm = 0.6065, lr_0 = 4.8840e-04
Loss = 3.3033e-01, PNorm = 75.3446, GNorm = 0.8391, lr_0 = 4.7426e-04
Validation prc-auc = 0.488431
Validation auc = 0.723982
Epoch 11
Loss = 3.0443e-01, PNorm = 75.4019, GNorm = 0.6540, lr_0 = 4.5919e-04
Loss = 3.4458e-01, PNorm = 75.4454, GNorm = 0.7269, lr_0 = 4.4590e-04
Loss = 3.3414e-01, PNorm = 75.5003, GNorm = 0.7050, lr_0 = 4.3299e-04
Validation prc-auc = 0.493398
Validation auc = 0.724359
Epoch 12
Loss = 3.2841e-01, PNorm = 75.5616, GNorm = 0.6692, lr_0 = 4.1923e-04
Loss = 3.2822e-01, PNorm = 75.6206, GNorm = 0.8717, lr_0 = 4.0709e-04
Loss = 3.0515e-01, PNorm = 75.6690, GNorm = 1.0313, lr_0 = 3.9531e-04
Validation prc-auc = 0.520165
Validation auc = 0.716063
Epoch 13
Loss = 3.4741e-01, PNorm = 75.7220, GNorm = 0.7175, lr_0 = 3.8274e-04
Loss = 3.0264e-01, PNorm = 75.7796, GNorm = 0.6590, lr_0 = 3.7167e-04
Loss = 3.1935e-01, PNorm = 75.8313, GNorm = 0.6120, lr_0 = 3.6091e-04
Validation prc-auc = 0.537574
Validation auc = 0.743967
Epoch 14
Loss = 2.8562e-01, PNorm = 75.8818, GNorm = 0.9567, lr_0 = 3.4944e-04
Loss = 3.1375e-01, PNorm = 75.9315, GNorm = 0.6461, lr_0 = 3.3932e-04
Loss = 3.1821e-01, PNorm = 75.9765, GNorm = 0.7937, lr_0 = 3.2950e-04
Validation prc-auc = 0.510065
Validation auc = 0.720400
Epoch 15
Loss = 2.4393e-01, PNorm = 76.0246, GNorm = 0.7057, lr_0 = 3.1996e-04
Loss = 2.8356e-01, PNorm = 76.0690, GNorm = 0.6614, lr_0 = 3.1070e-04
Loss = 3.0153e-01, PNorm = 76.1141, GNorm = 0.6929, lr_0 = 3.0171e-04
Loss = 2.7839e-01, PNorm = 76.1185, GNorm = 2.1621, lr_0 = 3.0083e-04
Validation prc-auc = 0.529993
Validation auc = 0.736237
Epoch 16
Loss = 2.5260e-01, PNorm = 76.1718, GNorm = 1.2858, lr_0 = 2.9212e-04
Loss = 2.7605e-01, PNorm = 76.2132, GNorm = 0.6748, lr_0 = 2.8367e-04
Validation prc-auc = 0.524096
Validation auc = 0.713989
Epoch 17
Loss = 3.0352e-01, PNorm = 76.2583, GNorm = 1.0194, lr_0 = 2.7465e-04
Loss = 2.9408e-01, PNorm = 76.3026, GNorm = 1.1674, lr_0 = 2.6670e-04
Loss = 2.7179e-01, PNorm = 76.3328, GNorm = 1.0297, lr_0 = 2.5898e-04
Validation prc-auc = 0.544616
Validation auc = 0.744155
Epoch 18
Loss = 2.8895e-01, PNorm = 76.3718, GNorm = 1.4847, lr_0 = 2.5075e-04
Loss = 2.5372e-01, PNorm = 76.4085, GNorm = 0.9461, lr_0 = 2.4349e-04
Loss = 2.3563e-01, PNorm = 76.4460, GNorm = 0.5487, lr_0 = 2.3644e-04
Validation prc-auc = 0.531731
Validation auc = 0.723416
Epoch 19
Loss = 2.6061e-01, PNorm = 76.4818, GNorm = 0.8023, lr_0 = 2.2893e-04
Loss = 2.6529e-01, PNorm = 76.5199, GNorm = 0.8710, lr_0 = 2.2230e-04
Loss = 2.4997e-01, PNorm = 76.5524, GNorm = 1.1282, lr_0 = 2.1587e-04
Validation prc-auc = 0.553716
Validation auc = 0.733220
Epoch 20
Loss = 2.3813e-01, PNorm = 76.5921, GNorm = 1.0184, lr_0 = 2.0900e-04
Loss = 2.7744e-01, PNorm = 76.6172, GNorm = 1.0048, lr_0 = 2.0295e-04
Loss = 2.3966e-01, PNorm = 76.6493, GNorm = 1.5456, lr_0 = 1.9708e-04
Loss = 6.4930e-01, PNorm = 76.6514, GNorm = 3.4535, lr_0 = 1.9650e-04
Validation prc-auc = 0.550070
Validation auc = 0.733974
Epoch 21
Loss = 2.4740e-01, PNorm = 76.6759, GNorm = 0.9482, lr_0 = 1.9081e-04
Loss = 2.6515e-01, PNorm = 76.7020, GNorm = 0.6109, lr_0 = 1.8529e-04
Validation prc-auc = 0.568954
Validation auc = 0.737557
Epoch 22
Loss = 1.1139e-01, PNorm = 76.7277, GNorm = 0.6102, lr_0 = 1.7993e-04
Loss = 2.4241e-01, PNorm = 76.7501, GNorm = 1.0210, lr_0 = 1.7472e-04
Loss = 2.4971e-01, PNorm = 76.7789, GNorm = 1.0473, lr_0 = 1.6966e-04
Validation prc-auc = 0.560864
Validation auc = 0.745098
Epoch 23
Loss = 2.6284e-01, PNorm = 76.8062, GNorm = 1.1065, lr_0 = 1.6427e-04
Loss = 2.3945e-01, PNorm = 76.8284, GNorm = 1.3469, lr_0 = 1.5952e-04
Loss = 2.1598e-01, PNorm = 76.8514, GNorm = 1.0130, lr_0 = 1.5490e-04
Validation prc-auc = 0.563566
Validation auc = 0.748492
Epoch 24
Loss = 2.0546e-01, PNorm = 76.8743, GNorm = 1.2852, lr_0 = 1.4998e-04
Loss = 2.3604e-01, PNorm = 76.8949, GNorm = 1.0769, lr_0 = 1.4563e-04
Loss = 2.1206e-01, PNorm = 76.9143, GNorm = 1.4891, lr_0 = 1.4142e-04
Validation prc-auc = 0.563309
Validation auc = 0.736614
Epoch 25
Loss = 2.8335e-01, PNorm = 76.9321, GNorm = 0.9047, lr_0 = 1.3692e-04
Loss = 1.9706e-01, PNorm = 76.9526, GNorm = 0.6857, lr_0 = 1.3296e-04
Loss = 1.8525e-01, PNorm = 76.9690, GNorm = 0.9616, lr_0 = 1.2911e-04
Validation prc-auc = 0.552094
Validation auc = 0.732843
Epoch 26
Loss = 2.2841e-01, PNorm = 76.9878, GNorm = 1.0456, lr_0 = 1.2501e-04
Loss = 2.3685e-01, PNorm = 77.0021, GNorm = 1.6904, lr_0 = 1.2139e-04
Validation prc-auc = 0.564167
Validation auc = 0.735860
Epoch 27
Loss = 1.1235e-01, PNorm = 77.0210, GNorm = 0.8207, lr_0 = 1.1753e-04
Loss = 1.9860e-01, PNorm = 77.0354, GNorm = 0.8533, lr_0 = 1.1413e-04
Loss = 1.9917e-01, PNorm = 77.0477, GNorm = 1.2657, lr_0 = 1.1083e-04
Validation prc-auc = 0.567006
Validation auc = 0.740950
Epoch 28
Loss = 1.8586e-01, PNorm = 77.0621, GNorm = 0.9555, lr_0 = 1.0730e-04
Loss = 1.8074e-01, PNorm = 77.0766, GNorm = 1.0035, lr_0 = 1.0420e-04
Loss = 2.3263e-01, PNorm = 77.0881, GNorm = 1.2730, lr_0 = 1.0118e-04
Validation prc-auc = 0.547000
Validation auc = 0.729827
Epoch 29
Loss = 1.7257e-01, PNorm = 77.1037, GNorm = 1.3305, lr_0 = 1.0000e-04
Loss = 2.4904e-01, PNorm = 77.1141, GNorm = 2.1640, lr_0 = 1.0000e-04
Loss = 1.9365e-01, PNorm = 77.1256, GNorm = 0.9674, lr_0 = 1.0000e-04
Validation prc-auc = 0.570875
Validation auc = 0.737745
Model 0 best validation prc-auc = 0.570875 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.680546
Model 0 test auc = 0.863278
Ensemble test prc-auc = 0.680546
Ensemble test auc = 0.863278
Fold 36
Splitting data with seed 36
Total scaffolds = 870 | train scaffolds = 643 | val scaffolds = 111 | test scaffolds = 116
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.1048e-01, PNorm = 72.7806, GNorm = 0.4376, lr_0 = 1.0000e-03
Loss = 5.2859e-01, PNorm = 73.1821, GNorm = 0.5980, lr_0 = 1.0000e-03
Validation prc-auc = 0.442085
Validation auc = 0.784105
Epoch 1
Loss = 4.8446e-01, PNorm = 73.4204, GNorm = 0.6269, lr_0 = 1.0000e-03
Loss = 4.4266e-01, PNorm = 73.5408, GNorm = 0.5943, lr_0 = 1.0000e-03
Loss = 4.5362e-01, PNorm = 73.6220, GNorm = 0.7653, lr_0 = 1.0000e-03
Validation prc-auc = 0.489773
Validation auc = 0.754902
Epoch 2
Loss = 3.8949e-01, PNorm = 73.6990, GNorm = 0.8242, lr_0 = 9.7965e-04
Loss = 4.0695e-01, PNorm = 73.7587, GNorm = 0.5575, lr_0 = 9.5130e-04
Loss = 4.4709e-01, PNorm = 73.8176, GNorm = 0.6006, lr_0 = 9.2376e-04
Validation prc-auc = 0.467718
Validation auc = 0.766792
Epoch 3
Loss = 4.0587e-01, PNorm = 73.8756, GNorm = 0.6160, lr_0 = 8.9440e-04
Loss = 4.3690e-01, PNorm = 73.9326, GNorm = 0.6031, lr_0 = 8.6851e-04
Loss = 3.6822e-01, PNorm = 73.9892, GNorm = 0.5772, lr_0 = 8.4337e-04
Validation prc-auc = 0.521901
Validation auc = 0.781393
Epoch 4
Loss = 3.9985e-01, PNorm = 74.0535, GNorm = 0.5287, lr_0 = 8.1656e-04
Loss = 3.9489e-01, PNorm = 74.1116, GNorm = 0.6483, lr_0 = 7.9293e-04
Loss = 3.6731e-01, PNorm = 74.1670, GNorm = 1.1545, lr_0 = 7.6998e-04
Loss = 5.2715e-01, PNorm = 74.1730, GNorm = 2.1701, lr_0 = 7.6772e-04
Validation prc-auc = 0.526563
Validation auc = 0.804339
Epoch 5
Loss = 3.9943e-01, PNorm = 74.2364, GNorm = 0.6158, lr_0 = 7.4550e-04
Loss = 3.6878e-01, PNorm = 74.3023, GNorm = 0.9327, lr_0 = 7.2393e-04
Validation prc-auc = 0.563494
Validation auc = 0.806842
Epoch 6
Loss = 4.0802e-01, PNorm = 74.3728, GNorm = 0.6605, lr_0 = 7.0091e-04
Loss = 4.0586e-01, PNorm = 74.4422, GNorm = 1.0541, lr_0 = 6.8063e-04
Loss = 3.7893e-01, PNorm = 74.5054, GNorm = 0.9533, lr_0 = 6.6093e-04
Validation prc-auc = 0.557516
Validation auc = 0.810805
Epoch 7
Loss = 3.6752e-01, PNorm = 74.5697, GNorm = 0.7576, lr_0 = 6.3992e-04
Loss = 3.3171e-01, PNorm = 74.6281, GNorm = 0.7811, lr_0 = 6.2139e-04
Loss = 3.4251e-01, PNorm = 74.6910, GNorm = 0.9351, lr_0 = 6.0341e-04
Validation prc-auc = 0.576219
Validation auc = 0.808302
Epoch 8
Loss = 3.5803e-01, PNorm = 74.7558, GNorm = 0.5571, lr_0 = 5.8595e-04
Loss = 3.2819e-01, PNorm = 74.8224, GNorm = 1.0979, lr_0 = 5.6899e-04
Loss = 3.7294e-01, PNorm = 74.8848, GNorm = 0.5030, lr_0 = 5.5252e-04
Validation prc-auc = 0.633616
Validation auc = 0.809971
Epoch 9
Loss = 3.5525e-01, PNorm = 74.9468, GNorm = 0.7154, lr_0 = 5.3495e-04
Loss = 2.9705e-01, PNorm = 75.0133, GNorm = 0.7874, lr_0 = 5.1947e-04
Loss = 3.6453e-01, PNorm = 75.0738, GNorm = 0.9437, lr_0 = 5.0444e-04
Validation prc-auc = 0.612389
Validation auc = 0.808093
Epoch 10
Loss = 3.3368e-01, PNorm = 75.1442, GNorm = 0.7131, lr_0 = 4.8840e-04
Loss = 3.8474e-01, PNorm = 75.2038, GNorm = 0.8263, lr_0 = 4.7426e-04
Validation prc-auc = 0.617519
Validation auc = 0.801836
Epoch 11
Loss = 2.3925e-01, PNorm = 75.2687, GNorm = 0.6059, lr_0 = 4.5919e-04
Loss = 3.5640e-01, PNorm = 75.3342, GNorm = 1.2279, lr_0 = 4.4590e-04
Loss = 3.2500e-01, PNorm = 75.3956, GNorm = 0.6941, lr_0 = 4.3299e-04
Validation prc-auc = 0.621377
Validation auc = 0.806216
Epoch 12
Loss = 2.7117e-01, PNorm = 75.4547, GNorm = 0.7723, lr_0 = 4.1923e-04
Loss = 3.0724e-01, PNorm = 75.5107, GNorm = 0.7258, lr_0 = 4.0709e-04
Loss = 3.4114e-01, PNorm = 75.5642, GNorm = 0.7006, lr_0 = 3.9531e-04
Validation prc-auc = 0.579264
Validation auc = 0.790363
Epoch 13
Loss = 3.2522e-01, PNorm = 75.6313, GNorm = 0.8441, lr_0 = 3.8274e-04
Loss = 2.9130e-01, PNorm = 75.6912, GNorm = 0.7390, lr_0 = 3.7167e-04
Loss = 2.9903e-01, PNorm = 75.7487, GNorm = 0.9547, lr_0 = 3.6091e-04
Validation prc-auc = 0.601221
Validation auc = 0.793283
Epoch 14
Loss = 2.5147e-01, PNorm = 75.8099, GNorm = 1.1077, lr_0 = 3.4944e-04
Loss = 2.9189e-01, PNorm = 75.8599, GNorm = 0.9821, lr_0 = 3.3932e-04
Loss = 3.1861e-01, PNorm = 75.9085, GNorm = 1.0545, lr_0 = 3.2950e-04
Validation prc-auc = 0.595693
Validation auc = 0.798081
Epoch 15
Loss = 2.7960e-01, PNorm = 75.9625, GNorm = 1.2864, lr_0 = 3.1996e-04
Loss = 3.0571e-01, PNorm = 76.0065, GNorm = 1.4419, lr_0 = 3.1070e-04
Loss = 3.0242e-01, PNorm = 76.0494, GNorm = 0.7913, lr_0 = 3.0171e-04
Loss = 3.2970e-02, PNorm = 76.0539, GNorm = 0.4321, lr_0 = 3.0083e-04
Validation prc-auc = 0.595464
Validation auc = 0.795578
Epoch 16
Loss = 3.1881e-01, PNorm = 76.0953, GNorm = 1.1230, lr_0 = 2.9212e-04
Loss = 3.0906e-01, PNorm = 76.1389, GNorm = 1.9252, lr_0 = 2.8367e-04
Validation prc-auc = 0.626727
Validation auc = 0.807259
Epoch 17
Loss = 2.8503e-01, PNorm = 76.1951, GNorm = 1.3802, lr_0 = 2.7465e-04
Loss = 3.0672e-01, PNorm = 76.2244, GNorm = 1.6082, lr_0 = 2.6670e-04
Loss = 2.7156e-01, PNorm = 76.2711, GNorm = 0.7599, lr_0 = 2.5898e-04
Validation prc-auc = 0.615600
Validation auc = 0.796621
Epoch 18
Loss = 2.1424e-01, PNorm = 76.3107, GNorm = 0.8216, lr_0 = 2.5075e-04
Loss = 2.5283e-01, PNorm = 76.3476, GNorm = 0.9932, lr_0 = 2.4349e-04
Loss = 2.8609e-01, PNorm = 76.3805, GNorm = 1.2850, lr_0 = 2.3644e-04
Validation prc-auc = 0.631354
Validation auc = 0.797247
Epoch 19
Loss = 2.6717e-01, PNorm = 76.4178, GNorm = 1.5430, lr_0 = 2.2893e-04
Loss = 2.4378e-01, PNorm = 76.4529, GNorm = 0.8179, lr_0 = 2.2230e-04
Loss = 2.5120e-01, PNorm = 76.4856, GNorm = 1.2161, lr_0 = 2.1587e-04
Validation prc-auc = 0.618927
Validation auc = 0.798915
Epoch 20
Loss = 2.4861e-01, PNorm = 76.5200, GNorm = 1.1205, lr_0 = 2.0900e-04
Loss = 2.2497e-01, PNorm = 76.5447, GNorm = 1.0961, lr_0 = 2.0295e-04
Loss = 2.6064e-01, PNorm = 76.5733, GNorm = 0.7691, lr_0 = 1.9708e-04
Loss = 1.3917e-01, PNorm = 76.5765, GNorm = 1.7936, lr_0 = 1.9650e-04
Validation prc-auc = 0.616276
Validation auc = 0.801627
Epoch 21
Loss = 2.2988e-01, PNorm = 76.6083, GNorm = 1.2394, lr_0 = 1.9081e-04
Loss = 2.0975e-01, PNorm = 76.6319, GNorm = 0.6311, lr_0 = 1.8529e-04
Validation prc-auc = 0.576682
Validation auc = 0.799124
Epoch 22
Loss = 1.5831e-01, PNorm = 76.6580, GNorm = 0.9160, lr_0 = 1.7993e-04
Loss = 1.9875e-01, PNorm = 76.6855, GNorm = 1.1448, lr_0 = 1.7472e-04
Loss = 2.4305e-01, PNorm = 76.7066, GNorm = 1.6590, lr_0 = 1.6966e-04
Validation prc-auc = 0.592142
Validation auc = 0.799750
Epoch 23
Loss = 1.5739e-01, PNorm = 76.7362, GNorm = 1.2903, lr_0 = 1.6427e-04
Loss = 1.9195e-01, PNorm = 76.7562, GNorm = 1.1173, lr_0 = 1.5952e-04
Loss = 2.2834e-01, PNorm = 76.7772, GNorm = 1.3139, lr_0 = 1.5490e-04
Validation prc-auc = 0.605509
Validation auc = 0.799750
Epoch 24
Loss = 2.1807e-01, PNorm = 76.8003, GNorm = 1.6971, lr_0 = 1.4998e-04
Loss = 1.9718e-01, PNorm = 76.8195, GNorm = 1.0006, lr_0 = 1.4563e-04
Loss = 2.2492e-01, PNorm = 76.8374, GNorm = 0.6165, lr_0 = 1.4142e-04
Validation prc-auc = 0.592278
Validation auc = 0.799750
Epoch 25
Loss = 2.4119e-01, PNorm = 76.8600, GNorm = 1.2437, lr_0 = 1.3692e-04
Loss = 2.0399e-01, PNorm = 76.8760, GNorm = 0.9009, lr_0 = 1.3296e-04
Loss = 1.8004e-01, PNorm = 76.8916, GNorm = 0.8119, lr_0 = 1.2911e-04
Validation prc-auc = 0.582530
Validation auc = 0.802044
Epoch 26
Loss = 2.1036e-01, PNorm = 76.9075, GNorm = 1.3721, lr_0 = 1.2501e-04
Loss = 2.2319e-01, PNorm = 76.9222, GNorm = 1.1027, lr_0 = 1.2139e-04
Validation prc-auc = 0.602651
Validation auc = 0.801627
Epoch 27
Loss = 1.4449e-01, PNorm = 76.9390, GNorm = 1.1056, lr_0 = 1.1753e-04
Loss = 2.1677e-01, PNorm = 76.9534, GNorm = 2.0228, lr_0 = 1.1413e-04
Loss = 2.3807e-01, PNorm = 76.9681, GNorm = 1.0480, lr_0 = 1.1083e-04
Validation prc-auc = 0.610123
Validation auc = 0.798081
Epoch 28
Loss = 1.5243e-01, PNorm = 76.9825, GNorm = 1.4056, lr_0 = 1.0730e-04
Loss = 2.0779e-01, PNorm = 76.9954, GNorm = 1.5822, lr_0 = 1.0420e-04
Loss = 2.1637e-01, PNorm = 77.0084, GNorm = 2.0951, lr_0 = 1.0118e-04
Validation prc-auc = 0.604537
Validation auc = 0.801836
Epoch 29
Loss = 1.9180e-01, PNorm = 77.0194, GNorm = 1.7351, lr_0 = 1.0000e-04
Loss = 2.1792e-01, PNorm = 77.0297, GNorm = 1.0125, lr_0 = 1.0000e-04
Loss = 2.0317e-01, PNorm = 77.0411, GNorm = 1.5144, lr_0 = 1.0000e-04
Validation prc-auc = 0.594678
Validation auc = 0.797872
Model 0 best validation prc-auc = 0.633616 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.572619
Model 0 test auc = 0.781324
Ensemble test prc-auc = 0.572619
Ensemble test auc = 0.781324
Fold 37
Splitting data with seed 37
Total scaffolds = 870 | train scaffolds = 641 | val scaffolds = 117 | test scaffolds = 112
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.5531e-01, PNorm = 72.7722, GNorm = 1.1256, lr_0 = 1.0000e-03
Loss = 4.3512e-01, PNorm = 73.1800, GNorm = 0.6109, lr_0 = 1.0000e-03
Validation prc-auc = 0.557559
Validation auc = 0.763378
Epoch 1
Loss = 4.7410e-01, PNorm = 73.4190, GNorm = 1.3344, lr_0 = 1.0000e-03
Loss = 4.5055e-01, PNorm = 73.5479, GNorm = 0.6457, lr_0 = 1.0000e-03
Loss = 3.6648e-01, PNorm = 73.6363, GNorm = 0.6958, lr_0 = 1.0000e-03
Validation prc-auc = 0.520194
Validation auc = 0.767019
Epoch 2
Loss = 3.7167e-01, PNorm = 73.7090, GNorm = 0.5986, lr_0 = 9.7965e-04
Loss = 3.7590e-01, PNorm = 73.7732, GNorm = 0.4931, lr_0 = 9.5130e-04
Loss = 4.4635e-01, PNorm = 73.8337, GNorm = 0.7736, lr_0 = 9.2376e-04
Validation prc-auc = 0.578823
Validation auc = 0.778668
Epoch 3
Loss = 4.0293e-01, PNorm = 73.9018, GNorm = 0.7635, lr_0 = 8.9440e-04
Loss = 4.1113e-01, PNorm = 73.9674, GNorm = 0.8212, lr_0 = 8.6851e-04
Loss = 3.7569e-01, PNorm = 74.0313, GNorm = 0.8875, lr_0 = 8.4337e-04
Validation prc-auc = 0.571287
Validation auc = 0.776301
Epoch 4
Loss = 4.0413e-01, PNorm = 74.0968, GNorm = 1.1987, lr_0 = 8.1656e-04
Loss = 3.5691e-01, PNorm = 74.1729, GNorm = 0.8004, lr_0 = 7.9293e-04
Loss = 4.0393e-01, PNorm = 74.2425, GNorm = 0.8209, lr_0 = 7.6998e-04
Loss = 6.4369e-01, PNorm = 74.2490, GNorm = 1.9769, lr_0 = 7.6772e-04
Validation prc-auc = 0.622438
Validation auc = 0.797233
Epoch 5
Loss = 3.3360e-01, PNorm = 74.3439, GNorm = 1.0569, lr_0 = 7.4550e-04
Loss = 3.5950e-01, PNorm = 74.4133, GNorm = 0.6758, lr_0 = 7.2393e-04
Validation prc-auc = 0.618782
Validation auc = 0.794685
Epoch 6
Loss = 4.1413e-01, PNorm = 74.4798, GNorm = 0.5941, lr_0 = 7.0091e-04
Loss = 3.3356e-01, PNorm = 74.5554, GNorm = 0.6611, lr_0 = 6.8063e-04
Loss = 3.5188e-01, PNorm = 74.6161, GNorm = 0.5187, lr_0 = 6.6093e-04
Validation prc-auc = 0.630859
Validation auc = 0.810521
Epoch 7
Loss = 3.7646e-01, PNorm = 74.6851, GNorm = 0.6358, lr_0 = 6.3992e-04
Loss = 3.6612e-01, PNorm = 74.7655, GNorm = 0.6977, lr_0 = 6.2139e-04
Loss = 3.1681e-01, PNorm = 74.8391, GNorm = 0.5974, lr_0 = 6.0341e-04
Validation prc-auc = 0.692825
Validation auc = 0.828540
Epoch 8
Loss = 3.6951e-01, PNorm = 74.9092, GNorm = 0.6183, lr_0 = 5.8595e-04
Loss = 3.7467e-01, PNorm = 74.9896, GNorm = 0.5752, lr_0 = 5.6899e-04
Loss = 3.1732e-01, PNorm = 75.0641, GNorm = 0.7029, lr_0 = 5.5252e-04
Validation prc-auc = 0.690128
Validation auc = 0.824900
Epoch 9
Loss = 3.4942e-01, PNorm = 75.1462, GNorm = 0.9322, lr_0 = 5.3495e-04
Loss = 3.2803e-01, PNorm = 75.2028, GNorm = 0.8461, lr_0 = 5.1947e-04
Loss = 3.3458e-01, PNorm = 75.2601, GNorm = 0.5962, lr_0 = 5.0444e-04
Validation prc-auc = 0.575476
Validation auc = 0.811431
Epoch 10
Loss = 3.7012e-01, PNorm = 75.3338, GNorm = 1.2633, lr_0 = 4.8840e-04
Loss = 3.2553e-01, PNorm = 75.3989, GNorm = 0.6011, lr_0 = 4.7426e-04
Validation prc-auc = 0.717272
Validation auc = 0.832545
Epoch 11
Loss = 3.1828e-01, PNorm = 75.4671, GNorm = 0.6415, lr_0 = 4.5919e-04
Loss = 2.9489e-01, PNorm = 75.5391, GNorm = 0.7873, lr_0 = 4.4590e-04
Loss = 3.1823e-01, PNorm = 75.5854, GNorm = 0.8951, lr_0 = 4.3299e-04
Validation prc-auc = 0.753145
Validation auc = 0.840917
Epoch 12
Loss = 3.1020e-01, PNorm = 75.6483, GNorm = 0.6408, lr_0 = 4.1923e-04
Loss = 2.7667e-01, PNorm = 75.7196, GNorm = 0.5601, lr_0 = 4.0709e-04
Loss = 3.1518e-01, PNorm = 75.7745, GNorm = 1.1052, lr_0 = 3.9531e-04
Validation prc-auc = 0.741186
Validation auc = 0.834729
Epoch 13
Loss = 2.6998e-01, PNorm = 75.8410, GNorm = 0.7586, lr_0 = 3.8274e-04
Loss = 2.7866e-01, PNorm = 75.9104, GNorm = 0.5967, lr_0 = 3.7167e-04
Loss = 2.9140e-01, PNorm = 75.9636, GNorm = 0.8960, lr_0 = 3.6091e-04
Validation prc-auc = 0.735676
Validation auc = 0.835457
Epoch 14
Loss = 3.2815e-01, PNorm = 76.0171, GNorm = 0.8905, lr_0 = 3.4944e-04
Loss = 2.6100e-01, PNorm = 76.0701, GNorm = 0.4991, lr_0 = 3.3932e-04
Loss = 2.8883e-01, PNorm = 76.1129, GNorm = 0.7441, lr_0 = 3.2950e-04
Validation prc-auc = 0.752306
Validation auc = 0.827630
Epoch 15
Loss = 2.9893e-01, PNorm = 76.1573, GNorm = 1.5304, lr_0 = 3.1996e-04
Loss = 2.6594e-01, PNorm = 76.2104, GNorm = 1.4001, lr_0 = 3.1070e-04
Loss = 2.6789e-01, PNorm = 76.2543, GNorm = 0.6621, lr_0 = 3.0171e-04
Loss = 4.0757e-02, PNorm = 76.2586, GNorm = 0.6183, lr_0 = 3.0083e-04
Validation prc-auc = 0.734604
Validation auc = 0.834729
Epoch 16
Loss = 2.6745e-01, PNorm = 76.2961, GNorm = 0.7805, lr_0 = 2.9212e-04
Loss = 2.6253e-01, PNorm = 76.3382, GNorm = 0.6476, lr_0 = 2.8367e-04
Validation prc-auc = 0.764697
Validation auc = 0.848926
Epoch 17
Loss = 3.4047e-01, PNorm = 76.3881, GNorm = 1.1256, lr_0 = 2.7465e-04
Loss = 2.5231e-01, PNorm = 76.4255, GNorm = 0.7854, lr_0 = 2.6670e-04
Loss = 2.3474e-01, PNorm = 76.4642, GNorm = 0.7693, lr_0 = 2.5898e-04
Validation prc-auc = 0.733882
Validation auc = 0.827084
Epoch 18
Loss = 1.9989e-01, PNorm = 76.5105, GNorm = 0.8978, lr_0 = 2.5075e-04
Loss = 2.6966e-01, PNorm = 76.5448, GNorm = 1.2576, lr_0 = 2.4349e-04
Loss = 2.6171e-01, PNorm = 76.5732, GNorm = 1.3080, lr_0 = 2.3644e-04
Validation prc-auc = 0.725552
Validation auc = 0.826902
Epoch 19
Loss = 2.3806e-01, PNorm = 76.6088, GNorm = 0.8591, lr_0 = 2.2893e-04
Loss = 2.3975e-01, PNorm = 76.6381, GNorm = 1.1076, lr_0 = 2.2230e-04
Loss = 2.5398e-01, PNorm = 76.6715, GNorm = 1.3246, lr_0 = 2.1587e-04
Validation prc-auc = 0.713336
Validation auc = 0.824718
Epoch 20
Loss = 2.4432e-01, PNorm = 76.7077, GNorm = 1.1568, lr_0 = 2.0900e-04
Loss = 2.4899e-01, PNorm = 76.7329, GNorm = 1.1515, lr_0 = 2.0295e-04
Loss = 2.5378e-01, PNorm = 76.7557, GNorm = 0.8828, lr_0 = 1.9708e-04
Loss = 4.5405e-01, PNorm = 76.7577, GNorm = 4.4394, lr_0 = 1.9650e-04
Validation prc-auc = 0.718917
Validation auc = 0.821988
Epoch 21
Loss = 1.9628e-01, PNorm = 76.7839, GNorm = 1.0605, lr_0 = 1.9081e-04
Loss = 2.2131e-01, PNorm = 76.8121, GNorm = 0.8024, lr_0 = 1.8529e-04
Validation prc-auc = 0.707496
Validation auc = 0.815071
Epoch 22
Loss = 2.4486e-01, PNorm = 76.8305, GNorm = 1.3414, lr_0 = 1.7993e-04
Loss = 1.9001e-01, PNorm = 76.8568, GNorm = 1.2470, lr_0 = 1.7472e-04
Loss = 2.5240e-01, PNorm = 76.8730, GNorm = 1.9306, lr_0 = 1.6966e-04
Validation prc-auc = 0.732015
Validation auc = 0.840553
Epoch 23
Loss = 1.9717e-01, PNorm = 76.9017, GNorm = 1.5463, lr_0 = 1.6427e-04
Loss = 2.5190e-01, PNorm = 76.9242, GNorm = 1.3904, lr_0 = 1.5952e-04
Loss = 1.8732e-01, PNorm = 76.9421, GNorm = 0.9686, lr_0 = 1.5490e-04
Validation prc-auc = 0.725573
Validation auc = 0.820714
Epoch 24
Loss = 1.9907e-01, PNorm = 76.9612, GNorm = 0.8890, lr_0 = 1.4998e-04
Loss = 2.6178e-01, PNorm = 76.9845, GNorm = 2.6155, lr_0 = 1.4563e-04
Loss = 1.9269e-01, PNorm = 77.0002, GNorm = 1.0303, lr_0 = 1.4142e-04
Validation prc-auc = 0.738589
Validation auc = 0.824536
Epoch 25
Loss = 2.0693e-01, PNorm = 77.0187, GNorm = 0.9871, lr_0 = 1.3692e-04
Loss = 2.0903e-01, PNorm = 77.0328, GNorm = 1.1288, lr_0 = 1.3296e-04
Loss = 1.9993e-01, PNorm = 77.0482, GNorm = 1.0203, lr_0 = 1.2911e-04
Validation prc-auc = 0.716837
Validation auc = 0.825810
Epoch 26
Loss = 2.2052e-01, PNorm = 77.0633, GNorm = 0.6857, lr_0 = 1.2501e-04
Loss = 1.9573e-01, PNorm = 77.0796, GNorm = 1.3184, lr_0 = 1.2139e-04
Validation prc-auc = 0.721146
Validation auc = 0.824900
Epoch 27
Loss = 1.3004e-01, PNorm = 77.0901, GNorm = 1.0503, lr_0 = 1.1753e-04
Loss = 1.8981e-01, PNorm = 77.1033, GNorm = 1.1698, lr_0 = 1.1413e-04
Loss = 2.0390e-01, PNorm = 77.1160, GNorm = 1.2831, lr_0 = 1.1083e-04
Validation prc-auc = 0.711658
Validation auc = 0.819621
Epoch 28
Loss = 1.7245e-01, PNorm = 77.1322, GNorm = 0.7915, lr_0 = 1.0730e-04
Loss = 1.8249e-01, PNorm = 77.1449, GNorm = 0.9902, lr_0 = 1.0420e-04
Loss = 1.9869e-01, PNorm = 77.1539, GNorm = 1.0287, lr_0 = 1.0118e-04
Validation prc-auc = 0.714023
Validation auc = 0.819075
Epoch 29
Loss = 1.6698e-01, PNorm = 77.1651, GNorm = 0.9256, lr_0 = 1.0000e-04
Loss = 2.1000e-01, PNorm = 77.1780, GNorm = 1.1957, lr_0 = 1.0000e-04
Loss = 1.8752e-01, PNorm = 77.1900, GNorm = 0.9674, lr_0 = 1.0000e-04
Validation prc-auc = 0.719206
Validation auc = 0.821260
Model 0 best validation prc-auc = 0.764697 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.556065
Model 0 test auc = 0.759764
Ensemble test prc-auc = 0.556065
Ensemble test auc = 0.759764
Fold 38
Splitting data with seed 38
Total scaffolds = 870 | train scaffolds = 657 | val scaffolds = 99 | test scaffolds = 114
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.0960e-01, PNorm = 72.7634, GNorm = 0.7252, lr_0 = 1.0000e-03
Loss = 4.4440e-01, PNorm = 73.1667, GNorm = 1.0148, lr_0 = 1.0000e-03
Validation prc-auc = 0.434419
Validation auc = 0.761419
Epoch 1
Loss = 4.3731e-01, PNorm = 73.4055, GNorm = 1.1496, lr_0 = 1.0000e-03
Loss = 4.7485e-01, PNorm = 73.5246, GNorm = 0.6292, lr_0 = 1.0000e-03
Loss = 4.2283e-01, PNorm = 73.6048, GNorm = 1.1367, lr_0 = 1.0000e-03
Validation prc-auc = 0.455942
Validation auc = 0.795432
Epoch 2
Loss = 4.3845e-01, PNorm = 73.6742, GNorm = 0.8687, lr_0 = 9.7965e-04
Loss = 4.1156e-01, PNorm = 73.7373, GNorm = 0.5204, lr_0 = 9.5130e-04
Loss = 4.1235e-01, PNorm = 73.7924, GNorm = 1.1132, lr_0 = 9.2376e-04
Validation prc-auc = 0.531170
Validation auc = 0.839650
Epoch 3
Loss = 4.1563e-01, PNorm = 73.8490, GNorm = 0.5066, lr_0 = 8.9440e-04
Loss = 4.0611e-01, PNorm = 73.8995, GNorm = 0.9074, lr_0 = 8.6851e-04
Loss = 3.9024e-01, PNorm = 73.9618, GNorm = 0.5216, lr_0 = 8.4337e-04
Validation prc-auc = 0.532512
Validation auc = 0.810253
Epoch 4
Loss = 3.7194e-01, PNorm = 74.0259, GNorm = 0.6121, lr_0 = 8.1656e-04
Loss = 4.1758e-01, PNorm = 74.0795, GNorm = 0.9655, lr_0 = 7.9293e-04
Loss = 3.8719e-01, PNorm = 74.1366, GNorm = 0.7507, lr_0 = 7.6998e-04
Loss = 1.5703e-01, PNorm = 74.1431, GNorm = 1.2829, lr_0 = 7.6772e-04
Validation prc-auc = 0.563457
Validation auc = 0.817541
Epoch 5
Loss = 3.2917e-01, PNorm = 74.1962, GNorm = 0.5350, lr_0 = 7.4550e-04
Loss = 4.2234e-01, PNorm = 74.2497, GNorm = 0.5583, lr_0 = 7.2393e-04
Validation prc-auc = 0.555543
Validation auc = 0.855442
Epoch 6
Loss = 3.8996e-01, PNorm = 74.3135, GNorm = 0.5203, lr_0 = 7.0091e-04
Loss = 3.8260e-01, PNorm = 74.3763, GNorm = 0.5174, lr_0 = 6.8063e-04
Loss = 3.3513e-01, PNorm = 74.4333, GNorm = 0.7443, lr_0 = 6.6093e-04
Validation prc-auc = 0.558105
Validation auc = 0.832362
Epoch 7
Loss = 4.0195e-01, PNorm = 74.4956, GNorm = 0.6249, lr_0 = 6.3992e-04
Loss = 3.6909e-01, PNorm = 74.5620, GNorm = 0.6798, lr_0 = 6.2139e-04
Loss = 3.8045e-01, PNorm = 74.6202, GNorm = 0.8254, lr_0 = 6.0341e-04
Validation prc-auc = 0.654029
Validation auc = 0.852041
Epoch 8
Loss = 3.5232e-01, PNorm = 74.6894, GNorm = 0.5351, lr_0 = 5.8595e-04
Loss = 3.3456e-01, PNorm = 74.7672, GNorm = 0.5828, lr_0 = 5.6899e-04
Loss = 3.5751e-01, PNorm = 74.8275, GNorm = 0.8850, lr_0 = 5.5252e-04
Validation prc-auc = 0.609403
Validation auc = 0.836492
Epoch 9
Loss = 3.3517e-01, PNorm = 74.9003, GNorm = 1.2707, lr_0 = 5.3495e-04
Loss = 3.6177e-01, PNorm = 74.9607, GNorm = 0.6740, lr_0 = 5.1947e-04
Loss = 3.7137e-01, PNorm = 75.0143, GNorm = 0.7008, lr_0 = 5.0444e-04
Validation prc-auc = 0.620395
Validation auc = 0.844023
Epoch 10
Loss = 3.5525e-01, PNorm = 75.0869, GNorm = 0.6381, lr_0 = 4.8840e-04
Loss = 3.4704e-01, PNorm = 75.1472, GNorm = 0.7906, lr_0 = 4.7426e-04
Validation prc-auc = 0.647929
Validation auc = 0.857629
Epoch 11
Loss = 3.1864e-01, PNorm = 75.1973, GNorm = 0.7115, lr_0 = 4.5919e-04
Loss = 3.7692e-01, PNorm = 75.2485, GNorm = 0.7132, lr_0 = 4.4590e-04
Loss = 2.9757e-01, PNorm = 75.3086, GNorm = 0.5366, lr_0 = 4.3299e-04
Validation prc-auc = 0.621894
Validation auc = 0.853013
Epoch 12
Loss = 3.6062e-01, PNorm = 75.3580, GNorm = 1.0879, lr_0 = 4.1923e-04
Loss = 3.3908e-01, PNorm = 75.4106, GNorm = 0.8557, lr_0 = 4.0709e-04
Loss = 2.9711e-01, PNorm = 75.4650, GNorm = 0.6961, lr_0 = 3.9531e-04
Validation prc-auc = 0.571780
Validation auc = 0.855442
Epoch 13
Loss = 3.1146e-01, PNorm = 75.5177, GNorm = 0.8095, lr_0 = 3.8274e-04
Loss = 3.3449e-01, PNorm = 75.5627, GNorm = 0.6800, lr_0 = 3.7167e-04
Loss = 3.2898e-01, PNorm = 75.6079, GNorm = 0.7171, lr_0 = 3.6091e-04
Validation prc-auc = 0.600748
Validation auc = 0.860787
Epoch 14
Loss = 2.5365e-01, PNorm = 75.6656, GNorm = 0.6469, lr_0 = 3.4944e-04
Loss = 2.9968e-01, PNorm = 75.7136, GNorm = 0.8630, lr_0 = 3.3932e-04
Loss = 3.4688e-01, PNorm = 75.7514, GNorm = 1.0761, lr_0 = 3.2950e-04
Validation prc-auc = 0.590897
Validation auc = 0.853256
Epoch 15
Loss = 3.0246e-01, PNorm = 75.8026, GNorm = 0.8359, lr_0 = 3.1996e-04
Loss = 3.0502e-01, PNorm = 75.8491, GNorm = 1.1146, lr_0 = 3.1070e-04
Loss = 3.2655e-01, PNorm = 75.8956, GNorm = 0.8911, lr_0 = 3.0171e-04
Loss = 8.1446e-02, PNorm = 75.8988, GNorm = 0.7592, lr_0 = 3.0083e-04
Validation prc-auc = 0.599958
Validation auc = 0.870262
Epoch 16
Loss = 2.7089e-01, PNorm = 75.9477, GNorm = 0.7227, lr_0 = 2.9212e-04
Loss = 3.1943e-01, PNorm = 75.9907, GNorm = 1.2656, lr_0 = 2.8367e-04
Validation prc-auc = 0.524096
Validation auc = 0.858115
Epoch 17
Loss = 2.2712e-01, PNorm = 76.0399, GNorm = 0.5951, lr_0 = 2.7465e-04
Loss = 2.8928e-01, PNorm = 76.0777, GNorm = 0.7712, lr_0 = 2.6670e-04
Loss = 2.6897e-01, PNorm = 76.1136, GNorm = 0.7001, lr_0 = 2.5898e-04
Validation prc-auc = 0.569881
Validation auc = 0.878037
Epoch 18
Loss = 2.9583e-01, PNorm = 76.1563, GNorm = 0.9157, lr_0 = 2.5075e-04
Loss = 2.8395e-01, PNorm = 76.1901, GNorm = 1.0627, lr_0 = 2.4349e-04
Loss = 2.4584e-01, PNorm = 76.2215, GNorm = 0.7222, lr_0 = 2.3644e-04
Validation prc-auc = 0.566315
Validation auc = 0.869291
Epoch 19
Loss = 2.4250e-01, PNorm = 76.2581, GNorm = 0.8921, lr_0 = 2.2893e-04
Loss = 2.5259e-01, PNorm = 76.2914, GNorm = 1.1157, lr_0 = 2.2230e-04
Loss = 2.9441e-01, PNorm = 76.3208, GNorm = 1.7935, lr_0 = 2.1587e-04
Validation prc-auc = 0.574619
Validation auc = 0.885083
Epoch 20
Loss = 2.6584e-01, PNorm = 76.3528, GNorm = 0.8955, lr_0 = 2.0900e-04
Loss = 2.3008e-01, PNorm = 76.3893, GNorm = 0.7351, lr_0 = 2.0295e-04
Loss = 2.8195e-01, PNorm = 76.4102, GNorm = 0.9154, lr_0 = 1.9708e-04
Loss = 6.5631e-01, PNorm = 76.4121, GNorm = 4.6545, lr_0 = 1.9650e-04
Validation prc-auc = 0.570587
Validation auc = 0.877551
Epoch 21
Loss = 2.5378e-01, PNorm = 76.4479, GNorm = 0.7422, lr_0 = 1.9081e-04
Loss = 2.3620e-01, PNorm = 76.4785, GNorm = 0.7431, lr_0 = 1.8529e-04
Validation prc-auc = 0.572355
Validation auc = 0.879252
Epoch 22
Loss = 3.0962e-01, PNorm = 76.4990, GNorm = 1.0464, lr_0 = 1.7993e-04
Loss = 2.4615e-01, PNorm = 76.5225, GNorm = 0.9664, lr_0 = 1.7472e-04
Loss = 2.4283e-01, PNorm = 76.5426, GNorm = 1.4329, lr_0 = 1.6966e-04
Validation prc-auc = 0.588338
Validation auc = 0.882896
Epoch 23
Loss = 2.7996e-01, PNorm = 76.5677, GNorm = 1.4606, lr_0 = 1.6427e-04
Loss = 2.6112e-01, PNorm = 76.5924, GNorm = 1.0713, lr_0 = 1.5952e-04
Loss = 2.1496e-01, PNorm = 76.6153, GNorm = 1.8087, lr_0 = 1.5490e-04
Validation prc-auc = 0.578555
Validation auc = 0.889456
Epoch 24
Loss = 1.9417e-01, PNorm = 76.6377, GNorm = 0.9296, lr_0 = 1.4998e-04
Loss = 2.4542e-01, PNorm = 76.6544, GNorm = 1.3910, lr_0 = 1.4563e-04
Loss = 2.4058e-01, PNorm = 76.6717, GNorm = 1.5638, lr_0 = 1.4142e-04
Validation prc-auc = 0.587235
Validation auc = 0.889699
Epoch 25
Loss = 2.2531e-01, PNorm = 76.6916, GNorm = 1.0461, lr_0 = 1.3692e-04
Loss = 2.0394e-01, PNorm = 76.7088, GNorm = 1.1742, lr_0 = 1.3296e-04
Loss = 2.4180e-01, PNorm = 76.7229, GNorm = 1.6700, lr_0 = 1.2911e-04
Validation prc-auc = 0.592769
Validation auc = 0.889699
Epoch 26
Loss = 1.9866e-01, PNorm = 76.7441, GNorm = 1.7286, lr_0 = 1.2501e-04
Loss = 2.0520e-01, PNorm = 76.7565, GNorm = 0.9917, lr_0 = 1.2139e-04
Validation prc-auc = 0.593932
Validation auc = 0.895044
Epoch 27
Loss = 1.7148e-01, PNorm = 76.7728, GNorm = 0.9572, lr_0 = 1.1753e-04
Loss = 2.1313e-01, PNorm = 76.7913, GNorm = 1.0002, lr_0 = 1.1413e-04
Loss = 2.6320e-01, PNorm = 76.8042, GNorm = 1.7415, lr_0 = 1.1083e-04
Validation prc-auc = 0.602676
Validation auc = 0.886054
Epoch 28
Loss = 2.1328e-01, PNorm = 76.8174, GNorm = 1.2713, lr_0 = 1.0730e-04
Loss = 2.1822e-01, PNorm = 76.8354, GNorm = 1.7714, lr_0 = 1.0420e-04
Loss = 2.2022e-01, PNorm = 76.8445, GNorm = 0.9433, lr_0 = 1.0118e-04
Validation prc-auc = 0.592297
Validation auc = 0.886540
Epoch 29
Loss = 1.8548e-01, PNorm = 76.8579, GNorm = 1.0802, lr_0 = 1.0000e-04
Loss = 2.2546e-01, PNorm = 76.8722, GNorm = 0.8581, lr_0 = 1.0000e-04
Loss = 2.3659e-01, PNorm = 76.8810, GNorm = 1.5045, lr_0 = 1.0000e-04
Validation prc-auc = 0.600886
Validation auc = 0.899174
Model 0 best validation prc-auc = 0.654029 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.520886
Model 0 test auc = 0.744832
Ensemble test prc-auc = 0.520886
Ensemble test auc = 0.744832
Fold 39
Splitting data with seed 39
Total scaffolds = 870 | train scaffolds = 657 | val scaffolds = 94 | test scaffolds = 119
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 5.7876e-01, PNorm = 72.7661, GNorm = 1.2408, lr_0 = 1.0000e-03
Loss = 4.7597e-01, PNorm = 73.1550, GNorm = 0.5788, lr_0 = 1.0000e-03
Validation prc-auc = 0.393255
Validation auc = 0.701735
Epoch 1
Loss = 4.9999e-01, PNorm = 73.3834, GNorm = 0.5553, lr_0 = 1.0000e-03
Loss = 4.2329e-01, PNorm = 73.5134, GNorm = 0.7672, lr_0 = 1.0000e-03
Loss = 3.8714e-01, PNorm = 73.6054, GNorm = 0.5178, lr_0 = 1.0000e-03
Validation prc-auc = 0.383227
Validation auc = 0.691742
Epoch 2
Loss = 3.3716e-01, PNorm = 73.6880, GNorm = 0.6633, lr_0 = 9.7965e-04
Loss = 4.0897e-01, PNorm = 73.7613, GNorm = 0.6748, lr_0 = 9.5130e-04
Loss = 4.3534e-01, PNorm = 73.8373, GNorm = 0.7106, lr_0 = 9.2376e-04
Validation prc-auc = 0.415427
Validation auc = 0.716252
Epoch 3
Loss = 3.5241e-01, PNorm = 73.9064, GNorm = 0.6268, lr_0 = 8.9440e-04
Loss = 3.9765e-01, PNorm = 73.9680, GNorm = 0.8631, lr_0 = 8.6851e-04
Loss = 4.1278e-01, PNorm = 74.0274, GNorm = 0.7517, lr_0 = 8.4337e-04
Validation prc-auc = 0.403078
Validation auc = 0.653092
Epoch 4
Loss = 4.1561e-01, PNorm = 74.0947, GNorm = 0.6069, lr_0 = 8.1656e-04
Loss = 3.5292e-01, PNorm = 74.1654, GNorm = 0.6509, lr_0 = 7.9293e-04
Loss = 4.2560e-01, PNorm = 74.2349, GNorm = 0.5978, lr_0 = 7.6998e-04
Loss = 2.7148e-01, PNorm = 74.2418, GNorm = 1.7746, lr_0 = 7.6772e-04
Validation prc-auc = 0.397407
Validation auc = 0.686086
Epoch 5
Loss = 3.7123e-01, PNorm = 74.3233, GNorm = 0.9734, lr_0 = 7.4550e-04
Loss = 3.3912e-01, PNorm = 74.4034, GNorm = 0.8520, lr_0 = 7.2393e-04
Validation prc-auc = 0.426856
Validation auc = 0.728318
Epoch 6
Loss = 2.7805e-01, PNorm = 74.4854, GNorm = 0.8324, lr_0 = 7.0091e-04
Loss = 3.6553e-01, PNorm = 74.5666, GNorm = 0.5894, lr_0 = 6.8063e-04
Loss = 4.3964e-01, PNorm = 74.6291, GNorm = 0.7781, lr_0 = 6.6093e-04
Validation prc-auc = 0.446174
Validation auc = 0.733597
Epoch 7
Loss = 2.9713e-01, PNorm = 74.7093, GNorm = 0.8719, lr_0 = 6.3992e-04
Loss = 3.6641e-01, PNorm = 74.7834, GNorm = 0.8977, lr_0 = 6.2139e-04
Loss = 3.5327e-01, PNorm = 74.8448, GNorm = 0.5376, lr_0 = 6.0341e-04
Validation prc-auc = 0.436575
Validation auc = 0.733974
Epoch 8
Loss = 3.3192e-01, PNorm = 74.9136, GNorm = 0.7191, lr_0 = 5.8595e-04
Loss = 3.3684e-01, PNorm = 74.9817, GNorm = 0.6238, lr_0 = 5.6899e-04
Loss = 3.6908e-01, PNorm = 75.0440, GNorm = 1.0438, lr_0 = 5.5252e-04
Validation prc-auc = 0.425312
Validation auc = 0.712670
Epoch 9
Loss = 3.2873e-01, PNorm = 75.1216, GNorm = 0.6257, lr_0 = 5.3495e-04
Loss = 3.0895e-01, PNorm = 75.2048, GNorm = 0.6943, lr_0 = 5.1947e-04
Loss = 3.5449e-01, PNorm = 75.2775, GNorm = 0.7618, lr_0 = 5.0444e-04
Validation prc-auc = 0.434560
Validation auc = 0.714555
Epoch 10
Loss = 3.1556e-01, PNorm = 75.3779, GNorm = 0.6330, lr_0 = 4.8840e-04
Loss = 3.4314e-01, PNorm = 75.4518, GNorm = 0.8666, lr_0 = 4.7426e-04
Validation prc-auc = 0.471124
Validation auc = 0.736614
Epoch 11
Loss = 4.2901e-01, PNorm = 75.5262, GNorm = 1.2090, lr_0 = 4.5919e-04
Loss = 3.1207e-01, PNorm = 75.6044, GNorm = 1.8062, lr_0 = 4.4590e-04
Loss = 3.2764e-01, PNorm = 75.6606, GNorm = 0.7774, lr_0 = 4.3299e-04
Validation prc-auc = 0.438489
Validation auc = 0.711161
Epoch 12
Loss = 2.3233e-01, PNorm = 75.7281, GNorm = 0.6598, lr_0 = 4.1923e-04
Loss = 3.0948e-01, PNorm = 75.7947, GNorm = 0.8288, lr_0 = 4.0709e-04
Loss = 2.9181e-01, PNorm = 75.8511, GNorm = 0.7300, lr_0 = 3.9531e-04
Validation prc-auc = 0.442124
Validation auc = 0.719268
Epoch 13
Loss = 2.7783e-01, PNorm = 75.9200, GNorm = 0.6583, lr_0 = 3.8274e-04
Loss = 2.7102e-01, PNorm = 75.9838, GNorm = 0.7401, lr_0 = 3.7167e-04
Loss = 2.9901e-01, PNorm = 76.0390, GNorm = 0.5956, lr_0 = 3.6091e-04
Validation prc-auc = 0.454081
Validation auc = 0.716063
Epoch 14
Loss = 3.1983e-01, PNorm = 76.1038, GNorm = 0.8329, lr_0 = 3.4944e-04
Loss = 2.5130e-01, PNorm = 76.1597, GNorm = 0.8731, lr_0 = 3.3932e-04
Loss = 2.8655e-01, PNorm = 76.2259, GNorm = 1.4006, lr_0 = 3.2950e-04
Validation prc-auc = 0.448511
Validation auc = 0.673643
Epoch 15
Loss = 2.6938e-01, PNorm = 76.2673, GNorm = 0.9494, lr_0 = 3.1996e-04
Loss = 2.7658e-01, PNorm = 76.3212, GNorm = 0.7567, lr_0 = 3.1070e-04
Loss = 2.7239e-01, PNorm = 76.3741, GNorm = 1.0001, lr_0 = 3.0171e-04
Loss = 3.1843e-01, PNorm = 76.3779, GNorm = 2.9229, lr_0 = 3.0083e-04
Validation prc-auc = 0.439780
Validation auc = 0.703808
Epoch 16
Loss = 2.5005e-01, PNorm = 76.4206, GNorm = 0.7961, lr_0 = 2.9212e-04
Loss = 2.5221e-01, PNorm = 76.4701, GNorm = 1.1411, lr_0 = 2.8367e-04
Validation prc-auc = 0.427239
Validation auc = 0.700792
Epoch 17
Loss = 2.2719e-01, PNorm = 76.5165, GNorm = 0.7284, lr_0 = 2.7465e-04
Loss = 2.5666e-01, PNorm = 76.5667, GNorm = 1.1014, lr_0 = 2.6670e-04
Loss = 2.3095e-01, PNorm = 76.5984, GNorm = 1.2508, lr_0 = 2.5898e-04
Validation prc-auc = 0.478044
Validation auc = 0.715498
Epoch 18
Loss = 1.9335e-01, PNorm = 76.6420, GNorm = 0.5667, lr_0 = 2.5075e-04
Loss = 2.4661e-01, PNorm = 76.6798, GNorm = 0.8044, lr_0 = 2.4349e-04
Loss = 2.4772e-01, PNorm = 76.7179, GNorm = 1.4414, lr_0 = 2.3644e-04
Validation prc-auc = 0.480381
Validation auc = 0.712670
Epoch 19
Loss = 2.5276e-01, PNorm = 76.7576, GNorm = 0.9186, lr_0 = 2.2893e-04
Loss = 2.1244e-01, PNorm = 76.7937, GNorm = 1.3254, lr_0 = 2.2230e-04
Loss = 2.3809e-01, PNorm = 76.8310, GNorm = 0.9573, lr_0 = 2.1587e-04
Validation prc-auc = 0.452894
Validation auc = 0.711161
Epoch 20
Loss = 2.7142e-01, PNorm = 76.8632, GNorm = 1.3286, lr_0 = 2.0900e-04
Loss = 1.9117e-01, PNorm = 76.8914, GNorm = 1.5278, lr_0 = 2.0295e-04
Loss = 2.1993e-01, PNorm = 76.9182, GNorm = 0.9574, lr_0 = 1.9708e-04
Loss = 1.2504e-01, PNorm = 76.9207, GNorm = 1.5807, lr_0 = 1.9650e-04
Validation prc-auc = 0.454094
Validation auc = 0.715309
Epoch 21
Loss = 2.1284e-01, PNorm = 76.9539, GNorm = 1.1000, lr_0 = 1.9081e-04
Loss = 1.8767e-01, PNorm = 76.9778, GNorm = 0.8874, lr_0 = 1.8529e-04
Validation prc-auc = 0.450098
Validation auc = 0.735860
Epoch 22
Loss = 1.2036e-01, PNorm = 76.9957, GNorm = 0.7070, lr_0 = 1.7993e-04
Loss = 2.2937e-01, PNorm = 77.0196, GNorm = 0.7980, lr_0 = 1.7472e-04
Loss = 1.9191e-01, PNorm = 77.0431, GNorm = 0.5633, lr_0 = 1.6966e-04
Validation prc-auc = 0.447382
Validation auc = 0.709276
Epoch 23
Loss = 1.5443e-01, PNorm = 77.0690, GNorm = 0.9009, lr_0 = 1.6427e-04
Loss = 2.1272e-01, PNorm = 77.0873, GNorm = 1.1983, lr_0 = 1.5952e-04
Loss = 2.3370e-01, PNorm = 77.1017, GNorm = 1.2726, lr_0 = 1.5490e-04
Validation prc-auc = 0.454655
Validation auc = 0.726056
Epoch 24
Loss = 2.0239e-01, PNorm = 77.1293, GNorm = 1.6361, lr_0 = 1.4998e-04
Loss = 2.0216e-01, PNorm = 77.1457, GNorm = 1.2148, lr_0 = 1.4563e-04
Loss = 1.9301e-01, PNorm = 77.1678, GNorm = 1.3289, lr_0 = 1.4142e-04
Validation prc-auc = 0.452195
Validation auc = 0.701735
Epoch 25
Loss = 1.8238e-01, PNorm = 77.1842, GNorm = 1.0166, lr_0 = 1.3692e-04
Loss = 1.9156e-01, PNorm = 77.2005, GNorm = 0.9316, lr_0 = 1.3296e-04
Loss = 2.1860e-01, PNorm = 77.2171, GNorm = 1.1114, lr_0 = 1.2911e-04
Validation prc-auc = 0.458200
Validation auc = 0.716440
Epoch 26
Loss = 1.7455e-01, PNorm = 77.2342, GNorm = 1.1117, lr_0 = 1.2501e-04
Loss = 1.9011e-01, PNorm = 77.2519, GNorm = 1.6580, lr_0 = 1.2139e-04
Validation prc-auc = 0.505542
Validation auc = 0.719080
Epoch 27
Loss = 3.1152e-01, PNorm = 77.2649, GNorm = 2.6886, lr_0 = 1.1753e-04
Loss = 1.7172e-01, PNorm = 77.2748, GNorm = 0.9187, lr_0 = 1.1413e-04
Loss = 2.2667e-01, PNorm = 77.2882, GNorm = 1.1938, lr_0 = 1.1083e-04
Validation prc-auc = 0.451655
Validation auc = 0.713424
Epoch 28
Loss = 1.9939e-01, PNorm = 77.3015, GNorm = 1.0399, lr_0 = 1.0730e-04
Loss = 1.9789e-01, PNorm = 77.3142, GNorm = 1.1480, lr_0 = 1.0420e-04
Loss = 1.7503e-01, PNorm = 77.3266, GNorm = 1.8330, lr_0 = 1.0118e-04
Validation prc-auc = 0.446167
Validation auc = 0.700226
Epoch 29
Loss = 1.8567e-01, PNorm = 77.3376, GNorm = 1.7590, lr_0 = 1.0000e-04
Loss = 1.9861e-01, PNorm = 77.3503, GNorm = 1.1204, lr_0 = 1.0000e-04
Loss = 1.4392e-01, PNorm = 77.3620, GNorm = 1.2467, lr_0 = 1.0000e-04
Validation prc-auc = 0.449596
Validation auc = 0.715121
Model 0 best validation prc-auc = 0.505542 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.702990
Model 0 test auc = 0.836091
Ensemble test prc-auc = 0.702990
Ensemble test auc = 0.836091
Fold 40
Splitting data with seed 40
Total scaffolds = 870 | train scaffolds = 634 | val scaffolds = 115 | test scaffolds = 121
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.7573e-01, PNorm = 72.7807, GNorm = 1.5588, lr_0 = 1.0000e-03
Loss = 4.2264e-01, PNorm = 73.1961, GNorm = 0.6872, lr_0 = 1.0000e-03
Validation prc-auc = 0.327162
Validation auc = 0.688178
Epoch 1
Loss = 3.8251e-01, PNorm = 73.4388, GNorm = 0.5861, lr_0 = 1.0000e-03
Loss = 4.5135e-01, PNorm = 73.5634, GNorm = 0.7118, lr_0 = 1.0000e-03
Loss = 4.2663e-01, PNorm = 73.6536, GNorm = 0.8389, lr_0 = 1.0000e-03
Validation prc-auc = 0.370845
Validation auc = 0.740578
Epoch 2
Loss = 4.5377e-01, PNorm = 73.7232, GNorm = 0.8313, lr_0 = 9.7965e-04
Loss = 4.0623e-01, PNorm = 73.7822, GNorm = 0.9454, lr_0 = 9.5130e-04
Loss = 4.3532e-01, PNorm = 73.8294, GNorm = 0.5622, lr_0 = 9.2376e-04
Validation prc-auc = 0.388205
Validation auc = 0.737481
Epoch 3
Loss = 4.1186e-01, PNorm = 73.8857, GNorm = 0.7634, lr_0 = 8.9440e-04
Loss = 3.9916e-01, PNorm = 73.9366, GNorm = 0.9189, lr_0 = 8.6851e-04
Loss = 3.8644e-01, PNorm = 73.9994, GNorm = 0.4972, lr_0 = 8.4337e-04
Validation prc-auc = 0.409644
Validation auc = 0.752969
Epoch 4
Loss = 3.3227e-01, PNorm = 74.0821, GNorm = 0.5650, lr_0 = 8.1656e-04
Loss = 4.1014e-01, PNorm = 74.1445, GNorm = 0.4943, lr_0 = 7.9293e-04
Loss = 4.0527e-01, PNorm = 74.2070, GNorm = 0.6575, lr_0 = 7.6998e-04
Loss = 5.1281e-01, PNorm = 74.2125, GNorm = 1.7096, lr_0 = 7.6772e-04
Validation prc-auc = 0.436000
Validation auc = 0.771554
Epoch 5
Loss = 3.6421e-01, PNorm = 74.2795, GNorm = 1.7435, lr_0 = 7.4550e-04
Loss = 3.7975e-01, PNorm = 74.3421, GNorm = 0.5932, lr_0 = 7.2393e-04
Validation prc-auc = 0.492832
Validation auc = 0.773877
Epoch 6
Loss = 3.3104e-01, PNorm = 74.3936, GNorm = 0.7932, lr_0 = 7.0091e-04
Loss = 3.8862e-01, PNorm = 74.4558, GNorm = 0.8237, lr_0 = 6.8063e-04
Loss = 3.8159e-01, PNorm = 74.5026, GNorm = 0.5423, lr_0 = 6.6093e-04
Validation prc-auc = 0.471837
Validation auc = 0.765875
Epoch 7
Loss = 3.6371e-01, PNorm = 74.5626, GNorm = 0.5032, lr_0 = 6.3992e-04
Loss = 3.4198e-01, PNorm = 74.6124, GNorm = 0.5749, lr_0 = 6.2139e-04
Loss = 3.7681e-01, PNorm = 74.6547, GNorm = 0.7154, lr_0 = 6.0341e-04
Validation prc-auc = 0.485398
Validation auc = 0.778007
Epoch 8
Loss = 3.3211e-01, PNorm = 74.7132, GNorm = 0.7160, lr_0 = 5.8595e-04
Loss = 3.3564e-01, PNorm = 74.7693, GNorm = 0.6090, lr_0 = 5.6899e-04
Loss = 3.7842e-01, PNorm = 74.8247, GNorm = 0.6482, lr_0 = 5.5252e-04
Validation prc-auc = 0.509161
Validation auc = 0.779298
Epoch 9
Loss = 3.3310e-01, PNorm = 74.8960, GNorm = 0.7788, lr_0 = 5.3495e-04
Loss = 3.1312e-01, PNorm = 74.9608, GNorm = 0.7226, lr_0 = 5.1947e-04
Loss = 3.8299e-01, PNorm = 75.0225, GNorm = 0.7873, lr_0 = 5.0444e-04
Validation prc-auc = 0.510447
Validation auc = 0.784461
Epoch 10
Loss = 2.9324e-01, PNorm = 75.1127, GNorm = 0.5966, lr_0 = 4.8840e-04
Loss = 3.4643e-01, PNorm = 75.1851, GNorm = 0.9958, lr_0 = 4.7426e-04
Validation prc-auc = 0.520105
Validation auc = 0.791430
Epoch 11
Loss = 3.3671e-01, PNorm = 75.2495, GNorm = 1.0419, lr_0 = 4.5919e-04
Loss = 3.4502e-01, PNorm = 75.3085, GNorm = 0.7984, lr_0 = 4.4590e-04
Loss = 3.2771e-01, PNorm = 75.3667, GNorm = 0.6613, lr_0 = 4.3299e-04
Validation prc-auc = 0.519704
Validation auc = 0.792979
Epoch 12
Loss = 2.7821e-01, PNorm = 75.4247, GNorm = 0.6852, lr_0 = 4.1923e-04
Loss = 3.5722e-01, PNorm = 75.4803, GNorm = 0.5736, lr_0 = 4.0709e-04
Loss = 2.8804e-01, PNorm = 75.5346, GNorm = 0.6896, lr_0 = 3.9531e-04
Validation prc-auc = 0.495799
Validation auc = 0.796593
Epoch 13
Loss = 3.3051e-01, PNorm = 75.5923, GNorm = 0.6024, lr_0 = 3.8274e-04
Loss = 3.1177e-01, PNorm = 75.6496, GNorm = 0.8134, lr_0 = 3.7167e-04
Loss = 3.1374e-01, PNorm = 75.7018, GNorm = 0.8205, lr_0 = 3.6091e-04
Validation prc-auc = 0.516128
Validation auc = 0.799174
Epoch 14
Loss = 2.6150e-01, PNorm = 75.7613, GNorm = 1.2866, lr_0 = 3.4944e-04
Loss = 2.9233e-01, PNorm = 75.8036, GNorm = 0.7332, lr_0 = 3.3932e-04
Loss = 3.3397e-01, PNorm = 75.8518, GNorm = 1.3877, lr_0 = 3.2950e-04
Validation prc-auc = 0.549851
Validation auc = 0.808725
Epoch 15
Loss = 2.9256e-01, PNorm = 75.9049, GNorm = 1.0557, lr_0 = 3.1996e-04
Loss = 3.1354e-01, PNorm = 75.9378, GNorm = 0.8752, lr_0 = 3.1070e-04
Loss = 3.1351e-01, PNorm = 75.9823, GNorm = 1.3907, lr_0 = 3.0171e-04
Loss = 1.1748e-01, PNorm = 75.9863, GNorm = 1.2861, lr_0 = 3.0083e-04
Validation prc-auc = 0.508485
Validation auc = 0.807176
Epoch 16
Loss = 3.0250e-01, PNorm = 76.0258, GNorm = 0.6372, lr_0 = 2.9212e-04
Loss = 2.8663e-01, PNorm = 76.0590, GNorm = 0.9679, lr_0 = 2.8367e-04
Validation prc-auc = 0.539723
Validation auc = 0.809499
Epoch 17
Loss = 2.8934e-01, PNorm = 76.0936, GNorm = 0.7601, lr_0 = 2.7465e-04
Loss = 3.2681e-01, PNorm = 76.1366, GNorm = 1.0744, lr_0 = 2.6670e-04
Loss = 2.7690e-01, PNorm = 76.1738, GNorm = 0.6850, lr_0 = 2.5898e-04
Validation prc-auc = 0.580891
Validation auc = 0.813113
Epoch 18
Loss = 3.1047e-01, PNorm = 76.2166, GNorm = 1.2549, lr_0 = 2.5075e-04
Loss = 2.8047e-01, PNorm = 76.2510, GNorm = 0.9587, lr_0 = 2.4349e-04
Loss = 2.4428e-01, PNorm = 76.2896, GNorm = 0.7329, lr_0 = 2.3644e-04
Validation prc-auc = 0.550199
Validation auc = 0.814662
Epoch 19
Loss = 2.9621e-01, PNorm = 76.3233, GNorm = 1.0205, lr_0 = 2.2893e-04
Loss = 2.5587e-01, PNorm = 76.3605, GNorm = 0.9945, lr_0 = 2.2230e-04
Loss = 2.5930e-01, PNorm = 76.3881, GNorm = 1.1059, lr_0 = 2.1587e-04
Validation prc-auc = 0.594170
Validation auc = 0.815178
Epoch 20
Loss = 2.4500e-01, PNorm = 76.4226, GNorm = 0.7234, lr_0 = 2.0900e-04
Loss = 2.9257e-01, PNorm = 76.4496, GNorm = 1.1006, lr_0 = 2.0295e-04
Loss = 2.2167e-01, PNorm = 76.4785, GNorm = 0.6404, lr_0 = 1.9708e-04
Loss = 2.4886e-01, PNorm = 76.4821, GNorm = 2.0697, lr_0 = 1.9650e-04
Validation prc-auc = 0.550427
Validation auc = 0.808983
Epoch 21
Loss = 2.4348e-01, PNorm = 76.5109, GNorm = 0.9677, lr_0 = 1.9081e-04
Loss = 2.3854e-01, PNorm = 76.5365, GNorm = 1.2323, lr_0 = 1.8529e-04
Validation prc-auc = 0.566803
Validation auc = 0.818018
Epoch 22
Loss = 2.7743e-01, PNorm = 76.5597, GNorm = 1.2168, lr_0 = 1.7993e-04
Loss = 2.4516e-01, PNorm = 76.5810, GNorm = 1.0562, lr_0 = 1.7472e-04
Loss = 2.4795e-01, PNorm = 76.6085, GNorm = 1.2138, lr_0 = 1.6966e-04
Validation prc-auc = 0.587878
Validation auc = 0.818792
Epoch 23
Loss = 2.1752e-01, PNorm = 76.6333, GNorm = 1.1846, lr_0 = 1.6427e-04
Loss = 2.5742e-01, PNorm = 76.6535, GNorm = 1.5306, lr_0 = 1.5952e-04
Loss = 2.4880e-01, PNorm = 76.6717, GNorm = 1.0971, lr_0 = 1.5490e-04
Validation prc-auc = 0.590245
Validation auc = 0.818792
Epoch 24
Loss = 1.9516e-01, PNorm = 76.7017, GNorm = 0.8118, lr_0 = 1.4998e-04
Loss = 2.5664e-01, PNorm = 76.7232, GNorm = 2.1453, lr_0 = 1.4563e-04
Loss = 2.3120e-01, PNorm = 76.7354, GNorm = 0.7116, lr_0 = 1.4142e-04
Validation prc-auc = 0.590844
Validation auc = 0.824471
Epoch 25
Loss = 2.1607e-01, PNorm = 76.7557, GNorm = 0.7879, lr_0 = 1.3692e-04
Loss = 1.9822e-01, PNorm = 76.7768, GNorm = 0.7115, lr_0 = 1.3296e-04
Loss = 2.4000e-01, PNorm = 76.7955, GNorm = 1.4341, lr_0 = 1.2911e-04
Validation prc-auc = 0.596067
Validation auc = 0.821115
Epoch 26
Loss = 2.2368e-01, PNorm = 76.8134, GNorm = 1.1814, lr_0 = 1.2501e-04
Loss = 1.7780e-01, PNorm = 76.8305, GNorm = 0.7297, lr_0 = 1.2139e-04
Validation prc-auc = 0.596385
Validation auc = 0.823955
Epoch 27
Loss = 1.9088e-01, PNorm = 76.8468, GNorm = 0.9492, lr_0 = 1.1753e-04
Loss = 1.9393e-01, PNorm = 76.8614, GNorm = 0.9858, lr_0 = 1.1413e-04
Loss = 2.4285e-01, PNorm = 76.8764, GNorm = 0.8613, lr_0 = 1.1083e-04
Validation prc-auc = 0.610176
Validation auc = 0.828601
Epoch 28
Loss = 1.3095e-01, PNorm = 76.8922, GNorm = 1.1830, lr_0 = 1.0730e-04
Loss = 2.2844e-01, PNorm = 76.9045, GNorm = 1.1704, lr_0 = 1.0420e-04
Loss = 2.3158e-01, PNorm = 76.9173, GNorm = 1.1934, lr_0 = 1.0118e-04
Validation prc-auc = 0.618913
Validation auc = 0.823180
Epoch 29
Loss = 1.8715e-01, PNorm = 76.9295, GNorm = 1.2497, lr_0 = 1.0000e-04
Loss = 2.0323e-01, PNorm = 76.9432, GNorm = 0.5214, lr_0 = 1.0000e-04
Loss = 2.0671e-01, PNorm = 76.9578, GNorm = 1.9044, lr_0 = 1.0000e-04
Validation prc-auc = 0.615188
Validation auc = 0.822922
Model 0 best validation prc-auc = 0.618913 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.559172
Model 0 test auc = 0.712413
Ensemble test prc-auc = 0.559172
Ensemble test auc = 0.712413
Fold 41
Splitting data with seed 41
Total scaffolds = 870 | train scaffolds = 620 | val scaffolds = 124 | test scaffolds = 126
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.0971e-01, PNorm = 72.7779, GNorm = 1.2215, lr_0 = 1.0000e-03
Loss = 4.5209e-01, PNorm = 73.1798, GNorm = 0.5979, lr_0 = 1.0000e-03
Validation prc-auc = 0.445172
Validation auc = 0.777636
Epoch 1
Loss = 4.5769e-01, PNorm = 73.4164, GNorm = 0.5921, lr_0 = 1.0000e-03
Loss = 4.1134e-01, PNorm = 73.5421, GNorm = 0.7690, lr_0 = 1.0000e-03
Loss = 4.3218e-01, PNorm = 73.6318, GNorm = 0.9121, lr_0 = 1.0000e-03
Validation prc-auc = 0.469760
Validation auc = 0.785531
Epoch 2
Loss = 4.3342e-01, PNorm = 73.7156, GNorm = 0.7839, lr_0 = 9.7965e-04
Loss = 3.3300e-01, PNorm = 73.7848, GNorm = 0.8333, lr_0 = 9.5130e-04
Loss = 4.3897e-01, PNorm = 73.8465, GNorm = 0.6519, lr_0 = 9.2376e-04
Validation prc-auc = 0.513251
Validation auc = 0.791293
Epoch 3
Loss = 4.2384e-01, PNorm = 73.9320, GNorm = 0.7097, lr_0 = 8.9440e-04
Loss = 4.5877e-01, PNorm = 74.0000, GNorm = 0.8197, lr_0 = 8.6851e-04
Loss = 3.7455e-01, PNorm = 74.0767, GNorm = 0.4769, lr_0 = 8.4337e-04
Validation prc-auc = 0.521915
Validation auc = 0.796201
Epoch 4
Loss = 3.6998e-01, PNorm = 74.1334, GNorm = 0.5143, lr_0 = 8.1656e-04
Loss = 3.9261e-01, PNorm = 74.1914, GNorm = 0.5731, lr_0 = 7.9293e-04
Loss = 3.6947e-01, PNorm = 74.2534, GNorm = 0.6423, lr_0 = 7.6998e-04
Loss = 1.9040e-01, PNorm = 74.2604, GNorm = 0.7772, lr_0 = 7.6772e-04
Validation prc-auc = 0.522974
Validation auc = 0.794067
Epoch 5
Loss = 3.4886e-01, PNorm = 74.3121, GNorm = 0.6970, lr_0 = 7.4550e-04
Loss = 3.7472e-01, PNorm = 74.3737, GNorm = 0.5571, lr_0 = 7.2393e-04
Validation prc-auc = 0.539975
Validation auc = 0.807939
Epoch 6
Loss = 3.1910e-01, PNorm = 74.4486, GNorm = 0.9314, lr_0 = 7.0091e-04
Loss = 3.6799e-01, PNorm = 74.5146, GNorm = 0.5730, lr_0 = 6.8063e-04
Loss = 3.4651e-01, PNorm = 74.5891, GNorm = 0.7140, lr_0 = 6.6093e-04
Validation prc-auc = 0.557774
Validation auc = 0.811993
Epoch 7
Loss = 3.4420e-01, PNorm = 74.6739, GNorm = 0.8311, lr_0 = 6.3992e-04
Loss = 3.2132e-01, PNorm = 74.7480, GNorm = 0.9404, lr_0 = 6.2139e-04
Loss = 4.0304e-01, PNorm = 74.8140, GNorm = 0.8122, lr_0 = 6.0341e-04
Validation prc-auc = 0.546380
Validation auc = 0.807512
Epoch 8
Loss = 3.0804e-01, PNorm = 74.8935, GNorm = 0.5873, lr_0 = 5.8595e-04
Loss = 4.0023e-01, PNorm = 74.9727, GNorm = 1.0346, lr_0 = 5.6899e-04
Loss = 3.4171e-01, PNorm = 75.0414, GNorm = 0.7434, lr_0 = 5.5252e-04
Validation prc-auc = 0.594034
Validation auc = 0.821810
Epoch 9
Loss = 3.6501e-01, PNorm = 75.1284, GNorm = 0.9692, lr_0 = 5.3495e-04
Loss = 3.3942e-01, PNorm = 75.2058, GNorm = 0.6963, lr_0 = 5.1947e-04
Loss = 3.0023e-01, PNorm = 75.2883, GNorm = 0.9200, lr_0 = 5.0444e-04
Validation prc-auc = 0.551153
Validation auc = 0.806445
Epoch 10
Loss = 3.1809e-01, PNorm = 75.3595, GNorm = 0.6645, lr_0 = 4.8840e-04
Loss = 3.4498e-01, PNorm = 75.4247, GNorm = 0.8378, lr_0 = 4.7426e-04
Validation prc-auc = 0.555482
Validation auc = 0.812207
Epoch 11
Loss = 4.6686e-01, PNorm = 75.5053, GNorm = 0.8004, lr_0 = 4.5919e-04
Loss = 3.3479e-01, PNorm = 75.5916, GNorm = 0.7818, lr_0 = 4.4590e-04
Loss = 2.9217e-01, PNorm = 75.6575, GNorm = 2.4623, lr_0 = 4.3299e-04
Validation prc-auc = 0.625096
Validation auc = 0.841229
Epoch 12
Loss = 2.9093e-01, PNorm = 75.7200, GNorm = 0.6697, lr_0 = 4.1923e-04
Loss = 3.2549e-01, PNorm = 75.7889, GNorm = 1.0089, lr_0 = 4.0709e-04
Loss = 3.2380e-01, PNorm = 75.8484, GNorm = 1.0053, lr_0 = 3.9531e-04
Validation prc-auc = 0.618359
Validation auc = 0.816475
Epoch 13
Loss = 3.0345e-01, PNorm = 75.8964, GNorm = 0.4958, lr_0 = 3.8274e-04
Loss = 2.6380e-01, PNorm = 75.9534, GNorm = 0.7766, lr_0 = 3.7167e-04
Loss = 3.1191e-01, PNorm = 75.9966, GNorm = 0.9922, lr_0 = 3.6091e-04
Validation prc-auc = 0.629419
Validation auc = 0.837601
Epoch 14
Loss = 2.6813e-01, PNorm = 76.0674, GNorm = 1.0645, lr_0 = 3.4944e-04
Loss = 3.0550e-01, PNorm = 76.1299, GNorm = 0.8995, lr_0 = 3.3932e-04
Loss = 2.7244e-01, PNorm = 76.1868, GNorm = 0.6368, lr_0 = 3.2950e-04
Validation prc-auc = 0.598059
Validation auc = 0.810926
Epoch 15
Loss = 2.9193e-01, PNorm = 76.2414, GNorm = 1.1841, lr_0 = 3.1996e-04
Loss = 2.8012e-01, PNorm = 76.2804, GNorm = 0.7902, lr_0 = 3.1070e-04
Loss = 2.8371e-01, PNorm = 76.3316, GNorm = 1.2668, lr_0 = 3.0171e-04
Loss = 3.1852e-01, PNorm = 76.3356, GNorm = 1.7391, lr_0 = 3.0083e-04
Validation prc-auc = 0.601565
Validation auc = 0.830346
Epoch 16
Loss = 2.9598e-01, PNorm = 76.3772, GNorm = 0.7877, lr_0 = 2.9212e-04
Loss = 2.5579e-01, PNorm = 76.4249, GNorm = 0.5464, lr_0 = 2.8367e-04
Validation prc-auc = 0.645336
Validation auc = 0.845711
Epoch 17
Loss = 2.1127e-01, PNorm = 76.4559, GNorm = 0.7037, lr_0 = 2.7465e-04
Loss = 2.6761e-01, PNorm = 76.4927, GNorm = 1.0018, lr_0 = 2.6670e-04
Loss = 2.7499e-01, PNorm = 76.5380, GNorm = 1.0076, lr_0 = 2.5898e-04
Validation prc-auc = 0.623155
Validation auc = 0.833974
Epoch 18
Loss = 2.8054e-01, PNorm = 76.5869, GNorm = 1.5269, lr_0 = 2.5075e-04
Loss = 2.2711e-01, PNorm = 76.6176, GNorm = 0.7745, lr_0 = 2.4349e-04
Loss = 2.6527e-01, PNorm = 76.6530, GNorm = 0.8744, lr_0 = 2.3644e-04
Validation prc-auc = 0.654826
Validation auc = 0.845070
Epoch 19
Loss = 2.1054e-01, PNorm = 76.6915, GNorm = 0.8165, lr_0 = 2.2893e-04
Loss = 2.4534e-01, PNorm = 76.7314, GNorm = 1.1688, lr_0 = 2.2230e-04
Loss = 2.8270e-01, PNorm = 76.7585, GNorm = 0.8775, lr_0 = 2.1587e-04
Validation prc-auc = 0.663998
Validation auc = 0.852539
Epoch 20
Loss = 2.5780e-01, PNorm = 76.7977, GNorm = 1.4820, lr_0 = 2.0900e-04
Loss = 2.0617e-01, PNorm = 76.8279, GNorm = 0.9402, lr_0 = 2.0295e-04
Loss = 2.5875e-01, PNorm = 76.8558, GNorm = 0.6045, lr_0 = 1.9708e-04
Loss = 1.2975e-01, PNorm = 76.8593, GNorm = 1.7202, lr_0 = 1.9650e-04
Validation prc-auc = 0.673756
Validation auc = 0.840376
Epoch 21
Loss = 2.2565e-01, PNorm = 76.8897, GNorm = 1.1114, lr_0 = 1.9081e-04
Loss = 1.9838e-01, PNorm = 76.9230, GNorm = 1.3803, lr_0 = 1.8529e-04
Validation prc-auc = 0.661122
Validation auc = 0.845284
Epoch 22
Loss = 2.7092e-01, PNorm = 76.9469, GNorm = 1.2788, lr_0 = 1.7993e-04
Loss = 2.0871e-01, PNorm = 76.9728, GNorm = 1.1021, lr_0 = 1.7472e-04
Loss = 2.4068e-01, PNorm = 76.9962, GNorm = 0.9606, lr_0 = 1.6966e-04
Validation prc-auc = 0.667596
Validation auc = 0.838668
Epoch 23
Loss = 2.6869e-01, PNorm = 77.0203, GNorm = 1.5508, lr_0 = 1.6427e-04
Loss = 2.3487e-01, PNorm = 77.0511, GNorm = 2.3335, lr_0 = 1.5952e-04
Loss = 2.3763e-01, PNorm = 77.0691, GNorm = 1.7283, lr_0 = 1.5490e-04
Validation prc-auc = 0.650775
Validation auc = 0.847418
Epoch 24
Loss = 2.4912e-01, PNorm = 77.0934, GNorm = 1.0241, lr_0 = 1.4998e-04
Loss = 2.1457e-01, PNorm = 77.1134, GNorm = 0.6628, lr_0 = 1.4563e-04
Loss = 2.0574e-01, PNorm = 77.1332, GNorm = 1.0072, lr_0 = 1.4142e-04
Validation prc-auc = 0.641617
Validation auc = 0.837815
Epoch 25
Loss = 1.9499e-01, PNorm = 77.1560, GNorm = 2.1854, lr_0 = 1.3692e-04
Loss = 2.4152e-01, PNorm = 77.1733, GNorm = 1.2948, lr_0 = 1.3296e-04
Loss = 1.8953e-01, PNorm = 77.1944, GNorm = 1.3736, lr_0 = 1.2911e-04
Validation prc-auc = 0.688312
Validation auc = 0.856381
Epoch 26
Loss = 2.3558e-01, PNorm = 77.2133, GNorm = 0.9694, lr_0 = 1.2501e-04
Loss = 1.8981e-01, PNorm = 77.2294, GNorm = 1.5035, lr_0 = 1.2139e-04
Validation prc-auc = 0.689940
Validation auc = 0.850405
Epoch 27
Loss = 1.4068e-01, PNorm = 77.2407, GNorm = 0.9406, lr_0 = 1.1753e-04
Loss = 2.2013e-01, PNorm = 77.2579, GNorm = 1.1723, lr_0 = 1.1413e-04
Loss = 1.5929e-01, PNorm = 77.2716, GNorm = 1.0767, lr_0 = 1.1083e-04
Validation prc-auc = 0.669349
Validation auc = 0.841229
Epoch 28
Loss = 2.1889e-01, PNorm = 77.2844, GNorm = 1.4970, lr_0 = 1.0730e-04
Loss = 1.6753e-01, PNorm = 77.3007, GNorm = 0.8627, lr_0 = 1.0420e-04
Loss = 2.0164e-01, PNorm = 77.3099, GNorm = 1.2786, lr_0 = 1.0118e-04
Validation prc-auc = 0.667723
Validation auc = 0.840376
Epoch 29
Loss = 2.0584e-01, PNorm = 77.3237, GNorm = 1.1319, lr_0 = 1.0000e-04
Loss = 1.8701e-01, PNorm = 77.3332, GNorm = 0.8560, lr_0 = 1.0000e-04
Loss = 1.8411e-01, PNorm = 77.3464, GNorm = 1.1307, lr_0 = 1.0000e-04
Validation prc-auc = 0.657581
Validation auc = 0.838668
Model 0 best validation prc-auc = 0.689940 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.664604
Model 0 test auc = 0.757913
Ensemble test prc-auc = 0.664604
Ensemble test auc = 0.757913
Fold 42
Splitting data with seed 42
Total scaffolds = 870 | train scaffolds = 671 | val scaffolds = 101 | test scaffolds = 98
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.6882e-01, PNorm = 72.7774, GNorm = 0.6754, lr_0 = 1.0000e-03
Loss = 4.4669e-01, PNorm = 73.1884, GNorm = 0.7746, lr_0 = 1.0000e-03
Validation prc-auc = 0.441057
Validation auc = 0.734955
Epoch 1
Loss = 5.1550e-01, PNorm = 73.4303, GNorm = 0.9547, lr_0 = 1.0000e-03
Loss = 4.3233e-01, PNorm = 73.5590, GNorm = 0.6384, lr_0 = 1.0000e-03
Loss = 4.1414e-01, PNorm = 73.6538, GNorm = 0.5841, lr_0 = 1.0000e-03
Validation prc-auc = 0.446933
Validation auc = 0.782330
Epoch 2
Loss = 4.4873e-01, PNorm = 73.7281, GNorm = 0.9354, lr_0 = 9.7965e-04
Loss = 4.0887e-01, PNorm = 73.8009, GNorm = 0.5532, lr_0 = 9.5130e-04
Loss = 4.2951e-01, PNorm = 73.8635, GNorm = 0.7125, lr_0 = 9.2376e-04
Validation prc-auc = 0.477674
Validation auc = 0.762697
Epoch 3
Loss = 3.6582e-01, PNorm = 73.9375, GNorm = 0.6114, lr_0 = 8.9440e-04
Loss = 4.2299e-01, PNorm = 73.9987, GNorm = 0.5939, lr_0 = 8.6851e-04
Loss = 4.0701e-01, PNorm = 74.0583, GNorm = 0.5144, lr_0 = 8.4337e-04
Validation prc-auc = 0.500420
Validation auc = 0.785105
Epoch 4
Loss = 3.8217e-01, PNorm = 74.1421, GNorm = 1.1226, lr_0 = 8.1656e-04
Loss = 3.9240e-01, PNorm = 74.2155, GNorm = 1.2529, lr_0 = 7.9293e-04
Loss = 4.1481e-01, PNorm = 74.2762, GNorm = 0.8172, lr_0 = 7.6998e-04
Loss = 2.3018e-01, PNorm = 74.2842, GNorm = 1.6918, lr_0 = 7.6772e-04
Validation prc-auc = 0.508915
Validation auc = 0.791080
Epoch 5
Loss = 3.7110e-01, PNorm = 74.3468, GNorm = 0.5226, lr_0 = 7.4550e-04
Loss = 3.8002e-01, PNorm = 74.4069, GNorm = 0.5784, lr_0 = 7.2393e-04
Validation prc-auc = 0.530074
Validation auc = 0.790440
Epoch 6
Loss = 5.4239e-01, PNorm = 74.4740, GNorm = 0.8688, lr_0 = 7.0091e-04
Loss = 3.8723e-01, PNorm = 74.5516, GNorm = 0.5597, lr_0 = 6.8063e-04
Loss = 3.8576e-01, PNorm = 74.6211, GNorm = 0.5563, lr_0 = 6.6093e-04
Validation prc-auc = 0.490927
Validation auc = 0.768886
Epoch 7
Loss = 4.2370e-01, PNorm = 74.7054, GNorm = 1.2449, lr_0 = 6.3992e-04
Loss = 3.5373e-01, PNorm = 74.7718, GNorm = 0.5971, lr_0 = 6.2139e-04
Loss = 3.5715e-01, PNorm = 74.8308, GNorm = 0.5890, lr_0 = 6.0341e-04
Validation prc-auc = 0.549418
Validation auc = 0.814554
Epoch 8
Loss = 3.3112e-01, PNorm = 74.8985, GNorm = 0.9257, lr_0 = 5.8595e-04
Loss = 3.7352e-01, PNorm = 74.9682, GNorm = 0.7356, lr_0 = 5.6899e-04
Loss = 3.1661e-01, PNorm = 75.0349, GNorm = 0.6139, lr_0 = 5.5252e-04
Validation prc-auc = 0.559598
Validation auc = 0.801536
Epoch 9
Loss = 3.2349e-01, PNorm = 75.1151, GNorm = 1.1275, lr_0 = 5.3495e-04
Loss = 3.3149e-01, PNorm = 75.1883, GNorm = 0.8303, lr_0 = 5.1947e-04
Loss = 3.7779e-01, PNorm = 75.2464, GNorm = 0.8572, lr_0 = 5.0444e-04
Validation prc-auc = 0.585572
Validation auc = 0.811780
Epoch 10
Loss = 3.5157e-01, PNorm = 75.3179, GNorm = 0.5261, lr_0 = 4.8840e-04
Loss = 3.6247e-01, PNorm = 75.3831, GNorm = 0.5669, lr_0 = 4.7426e-04
Validation prc-auc = 0.497454
Validation auc = 0.787025
Epoch 11
Loss = 5.0750e-01, PNorm = 75.4468, GNorm = 1.0084, lr_0 = 4.5919e-04
Loss = 3.3284e-01, PNorm = 75.5037, GNorm = 0.6094, lr_0 = 4.4590e-04
Loss = 2.8031e-01, PNorm = 75.5682, GNorm = 0.5669, lr_0 = 4.3299e-04
Validation prc-auc = 0.568751
Validation auc = 0.810499
Epoch 12
Loss = 3.3034e-01, PNorm = 75.6368, GNorm = 0.8440, lr_0 = 4.1923e-04
Loss = 3.2280e-01, PNorm = 75.6934, GNorm = 0.6997, lr_0 = 4.0709e-04
Loss = 3.0955e-01, PNorm = 75.7533, GNorm = 0.6081, lr_0 = 3.9531e-04
Validation prc-auc = 0.569954
Validation auc = 0.818395
Epoch 13
Loss = 2.7144e-01, PNorm = 75.8183, GNorm = 0.7415, lr_0 = 3.8274e-04
Loss = 2.8021e-01, PNorm = 75.8670, GNorm = 0.7332, lr_0 = 3.7167e-04
Loss = 2.8078e-01, PNorm = 75.9308, GNorm = 0.7284, lr_0 = 3.6091e-04
Validation prc-auc = 0.568421
Validation auc = 0.813274
Epoch 14
Loss = 2.7622e-01, PNorm = 75.9753, GNorm = 0.8697, lr_0 = 3.4944e-04
Loss = 3.2712e-01, PNorm = 76.0234, GNorm = 1.0137, lr_0 = 3.3932e-04
Loss = 3.1444e-01, PNorm = 76.0731, GNorm = 0.8981, lr_0 = 3.2950e-04
Validation prc-auc = 0.581428
Validation auc = 0.819889
Epoch 15
Loss = 2.7058e-01, PNorm = 76.1184, GNorm = 0.6813, lr_0 = 3.1996e-04
Loss = 3.0591e-01, PNorm = 76.1706, GNorm = 0.6442, lr_0 = 3.1070e-04
Loss = 2.7173e-01, PNorm = 76.2148, GNorm = 0.8594, lr_0 = 3.0171e-04
Loss = 4.2224e-01, PNorm = 76.2194, GNorm = 2.8613, lr_0 = 3.0083e-04
Validation prc-auc = 0.562665
Validation auc = 0.825864
Epoch 16
Loss = 2.8698e-01, PNorm = 76.2661, GNorm = 0.9272, lr_0 = 2.9212e-04
Loss = 2.4999e-01, PNorm = 76.3123, GNorm = 0.6566, lr_0 = 2.8367e-04
Validation prc-auc = 0.576395
Validation auc = 0.831199
Epoch 17
Loss = 3.3598e-01, PNorm = 76.3493, GNorm = 1.3011, lr_0 = 2.7465e-04
Loss = 2.6264e-01, PNorm = 76.3905, GNorm = 0.6509, lr_0 = 2.6670e-04
Loss = 2.7156e-01, PNorm = 76.4333, GNorm = 1.2296, lr_0 = 2.5898e-04
Validation prc-auc = 0.496330
Validation auc = 0.801750
Epoch 18
Loss = 2.2349e-01, PNorm = 76.4781, GNorm = 1.9519, lr_0 = 2.5075e-04
Loss = 2.7766e-01, PNorm = 76.5045, GNorm = 1.0007, lr_0 = 2.4349e-04
Loss = 2.5494e-01, PNorm = 76.5418, GNorm = 0.9705, lr_0 = 2.3644e-04
Validation prc-auc = 0.562170
Validation auc = 0.823090
Epoch 19
Loss = 2.7037e-01, PNorm = 76.5777, GNorm = 0.9703, lr_0 = 2.2893e-04
Loss = 2.1555e-01, PNorm = 76.6143, GNorm = 1.0713, lr_0 = 2.2230e-04
Loss = 2.8265e-01, PNorm = 76.6436, GNorm = 1.2605, lr_0 = 2.1587e-04
Validation prc-auc = 0.558769
Validation auc = 0.834400
Epoch 20
Loss = 2.7162e-01, PNorm = 76.6775, GNorm = 1.1796, lr_0 = 2.0900e-04
Loss = 2.2640e-01, PNorm = 76.7103, GNorm = 0.8575, lr_0 = 2.0295e-04
Loss = 2.7475e-01, PNorm = 76.7409, GNorm = 1.5494, lr_0 = 1.9708e-04
Loss = 2.2023e-01, PNorm = 76.7423, GNorm = 2.2815, lr_0 = 1.9650e-04
Validation prc-auc = 0.520312
Validation auc = 0.818395
Epoch 21
Loss = 2.5281e-01, PNorm = 76.7698, GNorm = 0.9702, lr_0 = 1.9081e-04
Loss = 2.2618e-01, PNorm = 76.7966, GNorm = 0.9884, lr_0 = 1.8529e-04
Validation prc-auc = 0.569660
Validation auc = 0.835467
Epoch 22
Loss = 3.1765e-01, PNorm = 76.8260, GNorm = 1.1416, lr_0 = 1.7993e-04
Loss = 2.3043e-01, PNorm = 76.8536, GNorm = 1.1859, lr_0 = 1.7472e-04
Loss = 2.5122e-01, PNorm = 76.8745, GNorm = 1.2745, lr_0 = 1.6966e-04
Validation prc-auc = 0.538345
Validation auc = 0.828638
Epoch 23
Loss = 2.3970e-01, PNorm = 76.9003, GNorm = 1.0104, lr_0 = 1.6427e-04
Loss = 2.3987e-01, PNorm = 76.9242, GNorm = 1.0712, lr_0 = 1.5952e-04
Loss = 2.1315e-01, PNorm = 76.9448, GNorm = 1.0854, lr_0 = 1.5490e-04
Validation prc-auc = 0.575315
Validation auc = 0.836534
Epoch 24
Loss = 2.6505e-01, PNorm = 76.9652, GNorm = 1.1986, lr_0 = 1.4998e-04
Loss = 2.0185e-01, PNorm = 76.9917, GNorm = 0.6157, lr_0 = 1.4563e-04
Loss = 2.1149e-01, PNorm = 77.0106, GNorm = 1.2196, lr_0 = 1.4142e-04
Validation prc-auc = 0.542878
Validation auc = 0.821383
Epoch 25
Loss = 2.3260e-01, PNorm = 77.0257, GNorm = 0.8861, lr_0 = 1.3692e-04
Loss = 1.9047e-01, PNorm = 77.0444, GNorm = 0.9277, lr_0 = 1.3296e-04
Loss = 2.4758e-01, PNorm = 77.0601, GNorm = 1.3862, lr_0 = 1.2911e-04
Validation prc-auc = 0.580243
Validation auc = 0.836534
Epoch 26
Loss = 2.0222e-01, PNorm = 77.0836, GNorm = 1.4048, lr_0 = 1.2501e-04
Loss = 1.9560e-01, PNorm = 77.0971, GNorm = 0.9126, lr_0 = 1.2139e-04
Validation prc-auc = 0.562476
Validation auc = 0.838028
Epoch 27
Loss = 1.3480e-01, PNorm = 77.1146, GNorm = 1.1574, lr_0 = 1.1753e-04
Loss = 2.0922e-01, PNorm = 77.1259, GNorm = 1.2046, lr_0 = 1.1413e-04
Loss = 1.6836e-01, PNorm = 77.1417, GNorm = 1.2530, lr_0 = 1.1083e-04
Validation prc-auc = 0.562478
Validation auc = 0.833547
Epoch 28
Loss = 1.9972e-01, PNorm = 77.1561, GNorm = 0.9259, lr_0 = 1.0730e-04
Loss = 1.9127e-01, PNorm = 77.1699, GNorm = 2.4004, lr_0 = 1.0420e-04
Loss = 1.9315e-01, PNorm = 77.1828, GNorm = 1.1828, lr_0 = 1.0118e-04
Validation prc-auc = 0.572068
Validation auc = 0.836748
Epoch 29
Loss = 1.6815e-01, PNorm = 77.1983, GNorm = 0.7974, lr_0 = 1.0000e-04
Loss = 2.0851e-01, PNorm = 77.2106, GNorm = 1.0905, lr_0 = 1.0000e-04
Loss = 1.8946e-01, PNorm = 77.2244, GNorm = 1.1070, lr_0 = 1.0000e-04
Validation prc-auc = 0.562358
Validation auc = 0.834187
Model 0 best validation prc-auc = 0.585572 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.660888
Model 0 test auc = 0.790157
Ensemble test prc-auc = 0.660888
Ensemble test auc = 0.790157
Fold 43
Splitting data with seed 43
Total scaffolds = 870 | train scaffolds = 630 | val scaffolds = 125 | test scaffolds = 115
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 8.1118e-01, PNorm = 72.7563, GNorm = 1.7903, lr_0 = 1.0000e-03
Loss = 4.6851e-01, PNorm = 73.1488, GNorm = 0.5625, lr_0 = 1.0000e-03
Validation prc-auc = 0.548291
Validation auc = 0.758107
Epoch 1
Loss = 3.9554e-01, PNorm = 73.3766, GNorm = 0.5253, lr_0 = 1.0000e-03
Loss = 4.4666e-01, PNorm = 73.4894, GNorm = 0.4472, lr_0 = 1.0000e-03
Loss = 4.3113e-01, PNorm = 73.5603, GNorm = 0.4969, lr_0 = 1.0000e-03
Validation prc-auc = 0.655070
Validation auc = 0.806938
Epoch 2
Loss = 3.9517e-01, PNorm = 73.6246, GNorm = 0.4262, lr_0 = 9.7965e-04
Loss = 4.3199e-01, PNorm = 73.6701, GNorm = 0.4888, lr_0 = 9.5130e-04
Loss = 4.2907e-01, PNorm = 73.7228, GNorm = 0.7222, lr_0 = 9.2376e-04
Validation prc-auc = 0.671309
Validation auc = 0.821644
Epoch 3
Loss = 4.3335e-01, PNorm = 73.7870, GNorm = 0.5412, lr_0 = 8.9440e-04
Loss = 4.3690e-01, PNorm = 73.8493, GNorm = 1.1734, lr_0 = 8.6851e-04
Loss = 3.7738e-01, PNorm = 73.9008, GNorm = 0.5478, lr_0 = 8.4337e-04
Validation prc-auc = 0.716612
Validation auc = 0.854449
Epoch 4
Loss = 4.1008e-01, PNorm = 73.9592, GNorm = 0.6144, lr_0 = 8.1656e-04
Loss = 3.4589e-01, PNorm = 74.0201, GNorm = 1.3810, lr_0 = 7.9293e-04
Loss = 4.2372e-01, PNorm = 74.0735, GNorm = 0.5030, lr_0 = 7.6998e-04
Loss = 5.9818e-01, PNorm = 74.0799, GNorm = 2.5332, lr_0 = 7.6772e-04
Validation prc-auc = 0.710346
Validation auc = 0.855392
Epoch 5
Loss = 3.7264e-01, PNorm = 74.1451, GNorm = 0.5142, lr_0 = 7.4550e-04
Loss = 4.1057e-01, PNorm = 74.2054, GNorm = 0.5719, lr_0 = 7.2393e-04
Validation prc-auc = 0.725434
Validation auc = 0.854638
Epoch 6
Loss = 3.9162e-01, PNorm = 74.2763, GNorm = 0.5595, lr_0 = 7.0091e-04
Loss = 3.5432e-01, PNorm = 74.3452, GNorm = 0.6204, lr_0 = 6.8063e-04
Loss = 3.7387e-01, PNorm = 74.4244, GNorm = 0.6030, lr_0 = 6.6093e-04
Validation prc-auc = 0.723685
Validation auc = 0.860671
Epoch 7
Loss = 3.0946e-01, PNorm = 74.5019, GNorm = 0.6600, lr_0 = 6.3992e-04
Loss = 4.0980e-01, PNorm = 74.5650, GNorm = 0.6221, lr_0 = 6.2139e-04
Loss = 3.5511e-01, PNorm = 74.6290, GNorm = 0.6154, lr_0 = 6.0341e-04
Validation prc-auc = 0.724952
Validation auc = 0.860294
Epoch 8
Loss = 3.6661e-01, PNorm = 74.6814, GNorm = 0.7498, lr_0 = 5.8595e-04
Loss = 3.6065e-01, PNorm = 74.7436, GNorm = 0.6612, lr_0 = 5.6899e-04
Loss = 3.8967e-01, PNorm = 74.7958, GNorm = 0.8240, lr_0 = 5.5252e-04
Validation prc-auc = 0.733378
Validation auc = 0.862557
Epoch 9
Loss = 3.3335e-01, PNorm = 74.8604, GNorm = 0.4950, lr_0 = 5.3495e-04
Loss = 3.3822e-01, PNorm = 74.9191, GNorm = 0.7566, lr_0 = 5.1947e-04
Loss = 3.3570e-01, PNorm = 74.9796, GNorm = 0.6062, lr_0 = 5.0444e-04
Validation prc-auc = 0.739852
Validation auc = 0.868778
Epoch 10
Loss = 3.8153e-01, PNorm = 75.0568, GNorm = 0.6227, lr_0 = 4.8840e-04
Loss = 3.2570e-01, PNorm = 75.1335, GNorm = 0.4765, lr_0 = 4.7426e-04
Validation prc-auc = 0.731656
Validation auc = 0.860294
Epoch 11
Loss = 3.2933e-01, PNorm = 75.1914, GNorm = 0.5120, lr_0 = 4.5919e-04
Loss = 3.7103e-01, PNorm = 75.2392, GNorm = 1.7706, lr_0 = 4.4590e-04
Loss = 3.0154e-01, PNorm = 75.2814, GNorm = 0.5971, lr_0 = 4.3299e-04
Validation prc-auc = 0.748381
Validation auc = 0.870287
Epoch 12
Loss = 2.5205e-01, PNorm = 75.3327, GNorm = 0.6060, lr_0 = 4.1923e-04
Loss = 3.4711e-01, PNorm = 75.3704, GNorm = 0.7421, lr_0 = 4.0709e-04
Loss = 3.4550e-01, PNorm = 75.4245, GNorm = 1.4336, lr_0 = 3.9531e-04
Validation prc-auc = 0.756050
Validation auc = 0.870098
Epoch 13
Loss = 2.7120e-01, PNorm = 75.4685, GNorm = 0.6207, lr_0 = 3.8274e-04
Loss = 3.4513e-01, PNorm = 75.5198, GNorm = 0.8713, lr_0 = 3.7167e-04
Loss = 3.3541e-01, PNorm = 75.5640, GNorm = 0.9124, lr_0 = 3.6091e-04
Validation prc-auc = 0.752774
Validation auc = 0.872738
Epoch 14
Loss = 3.3958e-01, PNorm = 75.6153, GNorm = 0.8341, lr_0 = 3.4944e-04
Loss = 3.0759e-01, PNorm = 75.6614, GNorm = 0.6115, lr_0 = 3.3932e-04
Loss = 2.8015e-01, PNorm = 75.7075, GNorm = 0.8092, lr_0 = 3.2950e-04
Validation prc-auc = 0.754296
Validation auc = 0.868967
Epoch 15
Loss = 3.2356e-01, PNorm = 75.7558, GNorm = 0.6900, lr_0 = 3.1996e-04
Loss = 2.9198e-01, PNorm = 75.7999, GNorm = 0.8645, lr_0 = 3.1070e-04
Loss = 2.9222e-01, PNorm = 75.8402, GNorm = 1.0641, lr_0 = 3.0171e-04
Loss = 2.1453e-01, PNorm = 75.8446, GNorm = 2.3510, lr_0 = 3.0083e-04
Validation prc-auc = 0.709434
Validation auc = 0.869721
Epoch 16
Loss = 2.8044e-01, PNorm = 75.8998, GNorm = 0.7394, lr_0 = 2.9212e-04
Loss = 2.9675e-01, PNorm = 75.9401, GNorm = 0.7507, lr_0 = 2.8367e-04
Validation prc-auc = 0.732224
Validation auc = 0.876885
Epoch 17
Loss = 3.9380e-01, PNorm = 75.9845, GNorm = 0.9076, lr_0 = 2.7465e-04
Loss = 2.8657e-01, PNorm = 76.0354, GNorm = 0.9141, lr_0 = 2.6670e-04
Loss = 2.8213e-01, PNorm = 76.0729, GNorm = 0.7783, lr_0 = 2.5898e-04
Validation prc-auc = 0.764227
Validation auc = 0.878394
Epoch 18
Loss = 2.4886e-01, PNorm = 76.1126, GNorm = 1.1532, lr_0 = 2.5075e-04
Loss = 2.6859e-01, PNorm = 76.1470, GNorm = 0.9203, lr_0 = 2.4349e-04
Loss = 2.9236e-01, PNorm = 76.1780, GNorm = 1.3098, lr_0 = 2.3644e-04
Validation prc-auc = 0.742105
Validation auc = 0.871606
Epoch 19
Loss = 2.9219e-01, PNorm = 76.2061, GNorm = 0.7410, lr_0 = 2.2893e-04
Loss = 2.7473e-01, PNorm = 76.2387, GNorm = 0.6677, lr_0 = 2.2230e-04
Loss = 2.5823e-01, PNorm = 76.2711, GNorm = 0.8299, lr_0 = 2.1587e-04
Validation prc-auc = 0.761452
Validation auc = 0.877451
Epoch 20
Loss = 2.2972e-01, PNorm = 76.3009, GNorm = 0.6533, lr_0 = 2.0900e-04
Loss = 2.6417e-01, PNorm = 76.3268, GNorm = 1.4354, lr_0 = 2.0295e-04
Loss = 2.5293e-01, PNorm = 76.3524, GNorm = 1.0209, lr_0 = 1.9708e-04
Loss = 1.8456e-01, PNorm = 76.3555, GNorm = 2.4234, lr_0 = 1.9650e-04
Validation prc-auc = 0.723958
Validation auc = 0.863122
Epoch 21
Loss = 2.2973e-01, PNorm = 76.3801, GNorm = 0.7060, lr_0 = 1.9081e-04
Loss = 2.6597e-01, PNorm = 76.4112, GNorm = 1.5169, lr_0 = 1.8529e-04
Validation prc-auc = 0.762403
Validation auc = 0.874434
Epoch 22
Loss = 2.8859e-01, PNorm = 76.4267, GNorm = 1.0089, lr_0 = 1.7993e-04
Loss = 2.8690e-01, PNorm = 76.4545, GNorm = 1.1909, lr_0 = 1.7472e-04
Loss = 2.4551e-01, PNorm = 76.4764, GNorm = 1.3319, lr_0 = 1.6966e-04
Validation prc-auc = 0.754661
Validation auc = 0.880090
Epoch 23
Loss = 1.5909e-01, PNorm = 76.4980, GNorm = 0.8904, lr_0 = 1.6427e-04
Loss = 2.4891e-01, PNorm = 76.5206, GNorm = 0.9019, lr_0 = 1.5952e-04
Loss = 2.7427e-01, PNorm = 76.5391, GNorm = 0.8901, lr_0 = 1.5490e-04
Validation prc-auc = 0.780850
Validation auc = 0.865385
Epoch 24
Loss = 2.7098e-01, PNorm = 76.5594, GNorm = 1.5808, lr_0 = 1.4998e-04
Loss = 2.2845e-01, PNorm = 76.5746, GNorm = 1.0242, lr_0 = 1.4563e-04
Loss = 2.1644e-01, PNorm = 76.5931, GNorm = 0.9065, lr_0 = 1.4142e-04
Validation prc-auc = 0.736635
Validation auc = 0.879713
Epoch 25
Loss = 2.0476e-01, PNorm = 76.6166, GNorm = 0.7047, lr_0 = 1.3692e-04
Loss = 2.5186e-01, PNorm = 76.6320, GNorm = 1.4989, lr_0 = 1.3296e-04
Loss = 2.3196e-01, PNorm = 76.6485, GNorm = 1.4394, lr_0 = 1.2911e-04
Validation prc-auc = 0.766634
Validation auc = 0.881787
Epoch 26
Loss = 2.1141e-01, PNorm = 76.6666, GNorm = 1.2462, lr_0 = 1.2501e-04
Loss = 2.4836e-01, PNorm = 76.6787, GNorm = 0.9979, lr_0 = 1.2139e-04
Validation prc-auc = 0.748777
Validation auc = 0.869155
Epoch 27
Loss = 1.7726e-01, PNorm = 76.6970, GNorm = 1.0168, lr_0 = 1.1753e-04
Loss = 2.3092e-01, PNorm = 76.7104, GNorm = 1.2849, lr_0 = 1.1413e-04
Loss = 2.3626e-01, PNorm = 76.7252, GNorm = 0.9577, lr_0 = 1.1083e-04
Validation prc-auc = 0.739500
Validation auc = 0.871418
Epoch 28
Loss = 1.9128e-01, PNorm = 76.7390, GNorm = 1.1069, lr_0 = 1.0730e-04
Loss = 2.3325e-01, PNorm = 76.7471, GNorm = 1.1193, lr_0 = 1.0420e-04
Loss = 2.3152e-01, PNorm = 76.7621, GNorm = 1.1122, lr_0 = 1.0118e-04
Validation prc-auc = 0.747015
Validation auc = 0.870287
Epoch 29
Loss = 2.0080e-01, PNorm = 76.7752, GNorm = 1.0651, lr_0 = 1.0000e-04
Loss = 2.0069e-01, PNorm = 76.7866, GNorm = 0.9805, lr_0 = 1.0000e-04
Loss = 2.2614e-01, PNorm = 76.7974, GNorm = 0.8818, lr_0 = 1.0000e-04
Validation prc-auc = 0.783537
Validation auc = 0.885558
Model 0 best validation prc-auc = 0.783537 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.622398
Model 0 test auc = 0.803704
Ensemble test prc-auc = 0.622398
Ensemble test auc = 0.803704
Fold 44
Splitting data with seed 44
Total scaffolds = 870 | train scaffolds = 641 | val scaffolds = 109 | test scaffolds = 120
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.9884e-01, PNorm = 72.7813, GNorm = 2.0210, lr_0 = 1.0000e-03
Loss = 4.9878e-01, PNorm = 73.1932, GNorm = 0.4764, lr_0 = 1.0000e-03
Validation prc-auc = 0.365302
Validation auc = 0.721938
Epoch 1
Loss = 4.8925e-01, PNorm = 73.4332, GNorm = 0.4606, lr_0 = 1.0000e-03
Loss = 4.5176e-01, PNorm = 73.5617, GNorm = 0.4053, lr_0 = 1.0000e-03
Loss = 4.2450e-01, PNorm = 73.6419, GNorm = 0.6803, lr_0 = 1.0000e-03
Validation prc-auc = 0.469277
Validation auc = 0.755015
Epoch 2
Loss = 3.9908e-01, PNorm = 73.7005, GNorm = 0.5427, lr_0 = 9.7965e-04
Loss = 4.4167e-01, PNorm = 73.7475, GNorm = 0.7188, lr_0 = 9.5130e-04
Loss = 4.2293e-01, PNorm = 73.7964, GNorm = 0.4604, lr_0 = 9.2376e-04
Validation prc-auc = 0.494664
Validation auc = 0.782757
Epoch 3
Loss = 3.8964e-01, PNorm = 73.8550, GNorm = 0.9344, lr_0 = 8.9440e-04
Loss = 4.1515e-01, PNorm = 73.9025, GNorm = 0.5397, lr_0 = 8.6851e-04
Loss = 4.3015e-01, PNorm = 73.9540, GNorm = 0.5347, lr_0 = 8.4337e-04
Validation prc-auc = 0.507336
Validation auc = 0.800469
Epoch 4
Loss = 3.8966e-01, PNorm = 74.0184, GNorm = 0.7475, lr_0 = 8.1656e-04
Loss = 3.9956e-01, PNorm = 74.0629, GNorm = 0.4943, lr_0 = 7.9293e-04
Loss = 4.1367e-01, PNorm = 74.1202, GNorm = 0.5890, lr_0 = 7.6998e-04
Loss = 2.2590e-01, PNorm = 74.1266, GNorm = 1.0889, lr_0 = 7.6772e-04
Validation prc-auc = 0.535224
Validation auc = 0.815408
Epoch 5
Loss = 4.4280e-01, PNorm = 74.1697, GNorm = 0.8949, lr_0 = 7.4550e-04
Loss = 3.8269e-01, PNorm = 74.2279, GNorm = 0.4336, lr_0 = 7.2393e-04
Validation prc-auc = 0.572957
Validation auc = 0.829065
Epoch 6
Loss = 4.2486e-01, PNorm = 74.2882, GNorm = 0.8581, lr_0 = 7.0091e-04
Loss = 3.6457e-01, PNorm = 74.3498, GNorm = 0.4532, lr_0 = 6.8063e-04
Loss = 3.7941e-01, PNorm = 74.4046, GNorm = 0.5926, lr_0 = 6.6093e-04
Validation prc-auc = 0.553235
Validation auc = 0.825011
Epoch 7
Loss = 3.7215e-01, PNorm = 74.4676, GNorm = 0.6951, lr_0 = 6.3992e-04
Loss = 3.6742e-01, PNorm = 74.5266, GNorm = 0.9567, lr_0 = 6.2139e-04
Loss = 3.7288e-01, PNorm = 74.5902, GNorm = 0.7050, lr_0 = 6.0341e-04
Validation prc-auc = 0.583876
Validation auc = 0.823517
Epoch 8
Loss = 3.2047e-01, PNorm = 74.6468, GNorm = 0.9146, lr_0 = 5.8595e-04
Loss = 3.7705e-01, PNorm = 74.7036, GNorm = 0.6805, lr_0 = 5.6899e-04
Loss = 3.6608e-01, PNorm = 74.7529, GNorm = 0.6415, lr_0 = 5.5252e-04
Validation prc-auc = 0.580969
Validation auc = 0.840802
Epoch 9
Loss = 3.3152e-01, PNorm = 74.8159, GNorm = 0.5952, lr_0 = 5.3495e-04
Loss = 3.7039e-01, PNorm = 74.8721, GNorm = 0.7959, lr_0 = 5.1947e-04
Loss = 3.5889e-01, PNorm = 74.9286, GNorm = 0.6505, lr_0 = 5.0444e-04
Validation prc-auc = 0.607852
Validation auc = 0.857448
Epoch 10
Loss = 3.3316e-01, PNorm = 74.9862, GNorm = 0.6287, lr_0 = 4.8840e-04
Loss = 3.0468e-01, PNorm = 75.0389, GNorm = 1.0778, lr_0 = 4.7426e-04
Validation prc-auc = 0.563042
Validation auc = 0.827785
Epoch 11
Loss = 2.1558e-01, PNorm = 75.1028, GNorm = 0.5741, lr_0 = 4.5919e-04
Loss = 3.1686e-01, PNorm = 75.1590, GNorm = 0.7311, lr_0 = 4.4590e-04
Loss = 3.2145e-01, PNorm = 75.2174, GNorm = 0.7650, lr_0 = 4.3299e-04
Validation prc-auc = 0.532049
Validation auc = 0.819249
Epoch 12
Loss = 3.2150e-01, PNorm = 75.2660, GNorm = 0.7454, lr_0 = 4.1923e-04
Loss = 3.6746e-01, PNorm = 75.3260, GNorm = 0.7886, lr_0 = 4.0709e-04
Loss = 3.1830e-01, PNorm = 75.3748, GNorm = 0.7108, lr_0 = 3.9531e-04
Validation prc-auc = 0.576910
Validation auc = 0.840589
Epoch 13
Loss = 3.1173e-01, PNorm = 75.4308, GNorm = 0.9914, lr_0 = 3.8274e-04
Loss = 2.9131e-01, PNorm = 75.4767, GNorm = 0.6506, lr_0 = 3.7167e-04
Loss = 3.6120e-01, PNorm = 75.5172, GNorm = 1.0832, lr_0 = 3.6091e-04
Validation prc-auc = 0.605194
Validation auc = 0.843150
Epoch 14
Loss = 2.8919e-01, PNorm = 75.5730, GNorm = 0.6948, lr_0 = 3.4944e-04
Loss = 3.2565e-01, PNorm = 75.6198, GNorm = 1.6485, lr_0 = 3.3932e-04
Loss = 3.2221e-01, PNorm = 75.6672, GNorm = 0.7461, lr_0 = 3.2950e-04
Validation prc-auc = 0.573553
Validation auc = 0.834827
Epoch 15
Loss = 2.7495e-01, PNorm = 75.7190, GNorm = 0.8313, lr_0 = 3.1996e-04
Loss = 3.0291e-01, PNorm = 75.7667, GNorm = 1.3712, lr_0 = 3.1070e-04
Loss = 3.1581e-01, PNorm = 75.8017, GNorm = 0.8186, lr_0 = 3.0171e-04
Loss = 1.0375e-01, PNorm = 75.8050, GNorm = 1.0290, lr_0 = 3.0083e-04
Validation prc-auc = 0.610645
Validation auc = 0.838455
Epoch 16
Loss = 2.9530e-01, PNorm = 75.8370, GNorm = 1.1955, lr_0 = 2.9212e-04
Loss = 2.7516e-01, PNorm = 75.8747, GNorm = 0.9257, lr_0 = 2.8367e-04
Validation prc-auc = 0.645275
Validation auc = 0.860435
Epoch 17
Loss = 3.2826e-01, PNorm = 75.9131, GNorm = 1.1112, lr_0 = 2.7465e-04
Loss = 2.3096e-01, PNorm = 75.9531, GNorm = 0.7249, lr_0 = 2.6670e-04
Loss = 2.8011e-01, PNorm = 75.9810, GNorm = 0.8657, lr_0 = 2.5898e-04
Validation prc-auc = 0.589374
Validation auc = 0.834614
Epoch 18
Loss = 2.5150e-01, PNorm = 76.0192, GNorm = 1.0360, lr_0 = 2.5075e-04
Loss = 2.4749e-01, PNorm = 76.0629, GNorm = 0.8537, lr_0 = 2.4349e-04
Loss = 2.9015e-01, PNorm = 76.0944, GNorm = 0.8484, lr_0 = 2.3644e-04
Validation prc-auc = 0.605760
Validation auc = 0.843577
Epoch 19
Loss = 2.4499e-01, PNorm = 76.1283, GNorm = 0.9139, lr_0 = 2.2893e-04
Loss = 2.9591e-01, PNorm = 76.1579, GNorm = 1.4487, lr_0 = 2.2230e-04
Loss = 2.6174e-01, PNorm = 76.1810, GNorm = 1.0367, lr_0 = 2.1587e-04
Validation prc-auc = 0.629207
Validation auc = 0.844003
Epoch 20
Loss = 2.7656e-01, PNorm = 76.2091, GNorm = 1.1003, lr_0 = 2.0900e-04
Loss = 2.4745e-01, PNorm = 76.2348, GNorm = 1.0106, lr_0 = 2.0295e-04
Loss = 2.7144e-01, PNorm = 76.2629, GNorm = 1.1827, lr_0 = 1.9708e-04
Loss = 1.9583e-01, PNorm = 76.2660, GNorm = 2.2365, lr_0 = 1.9650e-04
Validation prc-auc = 0.646229
Validation auc = 0.855741
Epoch 21
Loss = 2.9540e-01, PNorm = 76.2905, GNorm = 0.9843, lr_0 = 1.9081e-04
Loss = 2.4262e-01, PNorm = 76.3116, GNorm = 1.3951, lr_0 = 1.8529e-04
Validation prc-auc = 0.610936
Validation auc = 0.837601
Epoch 22
Loss = 2.1244e-01, PNorm = 76.3340, GNorm = 1.2096, lr_0 = 1.7993e-04
Loss = 2.3326e-01, PNorm = 76.3533, GNorm = 1.0208, lr_0 = 1.7472e-04
Loss = 2.2939e-01, PNorm = 76.3771, GNorm = 0.7412, lr_0 = 1.6966e-04
Validation prc-auc = 0.620057
Validation auc = 0.851899
Epoch 23
Loss = 2.3200e-01, PNorm = 76.3989, GNorm = 0.8835, lr_0 = 1.6427e-04
Loss = 2.3372e-01, PNorm = 76.4206, GNorm = 1.6216, lr_0 = 1.5952e-04
Loss = 2.2342e-01, PNorm = 76.4383, GNorm = 1.2446, lr_0 = 1.5490e-04
Validation prc-auc = 0.574865
Validation auc = 0.823730
Epoch 24
Loss = 2.0858e-01, PNorm = 76.4596, GNorm = 1.3821, lr_0 = 1.4998e-04
Loss = 2.5343e-01, PNorm = 76.4770, GNorm = 1.0966, lr_0 = 1.4563e-04
Loss = 2.2833e-01, PNorm = 76.4967, GNorm = 1.0164, lr_0 = 1.4142e-04
Validation prc-auc = 0.617044
Validation auc = 0.849765
Epoch 25
Loss = 2.0100e-01, PNorm = 76.5143, GNorm = 1.0840, lr_0 = 1.3692e-04
Loss = 2.2244e-01, PNorm = 76.5299, GNorm = 1.1274, lr_0 = 1.3296e-04
Loss = 2.3554e-01, PNorm = 76.5466, GNorm = 1.5740, lr_0 = 1.2911e-04
Validation prc-auc = 0.612757
Validation auc = 0.836534
Epoch 26
Loss = 1.9755e-01, PNorm = 76.5688, GNorm = 1.1052, lr_0 = 1.2501e-04
Loss = 2.5289e-01, PNorm = 76.5799, GNorm = 2.3593, lr_0 = 1.2139e-04
Validation prc-auc = 0.625035
Validation auc = 0.841869
Epoch 27
Loss = 2.4227e-01, PNorm = 76.5969, GNorm = 1.4538, lr_0 = 1.1753e-04
Loss = 2.3642e-01, PNorm = 76.6078, GNorm = 0.9860, lr_0 = 1.1413e-04
Loss = 2.2042e-01, PNorm = 76.6219, GNorm = 1.3113, lr_0 = 1.1083e-04
Validation prc-auc = 0.649973
Validation auc = 0.862569
Epoch 28
Loss = 1.5157e-01, PNorm = 76.6345, GNorm = 0.6476, lr_0 = 1.0730e-04
Loss = 2.0838e-01, PNorm = 76.6467, GNorm = 1.3497, lr_0 = 1.0420e-04
Loss = 2.4839e-01, PNorm = 76.6590, GNorm = 1.0038, lr_0 = 1.0118e-04
Validation prc-auc = 0.635714
Validation auc = 0.846778
Epoch 29
Loss = 1.7162e-01, PNorm = 76.6722, GNorm = 1.3596, lr_0 = 1.0000e-04
Loss = 2.0834e-01, PNorm = 76.6819, GNorm = 0.8929, lr_0 = 1.0000e-04
Loss = 2.0666e-01, PNorm = 76.6922, GNorm = 1.5325, lr_0 = 1.0000e-04
Validation prc-auc = 0.630762
Validation auc = 0.844430
Model 0 best validation prc-auc = 0.649973 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.575120
Model 0 test auc = 0.779730
Ensemble test prc-auc = 0.575120
Ensemble test auc = 0.779730
Fold 45
Splitting data with seed 45
Total scaffolds = 870 | train scaffolds = 675 | val scaffolds = 89 | test scaffolds = 106
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.6376e-01, PNorm = 72.7616, GNorm = 0.7152, lr_0 = 1.0000e-03
Loss = 4.5937e-01, PNorm = 73.1646, GNorm = 0.5801, lr_0 = 1.0000e-03
Validation prc-auc = 0.289832
Validation auc = 0.638889
Epoch 1
Loss = 4.5402e-01, PNorm = 73.3984, GNorm = 1.1424, lr_0 = 1.0000e-03
Loss = 4.3277e-01, PNorm = 73.5284, GNorm = 0.8052, lr_0 = 1.0000e-03
Loss = 4.0779e-01, PNorm = 73.6117, GNorm = 0.5309, lr_0 = 1.0000e-03
Validation prc-auc = 0.270504
Validation auc = 0.652653
Epoch 2
Loss = 4.0168e-01, PNorm = 73.6843, GNorm = 0.6130, lr_0 = 9.7965e-04
Loss = 4.1005e-01, PNorm = 73.7404, GNorm = 0.7443, lr_0 = 9.5130e-04
Loss = 4.1437e-01, PNorm = 73.7957, GNorm = 1.2679, lr_0 = 9.2376e-04
Validation prc-auc = 0.337140
Validation auc = 0.673924
Epoch 3
Loss = 3.6825e-01, PNorm = 73.8595, GNorm = 0.6567, lr_0 = 8.9440e-04
Loss = 3.7730e-01, PNorm = 73.9183, GNorm = 0.4758, lr_0 = 8.6851e-04
Loss = 4.0604e-01, PNorm = 73.9803, GNorm = 0.6256, lr_0 = 8.4337e-04
Validation prc-auc = 0.353922
Validation auc = 0.666917
Epoch 4
Loss = 3.9333e-01, PNorm = 74.0444, GNorm = 0.5540, lr_0 = 8.1656e-04
Loss = 3.9703e-01, PNorm = 74.1165, GNorm = 0.6167, lr_0 = 7.9293e-04
Loss = 3.8981e-01, PNorm = 74.1787, GNorm = 1.4618, lr_0 = 7.6998e-04
Loss = 5.6165e-01, PNorm = 74.1850, GNorm = 2.2608, lr_0 = 7.6772e-04
Validation prc-auc = 0.342829
Validation auc = 0.659159
Epoch 5
Loss = 3.4799e-01, PNorm = 74.2568, GNorm = 0.5228, lr_0 = 7.4550e-04
Loss = 4.0207e-01, PNorm = 74.3247, GNorm = 0.7498, lr_0 = 7.2393e-04
Validation prc-auc = 0.362055
Validation auc = 0.679930
Epoch 6
Loss = 3.1658e-01, PNorm = 74.3904, GNorm = 0.5186, lr_0 = 7.0091e-04
Loss = 3.9744e-01, PNorm = 74.4551, GNorm = 0.6310, lr_0 = 6.8063e-04
Loss = 4.0307e-01, PNorm = 74.5186, GNorm = 0.6099, lr_0 = 6.6093e-04
Validation prc-auc = 0.355340
Validation auc = 0.679429
Epoch 7
Loss = 3.3088e-01, PNorm = 74.5903, GNorm = 0.6456, lr_0 = 6.3992e-04
Loss = 3.8804e-01, PNorm = 74.6492, GNorm = 0.6815, lr_0 = 6.2139e-04
Loss = 3.7694e-01, PNorm = 74.6928, GNorm = 0.6433, lr_0 = 6.0341e-04
Validation prc-auc = 0.394725
Validation auc = 0.716466
Epoch 8
Loss = 3.3695e-01, PNorm = 74.7488, GNorm = 1.0085, lr_0 = 5.8595e-04
Loss = 3.3818e-01, PNorm = 74.8013, GNorm = 0.7478, lr_0 = 5.6899e-04
Loss = 3.6422e-01, PNorm = 74.8536, GNorm = 0.7323, lr_0 = 5.5252e-04
Validation prc-auc = 0.404892
Validation auc = 0.721221
Epoch 9
Loss = 3.1857e-01, PNorm = 74.9282, GNorm = 0.8360, lr_0 = 5.3495e-04
Loss = 3.8011e-01, PNorm = 74.9779, GNorm = 0.6454, lr_0 = 5.1947e-04
Loss = 3.4561e-01, PNorm = 75.0326, GNorm = 0.7951, lr_0 = 5.0444e-04
Validation prc-auc = 0.389665
Validation auc = 0.723473
Epoch 10
Loss = 2.9611e-01, PNorm = 75.0955, GNorm = 0.6927, lr_0 = 4.8840e-04
Loss = 3.4635e-01, PNorm = 75.1557, GNorm = 1.3478, lr_0 = 4.7426e-04
Validation prc-auc = 0.400907
Validation auc = 0.735235
Epoch 11
Loss = 3.3225e-01, PNorm = 75.2144, GNorm = 0.8626, lr_0 = 4.5919e-04
Loss = 3.7176e-01, PNorm = 75.2567, GNorm = 0.8435, lr_0 = 4.4590e-04
Loss = 2.9321e-01, PNorm = 75.3133, GNorm = 0.8213, lr_0 = 4.3299e-04
Validation prc-auc = 0.419771
Validation auc = 0.739990
Epoch 12
Loss = 2.4619e-01, PNorm = 75.3723, GNorm = 0.6246, lr_0 = 4.1923e-04
Loss = 2.9306e-01, PNorm = 75.4262, GNorm = 0.7338, lr_0 = 4.0709e-04
Loss = 3.6660e-01, PNorm = 75.4686, GNorm = 0.9409, lr_0 = 3.9531e-04
Validation prc-auc = 0.431470
Validation auc = 0.760511
Epoch 13
Loss = 3.1065e-01, PNorm = 75.5170, GNorm = 0.7707, lr_0 = 3.8274e-04
Loss = 3.2161e-01, PNorm = 75.5758, GNorm = 0.5708, lr_0 = 3.7167e-04
Loss = 3.0070e-01, PNorm = 75.6256, GNorm = 1.2108, lr_0 = 3.6091e-04
Validation prc-auc = 0.422299
Validation auc = 0.755506
Epoch 14
Loss = 2.9596e-01, PNorm = 75.6748, GNorm = 0.6110, lr_0 = 3.4944e-04
Loss = 2.7630e-01, PNorm = 75.7299, GNorm = 1.2105, lr_0 = 3.3932e-04
Loss = 3.0545e-01, PNorm = 75.7695, GNorm = 0.9299, lr_0 = 3.2950e-04
Validation prc-auc = 0.435922
Validation auc = 0.755005
Epoch 15
Loss = 2.6400e-01, PNorm = 75.8207, GNorm = 0.5869, lr_0 = 3.1996e-04
Loss = 2.9561e-01, PNorm = 75.8677, GNorm = 0.8557, lr_0 = 3.1070e-04
Loss = 2.8305e-01, PNorm = 75.9110, GNorm = 0.7402, lr_0 = 3.0171e-04
Loss = 2.3973e-01, PNorm = 75.9150, GNorm = 1.6617, lr_0 = 3.0083e-04
Validation prc-auc = 0.437124
Validation auc = 0.757758
Epoch 16
Loss = 2.6150e-01, PNorm = 75.9629, GNorm = 1.2233, lr_0 = 2.9212e-04
Loss = 2.7424e-01, PNorm = 76.0117, GNorm = 0.5929, lr_0 = 2.8367e-04
Validation prc-auc = 0.443024
Validation auc = 0.770771
Epoch 17
Loss = 4.7523e-01, PNorm = 76.0532, GNorm = 1.2637, lr_0 = 2.7465e-04
Loss = 2.4594e-01, PNorm = 76.0874, GNorm = 0.6357, lr_0 = 2.6670e-04
Loss = 2.6992e-01, PNorm = 76.1298, GNorm = 0.9256, lr_0 = 2.5898e-04
Validation prc-auc = 0.441086
Validation auc = 0.763764
Epoch 18
Loss = 2.6398e-01, PNorm = 76.1720, GNorm = 0.8082, lr_0 = 2.5075e-04
Loss = 2.7353e-01, PNorm = 76.2097, GNorm = 1.4289, lr_0 = 2.4349e-04
Loss = 2.6792e-01, PNorm = 76.2362, GNorm = 0.9252, lr_0 = 2.3644e-04
Validation prc-auc = 0.453657
Validation auc = 0.767267
Epoch 19
Loss = 2.8058e-01, PNorm = 76.2675, GNorm = 0.7649, lr_0 = 2.2893e-04
Loss = 2.3040e-01, PNorm = 76.3000, GNorm = 0.7520, lr_0 = 2.2230e-04
Loss = 2.5819e-01, PNorm = 76.3264, GNorm = 1.0722, lr_0 = 2.1587e-04
Validation prc-auc = 0.474551
Validation auc = 0.773273
Epoch 20
Loss = 2.6114e-01, PNorm = 76.3626, GNorm = 1.0375, lr_0 = 2.0900e-04
Loss = 2.7278e-01, PNorm = 76.3947, GNorm = 0.9727, lr_0 = 2.0295e-04
Loss = 2.3179e-01, PNorm = 76.4235, GNorm = 0.7433, lr_0 = 1.9708e-04
Loss = 1.9714e-01, PNorm = 76.4263, GNorm = 1.6771, lr_0 = 1.9650e-04
Validation prc-auc = 0.482176
Validation auc = 0.782032
Epoch 21
Loss = 2.3702e-01, PNorm = 76.4509, GNorm = 0.9926, lr_0 = 1.9081e-04
Loss = 2.3529e-01, PNorm = 76.4756, GNorm = 1.1946, lr_0 = 1.8529e-04
Validation prc-auc = 0.490427
Validation auc = 0.784034
Epoch 22
Loss = 3.7121e-01, PNorm = 76.5033, GNorm = 1.4983, lr_0 = 1.7993e-04
Loss = 2.3066e-01, PNorm = 76.5281, GNorm = 1.0682, lr_0 = 1.7472e-04
Loss = 2.1615e-01, PNorm = 76.5541, GNorm = 1.3003, lr_0 = 1.6966e-04
Validation prc-auc = 0.468825
Validation auc = 0.774525
Epoch 23
Loss = 2.1508e-01, PNorm = 76.5757, GNorm = 1.1041, lr_0 = 1.6427e-04
Loss = 2.1801e-01, PNorm = 76.5979, GNorm = 0.9832, lr_0 = 1.5952e-04
Loss = 2.1972e-01, PNorm = 76.6183, GNorm = 1.3684, lr_0 = 1.5490e-04
Validation prc-auc = 0.482627
Validation auc = 0.773273
Epoch 24
Loss = 2.3748e-01, PNorm = 76.6427, GNorm = 1.2116, lr_0 = 1.4998e-04
Loss = 2.3410e-01, PNorm = 76.6578, GNorm = 1.0887, lr_0 = 1.4563e-04
Loss = 2.4057e-01, PNorm = 76.6784, GNorm = 1.2697, lr_0 = 1.4142e-04
Validation prc-auc = 0.503195
Validation auc = 0.785786
Epoch 25
Loss = 2.2262e-01, PNorm = 76.7047, GNorm = 1.0799, lr_0 = 1.3692e-04
Loss = 1.9549e-01, PNorm = 76.7240, GNorm = 1.4068, lr_0 = 1.3296e-04
Loss = 2.3934e-01, PNorm = 76.7404, GNorm = 1.2373, lr_0 = 1.2911e-04
Validation prc-auc = 0.468968
Validation auc = 0.770020
Epoch 26
Loss = 1.9621e-01, PNorm = 76.7632, GNorm = 1.3549, lr_0 = 1.2501e-04
Loss = 2.0497e-01, PNorm = 76.7773, GNorm = 1.3492, lr_0 = 1.2139e-04
Validation prc-auc = 0.480836
Validation auc = 0.773273
Epoch 27
Loss = 4.3192e-01, PNorm = 76.7910, GNorm = 1.5650, lr_0 = 1.1753e-04
Loss = 2.1443e-01, PNorm = 76.8082, GNorm = 0.9655, lr_0 = 1.1413e-04
Loss = 1.8326e-01, PNorm = 76.8261, GNorm = 0.8547, lr_0 = 1.1083e-04
Validation prc-auc = 0.483209
Validation auc = 0.778779
Epoch 28
Loss = 2.2078e-01, PNorm = 76.8401, GNorm = 1.1403, lr_0 = 1.0730e-04
Loss = 1.9282e-01, PNorm = 76.8521, GNorm = 1.0356, lr_0 = 1.0420e-04
Loss = 2.0577e-01, PNorm = 76.8647, GNorm = 0.9321, lr_0 = 1.0118e-04
Validation prc-auc = 0.475539
Validation auc = 0.773273
Epoch 29
Loss = 1.8734e-01, PNorm = 76.8770, GNorm = 1.1333, lr_0 = 1.0000e-04
Loss = 2.0336e-01, PNorm = 76.8878, GNorm = 2.2980, lr_0 = 1.0000e-04
Loss = 1.9905e-01, PNorm = 76.8978, GNorm = 1.3786, lr_0 = 1.0000e-04
Validation prc-auc = 0.500089
Validation auc = 0.785536
Model 0 best validation prc-auc = 0.503195 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.526598
Model 0 test auc = 0.751684
Ensemble test prc-auc = 0.526598
Ensemble test auc = 0.751684
Fold 46
Splitting data with seed 46
Total scaffolds = 870 | train scaffolds = 664 | val scaffolds = 93 | test scaffolds = 113
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.0229e-01, PNorm = 72.7626, GNorm = 1.7421, lr_0 = 1.0000e-03
Loss = 4.9826e-01, PNorm = 73.1602, GNorm = 1.3411, lr_0 = 1.0000e-03
Validation prc-auc = 0.413274
Validation auc = 0.657658
Epoch 1
Loss = 4.9829e-01, PNorm = 73.3965, GNorm = 0.7214, lr_0 = 1.0000e-03
Loss = 4.5315e-01, PNorm = 73.5181, GNorm = 0.7812, lr_0 = 1.0000e-03
Loss = 4.1837e-01, PNorm = 73.5974, GNorm = 0.4895, lr_0 = 1.0000e-03
Validation prc-auc = 0.469763
Validation auc = 0.713474
Epoch 2
Loss = 3.8293e-01, PNorm = 73.6702, GNorm = 0.5859, lr_0 = 9.7965e-04
Loss = 4.4737e-01, PNorm = 73.7305, GNorm = 0.7021, lr_0 = 9.5130e-04
Loss = 4.4319e-01, PNorm = 73.7824, GNorm = 0.6745, lr_0 = 9.2376e-04
Validation prc-auc = 0.473361
Validation auc = 0.752644
Epoch 3
Loss = 3.9588e-01, PNorm = 73.8404, GNorm = 0.5462, lr_0 = 8.9440e-04
Loss = 4.1181e-01, PNorm = 73.8935, GNorm = 0.6898, lr_0 = 8.6851e-04
Loss = 4.1903e-01, PNorm = 73.9503, GNorm = 0.7061, lr_0 = 8.4337e-04
Validation prc-auc = 0.484156
Validation auc = 0.759107
Epoch 4
Loss = 4.2277e-01, PNorm = 74.0180, GNorm = 0.5422, lr_0 = 8.1656e-04
Loss = 3.5687e-01, PNorm = 74.0883, GNorm = 0.7623, lr_0 = 7.9293e-04
Loss = 4.2532e-01, PNorm = 74.1477, GNorm = 0.5928, lr_0 = 7.6998e-04
Loss = 3.3859e-01, PNorm = 74.1544, GNorm = 1.4047, lr_0 = 7.6772e-04
Validation prc-auc = 0.492132
Validation auc = 0.736584
Epoch 5
Loss = 4.2365e-01, PNorm = 74.2167, GNorm = 0.5592, lr_0 = 7.4550e-04
Loss = 3.8229e-01, PNorm = 74.2911, GNorm = 0.4787, lr_0 = 7.2393e-04
Validation prc-auc = 0.522148
Validation auc = 0.739522
Epoch 6
Loss = 3.1308e-01, PNorm = 74.3604, GNorm = 0.4991, lr_0 = 7.0091e-04
Loss = 3.7541e-01, PNorm = 74.4261, GNorm = 1.4575, lr_0 = 6.8063e-04
Loss = 3.8584e-01, PNorm = 74.4921, GNorm = 0.6717, lr_0 = 6.6093e-04
Validation prc-auc = 0.574318
Validation auc = 0.759499
Epoch 7
Loss = 3.7687e-01, PNorm = 74.5560, GNorm = 0.5979, lr_0 = 6.3992e-04
Loss = 3.8360e-01, PNorm = 74.6254, GNorm = 0.5258, lr_0 = 6.2139e-04
Loss = 3.5195e-01, PNorm = 74.6929, GNorm = 0.5477, lr_0 = 6.0341e-04
Validation prc-auc = 0.521608
Validation auc = 0.780063
Epoch 8
Loss = 3.3188e-01, PNorm = 74.7612, GNorm = 0.5845, lr_0 = 5.8595e-04
Loss = 3.8772e-01, PNorm = 74.8349, GNorm = 0.6564, lr_0 = 5.6899e-04
Loss = 3.3932e-01, PNorm = 74.9136, GNorm = 0.7455, lr_0 = 5.5252e-04
Validation prc-auc = 0.571030
Validation auc = 0.783000
Epoch 9
Loss = 3.2852e-01, PNorm = 74.9829, GNorm = 1.0003, lr_0 = 5.3495e-04
Loss = 3.5392e-01, PNorm = 75.0503, GNorm = 0.9115, lr_0 = 5.1947e-04
Loss = 3.6891e-01, PNorm = 75.1189, GNorm = 0.5919, lr_0 = 5.0444e-04
Validation prc-auc = 0.648452
Validation auc = 0.812378
Epoch 10
Loss = 3.6441e-01, PNorm = 75.1900, GNorm = 0.5532, lr_0 = 4.8840e-04
Loss = 3.6068e-01, PNorm = 75.2394, GNorm = 0.6810, lr_0 = 4.7426e-04
Validation prc-auc = 0.634082
Validation auc = 0.814336
Epoch 11
Loss = 2.0926e-01, PNorm = 75.3140, GNorm = 0.5010, lr_0 = 4.5919e-04
Loss = 3.0562e-01, PNorm = 75.3905, GNorm = 0.8284, lr_0 = 4.4590e-04
Loss = 3.7104e-01, PNorm = 75.4444, GNorm = 1.6129, lr_0 = 4.3299e-04
Validation prc-auc = 0.549693
Validation auc = 0.811594
Epoch 12
Loss = 2.9204e-01, PNorm = 75.5113, GNorm = 0.6397, lr_0 = 4.1923e-04
Loss = 3.6472e-01, PNorm = 75.5758, GNorm = 0.8413, lr_0 = 4.0709e-04
Loss = 2.8787e-01, PNorm = 75.6411, GNorm = 0.7225, lr_0 = 3.9531e-04
Validation prc-auc = 0.616273
Validation auc = 0.795339
Epoch 13
Loss = 3.0640e-01, PNorm = 75.7070, GNorm = 0.9397, lr_0 = 3.8274e-04
Loss = 3.2291e-01, PNorm = 75.7701, GNorm = 0.8232, lr_0 = 3.7167e-04
Loss = 3.2830e-01, PNorm = 75.8251, GNorm = 0.8664, lr_0 = 3.6091e-04
Validation prc-auc = 0.579328
Validation auc = 0.803564
Epoch 14
Loss = 3.1237e-01, PNorm = 75.8870, GNorm = 0.9140, lr_0 = 3.4944e-04
Loss = 2.9149e-01, PNorm = 75.9415, GNorm = 0.5746, lr_0 = 3.3932e-04
Loss = 2.8530e-01, PNorm = 75.9834, GNorm = 0.7108, lr_0 = 3.2950e-04
Validation prc-auc = 0.602869
Validation auc = 0.822170
Epoch 15
Loss = 3.0927e-01, PNorm = 76.0372, GNorm = 1.0022, lr_0 = 3.1996e-04
Loss = 2.5133e-01, PNorm = 76.0917, GNorm = 0.5808, lr_0 = 3.1070e-04
Loss = 2.9163e-01, PNorm = 76.1330, GNorm = 0.7636, lr_0 = 3.0171e-04
Loss = 5.3370e-01, PNorm = 76.1372, GNorm = 3.4299, lr_0 = 3.0083e-04
Validation prc-auc = 0.622764
Validation auc = 0.824520
Epoch 16
Loss = 2.7019e-01, PNorm = 76.1823, GNorm = 1.1035, lr_0 = 2.9212e-04
Loss = 2.8889e-01, PNorm = 76.2317, GNorm = 1.5800, lr_0 = 2.8367e-04
Validation prc-auc = 0.624980
Validation auc = 0.834117
Epoch 17
Loss = 3.0278e-01, PNorm = 76.2739, GNorm = 0.9649, lr_0 = 2.7465e-04
Loss = 2.4375e-01, PNorm = 76.3136, GNorm = 0.6714, lr_0 = 2.6670e-04
Loss = 2.5064e-01, PNorm = 76.3588, GNorm = 0.9636, lr_0 = 2.5898e-04
Validation prc-auc = 0.625514
Validation auc = 0.830200
Epoch 18
Loss = 2.8199e-01, PNorm = 76.3943, GNorm = 1.3045, lr_0 = 2.5075e-04
Loss = 2.5489e-01, PNorm = 76.4335, GNorm = 1.0645, lr_0 = 2.4349e-04
Loss = 2.3259e-01, PNorm = 76.4696, GNorm = 1.2168, lr_0 = 2.3644e-04
Validation prc-auc = 0.599527
Validation auc = 0.825695
Epoch 19
Loss = 2.2955e-01, PNorm = 76.5054, GNorm = 0.8521, lr_0 = 2.2893e-04
Loss = 2.0436e-01, PNorm = 76.5380, GNorm = 1.2822, lr_0 = 2.2230e-04
Loss = 2.9532e-01, PNorm = 76.5657, GNorm = 1.6041, lr_0 = 2.1587e-04
Validation prc-auc = 0.559409
Validation auc = 0.807873
Epoch 20
Loss = 2.3909e-01, PNorm = 76.6036, GNorm = 1.3863, lr_0 = 2.0900e-04
Loss = 2.2534e-01, PNorm = 76.6330, GNorm = 1.1890, lr_0 = 2.0295e-04
Loss = 2.6443e-01, PNorm = 76.6638, GNorm = 1.0064, lr_0 = 1.9708e-04
Loss = 1.1222e+00, PNorm = 76.6649, GNorm = 5.9734, lr_0 = 1.9650e-04
Validation prc-auc = 0.570627
Validation auc = 0.818253
Epoch 21
Loss = 2.2435e-01, PNorm = 76.6918, GNorm = 0.8409, lr_0 = 1.9081e-04
Loss = 2.3653e-01, PNorm = 76.7232, GNorm = 1.0542, lr_0 = 1.8529e-04
Validation prc-auc = 0.604034
Validation auc = 0.834117
Epoch 22
Loss = 2.3343e-01, PNorm = 76.7498, GNorm = 0.9158, lr_0 = 1.7993e-04
Loss = 2.3668e-01, PNorm = 76.7796, GNorm = 0.6618, lr_0 = 1.7472e-04
Loss = 2.1709e-01, PNorm = 76.8002, GNorm = 0.9382, lr_0 = 1.6966e-04
Validation prc-auc = 0.565824
Validation auc = 0.817861
Epoch 23
Loss = 2.4337e-01, PNorm = 76.8247, GNorm = 2.2151, lr_0 = 1.6427e-04
Loss = 2.1829e-01, PNorm = 76.8478, GNorm = 1.2854, lr_0 = 1.5952e-04
Loss = 2.2946e-01, PNorm = 76.8717, GNorm = 1.1669, lr_0 = 1.5490e-04
Validation prc-auc = 0.576720
Validation auc = 0.814532
Epoch 24
Loss = 2.3498e-01, PNorm = 76.8928, GNorm = 0.9725, lr_0 = 1.4998e-04
Loss = 2.3614e-01, PNorm = 76.9141, GNorm = 1.4116, lr_0 = 1.4563e-04
Loss = 2.1076e-01, PNorm = 76.9329, GNorm = 1.5410, lr_0 = 1.4142e-04
Validation prc-auc = 0.571175
Validation auc = 0.815511
Epoch 25
Loss = 2.0536e-01, PNorm = 76.9518, GNorm = 1.2556, lr_0 = 1.3692e-04
Loss = 1.9614e-01, PNorm = 76.9698, GNorm = 1.3060, lr_0 = 1.3296e-04
Loss = 2.0266e-01, PNorm = 76.9855, GNorm = 1.2564, lr_0 = 1.2911e-04
Validation prc-auc = 0.571452
Validation auc = 0.809244
Epoch 26
Loss = 1.9986e-01, PNorm = 77.0016, GNorm = 1.0610, lr_0 = 1.2501e-04
Loss = 2.1209e-01, PNorm = 77.0175, GNorm = 1.5360, lr_0 = 1.2139e-04
Validation prc-auc = 0.574452
Validation auc = 0.826087
Epoch 27
Loss = 2.4185e-01, PNorm = 77.0359, GNorm = 1.2294, lr_0 = 1.1753e-04
Loss = 1.9349e-01, PNorm = 77.0504, GNorm = 0.8671, lr_0 = 1.1413e-04
Loss = 1.9540e-01, PNorm = 77.0664, GNorm = 1.4694, lr_0 = 1.1083e-04
Validation prc-auc = 0.551726
Validation auc = 0.802977
Epoch 28
Loss = 2.0526e-01, PNorm = 77.0812, GNorm = 1.6119, lr_0 = 1.0730e-04
Loss = 2.1439e-01, PNorm = 77.0967, GNorm = 1.4358, lr_0 = 1.0420e-04
Loss = 1.7383e-01, PNorm = 77.1115, GNorm = 0.9527, lr_0 = 1.0118e-04
Validation prc-auc = 0.593602
Validation auc = 0.819428
Epoch 29
Loss = 2.1772e-01, PNorm = 77.1217, GNorm = 2.1464, lr_0 = 1.0000e-04
Loss = 2.0624e-01, PNorm = 77.1348, GNorm = 1.6101, lr_0 = 1.0000e-04
Loss = 1.9037e-01, PNorm = 77.1477, GNorm = 1.5521, lr_0 = 1.0000e-04
Validation prc-auc = 0.577528
Validation auc = 0.812573
Model 0 best validation prc-auc = 0.648452 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.483801
Model 0 test auc = 0.768670
Ensemble test prc-auc = 0.483801
Ensemble test auc = 0.768670
Fold 47
Splitting data with seed 47
Total scaffolds = 870 | train scaffolds = 625 | val scaffolds = 131 | test scaffolds = 114
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.000000


Scaffold 9
Task 0: count = 10 | target average = 0.200000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 7.0373e-01, PNorm = 72.7669, GNorm = 0.5787, lr_0 = 1.0000e-03
Loss = 4.6066e-01, PNorm = 73.1710, GNorm = 0.6088, lr_0 = 1.0000e-03
Validation prc-auc = 0.391769
Validation auc = 0.682245
Epoch 1
Loss = 3.4492e-01, PNorm = 73.4094, GNorm = 0.6633, lr_0 = 1.0000e-03
Loss = 5.0672e-01, PNorm = 73.5288, GNorm = 2.9282, lr_0 = 1.0000e-03
Loss = 4.8177e-01, PNorm = 73.6219, GNorm = 0.5286, lr_0 = 1.0000e-03
Validation prc-auc = 0.420888
Validation auc = 0.717551
Epoch 2
Loss = 4.3321e-01, PNorm = 73.6979, GNorm = 0.7797, lr_0 = 9.7965e-04
Loss = 4.5131e-01, PNorm = 73.7577, GNorm = 0.5161, lr_0 = 9.5130e-04
Loss = 4.0412e-01, PNorm = 73.8107, GNorm = 0.8430, lr_0 = 9.2376e-04
Validation prc-auc = 0.460493
Validation auc = 0.714082
Epoch 3
Loss = 3.6431e-01, PNorm = 73.8715, GNorm = 0.6575, lr_0 = 8.9440e-04
Loss = 4.5437e-01, PNorm = 73.9217, GNorm = 0.5270, lr_0 = 8.6851e-04
Loss = 4.0167e-01, PNorm = 73.9809, GNorm = 0.5287, lr_0 = 8.4337e-04
Validation prc-auc = 0.479332
Validation auc = 0.728367
Epoch 4
Loss = 3.6709e-01, PNorm = 74.0529, GNorm = 0.9618, lr_0 = 8.1656e-04
Loss = 3.7496e-01, PNorm = 74.1168, GNorm = 0.6836, lr_0 = 7.9293e-04
Loss = 3.9774e-01, PNorm = 74.1791, GNorm = 0.9851, lr_0 = 7.6998e-04
Loss = 4.6205e-01, PNorm = 74.1840, GNorm = 2.0093, lr_0 = 7.6772e-04
Validation prc-auc = 0.506179
Validation auc = 0.745306
Epoch 5
Loss = 3.5319e-01, PNorm = 74.2595, GNorm = 0.5381, lr_0 = 7.4550e-04
Loss = 4.0226e-01, PNorm = 74.3151, GNorm = 0.8727, lr_0 = 7.2393e-04
Validation prc-auc = 0.514154
Validation auc = 0.747551
Epoch 6
Loss = 3.4712e-01, PNorm = 74.3880, GNorm = 0.6913, lr_0 = 7.0091e-04
Loss = 3.5393e-01, PNorm = 74.4501, GNorm = 0.6669, lr_0 = 6.8063e-04
Loss = 3.7839e-01, PNorm = 74.5205, GNorm = 0.6264, lr_0 = 6.6093e-04
Validation prc-auc = 0.542852
Validation auc = 0.751633
Epoch 7
Loss = 4.0967e-01, PNorm = 74.5945, GNorm = 0.8075, lr_0 = 6.3992e-04
Loss = 3.7268e-01, PNorm = 74.6706, GNorm = 0.6781, lr_0 = 6.2139e-04
Loss = 3.4519e-01, PNorm = 74.7359, GNorm = 0.6113, lr_0 = 6.0341e-04
Validation prc-auc = 0.526404
Validation auc = 0.753061
Epoch 8
Loss = 3.6380e-01, PNorm = 74.8008, GNorm = 0.6148, lr_0 = 5.8595e-04
Loss = 3.5389e-01, PNorm = 74.8695, GNorm = 0.7045, lr_0 = 5.6899e-04
Loss = 3.8547e-01, PNorm = 74.9322, GNorm = 0.8151, lr_0 = 5.5252e-04
Validation prc-auc = 0.536397
Validation auc = 0.767347
Epoch 9
Loss = 3.5752e-01, PNorm = 75.0094, GNorm = 0.7988, lr_0 = 5.3495e-04
Loss = 3.6962e-01, PNorm = 75.0861, GNorm = 0.8411, lr_0 = 5.1947e-04
Loss = 3.4044e-01, PNorm = 75.1498, GNorm = 0.5349, lr_0 = 5.0444e-04
Validation prc-auc = 0.508396
Validation auc = 0.774286
Epoch 10
Loss = 3.0282e-01, PNorm = 75.2137, GNorm = 0.6032, lr_0 = 4.8840e-04
Loss = 3.3563e-01, PNorm = 75.2755, GNorm = 0.6534, lr_0 = 4.7426e-04
Validation prc-auc = 0.565039
Validation auc = 0.791224
Epoch 11
Loss = 2.9245e-01, PNorm = 75.3356, GNorm = 0.6808, lr_0 = 4.5919e-04
Loss = 3.1022e-01, PNorm = 75.3930, GNorm = 0.7114, lr_0 = 4.4590e-04
Loss = 3.3483e-01, PNorm = 75.4441, GNorm = 1.2116, lr_0 = 4.3299e-04
Validation prc-auc = 0.543383
Validation auc = 0.769796
Epoch 12
Loss = 3.5052e-01, PNorm = 75.5063, GNorm = 0.8982, lr_0 = 4.1923e-04
Loss = 3.2544e-01, PNorm = 75.5720, GNorm = 1.1458, lr_0 = 4.0709e-04
Loss = 2.7035e-01, PNorm = 75.6261, GNorm = 0.9393, lr_0 = 3.9531e-04
Validation prc-auc = 0.577650
Validation auc = 0.794286
Epoch 13
Loss = 2.6636e-01, PNorm = 75.6818, GNorm = 1.0481, lr_0 = 3.8274e-04
Loss = 2.7446e-01, PNorm = 75.7373, GNorm = 0.6758, lr_0 = 3.7167e-04
Loss = 3.5722e-01, PNorm = 75.7882, GNorm = 0.8255, lr_0 = 3.6091e-04
Validation prc-auc = 0.568595
Validation auc = 0.772857
Epoch 14
Loss = 3.1549e-01, PNorm = 75.8382, GNorm = 0.7997, lr_0 = 3.4944e-04
Loss = 3.2579e-01, PNorm = 75.8922, GNorm = 0.8793, lr_0 = 3.3932e-04
Loss = 2.7178e-01, PNorm = 75.9419, GNorm = 0.6445, lr_0 = 3.2950e-04
Validation prc-auc = 0.574632
Validation auc = 0.789388
Epoch 15
Loss = 3.2374e-01, PNorm = 75.9965, GNorm = 1.6628, lr_0 = 3.1996e-04
Loss = 2.6575e-01, PNorm = 76.0486, GNorm = 0.8031, lr_0 = 3.1070e-04
Loss = 3.2564e-01, PNorm = 76.0921, GNorm = 0.9713, lr_0 = 3.0171e-04
Loss = 1.9344e-01, PNorm = 76.0967, GNorm = 2.1966, lr_0 = 3.0083e-04
Validation prc-auc = 0.567202
Validation auc = 0.774898
Epoch 16
Loss = 2.7023e-01, PNorm = 76.1362, GNorm = 0.9274, lr_0 = 2.9212e-04
Loss = 3.0731e-01, PNorm = 76.1821, GNorm = 0.9683, lr_0 = 2.8367e-04
Validation prc-auc = 0.607947
Validation auc = 0.802245
Epoch 17
Loss = 2.6446e-01, PNorm = 76.2175, GNorm = 0.7204, lr_0 = 2.7465e-04
Loss = 2.7053e-01, PNorm = 76.2558, GNorm = 1.0170, lr_0 = 2.6670e-04
Loss = 2.3753e-01, PNorm = 76.3002, GNorm = 0.7762, lr_0 = 2.5898e-04
Validation prc-auc = 0.589690
Validation auc = 0.798367
Epoch 18
Loss = 2.5522e-01, PNorm = 76.3308, GNorm = 1.2171, lr_0 = 2.5075e-04
Loss = 2.4460e-01, PNorm = 76.3708, GNorm = 0.8352, lr_0 = 2.4349e-04
Loss = 2.7625e-01, PNorm = 76.4094, GNorm = 1.3077, lr_0 = 2.3644e-04
Validation prc-auc = 0.595477
Validation auc = 0.800204
Epoch 19
Loss = 2.1804e-01, PNorm = 76.4497, GNorm = 0.7842, lr_0 = 2.2893e-04
Loss = 2.8186e-01, PNorm = 76.4750, GNorm = 1.1351, lr_0 = 2.2230e-04
Loss = 2.5877e-01, PNorm = 76.5073, GNorm = 0.8470, lr_0 = 2.1587e-04
Validation prc-auc = 0.593321
Validation auc = 0.792857
Epoch 20
Loss = 2.3129e-01, PNorm = 76.5452, GNorm = 0.8280, lr_0 = 2.0900e-04
Loss = 2.7444e-01, PNorm = 76.5725, GNorm = 1.6737, lr_0 = 2.0295e-04
Loss = 2.5034e-01, PNorm = 76.5974, GNorm = 0.8473, lr_0 = 1.9708e-04
Loss = 7.0880e-02, PNorm = 76.5998, GNorm = 1.4305, lr_0 = 1.9650e-04
Validation prc-auc = 0.583493
Validation auc = 0.791429
Epoch 21
Loss = 2.4089e-01, PNorm = 76.6224, GNorm = 0.6429, lr_0 = 1.9081e-04
Loss = 2.3215e-01, PNorm = 76.6492, GNorm = 0.7091, lr_0 = 1.8529e-04
Validation prc-auc = 0.607220
Validation auc = 0.800000
Epoch 22
Loss = 1.7538e-01, PNorm = 76.6741, GNorm = 0.8698, lr_0 = 1.7993e-04
Loss = 1.9644e-01, PNorm = 76.7040, GNorm = 0.8007, lr_0 = 1.7472e-04
Loss = 2.3870e-01, PNorm = 76.7240, GNorm = 1.3357, lr_0 = 1.6966e-04
Validation prc-auc = 0.606905
Validation auc = 0.794286
Epoch 23
Loss = 2.5145e-01, PNorm = 76.7517, GNorm = 1.2798, lr_0 = 1.6427e-04
Loss = 2.3177e-01, PNorm = 76.7710, GNorm = 1.3699, lr_0 = 1.5952e-04
Loss = 2.1712e-01, PNorm = 76.7903, GNorm = 1.2312, lr_0 = 1.5490e-04
Validation prc-auc = 0.590395
Validation auc = 0.801633
Epoch 24
Loss = 2.2622e-01, PNorm = 76.8142, GNorm = 1.3574, lr_0 = 1.4998e-04
Loss = 2.4487e-01, PNorm = 76.8288, GNorm = 1.7761, lr_0 = 1.4563e-04
Loss = 2.3495e-01, PNorm = 76.8502, GNorm = 1.1417, lr_0 = 1.4142e-04
Validation prc-auc = 0.604538
Validation auc = 0.794898
Epoch 25
Loss = 1.7804e-01, PNorm = 76.8697, GNorm = 1.2554, lr_0 = 1.3692e-04
Loss = 2.0910e-01, PNorm = 76.8848, GNorm = 0.7808, lr_0 = 1.3296e-04
Loss = 2.3212e-01, PNorm = 76.9018, GNorm = 0.9704, lr_0 = 1.2911e-04
Validation prc-auc = 0.603765
Validation auc = 0.803673
Epoch 26
Loss = 2.1289e-01, PNorm = 76.9193, GNorm = 1.3719, lr_0 = 1.2501e-04
Loss = 2.0093e-01, PNorm = 76.9342, GNorm = 1.2342, lr_0 = 1.2139e-04
Validation prc-auc = 0.607070
Validation auc = 0.799592
Epoch 27
Loss = 2.2771e-01, PNorm = 76.9477, GNorm = 1.1392, lr_0 = 1.1753e-04
Loss = 2.3011e-01, PNorm = 76.9642, GNorm = 1.7392, lr_0 = 1.1413e-04
Loss = 2.4480e-01, PNorm = 76.9808, GNorm = 2.5285, lr_0 = 1.1083e-04
Validation prc-auc = 0.608187
Validation auc = 0.797959
Epoch 28
Loss = 1.6309e-01, PNorm = 76.9909, GNorm = 0.8883, lr_0 = 1.0730e-04
Loss = 1.9339e-01, PNorm = 77.0039, GNorm = 0.9124, lr_0 = 1.0420e-04
Loss = 2.3399e-01, PNorm = 77.0161, GNorm = 1.4771, lr_0 = 1.0118e-04
Validation prc-auc = 0.608010
Validation auc = 0.803061
Epoch 29
Loss = 1.8416e-01, PNorm = 77.0280, GNorm = 0.8984, lr_0 = 1.0000e-04
Loss = 1.8397e-01, PNorm = 77.0431, GNorm = 1.6847, lr_0 = 1.0000e-04
Loss = 2.0019e-01, PNorm = 77.0542, GNorm = 1.6579, lr_0 = 1.0000e-04
Validation prc-auc = 0.590269
Validation auc = 0.800612
Model 0 best validation prc-auc = 0.608187 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.466905
Model 0 test auc = 0.727901
Ensemble test prc-auc = 0.466905
Ensemble test auc = 0.727901
Fold 48
Splitting data with seed 48
Total scaffolds = 870 | train scaffolds = 643 | val scaffolds = 91 | test scaffolds = 136
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 8.0104e-01, PNorm = 72.7548, GNorm = 0.9523, lr_0 = 1.0000e-03
Loss = 4.6950e-01, PNorm = 73.1549, GNorm = 0.8982, lr_0 = 1.0000e-03
Validation prc-auc = 0.352012
Validation auc = 0.697807
Epoch 1
Loss = 3.4809e-01, PNorm = 73.3852, GNorm = 0.4604, lr_0 = 1.0000e-03
Loss = 4.2709e-01, PNorm = 73.4984, GNorm = 0.7226, lr_0 = 1.0000e-03
Loss = 4.8131e-01, PNorm = 73.5741, GNorm = 0.6838, lr_0 = 1.0000e-03
Validation prc-auc = 0.402309
Validation auc = 0.731297
Epoch 2
Loss = 4.0178e-01, PNorm = 73.6439, GNorm = 0.9567, lr_0 = 9.7965e-04
Loss = 4.2381e-01, PNorm = 73.7056, GNorm = 0.6662, lr_0 = 9.5130e-04
Loss = 4.0496e-01, PNorm = 73.7688, GNorm = 0.6475, lr_0 = 9.2376e-04
Validation prc-auc = 0.466337
Validation auc = 0.783980
Epoch 3
Loss = 4.1540e-01, PNorm = 73.8365, GNorm = 0.6145, lr_0 = 8.9440e-04
Loss = 4.3280e-01, PNorm = 73.9039, GNorm = 0.8919, lr_0 = 8.6851e-04
Loss = 4.0285e-01, PNorm = 73.9673, GNorm = 0.5720, lr_0 = 8.4337e-04
Validation prc-auc = 0.479118
Validation auc = 0.769879
Epoch 4
Loss = 3.6530e-01, PNorm = 74.0455, GNorm = 0.5482, lr_0 = 8.1656e-04
Loss = 3.5377e-01, PNorm = 74.1065, GNorm = 0.6278, lr_0 = 7.9293e-04
Loss = 4.0637e-01, PNorm = 74.1670, GNorm = 0.6141, lr_0 = 7.6998e-04
Loss = 1.3150e+00, PNorm = 74.1697, GNorm = 4.4344, lr_0 = 7.6772e-04
Validation prc-auc = 0.550901
Validation auc = 0.829416
Epoch 5
Loss = 4.0786e-01, PNorm = 74.2549, GNorm = 1.4188, lr_0 = 7.4550e-04
Loss = 3.8399e-01, PNorm = 74.3168, GNorm = 0.8365, lr_0 = 7.2393e-04
Validation prc-auc = 0.572224
Validation auc = 0.832942
Epoch 6
Loss = 3.6095e-01, PNorm = 74.3808, GNorm = 0.5644, lr_0 = 7.0091e-04
Loss = 3.9037e-01, PNorm = 74.4538, GNorm = 1.2990, lr_0 = 6.8063e-04
Loss = 3.4134e-01, PNorm = 74.5010, GNorm = 0.4735, lr_0 = 6.6093e-04
Validation prc-auc = 0.551490
Validation auc = 0.811790
Epoch 7
Loss = 3.4846e-01, PNorm = 74.5604, GNorm = 1.3720, lr_0 = 6.3992e-04
Loss = 4.0110e-01, PNorm = 74.5945, GNorm = 0.6623, lr_0 = 6.2139e-04
Loss = 3.7161e-01, PNorm = 74.6483, GNorm = 0.4760, lr_0 = 6.0341e-04
Validation prc-auc = 0.518486
Validation auc = 0.794164
Epoch 8
Loss = 2.8052e-01, PNorm = 74.7151, GNorm = 0.7966, lr_0 = 5.8595e-04
Loss = 3.3797e-01, PNorm = 74.7644, GNorm = 0.6508, lr_0 = 5.6899e-04
Loss = 3.9559e-01, PNorm = 74.8090, GNorm = 0.7561, lr_0 = 5.5252e-04
Validation prc-auc = 0.612173
Validation auc = 0.847434
Epoch 9
Loss = 3.6042e-01, PNorm = 74.8652, GNorm = 0.8777, lr_0 = 5.3495e-04
Loss = 3.3892e-01, PNorm = 74.9241, GNorm = 1.0977, lr_0 = 5.1947e-04
Loss = 3.5917e-01, PNorm = 74.9749, GNorm = 0.6389, lr_0 = 5.0444e-04
Validation prc-auc = 0.589288
Validation auc = 0.834313
Epoch 10
Loss = 3.8181e-01, PNorm = 75.0236, GNorm = 0.8081, lr_0 = 4.8840e-04
Loss = 3.7029e-01, PNorm = 75.0753, GNorm = 0.7999, lr_0 = 4.7426e-04
Validation prc-auc = 0.650329
Validation auc = 0.848805
Epoch 11
Loss = 4.3333e-01, PNorm = 75.1313, GNorm = 0.8818, lr_0 = 4.5919e-04
Loss = 2.8547e-01, PNorm = 75.1850, GNorm = 1.1406, lr_0 = 4.4590e-04
Loss = 3.3466e-01, PNorm = 75.2355, GNorm = 1.0542, lr_0 = 4.3299e-04
Validation prc-auc = 0.599725
Validation auc = 0.822366
Epoch 12
Loss = 4.2177e-01, PNorm = 75.2789, GNorm = 0.8375, lr_0 = 4.1923e-04
Loss = 3.1121e-01, PNorm = 75.3335, GNorm = 0.6239, lr_0 = 4.0709e-04
Loss = 3.4182e-01, PNorm = 75.3846, GNorm = 0.6538, lr_0 = 3.9531e-04
Validation prc-auc = 0.653422
Validation auc = 0.843126
Epoch 13
Loss = 3.6169e-01, PNorm = 75.4389, GNorm = 0.8040, lr_0 = 3.8274e-04
Loss = 2.9687e-01, PNorm = 75.4980, GNorm = 0.8518, lr_0 = 3.7167e-04
Loss = 3.3167e-01, PNorm = 75.5520, GNorm = 0.6606, lr_0 = 3.6091e-04
Validation prc-auc = 0.669814
Validation auc = 0.840776
Epoch 14
Loss = 3.0058e-01, PNorm = 75.6152, GNorm = 1.0596, lr_0 = 3.4944e-04
Loss = 3.0940e-01, PNorm = 75.6660, GNorm = 0.8811, lr_0 = 3.3932e-04
Loss = 3.3851e-01, PNorm = 75.7110, GNorm = 0.6949, lr_0 = 3.2950e-04
Validation prc-auc = 0.721857
Validation auc = 0.859381
Epoch 15
Loss = 3.3276e-01, PNorm = 75.7504, GNorm = 0.6155, lr_0 = 3.1996e-04
Loss = 3.1703e-01, PNorm = 75.8027, GNorm = 0.6880, lr_0 = 3.1070e-04
Loss = 2.9475e-01, PNorm = 75.8483, GNorm = 1.1950, lr_0 = 3.0171e-04
Loss = 2.7721e-01, PNorm = 75.8514, GNorm = 2.0906, lr_0 = 3.0083e-04
Validation prc-auc = 0.711263
Validation auc = 0.844301
Epoch 16
Loss = 3.4559e-01, PNorm = 75.8924, GNorm = 0.8675, lr_0 = 2.9212e-04
Loss = 2.5667e-01, PNorm = 75.9411, GNorm = 0.9723, lr_0 = 2.8367e-04
Validation prc-auc = 0.712238
Validation auc = 0.840188
Epoch 17
Loss = 2.8570e-01, PNorm = 75.9868, GNorm = 0.8336, lr_0 = 2.7465e-04
Loss = 3.0116e-01, PNorm = 76.0293, GNorm = 1.0586, lr_0 = 2.6670e-04
Loss = 2.7083e-01, PNorm = 76.0658, GNorm = 0.9292, lr_0 = 2.5898e-04
Validation prc-auc = 0.735722
Validation auc = 0.852331
Epoch 18
Loss = 3.1538e-01, PNorm = 76.1029, GNorm = 0.6018, lr_0 = 2.5075e-04
Loss = 2.7855e-01, PNorm = 76.1327, GNorm = 0.8997, lr_0 = 2.4349e-04
Loss = 2.8299e-01, PNorm = 76.1699, GNorm = 0.7485, lr_0 = 2.3644e-04
Validation prc-auc = 0.723685
Validation auc = 0.851939
Epoch 19
Loss = 2.4927e-01, PNorm = 76.2127, GNorm = 1.3338, lr_0 = 2.2893e-04
Loss = 2.8319e-01, PNorm = 76.2474, GNorm = 0.8969, lr_0 = 2.2230e-04
Loss = 2.8899e-01, PNorm = 76.2782, GNorm = 1.0085, lr_0 = 2.1587e-04
Validation prc-auc = 0.724858
Validation auc = 0.843517
Epoch 20
Loss = 2.5111e-01, PNorm = 76.3170, GNorm = 0.7562, lr_0 = 2.0900e-04
Loss = 2.8434e-01, PNorm = 76.3426, GNorm = 0.8504, lr_0 = 2.0295e-04
Loss = 2.6145e-01, PNorm = 76.3776, GNorm = 1.1964, lr_0 = 1.9708e-04
Loss = 3.0517e-01, PNorm = 76.3805, GNorm = 2.4059, lr_0 = 1.9650e-04
Validation prc-auc = 0.716480
Validation auc = 0.847434
Epoch 21
Loss = 2.8332e-01, PNorm = 76.4057, GNorm = 1.3253, lr_0 = 1.9081e-04
Loss = 2.3123e-01, PNorm = 76.4308, GNorm = 1.3162, lr_0 = 1.8529e-04
Validation prc-auc = 0.712185
Validation auc = 0.840188
Epoch 22
Loss = 2.3276e-01, PNorm = 76.4508, GNorm = 1.0234, lr_0 = 1.7993e-04
Loss = 2.6616e-01, PNorm = 76.4741, GNorm = 1.1113, lr_0 = 1.7472e-04
Loss = 2.5310e-01, PNorm = 76.4952, GNorm = 0.9402, lr_0 = 1.6966e-04
Validation prc-auc = 0.725038
Validation auc = 0.845280
Epoch 23
Loss = 2.6563e-01, PNorm = 76.5158, GNorm = 1.0097, lr_0 = 1.6427e-04
Loss = 2.5011e-01, PNorm = 76.5386, GNorm = 1.0444, lr_0 = 1.5952e-04
Loss = 2.3863e-01, PNorm = 76.5619, GNorm = 0.6681, lr_0 = 1.5490e-04
Validation prc-auc = 0.728044
Validation auc = 0.845084
Epoch 24
Loss = 2.6140e-01, PNorm = 76.5859, GNorm = 1.3936, lr_0 = 1.4998e-04
Loss = 2.1678e-01, PNorm = 76.6103, GNorm = 1.0500, lr_0 = 1.4563e-04
Loss = 2.5178e-01, PNorm = 76.6286, GNorm = 0.8443, lr_0 = 1.4142e-04
Validation prc-auc = 0.724519
Validation auc = 0.843126
Epoch 25
Loss = 2.5550e-01, PNorm = 76.6471, GNorm = 0.9097, lr_0 = 1.3692e-04
Loss = 2.4413e-01, PNorm = 76.6701, GNorm = 1.0844, lr_0 = 1.3296e-04
Loss = 2.0583e-01, PNorm = 76.6901, GNorm = 2.1221, lr_0 = 1.2911e-04
Validation prc-auc = 0.730691
Validation auc = 0.843517
Epoch 26
Loss = 2.1078e-01, PNorm = 76.7064, GNorm = 1.1419, lr_0 = 1.2501e-04
Loss = 2.4348e-01, PNorm = 76.7218, GNorm = 0.9873, lr_0 = 1.2139e-04
Validation prc-auc = 0.725723
Validation auc = 0.840384
Epoch 27
Loss = 1.8240e-01, PNorm = 76.7331, GNorm = 1.0272, lr_0 = 1.1753e-04
Loss = 2.2907e-01, PNorm = 76.7467, GNorm = 1.1451, lr_0 = 1.1413e-04
Loss = 2.2349e-01, PNorm = 76.7625, GNorm = 0.9355, lr_0 = 1.1083e-04
Validation prc-auc = 0.729069
Validation auc = 0.846063
Epoch 28
Loss = 1.6459e-01, PNorm = 76.7790, GNorm = 0.7274, lr_0 = 1.0730e-04
Loss = 2.4173e-01, PNorm = 76.7886, GNorm = 1.0614, lr_0 = 1.0420e-04
Loss = 1.9450e-01, PNorm = 76.8021, GNorm = 1.0504, lr_0 = 1.0118e-04
Validation prc-auc = 0.730129
Validation auc = 0.846455
Epoch 29
Loss = 2.3308e-01, PNorm = 76.8102, GNorm = 1.1622, lr_0 = 1.0000e-04
Loss = 2.0985e-01, PNorm = 76.8219, GNorm = 0.8555, lr_0 = 1.0000e-04
Loss = 2.0273e-01, PNorm = 76.8350, GNorm = 0.8361, lr_0 = 1.0000e-04
Validation prc-auc = 0.728005
Validation auc = 0.844497
Model 0 best validation prc-auc = 0.735722 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.614099
Model 0 test auc = 0.771488
Ensemble test prc-auc = 0.614099
Ensemble test auc = 0.771488
Fold 49
Splitting data with seed 49
Total scaffolds = 870 | train scaffolds = 653 | val scaffolds = 106 | test scaffolds = 111
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 229 | target average = 0.131004


Scaffold 1
Task 0: count = 159 | target average = 0.113208


Scaffold 2
Task 0: count = 26 | target average = 0.038462


Scaffold 3
Task 0: count = 19 | target average = 0.000000


Scaffold 4
Task 0: count = 18 | target average = 0.055556


Scaffold 5
Task 0: count = 16 | target average = 0.375000


Scaffold 6
Task 0: count = 14 | target average = 0.071429


Scaffold 7
Task 0: count = 11 | target average = 0.000000


Scaffold 8
Task 0: count = 10 | target average = 0.200000


Scaffold 9
Task 0: count = 10 | target average = 0.000000


Class sizes
hit 0: 81.41%, 1: 18.59%
Total size = 1,759 | train size = 1,407 | val size = 175 | test size = 177
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=1200, out_features=1200, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 6,340,801
Epoch 0
Loss = 6.2646e-01, PNorm = 72.8039, GNorm = 0.7809, lr_0 = 1.0000e-03
Loss = 4.7219e-01, PNorm = 73.2551, GNorm = 0.4953, lr_0 = 1.0000e-03
Validation prc-auc = 0.366997
Validation auc = 0.699041
Epoch 1
Loss = 4.3879e-01, PNorm = 73.5262, GNorm = 0.7977, lr_0 = 1.0000e-03
Loss = 4.5413e-01, PNorm = 73.6679, GNorm = 0.5244, lr_0 = 1.0000e-03
Loss = 4.2315e-01, PNorm = 73.7638, GNorm = 0.5611, lr_0 = 1.0000e-03
Validation prc-auc = 0.443475
Validation auc = 0.770384
Epoch 2
Loss = 4.4266e-01, PNorm = 73.8364, GNorm = 0.5373, lr_0 = 9.7965e-04
Loss = 4.2670e-01, PNorm = 73.8959, GNorm = 0.5809, lr_0 = 9.5130e-04
Loss = 4.5418e-01, PNorm = 73.9585, GNorm = 0.6153, lr_0 = 9.2376e-04
Validation prc-auc = 0.445537
Validation auc = 0.768585
Epoch 3
Loss = 4.4031e-01, PNorm = 74.0180, GNorm = 0.6823, lr_0 = 8.9440e-04
Loss = 4.1225e-01, PNorm = 74.0789, GNorm = 0.8627, lr_0 = 8.6851e-04
Loss = 3.8617e-01, PNorm = 74.1404, GNorm = 0.9676, lr_0 = 8.4337e-04
Validation prc-auc = 0.424426
Validation auc = 0.756595
Epoch 4
Loss = 3.8862e-01, PNorm = 74.2159, GNorm = 0.5621, lr_0 = 8.1656e-04
Loss = 3.5239e-01, PNorm = 74.2785, GNorm = 0.5930, lr_0 = 7.9293e-04
Loss = 4.3983e-01, PNorm = 74.3372, GNorm = 1.0873, lr_0 = 7.6998e-04
Loss = 6.1307e-01, PNorm = 74.3446, GNorm = 2.1103, lr_0 = 7.6772e-04
Validation prc-auc = 0.464433
Validation auc = 0.778577
Epoch 5
Loss = 4.1374e-01, PNorm = 74.4315, GNorm = 0.8752, lr_0 = 7.4550e-04
Loss = 4.0938e-01, PNorm = 74.5092, GNorm = 0.6459, lr_0 = 7.2393e-04
Validation prc-auc = 0.517568
Validation auc = 0.814548
Epoch 6
Loss = 3.2498e-01, PNorm = 74.6004, GNorm = 0.6492, lr_0 = 7.0091e-04
Loss = 4.0347e-01, PNorm = 74.6691, GNorm = 0.7330, lr_0 = 6.8063e-04
Loss = 3.5413e-01, PNorm = 74.7439, GNorm = 0.6694, lr_0 = 6.6093e-04
Validation prc-auc = 0.496243
Validation auc = 0.811751
Epoch 7
Loss = 3.7699e-01, PNorm = 74.8313, GNorm = 0.6710, lr_0 = 6.3992e-04
Loss = 3.9671e-01, PNorm = 74.9023, GNorm = 0.6681, lr_0 = 6.2139e-04
Loss = 3.4312e-01, PNorm = 74.9772, GNorm = 0.7313, lr_0 = 6.0341e-04
Validation prc-auc = 0.526014
Validation auc = 0.810152
Epoch 8
Loss = 3.4117e-01, PNorm = 75.0470, GNorm = 0.9459, lr_0 = 5.8595e-04
Loss = 3.8885e-01, PNorm = 75.1100, GNorm = 0.8883, lr_0 = 5.6899e-04
Loss = 3.7282e-01, PNorm = 75.1841, GNorm = 1.6814, lr_0 = 5.5252e-04
Validation prc-auc = 0.513791
Validation auc = 0.804956
Epoch 9
Loss = 3.4591e-01, PNorm = 75.2653, GNorm = 0.9266, lr_0 = 5.3495e-04
Loss = 3.6945e-01, PNorm = 75.3140, GNorm = 0.7042, lr_0 = 5.1947e-04
Loss = 3.6954e-01, PNorm = 75.3757, GNorm = 1.1713, lr_0 = 5.0444e-04
Validation prc-auc = 0.549321
Validation auc = 0.800759
Epoch 10
Loss = 3.1869e-01, PNorm = 75.4407, GNorm = 0.8940, lr_0 = 4.8840e-04
Loss = 3.5876e-01, PNorm = 75.4997, GNorm = 0.6645, lr_0 = 4.7426e-04
Validation prc-auc = 0.546312
Validation auc = 0.810751
Epoch 11
Loss = 2.4034e-01, PNorm = 75.5638, GNorm = 0.7305, lr_0 = 4.5919e-04
Loss = 3.6694e-01, PNorm = 75.6104, GNorm = 1.4017, lr_0 = 4.4590e-04
Loss = 3.2462e-01, PNorm = 75.6784, GNorm = 0.6827, lr_0 = 4.3299e-04
Validation prc-auc = 0.562784
Validation auc = 0.791966
Epoch 12
Loss = 2.6464e-01, PNorm = 75.7428, GNorm = 0.5254, lr_0 = 4.1923e-04
Loss = 3.0946e-01, PNorm = 75.7924, GNorm = 1.4094, lr_0 = 4.0709e-04
Loss = 3.3334e-01, PNorm = 75.8415, GNorm = 0.6601, lr_0 = 3.9531e-04
Validation prc-auc = 0.571971
Validation auc = 0.795963
Epoch 13
Loss = 3.4502e-01, PNorm = 75.8996, GNorm = 0.8253, lr_0 = 3.8274e-04
Loss = 2.9193e-01, PNorm = 75.9616, GNorm = 0.6098, lr_0 = 3.7167e-04
Loss = 3.3151e-01, PNorm = 76.0177, GNorm = 1.4879, lr_0 = 3.6091e-04
Validation prc-auc = 0.580784
Validation auc = 0.797162
Epoch 14
Loss = 2.8352e-01, PNorm = 76.0656, GNorm = 0.5971, lr_0 = 3.4944e-04
Loss = 3.0802e-01, PNorm = 76.1237, GNorm = 0.9810, lr_0 = 3.3932e-04
Loss = 3.4614e-01, PNorm = 76.1741, GNorm = 0.9700, lr_0 = 3.2950e-04
Validation prc-auc = 0.569717
Validation auc = 0.806954
Epoch 15
Loss = 2.9631e-01, PNorm = 76.2227, GNorm = 0.6870, lr_0 = 3.1996e-04
Loss = 2.9959e-01, PNorm = 76.2675, GNorm = 0.8133, lr_0 = 3.1070e-04
Loss = 3.1133e-01, PNorm = 76.3140, GNorm = 1.2371, lr_0 = 3.0171e-04
Loss = 1.0722e-01, PNorm = 76.3175, GNorm = 0.9604, lr_0 = 3.0083e-04
Validation prc-auc = 0.580613
Validation auc = 0.803357
Epoch 16
Loss = 2.8650e-01, PNorm = 76.3609, GNorm = 0.7488, lr_0 = 2.9212e-04
Loss = 2.6586e-01, PNorm = 76.4019, GNorm = 0.8953, lr_0 = 2.8367e-04
Validation prc-auc = 0.592191
Validation auc = 0.814548
Epoch 17
Loss = 3.6286e-01, PNorm = 76.4459, GNorm = 0.9357, lr_0 = 2.7465e-04
Loss = 2.7766e-01, PNorm = 76.4861, GNorm = 1.0073, lr_0 = 2.6670e-04
Loss = 2.7107e-01, PNorm = 76.5229, GNorm = 0.7987, lr_0 = 2.5898e-04
Validation prc-auc = 0.573754
Validation auc = 0.798361
Epoch 18
Loss = 3.1901e-01, PNorm = 76.5628, GNorm = 0.9805, lr_0 = 2.5075e-04
Loss = 2.6019e-01, PNorm = 76.5973, GNorm = 1.3834, lr_0 = 2.4349e-04
Loss = 2.6462e-01, PNorm = 76.6285, GNorm = 1.5467, lr_0 = 2.3644e-04
Validation prc-auc = 0.575371
Validation auc = 0.801759
Epoch 19
Loss = 2.6751e-01, PNorm = 76.6662, GNorm = 1.0163, lr_0 = 2.2893e-04
Loss = 2.5193e-01, PNorm = 76.6956, GNorm = 0.9994, lr_0 = 2.2230e-04
Loss = 2.5609e-01, PNorm = 76.7273, GNorm = 0.7579, lr_0 = 2.1587e-04
Validation prc-auc = 0.590413
Validation auc = 0.812950
Epoch 20
Loss = 2.4728e-01, PNorm = 76.7626, GNorm = 1.2542, lr_0 = 2.0900e-04
Loss = 2.8014e-01, PNorm = 76.7937, GNorm = 0.9489, lr_0 = 2.0295e-04
Loss = 2.5414e-01, PNorm = 76.8250, GNorm = 0.9107, lr_0 = 1.9708e-04
Loss = 1.3481e-01, PNorm = 76.8289, GNorm = 1.4754, lr_0 = 1.9650e-04
Validation prc-auc = 0.563114
Validation auc = 0.809552
Epoch 21
Loss = 2.7407e-01, PNorm = 76.8607, GNorm = 1.5615, lr_0 = 1.9081e-04
Loss = 2.4143e-01, PNorm = 76.8850, GNorm = 1.6864, lr_0 = 1.8529e-04
Validation prc-auc = 0.566340
Validation auc = 0.785771
Epoch 22
Loss = 2.4445e-01, PNorm = 76.9091, GNorm = 0.9849, lr_0 = 1.7993e-04
Loss = 2.2941e-01, PNorm = 76.9348, GNorm = 1.0140, lr_0 = 1.7472e-04
Loss = 2.2518e-01, PNorm = 76.9574, GNorm = 1.0629, lr_0 = 1.6966e-04
Validation prc-auc = 0.566156
Validation auc = 0.809752
Epoch 23
Loss = 2.4629e-01, PNorm = 76.9775, GNorm = 1.1451, lr_0 = 1.6427e-04
Loss = 2.1697e-01, PNorm = 76.9971, GNorm = 0.9605, lr_0 = 1.5952e-04
Loss = 2.4686e-01, PNorm = 77.0178, GNorm = 1.2487, lr_0 = 1.5490e-04
Validation prc-auc = 0.560361
Validation auc = 0.797962
Epoch 24
Loss = 2.3378e-01, PNorm = 77.0399, GNorm = 1.3111, lr_0 = 1.4998e-04
Loss = 2.2649e-01, PNorm = 77.0630, GNorm = 0.9116, lr_0 = 1.4563e-04
Loss = 2.0027e-01, PNorm = 77.0864, GNorm = 2.1034, lr_0 = 1.4142e-04
Validation prc-auc = 0.573407
Validation auc = 0.815548
Epoch 25
Loss = 2.3611e-01, PNorm = 77.1000, GNorm = 1.7579, lr_0 = 1.3692e-04
Loss = 2.3526e-01, PNorm = 77.1213, GNorm = 1.3680, lr_0 = 1.3296e-04
Loss = 1.9828e-01, PNorm = 77.1350, GNorm = 0.9664, lr_0 = 1.2911e-04
Validation prc-auc = 0.565445
Validation auc = 0.794764
Epoch 26
Loss = 1.8841e-01, PNorm = 77.1558, GNorm = 1.5641, lr_0 = 1.2501e-04
Loss = 2.3015e-01, PNorm = 77.1692, GNorm = 1.9080, lr_0 = 1.2139e-04
Validation prc-auc = 0.549428
Validation auc = 0.809353
Epoch 27
Loss = 3.6290e-01, PNorm = 77.1892, GNorm = 2.2904, lr_0 = 1.1753e-04
Loss = 1.6904e-01, PNorm = 77.2043, GNorm = 0.9433, lr_0 = 1.1413e-04
Loss = 2.2695e-01, PNorm = 77.2188, GNorm = 2.2105, lr_0 = 1.1083e-04
Validation prc-auc = 0.558510
Validation auc = 0.806755
Epoch 28
Loss = 1.9654e-01, PNorm = 77.2364, GNorm = 1.0564, lr_0 = 1.0730e-04
Loss = 2.0923e-01, PNorm = 77.2466, GNorm = 1.1571, lr_0 = 1.0420e-04
Loss = 2.2475e-01, PNorm = 77.2619, GNorm = 1.2011, lr_0 = 1.0118e-04
Validation prc-auc = 0.542039
Validation auc = 0.799960
Epoch 29
Loss = 2.8249e-01, PNorm = 77.2731, GNorm = 1.3696, lr_0 = 1.0000e-04
Loss = 1.8957e-01, PNorm = 77.2851, GNorm = 1.0510, lr_0 = 1.0000e-04
Loss = 2.0273e-01, PNorm = 77.2993, GNorm = 1.2401, lr_0 = 1.0000e-04
Validation prc-auc = 0.532479
Validation auc = 0.790767
Model 0 best validation prc-auc = 0.592191 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test prc-auc = 0.793394
Model 0 test auc = 0.924346
Ensemble test prc-auc = 0.793394
Ensemble test auc = 0.924346
50-fold cross validation
	Seed 0 ==> test prc-auc = 0.642396
	Seed 0 ==> test auc = 0.821267
	Seed 1 ==> test prc-auc = 0.495492
	Seed 1 ==> test auc = 0.724950
	Seed 2 ==> test prc-auc = 0.606983
	Seed 2 ==> test auc = 0.789009
	Seed 3 ==> test prc-auc = 0.617508
	Seed 3 ==> test auc = 0.761699
	Seed 4 ==> test prc-auc = 0.571876
	Seed 4 ==> test auc = 0.834321
	Seed 5 ==> test prc-auc = 0.508171
	Seed 5 ==> test auc = 0.766351
	Seed 6 ==> test prc-auc = 0.672879
	Seed 6 ==> test auc = 0.828571
	Seed 7 ==> test prc-auc = 0.637621
	Seed 7 ==> test auc = 0.815693
	Seed 8 ==> test prc-auc = 0.567053
	Seed 8 ==> test auc = 0.817971
	Seed 9 ==> test prc-auc = 0.668348
	Seed 9 ==> test auc = 0.847162
	Seed 10 ==> test prc-auc = 0.637621
	Seed 10 ==> test auc = 0.871983
	Seed 11 ==> test prc-auc = 0.634420
	Seed 11 ==> test auc = 0.845473
	Seed 12 ==> test prc-auc = 0.711764
	Seed 12 ==> test auc = 0.877319
	Seed 13 ==> test prc-auc = 0.636175
	Seed 13 ==> test auc = 0.821336
	Seed 14 ==> test prc-auc = 0.660523
	Seed 14 ==> test auc = 0.827883
	Seed 15 ==> test prc-auc = 0.679604
	Seed 15 ==> test auc = 0.782194
	Seed 16 ==> test prc-auc = 0.661487
	Seed 16 ==> test auc = 0.829246
	Seed 17 ==> test prc-auc = 0.663401
	Seed 17 ==> test auc = 0.839152
	Seed 18 ==> test prc-auc = 0.423667
	Seed 18 ==> test auc = 0.773810
	Seed 19 ==> test prc-auc = 0.716155
	Seed 19 ==> test auc = 0.831752
	Seed 20 ==> test prc-auc = 0.609091
	Seed 20 ==> test auc = 0.813869
	Seed 21 ==> test prc-auc = 0.585705
	Seed 21 ==> test auc = 0.743613
	Seed 22 ==> test prc-auc = 0.646887
	Seed 22 ==> test auc = 0.817168
	Seed 23 ==> test prc-auc = 0.573706
	Seed 23 ==> test auc = 0.777609
	Seed 24 ==> test prc-auc = 0.513564
	Seed 24 ==> test auc = 0.702713
	Seed 25 ==> test prc-auc = 0.575376
	Seed 25 ==> test auc = 0.775097
	Seed 26 ==> test prc-auc = 0.565234
	Seed 26 ==> test auc = 0.734981
	Seed 27 ==> test prc-auc = 0.457833
	Seed 27 ==> test auc = 0.826222
	Seed 28 ==> test prc-auc = 0.658104
	Seed 28 ==> test auc = 0.795438
	Seed 29 ==> test prc-auc = 0.653296
	Seed 29 ==> test auc = 0.880418
	Seed 30 ==> test prc-auc = 0.538950
	Seed 30 ==> test auc = 0.757507
	Seed 31 ==> test prc-auc = 0.458766
	Seed 31 ==> test auc = 0.729982
	Seed 32 ==> test prc-auc = 0.631764
	Seed 32 ==> test auc = 0.750434
	Seed 33 ==> test prc-auc = 0.508594
	Seed 33 ==> test auc = 0.796825
	Seed 34 ==> test prc-auc = 0.582113
	Seed 34 ==> test auc = 0.882469
	Seed 35 ==> test prc-auc = 0.680546
	Seed 35 ==> test auc = 0.863278
	Seed 36 ==> test prc-auc = 0.572619
	Seed 36 ==> test auc = 0.781324
	Seed 37 ==> test prc-auc = 0.556065
	Seed 37 ==> test auc = 0.759764
	Seed 38 ==> test prc-auc = 0.520886
	Seed 38 ==> test auc = 0.744832
	Seed 39 ==> test prc-auc = 0.702990
	Seed 39 ==> test auc = 0.836091
	Seed 40 ==> test prc-auc = 0.559172
	Seed 40 ==> test auc = 0.712413
	Seed 41 ==> test prc-auc = 0.664604
	Seed 41 ==> test auc = 0.757913
	Seed 42 ==> test prc-auc = 0.660888
	Seed 42 ==> test auc = 0.790157
	Seed 43 ==> test prc-auc = 0.622398
	Seed 43 ==> test auc = 0.803704
	Seed 44 ==> test prc-auc = 0.575120
	Seed 44 ==> test auc = 0.779730
	Seed 45 ==> test prc-auc = 0.526598
	Seed 45 ==> test auc = 0.751684
	Seed 46 ==> test prc-auc = 0.483801
	Seed 46 ==> test auc = 0.768670
	Seed 47 ==> test prc-auc = 0.466905
	Seed 47 ==> test auc = 0.727901
	Seed 48 ==> test prc-auc = 0.614099
	Seed 48 ==> test auc = 0.771488
	Seed 49 ==> test prc-auc = 0.793394
	Seed 49 ==> test auc = 0.924346
Overall test prc-auc = 0.599444 +/- 0.077033
Overall test auc = 0.797296 +/- 0.048742
Elapsed time = 3:42:34
