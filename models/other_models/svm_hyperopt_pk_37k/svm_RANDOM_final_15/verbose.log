Command line
python sklearn_train.py --num_bits 4096 --radius 2 --class_weight balanced --save_dir ../models/other_models/svm_hyperopt_pk_37k/svm_RANDOM_final_15 --data_path ../data/data_prep_for_ml/data_prep_for_ml_pk_37k_screen/FULL_03_19_2022.csv --num_folds 30 --dataset_type classification --features_path ../data/data_prep_for_ml/data_prep_for_ml_pk_37k_screen/FULL_03_19_2022.npz --no_features_scaling --split_type random --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --model_type svm --metric prc-auc --extra_metrics auc
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'class_weight': 'balanced',
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/data_prep_for_ml/data_prep_for_ml_pk_37k_screen/FULL_03_19_2022.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/data_prep_for_ml/data_prep_for_ml_pk_37k_screen/FULL_03_19_2022.npz'],
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'impute_mode': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'model_type': 'svm',
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'no_shared_atom_bond_ffn': False,
 'num_bits': 4096,
 'num_folds': 30,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_trees': 500,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'radius': 2,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../models/other_models/svm_hyperopt_pk_37k/svm_RANDOM_final_15',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'single_task': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Loading data
Splitting data with seed 0
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.6077232897731915
Test auc = 0.8839463603719837
Fold 1
Loading data
Splitting data with seed 1
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.49195912437719974
Test auc = 0.8866344678161957
Fold 2
Loading data
Splitting data with seed 2
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5563167996651295
Test auc = 0.8742670895065412
Fold 3
Loading data
Splitting data with seed 3
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5071233403157005
Test auc = 0.8830768647904578
Fold 4
Loading data
Splitting data with seed 4
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5442001265916908
Test auc = 0.8750937853107345
Fold 5
Loading data
Splitting data with seed 5
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5741995391983561
Test auc = 0.9024965937897689
Fold 6
Loading data
Splitting data with seed 6
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5509332159675978
Test auc = 0.8779034640171858
Fold 7
Loading data
Splitting data with seed 7
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5759783693747956
Test auc = 0.9064341673850205
Fold 8
Loading data
Splitting data with seed 8
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5745004452949761
Test auc = 0.9084938002936348
Fold 9
Loading data
Splitting data with seed 9
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5764481233018169
Test auc = 0.857313769385504
Fold 10
Loading data
Splitting data with seed 10
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.4842945212035766
Test auc = 0.9065293150007607
Fold 11
Loading data
Splitting data with seed 11
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5307983309010692
Test auc = 0.9250427159068144
Fold 12
Loading data
Splitting data with seed 12
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5178410972924848
Test auc = 0.8600854929201175
Fold 13
Loading data
Splitting data with seed 13
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5041100525595676
Test auc = 0.8478748916877457
Fold 14
Loading data
Splitting data with seed 14
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5383359884452994
Test auc = 0.9035175141242937
Fold 15
Loading data
Splitting data with seed 15
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.48734314160466513
Test auc = 0.8572998761965154
Fold 16
Loading data
Splitting data with seed 16
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5385370984631226
Test auc = 0.8902928643048128
Fold 17
Loading data
Splitting data with seed 17
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5259090682561818
Test auc = 0.8432862633689839
Fold 18
Loading data
Splitting data with seed 18
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.49112267461153225
Test auc = 0.8503684490291958
Fold 19
Loading data
Splitting data with seed 19
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5238856869001691
Test auc = 0.8791861780183009
Fold 20
Loading data
Splitting data with seed 20
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5880576718972721
Test auc = 0.907311992779568
Fold 21
Loading data
Splitting data with seed 21
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.4170268205739202
Test auc = 0.8301046119626039
Fold 22
Loading data
Splitting data with seed 22
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5049300338042676
Test auc = 0.8729424766561282
Fold 23
Loading data
Splitting data with seed 23
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5519618529564961
Test auc = 0.8790299040774627
Fold 24
Loading data
Splitting data with seed 24
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.530212526184585
Test auc = 0.8586706386734758
Fold 25
Loading data
Splitting data with seed 25
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5035221007599766
Test auc = 0.87987721956716
Fold 26
Loading data
Splitting data with seed 26
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5390140186278397
Test auc = 0.8881359481352018
Fold 27
Loading data
Splitting data with seed 27
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5227835108946836
Test auc = 0.8885191583933553
Fold 28
Loading data
Splitting data with seed 28
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.48089886455408726
Test auc = 0.8406362177988476
Fold 29
Loading data
Splitting data with seed 29
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
SVC()
Training
Test prc-auc = 0.5213170945363532
Test auc = 0.875697175141243
30-fold cross validation
	Seed 0 ==> test prc-auc = 0.607723
	Seed 0 ==> test auc = 0.883946
	Seed 1 ==> test prc-auc = 0.491959
	Seed 1 ==> test auc = 0.886634
	Seed 2 ==> test prc-auc = 0.556317
	Seed 2 ==> test auc = 0.874267
	Seed 3 ==> test prc-auc = 0.507123
	Seed 3 ==> test auc = 0.883077
	Seed 4 ==> test prc-auc = 0.544200
	Seed 4 ==> test auc = 0.875094
	Seed 5 ==> test prc-auc = 0.574200
	Seed 5 ==> test auc = 0.902497
	Seed 6 ==> test prc-auc = 0.550933
	Seed 6 ==> test auc = 0.877903
	Seed 7 ==> test prc-auc = 0.575978
	Seed 7 ==> test auc = 0.906434
	Seed 8 ==> test prc-auc = 0.574500
	Seed 8 ==> test auc = 0.908494
	Seed 9 ==> test prc-auc = 0.576448
	Seed 9 ==> test auc = 0.857314
	Seed 10 ==> test prc-auc = 0.484295
	Seed 10 ==> test auc = 0.906529
	Seed 11 ==> test prc-auc = 0.530798
	Seed 11 ==> test auc = 0.925043
	Seed 12 ==> test prc-auc = 0.517841
	Seed 12 ==> test auc = 0.860085
	Seed 13 ==> test prc-auc = 0.504110
	Seed 13 ==> test auc = 0.847875
	Seed 14 ==> test prc-auc = 0.538336
	Seed 14 ==> test auc = 0.903518
	Seed 15 ==> test prc-auc = 0.487343
	Seed 15 ==> test auc = 0.857300
	Seed 16 ==> test prc-auc = 0.538537
	Seed 16 ==> test auc = 0.890293
	Seed 17 ==> test prc-auc = 0.525909
	Seed 17 ==> test auc = 0.843286
	Seed 18 ==> test prc-auc = 0.491123
	Seed 18 ==> test auc = 0.850368
	Seed 19 ==> test prc-auc = 0.523886
	Seed 19 ==> test auc = 0.879186
	Seed 20 ==> test prc-auc = 0.588058
	Seed 20 ==> test auc = 0.907312
	Seed 21 ==> test prc-auc = 0.417027
	Seed 21 ==> test auc = 0.830105
	Seed 22 ==> test prc-auc = 0.504930
	Seed 22 ==> test auc = 0.872942
	Seed 23 ==> test prc-auc = 0.551962
	Seed 23 ==> test auc = 0.879030
	Seed 24 ==> test prc-auc = 0.530213
	Seed 24 ==> test auc = 0.858671
	Seed 25 ==> test prc-auc = 0.503522
	Seed 25 ==> test auc = 0.879877
	Seed 26 ==> test prc-auc = 0.539014
	Seed 26 ==> test auc = 0.888136
	Seed 27 ==> test prc-auc = 0.522784
	Seed 27 ==> test auc = 0.888519
	Seed 28 ==> test prc-auc = 0.480899
	Seed 28 ==> test auc = 0.840636
	Seed 29 ==> test prc-auc = 0.521317
	Seed 29 ==> test auc = 0.875697
Overall test prc-auc = 0.528709 +/- 0.038514
Overall test auc = 0.878002 +/- 0.022769
Elapsed time = 4:05:58
