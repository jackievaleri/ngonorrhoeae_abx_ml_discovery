Command line
python sklearn_train.py --num_bits 4096 --radius 2 --class_weight balanced --num_trees 250 --save_dir ../models/other_models/rfc_hyperopt_pk_37k/rfc_RANDOM_final_122 --data_path ../data/data_prep_for_ml/data_prep_for_ml_pk_37k_screen/FULL_03_19_2022.csv --num_folds 30 --dataset_type classification --features_path ../data/data_prep_for_ml/data_prep_for_ml_pk_37k_screen/FULL_03_19_2022.npz --no_features_scaling --split_type random --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --model_type random_forest --metric prc-auc --extra_metrics auc
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'class_weight': 'balanced',
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/data_prep_for_ml/data_prep_for_ml_pk_37k_screen/FULL_03_19_2022.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/data_prep_for_ml/data_prep_for_ml_pk_37k_screen/FULL_03_19_2022.npz'],
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'impute_mode': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'model_type': 'random_forest',
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'no_shared_atom_bond_ffn': False,
 'num_bits': 4096,
 'num_folds': 30,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_trees': 250,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'radius': 2,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../models/other_models/rfc_hyperopt_pk_37k/rfc_RANDOM_final_122',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'single_task': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Loading data
Splitting data with seed 0
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=0)
Training
Test prc-auc = 0.5006018864607402
Test auc = 0.9441710576643128
Fold 1
Loading data
Splitting data with seed 1
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=1)
Training
Test prc-auc = 0.36587307774504735
Test auc = 0.9023514690098603
Fold 2
Loading data
Splitting data with seed 2
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=2)
Training
Test prc-auc = 0.4237991731576048
Test auc = 0.9144786137842931
Fold 3
Loading data
Splitting data with seed 3
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=3)
Training
Test prc-auc = 0.39131404317747265
Test auc = 0.8957561138859246
Fold 4
Loading data
Splitting data with seed 4
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=4)
Training
Test prc-auc = 0.38104514909684467
Test auc = 0.921336723163842
Fold 5
Loading data
Splitting data with seed 5
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=5)
Training
Test prc-auc = 0.44759220252193643
Test auc = 0.918794313926957
Fold 6
Loading data
Splitting data with seed 6
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=6)
Training
Test prc-auc = 0.48542222924260064
Test auc = 0.9292884368659744
Fold 7
Loading data
Splitting data with seed 7
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=7)
Training
Test prc-auc = 0.5297838001125037
Test auc = 0.9311522015881806
Fold 8
Loading data
Splitting data with seed 8
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=8)
Training
Test prc-auc = 0.41041089085255467
Test auc = 0.9362714172989846
Fold 9
Loading data
Splitting data with seed 9
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=9)
Training
Test prc-auc = 0.5039590806856282
Test auc = 0.9306410599571735
Fold 10
Loading data
Splitting data with seed 10
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=10)
Training
Test prc-auc = 0.4029491312230711
Test auc = 0.9197320002282061
Fold 11
Loading data
Splitting data with seed 11
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=11)
Training
Test prc-auc = 0.36866981138426713
Test auc = 0.9322873337025559
Fold 12
Loading data
Splitting data with seed 12
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=12)
Training
Test prc-auc = 0.35904401906771577
Test auc = 0.9217387122628906
Fold 13
Loading data
Splitting data with seed 13
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=13)
Training
Test prc-auc = 0.39794738287116305
Test auc = 0.9324864554978864
Fold 14
Loading data
Splitting data with seed 14
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=14)
Training
Test prc-auc = 0.40494854869631747
Test auc = 0.928142372881356
Fold 15
Loading data
Splitting data with seed 15
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=15)
Training
Test prc-auc = 0.4370428870610093
Test auc = 0.9270837736912563
Fold 16
Loading data
Splitting data with seed 16
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=16)
Training
Test prc-auc = 0.38333493382338624
Test auc = 0.9119788185160427
Fold 17
Loading data
Splitting data with seed 17
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=17)
Training
Test prc-auc = 0.37546921883986917
Test auc = 0.876479988302139
Fold 18
Loading data
Splitting data with seed 18
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=18)
Training
Test prc-auc = 0.38751623720175987
Test auc = 0.9036507442868896
Fold 19
Loading data
Splitting data with seed 19
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=19)
Training
Test prc-auc = 0.33098899427547535
Test auc = 0.9107922309770163
Fold 20
Loading data
Splitting data with seed 20
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=20)
Training
Test prc-auc = 0.4398036303733226
Test auc = 0.9190507891753191
Fold 21
Loading data
Splitting data with seed 21
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=21)
Training
Test prc-auc = 0.356378073966639
Test auc = 0.9162409203072325
Fold 22
Loading data
Splitting data with seed 22
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=22)
Training
Test prc-auc = 0.3951455059481238
Test auc = 0.9073103540180869
Fold 23
Loading data
Splitting data with seed 23
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=23)
Training
Test prc-auc = 0.5040990455463729
Test auc = 0.9202413664683797
Fold 24
Loading data
Splitting data with seed 24
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=24)
Training
Test prc-auc = 0.43564866505732247
Test auc = 0.8973484490259126
Fold 25
Loading data
Splitting data with seed 25
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=25)
Training
Test prc-auc = 0.4241191464250476
Test auc = 0.9136068694875084
Fold 26
Loading data
Splitting data with seed 26
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=26)
Training
Test prc-auc = 0.40603814154994483
Test auc = 0.9150075363184204
Fold 27
Loading data
Splitting data with seed 27
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=27)
Training
Test prc-auc = 0.39909590485824653
Test auc = 0.9269048893647396
Fold 28
Loading data
Splitting data with seed 28
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=28)
Training
Test prc-auc = 0.3688932904811864
Test auc = 0.9389751742692919
Fold 29
Loading data
Splitting data with seed 29
Total size = 38,680 | train size = 30,944 | test size = 3,868
Computing morgan fingerprints
Building model
RandomForestClassifier(class_weight='balanced', n_estimators=250, n_jobs=-1,
                       random_state=29)
Training
Test prc-auc = 0.41855215797339784
Test auc = 0.9127615819209038
30-fold cross validation
	Seed 0 ==> test prc-auc = 0.500602
	Seed 0 ==> test auc = 0.944171
	Seed 1 ==> test prc-auc = 0.365873
	Seed 1 ==> test auc = 0.902351
	Seed 2 ==> test prc-auc = 0.423799
	Seed 2 ==> test auc = 0.914479
	Seed 3 ==> test prc-auc = 0.391314
	Seed 3 ==> test auc = 0.895756
	Seed 4 ==> test prc-auc = 0.381045
	Seed 4 ==> test auc = 0.921337
	Seed 5 ==> test prc-auc = 0.447592
	Seed 5 ==> test auc = 0.918794
	Seed 6 ==> test prc-auc = 0.485422
	Seed 6 ==> test auc = 0.929288
	Seed 7 ==> test prc-auc = 0.529784
	Seed 7 ==> test auc = 0.931152
	Seed 8 ==> test prc-auc = 0.410411
	Seed 8 ==> test auc = 0.936271
	Seed 9 ==> test prc-auc = 0.503959
	Seed 9 ==> test auc = 0.930641
	Seed 10 ==> test prc-auc = 0.402949
	Seed 10 ==> test auc = 0.919732
	Seed 11 ==> test prc-auc = 0.368670
	Seed 11 ==> test auc = 0.932287
	Seed 12 ==> test prc-auc = 0.359044
	Seed 12 ==> test auc = 0.921739
	Seed 13 ==> test prc-auc = 0.397947
	Seed 13 ==> test auc = 0.932486
	Seed 14 ==> test prc-auc = 0.404949
	Seed 14 ==> test auc = 0.928142
	Seed 15 ==> test prc-auc = 0.437043
	Seed 15 ==> test auc = 0.927084
	Seed 16 ==> test prc-auc = 0.383335
	Seed 16 ==> test auc = 0.911979
	Seed 17 ==> test prc-auc = 0.375469
	Seed 17 ==> test auc = 0.876480
	Seed 18 ==> test prc-auc = 0.387516
	Seed 18 ==> test auc = 0.903651
	Seed 19 ==> test prc-auc = 0.330989
	Seed 19 ==> test auc = 0.910792
	Seed 20 ==> test prc-auc = 0.439804
	Seed 20 ==> test auc = 0.919051
	Seed 21 ==> test prc-auc = 0.356378
	Seed 21 ==> test auc = 0.916241
	Seed 22 ==> test prc-auc = 0.395146
	Seed 22 ==> test auc = 0.907310
	Seed 23 ==> test prc-auc = 0.504099
	Seed 23 ==> test auc = 0.920241
	Seed 24 ==> test prc-auc = 0.435649
	Seed 24 ==> test auc = 0.897348
	Seed 25 ==> test prc-auc = 0.424119
	Seed 25 ==> test auc = 0.913607
	Seed 26 ==> test prc-auc = 0.406038
	Seed 26 ==> test auc = 0.915008
	Seed 27 ==> test prc-auc = 0.399096
	Seed 27 ==> test auc = 0.926905
	Seed 28 ==> test prc-auc = 0.368893
	Seed 28 ==> test auc = 0.938975
	Seed 29 ==> test prc-auc = 0.418552
	Seed 29 ==> test auc = 0.912762
Overall test prc-auc = 0.414516 +/- 0.048546
Overall test auc = 0.918535 +/- 0.014134
Elapsed time = 0:13:16
